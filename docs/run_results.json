{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.9", "generated_at": "2025-02-25T21:26:35.572395Z", "invocation_id": "508239b4-cfdc-4180-b402-c8a92e96defa", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:14.927360Z", "completed_at": "2025-02-25T21:26:14.955577Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:14.955879Z", "completed_at": "2025-02-25T21:26:14.955889Z"}], "thread_id": "Thread-1", "execution_time": 0.030852079391479492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.input_layer.condition", "compiled": true, "compiled_code": "select\n      cast(null as TEXT ) as condition_id\n    , cast(null as TEXT ) as person_id\n    , cast(null as TEXT ) as patient_id\n    , cast(null as TEXT ) as encounter_id\n    , cast(null as TEXT ) as claim_id\n    , cast(null as date) as recorded_date\n    , cast(null as date) as onset_date\n    , cast(null as date) as resolved_date\n    , cast(null as TEXT ) as status\n    , cast(null as TEXT ) as condition_type\n    , cast(null as TEXT ) as source_code_type\n    , cast(null as TEXT ) as source_code\n    , cast(null as TEXT ) as source_description\n    , cast(null as TEXT ) as normalized_code_type\n    , cast(null as TEXT ) as normalized_code\n    , cast(null as TEXT ) as normalized_description\n    , cast(null as integer ) as condition_rank\n    , cast(null as TEXT ) as present_on_admit_code\n    , cast(null as TEXT ) as present_on_admit_description\n    , cast(null as TEXT ) as data_source\n    , cast(null as TEXT ) as file_name\n    , cast(null as timestamp ) as ingest_datetime\nlimit 0", "relation_name": "tuva.input_layer.condition"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:14.951178Z", "completed_at": "2025-02-25T21:26:14.956697Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:14.957666Z", "completed_at": "2025-02-25T21:26:14.957670Z"}], "thread_id": "Thread-4", "execution_time": 0.03176999092102051, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.input_layer.location", "compiled": true, "compiled_code": "select\n      cast(null as TEXT ) as location_id\n    , cast(null as TEXT ) as npi\n    , cast(null as TEXT ) as name\n    , cast(null as TEXT ) as facility_type\n    , cast(null as TEXT ) as parent_organization\n    , cast(null as TEXT ) as address\n    , cast(null as TEXT ) as city\n    , cast(null as TEXT ) as state\n    , cast(null as TEXT ) as zip_code\n    , cast(null as float ) as latitude\n    , cast(null as float ) as longitude\n    , cast(null as TEXT ) as data_source\n    , cast(null as TEXT ) as file_name\n    , cast(null as timestamp ) as ingest_datetime\nlimit 0", "relation_name": "tuva.input_layer.location"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:14.938284Z", "completed_at": "2025-02-25T21:26:14.956877Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:14.958736Z", "completed_at": "2025-02-25T21:26:14.958739Z"}], "thread_id": "Thread-2", "execution_time": 0.032984018325805664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.input_layer.encounter", "compiled": true, "compiled_code": "select \n      cast(null as TEXT ) as encounter_id\n    , cast(null as TEXT ) as person_id\n    , cast(null as TEXT ) as patient_id\n    , cast(null as TEXT ) as encounter_type\n    , cast(null as date) as encounter_start_date\n    , cast(null as date) as encounter_end_date\n    , cast(null as integer ) as length_of_stay\n    , cast(null as TEXT ) as admit_source_code\n    , cast(null as TEXT ) as admit_source_description\n    , cast(null as TEXT ) as admit_type_code\n    , cast(null as TEXT ) as admit_type_description\n    , cast(null as TEXT ) as discharge_disposition_code\n    , cast(null as TEXT ) as discharge_disposition_description\n    , cast(null as TEXT ) as attending_provider_id\n    , cast(null as TEXT ) as attending_provider_name\n    , cast(null as TEXT ) as facility_id\n    , cast(null as TEXT ) as facility_name\n    , cast(null as TEXT ) as primary_diagnosis_code_type\n    , cast(null as TEXT ) as primary_diagnosis_code\n    , cast(null as TEXT ) as primary_diagnosis_description\n    , cast(null as TEXT ) as drg_code_type\n    , cast(null as TEXT ) as drg_code\n     , cast(null as TEXT ) as drg_description\n    , cast(null as numeric(28,6) ) as paid_amount\n    , cast(null as numeric(28,6) ) as allowed_amount\n    , cast(null as numeric(28,6) ) as charge_amount\n    , cast(null as TEXT ) as data_source\n    , cast(null as TEXT ) as file_name\n    , cast(null as timestamp ) as ingest_datetime\nlimit 0", "relation_name": "tuva.input_layer.encounter"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:14.944788Z", "completed_at": "2025-02-25T21:26:14.957471Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:14.959350Z", "completed_at": "2025-02-25T21:26:14.959353Z"}], "thread_id": "Thread-3", "execution_time": 0.03324007987976074, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.input_layer.lab_result", "compiled": true, "compiled_code": "select\n      cast(null as TEXT ) as lab_result_id\n    , cast(null as TEXT ) as person_id\n    , cast(null as TEXT ) as patient_id\n    , cast(null as TEXT ) as encounter_id\n    , cast(null as TEXT ) as accession_number\n    , cast(null as TEXT ) as source_code_type\n    , cast(null as TEXT ) as source_code\n    , cast(null as TEXT ) as source_description\n    , cast(null as TEXT ) as source_component\n    , cast(null as TEXT ) as normalized_code_type\n    , cast(null as TEXT ) as normalized_code\n    , cast(null as TEXT ) as normalized_description\n    , cast(null as TEXT ) as normalized_component\n    , cast(null as TEXT ) as status\n    , cast(null as TEXT ) as result\n    , cast(null as date) as result_date\n    , cast(null as date) as collection_date\n    , cast(null as TEXT ) as source_units\n    , cast(null as TEXT ) as normalized_units\n    , cast(null as TEXT ) as source_reference_range_low\n    , cast(null as TEXT ) as source_reference_range_high\n    , cast(null as TEXT ) as normalized_reference_range_low\n    , cast(null as TEXT ) as normalized_reference_range_high\n    , cast(null as integer ) as source_abnormal_flag\n    , cast(null as integer ) as normalized_abnormal_flag\n    , cast(null as TEXT ) as specimen\n    , cast(null as TEXT ) as ordering_practitioner_id\n    , cast(null as TEXT ) as data_source\n    , cast(null as TEXT ) as file_name\n    , cast(null as timestamp ) as ingest_datetime\nlimit 0", "relation_name": "tuva.input_layer.lab_result"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:14.960557Z", "completed_at": "2025-02-25T21:26:14.973328Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:14.983121Z", "completed_at": "2025-02-25T21:26:14.983128Z"}], "thread_id": "Thread-1", "execution_time": 0.02616119384765625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.input_layer.medication", "compiled": true, "compiled_code": "select \n      cast(null as TEXT ) as medication_id\n    , cast(null as TEXT ) as person_id\n    , cast(null as TEXT ) as patient_id\n    , cast(null as TEXT ) as encounter_id\n    , cast(null as date) as dispensing_date\n    , cast(null as date) as prescribing_date\n    , cast(null as TEXT ) as source_code_type\n    , cast(null as TEXT ) as source_code\n    , cast(null as TEXT ) as source_description\n    , cast(null as TEXT ) as ndc_code\n    , cast(null as TEXT ) as ndc_description\n    , cast(null as TEXT ) as rxnorm_code\n    , cast(null as TEXT ) as rxnorm_description\n    , cast(null as TEXT ) as atc_code\n    , cast(null as TEXT ) as atc_description\n    , cast(null as TEXT ) as route\n    , cast(null as TEXT ) as strength\n    , cast(null as integer ) as quantity\n    , cast(null as TEXT ) as quantity_unit\n    , cast(null as integer ) as days_supply\n    , cast(null as TEXT ) as practitioner_id\n    , cast(null as TEXT ) as data_source\n    , cast(null as TEXT ) as file_name\n    , cast(null as timestamp ) as ingest_datetime\nlimit 0", "relation_name": "tuva.input_layer.medication"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:14.967919Z", "completed_at": "2025-02-25T21:26:14.984332Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:14.985071Z", "completed_at": "2025-02-25T21:26:14.985076Z"}], "thread_id": "Thread-4", "execution_time": 0.018928050994873047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.input_layer.observation", "compiled": true, "compiled_code": "select\n      cast(null as TEXT ) as observation_id\n    , cast(null as TEXT ) as person_id\n    , cast(null as TEXT ) as patient_id\n    , cast(null as TEXT ) as encounter_id\n    , cast(null as TEXT ) as panel_id\n    , cast(null as date) as observation_date\n    , cast(null as TEXT ) as observation_type\n    , cast(null as TEXT ) as source_code_type\n    , cast(null as TEXT ) as source_code\n    , cast(null as TEXT ) as source_description\n    , cast(null as TEXT ) as normalized_code_type\n    , cast(null as TEXT ) as normalized_code\n    , cast(null as TEXT ) as normalized_description\n    , cast(null as TEXT ) as result\n    , cast(null as TEXT ) as source_units\n    , cast(null as TEXT ) as normalized_units\n    , cast(null as TEXT ) as source_reference_range_low\n    , cast(null as TEXT ) as source_reference_range_high\n    , cast(null as TEXT ) as normalized_reference_range_low\n    , cast(null as TEXT ) as normalized_reference_range_high\n    , cast(null as TEXT ) as data_source\n    , cast(null as TEXT ) as file_name\n    , cast(null as timestamp ) as ingest_datetime\nlimit 0", "relation_name": "tuva.input_layer.observation"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:14.978910Z", "completed_at": "2025-02-25T21:26:14.985494Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:14.991151Z", "completed_at": "2025-02-25T21:26:14.991156Z"}], "thread_id": "Thread-3", "execution_time": 0.024197101593017578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.input_layer.practitioner", "compiled": true, "compiled_code": "select\n      cast(null as TEXT ) as practitioner_id\n    , cast(null as TEXT ) as npi\n    , cast(null as TEXT ) as first_name\n    , cast(null as TEXT ) as last_name\n    , cast(null as TEXT ) as practice_affiliation\n    , cast(null as TEXT ) as specialty\n    , cast(null as TEXT ) as sub_specialty\n    , cast(null as TEXT ) as data_source\n    , cast(null as TEXT ) as file_name\n    , cast(null as timestamp ) as ingest_datetime\nlimit 0", "relation_name": "tuva.input_layer.practitioner"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:14.973574Z", "completed_at": "2025-02-25T21:26:14.985685Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:14.991738Z", "completed_at": "2025-02-25T21:26:14.991741Z"}], "thread_id": "Thread-2", "execution_time": 0.025051116943359375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.input_layer.patient", "compiled": true, "compiled_code": "select\n      cast(null as TEXT ) as person_id\n    , cast(null as TEXT ) as patient_id\n    , cast(null as TEXT ) as first_name\n    , cast(null as TEXT ) as last_name\n    , cast(null as TEXT ) as sex\n    , cast(null as TEXT ) as race\n    , cast(null as date) as birth_date\n    , cast(null as date) as death_date\n    , cast(null as integer ) as death_flag\n    , cast(null as TEXT ) as social_security_number\n    , cast(null as TEXT ) as address\n    , cast(null as TEXT ) as city\n    , cast(null as TEXT ) as state\n    , cast(null as TEXT ) as zip_code\n    , cast(null as TEXT ) as county\n    , cast(null as float ) as latitude\n    , cast(null as float ) as longitude\n    , cast(null as TEXT ) as phone\n    , cast(null as TEXT ) as data_source\n    , cast(null as TEXT ) as file_name\n    , cast(null as timestamp ) as ingest_datetime\nlimit 0", "relation_name": "tuva.input_layer.patient"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:14.985894Z", "completed_at": "2025-02-25T21:26:14.993220Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:14.994426Z", "completed_at": "2025-02-25T21:26:14.994431Z"}], "thread_id": "Thread-1", "execution_time": 0.010487794876098633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.input_layer.procedure", "compiled": true, "compiled_code": "select\n      cast(null as TEXT ) as procedure_id\n    , cast(null as TEXT ) as person_id\n    , cast(null as TEXT ) as patient_id\n    , cast(null as TEXT ) as encounter_id\n    , cast(null as TEXT ) as claim_id\n    , cast(null as date) as procedure_date\n    , cast(null as TEXT ) as source_code_type\n    , cast(null as TEXT ) as source_code\n    , cast(null as TEXT ) as source_description\n    , cast(null as TEXT ) as normalized_code_type\n    , cast(null as TEXT ) as normalized_code\n    , cast(null as TEXT ) as normalized_description\n    , cast(null as TEXT ) as modifier_1\n    , cast(null as TEXT ) as modifier_2\n    , cast(null as TEXT ) as modifier_3\n    , cast(null as TEXT ) as modifier_4\n    , cast(null as TEXT ) as modifier_5\n    , cast(null as TEXT ) as practitioner_id\n    , cast(null as TEXT ) as data_source\n    , cast(null as TEXT ) as file_name\n    , cast(null as timestamp ) as ingest_datetime\nlimit 0", "relation_name": "tuva.input_layer.procedure"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.003823Z", "completed_at": "2025-02-25T21:26:15.005216Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.007934Z", "completed_at": "2025-02-25T21:26:15.007940Z"}], "thread_id": "Thread-3", "execution_time": 0.014127969741821289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.input_layer.eligibility_seed", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.005430Z", "completed_at": "2025-02-25T21:26:15.007282Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.008294Z", "completed_at": "2025-02-25T21:26:15.008297Z"}], "thread_id": "Thread-2", "execution_time": 0.014153003692626953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.input_layer.lab_result_seed", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.009984Z", "completed_at": "2025-02-25T21:26:15.011498Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.012954Z", "completed_at": "2025-02-25T21:26:15.012959Z"}], "thread_id": "Thread-1", "execution_time": 0.0055239200592041016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.input_layer.medical_claim_seed", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.013927Z", "completed_at": "2025-02-25T21:26:15.015202Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.017680Z", "completed_at": "2025-02-25T21:26:15.017686Z"}], "thread_id": "Thread-3", "execution_time": 0.005679130554199219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.input_layer.observation_seed", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.015558Z", "completed_at": "2025-02-25T21:26:15.016788Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.018078Z", "completed_at": "2025-02-25T21:26:15.018082Z"}], "thread_id": "Thread-2", "execution_time": 0.005522251129150391, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.input_layer.pharmacy_claim_seed", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.019262Z", "completed_at": "2025-02-25T21:26:15.020625Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.021377Z", "completed_at": "2025-02-25T21:26:15.021381Z"}], "thread_id": "Thread-1", "execution_time": 0.004235982894897461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.input_layer.provider_attribution_seed", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.022292Z", "completed_at": "2025-02-25T21:26:15.024393Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.026707Z", "completed_at": "2025-02-25T21:26:15.026712Z"}], "thread_id": "Thread-3", "execution_time": 0.005884885787963867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.ccsr__dxccsr_v2023_1_body_systems", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.024750Z", "completed_at": "2025-02-25T21:26:15.026115Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.027082Z", "completed_at": "2025-02-25T21:26:15.027085Z"}], "thread_id": "Thread-2", "execution_time": 0.00598597526550293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.ccsr__dxccsr_v2023_1_cleaned_map", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.028183Z", "completed_at": "2025-02-25T21:26:15.029445Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.030118Z", "completed_at": "2025-02-25T21:26:15.030121Z"}], "thread_id": "Thread-1", "execution_time": 0.0037403106689453125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.ccsr__prccsr_v2023_1_cleaned_map", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.031043Z", "completed_at": "2025-02-25T21:26:15.032283Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.034342Z", "completed_at": "2025-02-25T21:26:15.034347Z"}], "thread_id": "Thread-3", "execution_time": 0.004748106002807617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.chronic_conditions__cms_chronic_conditions_hierarchy", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.032542Z", "completed_at": "2025-02-25T21:26:15.033821Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.034760Z", "completed_at": "2025-02-25T21:26:15.034764Z"}], "thread_id": "Thread-2", "execution_time": 0.00492095947265625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.chronic_conditions__tuva_chronic_conditions_hierarchy", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.035834Z", "completed_at": "2025-02-25T21:26:15.037225Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.037893Z", "completed_at": "2025-02-25T21:26:15.037897Z"}], "thread_id": "Thread-1", "execution_time": 0.0038900375366210938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.clinical_concept_library__clinical_concepts", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.038818Z", "completed_at": "2025-02-25T21:26:15.040791Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.042709Z", "completed_at": "2025-02-25T21:26:15.042713Z"}], "thread_id": "Thread-3", "execution_time": 0.005326747894287109, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.clinical_concept_library__coding_systems", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.041012Z", "completed_at": "2025-02-25T21:26:15.042222Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.043080Z", "completed_at": "2025-02-25T21:26:15.043083Z"}], "thread_id": "Thread-2", "execution_time": 0.0054531097412109375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.clinical_concept_library__value_set_members", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.044243Z", "completed_at": "2025-02-25T21:26:15.045558Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.046214Z", "completed_at": "2025-02-25T21:26:15.046218Z"}], "thread_id": "Thread-1", "execution_time": 0.0038106441497802734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.cms_hcc__adjustment_rates", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.047142Z", "completed_at": "2025-02-25T21:26:15.048358Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.050244Z", "completed_at": "2025-02-25T21:26:15.050247Z"}], "thread_id": "Thread-3", "execution_time": 0.004518985748291016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.cms_hcc__cpt_hcpcs", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.048583Z", "completed_at": "2025-02-25T21:26:15.049794Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.050567Z", "completed_at": "2025-02-25T21:26:15.050571Z"}], "thread_id": "Thread-2", "execution_time": 0.0046117305755615234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.cms_hcc__demographic_factors", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.051581Z", "completed_at": "2025-02-25T21:26:15.053469Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.054109Z", "completed_at": "2025-02-25T21:26:15.054112Z"}], "thread_id": "Thread-1", "execution_time": 0.0041348934173583984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.cms_hcc__disabled_interaction_factors", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.055025Z", "completed_at": "2025-02-25T21:26:15.056233Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.058067Z", "completed_at": "2025-02-25T21:26:15.058070Z"}], "thread_id": "Thread-3", "execution_time": 0.0044400691986083984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.cms_hcc__disease_factors", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.056435Z", "completed_at": "2025-02-25T21:26:15.057617Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.058428Z", "completed_at": "2025-02-25T21:26:15.058431Z"}], "thread_id": "Thread-2", "execution_time": 0.004575014114379883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.cms_hcc__disease_hierarchy", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.059540Z", "completed_at": "2025-02-25T21:26:15.060991Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.061724Z", "completed_at": "2025-02-25T21:26:15.061729Z"}], "thread_id": "Thread-1", "execution_time": 0.003957033157348633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.cms_hcc__disease_interaction_factors", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.062646Z", "completed_at": "2025-02-25T21:26:15.063933Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.066061Z", "completed_at": "2025-02-25T21:26:15.066066Z"}], "thread_id": "Thread-3", "execution_time": 0.004879951477050781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.cms_hcc__enrollment_interaction_factors", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.064238Z", "completed_at": "2025-02-25T21:26:15.065572Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.066414Z", "completed_at": "2025-02-25T21:26:15.066417Z"}], "thread_id": "Thread-2", "execution_time": 0.004961967468261719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.cms_hcc__icd_10_cm_mappings", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.067420Z", "completed_at": "2025-02-25T21:26:15.069457Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.070163Z", "completed_at": "2025-02-25T21:26:15.070167Z"}], "thread_id": "Thread-1", "execution_time": 0.004402875900268555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.cms_hcc__payment_hcc_count_factors", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.071106Z", "completed_at": "2025-02-25T21:26:15.072364Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.074255Z", "completed_at": "2025-02-25T21:26:15.074259Z"}], "thread_id": "Thread-3", "execution_time": 0.004608154296875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.data_quality__crosswalk_field_info", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.072590Z", "completed_at": "2025-02-25T21:26:15.073793Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.074669Z", "completed_at": "2025-02-25T21:26:15.074673Z"}], "thread_id": "Thread-2", "execution_time": 0.004785299301147461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.data_quality__crosswalk_field_to_mart", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.075916Z", "completed_at": "2025-02-25T21:26:15.077251Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.077919Z", "completed_at": "2025-02-25T21:26:15.077923Z"}], "thread_id": "Thread-1", "execution_time": 0.003942012786865234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.data_quality__crosswalk_mart_to_outcome_measure", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.078877Z", "completed_at": "2025-02-25T21:26:15.080130Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.082052Z", "completed_at": "2025-02-25T21:26:15.082056Z"}], "thread_id": "Thread-3", "execution_time": 0.004635810852050781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.data_quality__crosswalk_measure_reasonable_ranges", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.080370Z", "completed_at": "2025-02-25T21:26:15.081583Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.082403Z", "completed_at": "2025-02-25T21:26:15.082406Z"}], "thread_id": "Thread-2", "execution_time": 0.004743099212646484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.data_quality__reference_mart_analytics", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.083411Z", "completed_at": "2025-02-25T21:26:15.085438Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.086195Z", "completed_at": "2025-02-25T21:26:15.086201Z"}], "thread_id": "Thread-1", "execution_time": 0.004459857940673828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.ed_classification__categories", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.087189Z", "completed_at": "2025-02-25T21:26:15.088459Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.090362Z", "completed_at": "2025-02-25T21:26:15.090365Z"}], "thread_id": "Thread-3", "execution_time": 0.004764080047607422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.ed_classification__icd_10_cm_to_ccs", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.088696Z", "completed_at": "2025-02-25T21:26:15.089939Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.090702Z", "completed_at": "2025-02-25T21:26:15.090706Z"}], "thread_id": "Thread-2", "execution_time": 0.004815101623535156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.ed_classification__johnston_icd10", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.091747Z", "completed_at": "2025-02-25T21:26:15.092998Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.093635Z", "completed_at": "2025-02-25T21:26:15.093638Z"}], "thread_id": "Thread-1", "execution_time": 0.003547191619873047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.ed_classification__johnston_icd9", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.094538Z", "completed_at": "2025-02-25T21:26:15.095762Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.098401Z", "completed_at": "2025-02-25T21:26:15.098405Z"}], "thread_id": "Thread-3", "execution_time": 0.005243062973022461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.hcc_suspecting__clinical_concepts", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.096024Z", "completed_at": "2025-02-25T21:26:15.097953Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.098744Z", "completed_at": "2025-02-25T21:26:15.098748Z"}], "thread_id": "Thread-2", "execution_time": 0.005366086959838867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.hcc_suspecting__hcc_descriptions", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.099714Z", "completed_at": "2025-02-25T21:26:15.100979Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.101606Z", "completed_at": "2025-02-25T21:26:15.101609Z"}], "thread_id": "Thread-1", "execution_time": 0.0034821033477783203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.hcc_suspecting__icd_10_cm_mappings", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.102567Z", "completed_at": "2025-02-25T21:26:15.103782Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.105610Z", "completed_at": "2025-02-25T21:26:15.105614Z"}], "thread_id": "Thread-3", "execution_time": 0.00448298454284668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.pharmacy__rxnorm_generic_available", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.103985Z", "completed_at": "2025-02-25T21:26:15.105185Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.105938Z", "completed_at": "2025-02-25T21:26:15.105941Z"}], "thread_id": "Thread-2", "execution_time": 0.0045909881591796875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.pqi__measures", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.106939Z", "completed_at": "2025-02-25T21:26:15.108171Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.108782Z", "completed_at": "2025-02-25T21:26:15.108785Z"}], "thread_id": "Thread-1", "execution_time": 0.0034461021423339844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.pqi__value_sets", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.109710Z", "completed_at": "2025-02-25T21:26:15.110953Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.113521Z", "completed_at": "2025-02-25T21:26:15.113525Z"}], "thread_id": "Thread-3", "execution_time": 0.005204916000366211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.quality_measures__concepts", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.111167Z", "completed_at": "2025-02-25T21:26:15.113085Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.113850Z", "completed_at": "2025-02-25T21:26:15.113853Z"}], "thread_id": "Thread-2", "execution_time": 0.005319356918334961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.quality_measures__measures", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.114913Z", "completed_at": "2025-02-25T21:26:15.116145Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.116779Z", "completed_at": "2025-02-25T21:26:15.116783Z"}], "thread_id": "Thread-1", "execution_time": 0.003534078598022461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.quality_measures__value_sets", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.117747Z", "completed_at": "2025-02-25T21:26:15.118956Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.120796Z", "completed_at": "2025-02-25T21:26:15.120800Z"}], "thread_id": "Thread-3", "execution_time": 0.004498004913330078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.readmissions__acute_diagnosis_ccs", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.119191Z", "completed_at": "2025-02-25T21:26:15.120383Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.121126Z", "completed_at": "2025-02-25T21:26:15.121129Z"}], "thread_id": "Thread-2", "execution_time": 0.004608154296875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.readmissions__acute_diagnosis_icd_10_cm", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.122088Z", "completed_at": "2025-02-25T21:26:15.123292Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.123914Z", "completed_at": "2025-02-25T21:26:15.123917Z"}], "thread_id": "Thread-1", "execution_time": 0.0033860206604003906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.readmissions__always_planned_ccs_diagnosis_category", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.124819Z", "completed_at": "2025-02-25T21:26:15.126025Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.128604Z", "completed_at": "2025-02-25T21:26:15.128608Z"}], "thread_id": "Thread-3", "execution_time": 0.00516510009765625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.readmissions__always_planned_ccs_procedure_category", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.126246Z", "completed_at": "2025-02-25T21:26:15.128177Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.128944Z", "completed_at": "2025-02-25T21:26:15.128947Z"}], "thread_id": "Thread-2", "execution_time": 0.0052852630615234375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.readmissions__exclusion_ccs_diagnosis_category", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.129888Z", "completed_at": "2025-02-25T21:26:15.131111Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.131742Z", "completed_at": "2025-02-25T21:26:15.131745Z"}], "thread_id": "Thread-1", "execution_time": 0.003404855728149414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.readmissions__icd_10_cm_to_ccs", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.132655Z", "completed_at": "2025-02-25T21:26:15.133873Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.135711Z", "completed_at": "2025-02-25T21:26:15.135714Z"}], "thread_id": "Thread-3", "execution_time": 0.004451751708984375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.readmissions__icd_10_pcs_to_ccs", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.134089Z", "completed_at": "2025-02-25T21:26:15.135286Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.136044Z", "completed_at": "2025-02-25T21:26:15.136046Z"}], "thread_id": "Thread-2", "execution_time": 0.004561185836791992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.readmissions__potentially_planned_ccs_procedure_category", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.137011Z", "completed_at": "2025-02-25T21:26:15.138245Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.138870Z", "completed_at": "2025-02-25T21:26:15.138873Z"}], "thread_id": "Thread-1", "execution_time": 0.0034308433532714844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.readmissions__potentially_planned_icd_10_pcs", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.139818Z", "completed_at": "2025-02-25T21:26:15.141723Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.143600Z", "completed_at": "2025-02-25T21:26:15.143603Z"}], "thread_id": "Thread-3", "execution_time": 0.005201816558837891, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.readmissions__specialty_cohort", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.141943Z", "completed_at": "2025-02-25T21:26:15.143118Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.143935Z", "completed_at": "2025-02-25T21:26:15.143938Z"}], "thread_id": "Thread-2", "execution_time": 0.005320072174072266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.readmissions__surgery_gynecology_cohort", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.145017Z", "completed_at": "2025-02-25T21:26:15.146258Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.150436Z", "completed_at": "2025-02-25T21:26:15.150441Z"}], "thread_id": "Thread-1", "execution_time": 0.0071239471435546875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.reference_data__ansi_fips_state", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.151426Z", "completed_at": "2025-02-25T21:26:15.152720Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.154570Z", "completed_at": "2025-02-25T21:26:15.154574Z"}], "thread_id": "Thread-3", "execution_time": 0.008159875869750977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.reference_data__calendar", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.152924Z", "completed_at": "2025-02-25T21:26:15.154124Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.154902Z", "completed_at": "2025-02-25T21:26:15.154905Z"}], "thread_id": "Thread-2", "execution_time": 0.0048389434814453125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.reference_data__code_type", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.155909Z", "completed_at": "2025-02-25T21:26:15.157127Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.157837Z", "completed_at": "2025-02-25T21:26:15.157840Z"}], "thread_id": "Thread-1", "execution_time": 0.0035352706909179688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.reference_data__fips_county", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.158733Z", "completed_at": "2025-02-25T21:26:15.160689Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.162542Z", "completed_at": "2025-02-25T21:26:15.162545Z"}], "thread_id": "Thread-3", "execution_time": 0.005199909210205078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.reference_data__ssa_fips_state", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.160913Z", "completed_at": "2025-02-25T21:26:15.162116Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.162874Z", "completed_at": "2025-02-25T21:26:15.162877Z"}], "thread_id": "Thread-2", "execution_time": 0.005298137664794922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.service_category__service_categories", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.163825Z", "completed_at": "2025-02-25T21:26:15.165045Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.165653Z", "completed_at": "2025-02-25T21:26:15.165656Z"}], "thread_id": "Thread-1", "execution_time": 0.003384113311767578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.terminology__admit_source", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.166562Z", "completed_at": "2025-02-25T21:26:15.167776Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.169711Z", "completed_at": "2025-02-25T21:26:15.169714Z"}], "thread_id": "Thread-3", "execution_time": 0.004524707794189453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.terminology__admit_type", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.168024Z", "completed_at": "2025-02-25T21:26:15.169269Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.170053Z", "completed_at": "2025-02-25T21:26:15.170056Z"}], "thread_id": "Thread-2", "execution_time": 0.004705905914306641, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.terminology__apr_drg", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.171173Z", "completed_at": "2025-02-25T21:26:15.173149Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.173790Z", "completed_at": "2025-02-25T21:26:15.173794Z"}], "thread_id": "Thread-1", "execution_time": 0.004356861114501953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.terminology__bill_type", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.174694Z", "completed_at": "2025-02-25T21:26:15.175914Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.177774Z", "completed_at": "2025-02-25T21:26:15.177778Z"}], "thread_id": "Thread-3", "execution_time": 0.004464149475097656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.terminology__ccs_services_procedures", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.176141Z", "completed_at": "2025-02-25T21:26:15.177352Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.178104Z", "completed_at": "2025-02-25T21:26:15.178107Z"}], "thread_id": "Thread-2", "execution_time": 0.004569053649902344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.terminology__claim_type", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.179054Z", "completed_at": "2025-02-25T21:26:15.180268Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.180892Z", "completed_at": "2025-02-25T21:26:15.180896Z"}], "thread_id": "Thread-1", "execution_time": 0.0033898353576660156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.terminology__discharge_disposition", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.181790Z", "completed_at": "2025-02-25T21:26:15.183014Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.184914Z", "completed_at": "2025-02-25T21:26:15.184917Z"}], "thread_id": "Thread-3", "execution_time": 0.0044977664947509766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.terminology__encounter_type", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.183271Z", "completed_at": "2025-02-25T21:26:15.184494Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.185252Z", "completed_at": "2025-02-25T21:26:15.185256Z"}], "thread_id": "Thread-2", "execution_time": 0.004614353179931641, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.terminology__ethnicity", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.186252Z", "completed_at": "2025-02-25T21:26:15.188237Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.188861Z", "completed_at": "2025-02-25T21:26:15.188865Z"}], "thread_id": "Thread-1", "execution_time": 0.004217863082885742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.terminology__gender", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.189756Z", "completed_at": "2025-02-25T21:26:15.190970Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.192848Z", "completed_at": "2025-02-25T21:26:15.192851Z"}], "thread_id": "Thread-3", "execution_time": 0.004458904266357422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.terminology__hcpcs_level_2", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.191212Z", "completed_at": "2025-02-25T21:26:15.192413Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.193181Z", "completed_at": "2025-02-25T21:26:15.193184Z"}], "thread_id": "Thread-2", "execution_time": 0.0045719146728515625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.terminology__hcpcs_to_rbcs", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.194140Z", "completed_at": "2025-02-25T21:26:15.195365Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.196105Z", "completed_at": "2025-02-25T21:26:15.196109Z"}], "thread_id": "Thread-1", "execution_time": 0.003536701202392578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.terminology__icd_10_cm", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.197007Z", "completed_at": "2025-02-25T21:26:15.198214Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.200113Z", "completed_at": "2025-02-25T21:26:15.200116Z"}], "thread_id": "Thread-3", "execution_time": 0.004498004913330078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.terminology__icd_10_pcs", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.198487Z", "completed_at": "2025-02-25T21:26:15.199692Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.200447Z", "completed_at": "2025-02-25T21:26:15.200450Z"}], "thread_id": "Thread-2", "execution_time": 0.004600048065185547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.terminology__icd_9_cm", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.201417Z", "completed_at": "2025-02-25T21:26:15.203397Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.204025Z", "completed_at": "2025-02-25T21:26:15.204029Z"}], "thread_id": "Thread-1", "execution_time": 0.00418400764465332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.terminology__icd_9_pcs", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.204920Z", "completed_at": "2025-02-25T21:26:15.206156Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.208029Z", "completed_at": "2025-02-25T21:26:15.208032Z"}], "thread_id": "Thread-3", "execution_time": 0.004477024078369141, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.terminology__loinc", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.206401Z", "completed_at": "2025-02-25T21:26:15.207602Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.208363Z", "completed_at": "2025-02-25T21:26:15.208366Z"}], "thread_id": "Thread-2", "execution_time": 0.0045928955078125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.terminology__loinc_deprecated_mapping", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.209327Z", "completed_at": "2025-02-25T21:26:15.210559Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.211230Z", "completed_at": "2025-02-25T21:26:15.211234Z"}], "thread_id": "Thread-1", "execution_time": 0.003470897674560547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.terminology__mdc", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.212121Z", "completed_at": "2025-02-25T21:26:15.213348Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.215991Z", "completed_at": "2025-02-25T21:26:15.215994Z"}], "thread_id": "Thread-3", "execution_time": 0.005243062973022461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.terminology__medicare_dual_eligibility", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.213560Z", "completed_at": "2025-02-25T21:26:15.214765Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.216323Z", "completed_at": "2025-02-25T21:26:15.216326Z"}], "thread_id": "Thread-2", "execution_time": 0.005346059799194336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.terminology__medicare_orec", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.217298Z", "completed_at": "2025-02-25T21:26:15.218501Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.219184Z", "completed_at": "2025-02-25T21:26:15.219187Z"}], "thread_id": "Thread-1", "execution_time": 0.004274845123291016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.terminology__medicare_status", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.220082Z", "completed_at": "2025-02-25T21:26:15.221296Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.223100Z", "completed_at": "2025-02-25T21:26:15.223103Z"}], "thread_id": "Thread-3", "execution_time": 0.004441976547241211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.terminology__ms_drg", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.221510Z", "completed_at": "2025-02-25T21:26:15.222699Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.223428Z", "completed_at": "2025-02-25T21:26:15.223431Z"}], "thread_id": "Thread-2", "execution_time": 0.004500150680541992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.terminology__ms_drg_weights_los", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.224393Z", "completed_at": "2025-02-25T21:26:15.225627Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.226301Z", "completed_at": "2025-02-25T21:26:15.226305Z"}], "thread_id": "Thread-1", "execution_time": 0.0034639835357666016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.terminology__ndc", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.227335Z", "completed_at": "2025-02-25T21:26:15.228663Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.231445Z", "completed_at": "2025-02-25T21:26:15.231450Z"}], "thread_id": "Thread-3", "execution_time": 0.005644083023071289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.terminology__nitos", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.228904Z", "completed_at": "2025-02-25T21:26:15.230967Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.231807Z", "completed_at": "2025-02-25T21:26:15.231810Z"}], "thread_id": "Thread-2", "execution_time": 0.0057752132415771484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.terminology__other_provider_taxonomy", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.232798Z", "completed_at": "2025-02-25T21:26:15.234093Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.234746Z", "completed_at": "2025-02-25T21:26:15.234750Z"}], "thread_id": "Thread-1", "execution_time": 0.003610849380493164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.terminology__payer_type", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.235660Z", "completed_at": "2025-02-25T21:26:15.236973Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.238949Z", "completed_at": "2025-02-25T21:26:15.238954Z"}], "thread_id": "Thread-3", "execution_time": 0.004703044891357422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.terminology__place_of_service", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.237223Z", "completed_at": "2025-02-25T21:26:15.238473Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.239340Z", "completed_at": "2025-02-25T21:26:15.239344Z"}], "thread_id": "Thread-2", "execution_time": 0.004854917526245117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.terminology__present_on_admission", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.240484Z", "completed_at": "2025-02-25T21:26:15.241801Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.242500Z", "completed_at": "2025-02-25T21:26:15.242504Z"}], "thread_id": "Thread-1", "execution_time": 0.0038521289825439453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.terminology__provider", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.243444Z", "completed_at": "2025-02-25T21:26:15.244753Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.248189Z", "completed_at": "2025-02-25T21:26:15.248194Z"}], "thread_id": "Thread-3", "execution_time": 0.006226062774658203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.terminology__race", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.245161Z", "completed_at": "2025-02-25T21:26:15.247497Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.248558Z", "completed_at": "2025-02-25T21:26:15.248561Z"}], "thread_id": "Thread-2", "execution_time": 0.006351947784423828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.terminology__revenue_center", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.249769Z", "completed_at": "2025-02-25T21:26:15.251213Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.252021Z", "completed_at": "2025-02-25T21:26:15.252026Z"}], "thread_id": "Thread-1", "execution_time": 0.004163026809692383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.terminology__rxnorm_brand_generic", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.253248Z", "completed_at": "2025-02-25T21:26:15.254704Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.257056Z", "completed_at": "2025-02-25T21:26:15.257061Z"}], "thread_id": "Thread-3", "execution_time": 0.0056629180908203125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.terminology__rxnorm_to_atc", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.255003Z", "completed_at": "2025-02-25T21:26:15.256439Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.257439Z", "completed_at": "2025-02-25T21:26:15.257442Z"}], "thread_id": "Thread-2", "execution_time": 0.00574493408203125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.terminology__snomed_ct", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.258776Z", "completed_at": "2025-02-25T21:26:15.260230Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.261097Z", "completed_at": "2025-02-25T21:26:15.261101Z"}], "thread_id": "Thread-1", "execution_time": 0.004409074783325195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.terminology__snomed_ct_transitive_closures", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.262185Z", "completed_at": "2025-02-25T21:26:15.263625Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.272330Z", "completed_at": "2025-02-25T21:26:15.272337Z"}], "thread_id": "Thread-3", "execution_time": 0.011895179748535156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.the_tuva_project.terminology__snomed_icd_10_map", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.264929Z", "completed_at": "2025-02-25T21:26:15.277367Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.277969Z", "completed_at": "2025-02-25T21:26:15.277975Z"}], "thread_id": "Thread-2", "execution_time": 0.017213821411132812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.core__stg_clinical_condition", "compiled": true, "compiled_code": "\n\nselect\n    cast(condition_id as TEXT ) as condition_id\n    , cast(person_id as TEXT ) as person_id\n    , cast(null as TEXT ) as member_id\n    , cast(patient_id as TEXT ) as patient_id\n    , cast(encounter_id as TEXT ) as encounter_id\n    , cast(claim_id as TEXT ) as claim_id\n    , try_cast( recorded_date as date ) as recorded_date\n    , try_cast( onset_date as date ) as onset_date\n    , try_cast( resolved_date as date ) as resolved_date\n    , cast(status as TEXT ) as status\n    , cast(condition_type as TEXT ) as condition_type\n    , cast(source_code_type as TEXT ) as source_code_type\n    , cast(source_code as TEXT ) as source_code\n    , cast(source_description as TEXT ) as source_description\n    , cast(normalized_code_type as TEXT ) as normalized_code_type\n    , cast(normalized_code as TEXT ) as normalized_code\n    , cast(normalized_description as TEXT ) as normalized_description\n    , cast(condition_rank as integer ) as condition_rank\n    , cast(present_on_admit_code as TEXT ) as present_on_admit_code\n    , cast(present_on_admit_description as TEXT ) as present_on_admit_description\n    , cast(data_source as TEXT ) as data_source\n    , cast('2025-02-25 21:25:59.177756+00:00' as timestamp ) as tuva_last_run\nfrom tuva.input_layer.condition", "relation_name": "tuva.core._stg_clinical_condition"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.273438Z", "completed_at": "2025-02-25T21:26:15.278360Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.282167Z", "completed_at": "2025-02-25T21:26:15.282171Z"}], "thread_id": "Thread-1", "execution_time": 0.01020503044128418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__condition_claim_id", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(m.recorded_date,cast('1900-01-01' as date)) as source_date\n    , 'CONDITION' AS table_name\n    , 'Condition ID' as drill_down_key\n    , coalesce(condition_id, 'NULL') AS drill_down_value\n    , 'CLAIM_ID' AS field_name\n    , case when m.claim_id is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(claim_id as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nFROM tuva.input_layer.condition m", "relation_name": "tuva.data_quality.condition_claim_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.278553Z", "completed_at": "2025-02-25T21:26:15.283291Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.287188Z", "completed_at": "2025-02-25T21:26:15.287193Z"}], "thread_id": "Thread-3", "execution_time": 0.01026010513305664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__condition_condition_id", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(m.recorded_date,cast('1900-01-01' as date)) as source_date\n    , 'CONDITION' AS table_name\n    , 'Condition ID' as drill_down_key\n    , coalesce(condition_id, 'NULL') AS drill_down_value\n    , 'CONDITION_ID' AS field_name\n    , case when m.condition_id is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(condition_id as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.condition m", "relation_name": "tuva.data_quality.condition_condition_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.283858Z", "completed_at": "2025-02-25T21:26:15.296076Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.296339Z", "completed_at": "2025-02-25T21:26:15.296345Z"}], "thread_id": "Thread-2", "execution_time": 0.013833045959472656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__condition_condition_rank", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(m.recorded_date,cast('1900-01-01' as date)) as source_date\n    , 'CONDITION' AS table_name\n    , 'Condition ID' as drill_down_key\n    , coalesce(condition_id, 'NULL') AS drill_down_value\n    , 'CONDITION_RANK' AS field_name\n    , case when m.condition_rank is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(condition_rank as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.condition m", "relation_name": "tuva.data_quality.condition_condition_rank"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.288265Z", "completed_at": "2025-02-25T21:26:15.296987Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.297452Z", "completed_at": "2025-02-25T21:26:15.297456Z"}], "thread_id": "Thread-1", "execution_time": 0.013993024826049805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__condition_condition_type", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(m.recorded_date,cast('1900-01-01' as date)) as source_date\n    , 'CONDITION' AS table_name\n    , 'Condition ID' as drill_down_key\n    , coalesce(condition_id, 'NULL') AS drill_down_value\n    , 'CONDITION_TYPE' AS field_name\n    , case when m.condition_type is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(condition_type as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.condition m", "relation_name": "tuva.data_quality.condition_condition_type"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.292922Z", "completed_at": "2025-02-25T21:26:15.297822Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.298475Z", "completed_at": "2025-02-25T21:26:15.298479Z"}], "thread_id": "Thread-3", "execution_time": 0.006168842315673828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__condition_data_source", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(m.recorded_date,cast('1900-01-01' as date)) as source_date\n    , 'CONDITION' AS table_name\n    , 'Condition ID' as drill_down_key\n    , coalesce(condition_id, 'NULL') AS drill_down_value\n    , 'DATA_SOURCE' AS field_name\n    , case when m.data_source is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(data_source as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.condition m", "relation_name": "tuva.data_quality.condition_data_source"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.298827Z", "completed_at": "2025-02-25T21:26:15.306191Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.306647Z", "completed_at": "2025-02-25T21:26:15.306652Z"}], "thread_id": "Thread-2", "execution_time": 0.009511232376098633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__condition_encounter_id", "compiled": true, "compiled_code": "\n\nSELECT\n    m.data_source\n    ,coalesce(m.recorded_date,cast('1900-01-01' as date)) as source_date\n    ,'CONDITION' AS table_name\n    ,'Condition ID' as drill_down_key\n    , coalesce(condition_id, 'NULL') AS drill_down_value\n    ,'ENCOUNTER_ID' AS field_name\n    ,case when m.encounter_id is not null then 'valid' else 'null' end as bucket_name\n    ,cast(null as TEXT) as invalid_reason\n    ,cast(encounter_id as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.condition m", "relation_name": "tuva.data_quality.condition_encounter_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.303156Z", "completed_at": "2025-02-25T21:26:15.311334Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.311793Z", "completed_at": "2025-02-25T21:26:15.311797Z"}], "thread_id": "Thread-1", "execution_time": 0.009720802307128906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__condition_normalized_description", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(m.recorded_date,cast('1900-01-01' as date)) as source_date\n    , 'CONDITION' AS table_name\n    , 'Condition ID' as drill_down_key\n    , coalesce(condition_id, 'NULL') AS drill_down_value\n    , 'NORMALIZED_DESCRIPTION' AS field_name\n    , case when m.normalized_description is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(substring(normalized_description, 1, 255) as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.condition m", "relation_name": "tuva.data_quality.condition_normalized_description"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.307026Z", "completed_at": "2025-02-25T21:26:15.312368Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.316555Z", "completed_at": "2025-02-25T21:26:15.316560Z"}], "thread_id": "Thread-3", "execution_time": 0.013708114624023438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__condition_onset_date", "compiled": true, "compiled_code": "\n\nSELECT\n    m.data_source\n    ,coalesce(m.recorded_date,cast('1900-01-01' as date)) as source_date\n    ,'CONDITION' AS table_name\n    ,'Condition ID' as drill_down_key\n    , coalesce(condition_id, 'NULL') AS drill_down_value\n    ,'ONSET_DATE' AS field_name\n    ,case\n        when m.onset_date > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'invalid'\n        when m.onset_date <= cast('1901-01-01' as date) then 'invalid'\n        when m.onset_date > m.resolved_date then 'invalid'\n        when m.onset_date is null then 'null'\n        else 'valid'\n    end as bucket_name\n    ,case\n        when m.onset_date > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'future'\n        when m.onset_date <= cast('1901-01-01' as date) then 'too old'\n        WHEN m.onset_date < m.resolved_date THEN 'Onset date after resolved date'\n        else null\n    end as invalid_reason\n    ,cast(onset_date as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.condition m", "relation_name": "tuva.data_quality.condition_onset_date"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.312781Z", "completed_at": "2025-02-25T21:26:15.317886Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.321387Z", "completed_at": "2025-02-25T21:26:15.321394Z"}], "thread_id": "Thread-2", "execution_time": 0.009901285171508789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__condition_patient_id", "compiled": true, "compiled_code": "\n\nSELECT\n    m.data_source\n    ,coalesce(m.recorded_date,cast('1900-01-01' as date) ) as source_date\n    ,'CONDITION' AS table_name\n    ,'Condition ID' as drill_down_key\n    , coalesce(condition_id, 'NULL') AS drill_down_value\n    ,'PATIENT_ID' AS field_name\n    ,case when m.patient_id is not null then 'valid' else 'null' end as bucket_name\n    ,cast(null as TEXT) as invalid_reason\n    ,cast(patient_id as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.condition m", "relation_name": "tuva.data_quality.condition_patient_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.318073Z", "completed_at": "2025-02-25T21:26:15.326847Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.331482Z", "completed_at": "2025-02-25T21:26:15.331489Z"}], "thread_id": "Thread-1", "execution_time": 0.014627695083618164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__condition_present_on_admit_description", "compiled": true, "compiled_code": "\n\nSELECT\n    m.data_source\n    ,coalesce(m.recorded_date,cast('1900-01-01' as date)) as source_date\n    ,'CONDITION' AS table_name\n    ,'Condition ID' as drill_down_key\n    , coalesce(condition_id, 'NULL') AS drill_down_value\n    ,'PRESENT_ON_ADMIT_DESCRIPTION' AS field_name\n    ,case when m.present_on_admit_description is not null then 'valid' else 'null' end as bucket_name\n    ,cast(null as TEXT) as invalid_reason\n    ,cast(substring(present_on_admit_description, 1, 255) as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.condition m", "relation_name": "tuva.data_quality.condition_present_on_admit_description"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.321818Z", "completed_at": "2025-02-25T21:26:15.331874Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.332420Z", "completed_at": "2025-02-25T21:26:15.332424Z"}], "thread_id": "Thread-3", "execution_time": 0.014821052551269531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__condition_recorded_date", "compiled": true, "compiled_code": "\n\nSELECT\n    m.data_source\n    ,coalesce(m.recorded_date,cast('1900-01-01' as date)) as source_date\n    ,'CONDITION' AS table_name\n    ,'Condition ID' as drill_down_key\n    , coalesce(condition_id, 'NULL') AS drill_down_value\n    ,'RECORDED_DATE' AS field_name\n    ,CASE\n        when m.recorded_date > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'invalid'\n        when m.recorded_date <= cast('1901-01-01' as date) then 'invalid'\n        when m.recorded_date < m.onset_date then 'invalid'\n        when m.recorded_date is null then 'null'\n        else 'valid'\n    end as bucket_name\n    ,case\n        when m.recorded_date > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'future'\n        when m.recorded_date <= cast('1901-01-01' as date) then 'too old'\n        WHEN m.recorded_date < m.onset_date THEN 'Recorded date before onset date'\n        else null\n    end as invalid_reason\n    ,cast(recorded_date as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.condition m", "relation_name": "tuva.data_quality.condition_recorded_date"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.327065Z", "completed_at": "2025-02-25T21:26:15.333055Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.333667Z", "completed_at": "2025-02-25T21:26:15.333670Z"}], "thread_id": "Thread-2", "execution_time": 0.0073359012603759766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__condition_resolved_date", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(m.recorded_date,cast('1900-01-01' as date)) as source_date\n    , 'CONDITION' AS table_name\n    , 'Condition ID' as drill_down_key\n    , coalesce(condition_id, 'NULL') AS drill_down_value\n    , 'RESOLVED_DATE' AS field_name\n    , CASE\n        when m.resolved_date > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'invalid'\n        when m.resolved_date <= cast('1901-01-01' as date) then 'invalid'\n        when m.resolved_date < m.onset_date then 'invalid'\n        when m.resolved_date is null then 'null'\n        else 'valid'\n    end as bucket_name\n    , case\n        when m.resolved_date > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'future'\n        when m.resolved_date <= cast('1901-01-01' as date) then 'too old'\n        when m.resolved_date < m.onset_date THEN 'Resolved date before onset date'\n        else null\n    end as invalid_reason\n    , cast(resolved_date as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.condition m", "relation_name": "tuva.data_quality.condition_resolved_date"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.334230Z", "completed_at": "2025-02-25T21:26:15.346817Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.347098Z", "completed_at": "2025-02-25T21:26:15.347105Z"}], "thread_id": "Thread-1", "execution_time": 0.01436471939086914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__condition_source_code", "compiled": true, "compiled_code": "\n\nSELECT\n    m.data_source\n    ,coalesce(m.recorded_date,cast('1900-01-01' as date)) as source_date\n    ,'CONDITION' AS table_name\n    ,'Condition ID' as drill_down_key\n    , coalesce(condition_id, 'NULL') AS drill_down_value\n    ,'SOURCE_CODE' AS field_name\n    ,case when m.source_code is not null then 'valid' else 'null' end as bucket_name\n    ,cast(null as TEXT) as invalid_reason\n    ,cast(source_code as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.condition m", "relation_name": "tuva.data_quality.condition_source_code"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.338403Z", "completed_at": "2025-02-25T21:26:15.347527Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.348037Z", "completed_at": "2025-02-25T21:26:15.348041Z"}], "thread_id": "Thread-3", "execution_time": 0.014088869094848633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__condition_source_code_type", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(m.recorded_date,cast('1900-01-01' as date)) as source_date\n    , 'CONDITION' AS table_name\n    , 'Condition ID' as drill_down_key\n    , coalesce(condition_id, 'NULL') AS drill_down_value\n    , 'SOURCE_CODE_TYPE' AS field_name\n    , case when m.source_code_type is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(source_code_type as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.condition m", "relation_name": "tuva.data_quality.condition_source_code_type"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.343411Z", "completed_at": "2025-02-25T21:26:15.348388Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.349205Z", "completed_at": "2025-02-25T21:26:15.349209Z"}], "thread_id": "Thread-2", "execution_time": 0.011128902435302734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__condition_source_description", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(m.recorded_date,cast('1900-01-01' as date)) as source_date\n    , 'CONDITION' AS table_name\n    , 'Condition ID' as drill_down_key\n    , coalesce(condition_id, 'NULL') AS drill_down_value\n    , 'SOURCE_DESCRIPTION' AS field_name\n    , case when m.source_description is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(substring(source_description, 1, 255) as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.condition m", "relation_name": "tuva.data_quality.condition_source_description"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.350343Z", "completed_at": "2025-02-25T21:26:15.361362Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.366211Z", "completed_at": "2025-02-25T21:26:15.366221Z"}], "thread_id": "Thread-1", "execution_time": 0.01769709587097168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__condition_status", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(m.recorded_date,cast('1900-01-01' as date)) as source_date\n    , 'CONDITION' AS table_name\n    , 'Condition ID' as drill_down_key\n    , coalesce(condition_id, 'NULL') AS drill_down_value\n    , 'STATUS' AS field_name\n    , case when m.status is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(status as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.condition m", "relation_name": "tuva.data_quality.condition_status"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.354571Z", "completed_at": "2025-02-25T21:26:15.367461Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.368076Z", "completed_at": "2025-02-25T21:26:15.368081Z"}], "thread_id": "Thread-3", "execution_time": 0.018318891525268555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.core__stg_clinical_location", "compiled": true, "compiled_code": "\n\nselect\n    cast(location_id as TEXT ) as location_id\n    , cast(npi as TEXT ) as npi\n    , cast(name as TEXT ) as name\n    , cast(facility_type as TEXT ) as facility_type\n    , cast(parent_organization as TEXT ) as parent_organization\n    , cast(address as TEXT ) as address\n    , cast(city as TEXT ) as city\n    , cast(state as TEXT ) as state\n    , cast(zip_code as TEXT ) as zip_code\n    , cast(latitude as float ) as latitude\n    , cast(longitude as float ) as longitude\n    , cast(data_source as TEXT ) as data_source\n    , cast('2025-02-25 21:25:59.177756+00:00' as timestamp ) as tuva_last_run\nfrom tuva.input_layer.location", "relation_name": "tuva.core._stg_clinical_location"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.361650Z", "completed_at": "2025-02-25T21:26:15.368695Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.374741Z", "completed_at": "2025-02-25T21:26:15.374752Z"}], "thread_id": "Thread-2", "execution_time": 0.020647764205932617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__location_address", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    \n        , cast(coalesce(convert_timezone('UTC', current_timestamp()), cast('1900-01-01' as date)) as date) as source_date\n    \n    , 'LOCATION' AS table_name\n    , 'Location ID' as drill_down_key\n    , coalesce(location_id, 'NULL') AS drill_down_value\n    , 'ADDRESS' AS field_name\n    , case when m.address is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(address as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.location m", "relation_name": "tuva.data_quality.location_address"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.369237Z", "completed_at": "2025-02-25T21:26:15.376917Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.382083Z", "completed_at": "2025-02-25T21:26:15.382090Z"}], "thread_id": "Thread-1", "execution_time": 0.014479875564575195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__location_city", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    \n        , cast(coalesce(convert_timezone('UTC', current_timestamp()), cast('1900-01-01' as date)) as date) as source_date\n    \n    , 'LOCATION' AS table_name\n    , 'Location ID' as drill_down_key\n    , coalesce(location_id, 'NULL') AS drill_down_value\n    , 'CITY' AS field_name\n    , case when m.city is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(city as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.location m", "relation_name": "tuva.data_quality.location_city"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.377193Z", "completed_at": "2025-02-25T21:26:15.387915Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.388480Z", "completed_at": "2025-02-25T21:26:15.388486Z"}], "thread_id": "Thread-3", "execution_time": 0.013169050216674805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__location_data_source", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    \n        , cast(coalesce(convert_timezone('UTC', current_timestamp()), cast('1900-01-01' as date)) as date) as source_date\n    \n    , 'LOCATION' AS table_name\n    , 'Location ID' as drill_down_key\n    , coalesce(location_id, 'NULL') AS drill_down_value\n    , 'DATA_SOURCE' AS field_name\n    , case when m.data_source is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(data_source as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.location m", "relation_name": "tuva.data_quality.location_data_source"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.382608Z", "completed_at": "2025-02-25T21:26:15.389164Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.394158Z", "completed_at": "2025-02-25T21:26:15.394165Z"}], "thread_id": "Thread-2", "execution_time": 0.017668962478637695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__location_facility_type", "compiled": true, "compiled_code": "\n\n\nSELECT\n    m.data_source\n    \n        , cast(coalesce(convert_timezone('UTC', current_timestamp()), cast('1900-01-01' as date)) as date) as source_date\n    \n    ,'LOCATION' AS table_name\n    ,'Location ID' as drill_down_key\n    , coalesce(location_id, 'NULL') AS drill_down_value\n    ,'FACILITY_TYPE' AS field_name\n    ,case when m.facility_type is not null then 'valid' else 'null' end as bucket_name\n    ,cast(null as TEXT) as invalid_reason\n    ,cast(facility_type as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.location m", "relation_name": "tuva.data_quality.location_facility_type"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.389624Z", "completed_at": "2025-02-25T21:26:15.395970Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.400803Z", "completed_at": "2025-02-25T21:26:15.400811Z"}], "thread_id": "Thread-1", "execution_time": 0.012743234634399414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__location_latitude", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    \n        , cast(coalesce(convert_timezone('UTC', current_timestamp()), cast('1900-01-01' as date)) as date) as source_date\n    \n    , 'LOCATION' AS table_name\n    , 'Location ID' as drill_down_key\n    , coalesce(location_id, 'NULL') AS drill_down_value\n    , 'LATITUDE' as field_name\n    , case when m.latitude is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(latitude as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.location m", "relation_name": "tuva.data_quality.location_latitude"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.396194Z", "completed_at": "2025-02-25T21:26:15.407618Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.408388Z", "completed_at": "2025-02-25T21:26:15.408395Z"}], "thread_id": "Thread-3", "execution_time": 0.013806819915771484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__location_location_id", "compiled": true, "compiled_code": "\n\n\nSELECT\n    m.data_source\n    \n        , cast(coalesce(convert_timezone('UTC', current_timestamp()), cast('1900-01-01' as date)) as date) as source_date\n    \n    ,'LOCATION' AS table_name\n    ,'Location ID' as drill_down_key\n    , coalesce(location_id, 'NULL') AS drill_down_value\n    ,'LOCATION_ID' AS field_name\n    ,case when m.location_id is not null then 'valid' else 'null' end as bucket_name\n    ,cast(null as TEXT) as invalid_reason\n    ,cast(location_id as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.location m", "relation_name": "tuva.data_quality.location_location_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.401305Z", "completed_at": "2025-02-25T21:26:15.408845Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.409663Z", "completed_at": "2025-02-25T21:26:15.409668Z"}], "thread_id": "Thread-2", "execution_time": 0.014169931411743164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__location_longitude", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    \n        , cast(coalesce(convert_timezone('UTC', current_timestamp()), cast('1900-01-01' as date)) as date) as source_date\n    \n    , 'LOCATION' AS table_name\n    , 'Location ID' as drill_down_key\n    , coalesce(location_id, 'NULL') AS drill_down_value\n    , 'LONGITUDE' as field_name\n    , case when m.longitude is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(longitude as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.location m", "relation_name": "tuva.data_quality.location_longitude"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.410208Z", "completed_at": "2025-02-25T21:26:15.421059Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.425865Z", "completed_at": "2025-02-25T21:26:15.425874Z"}], "thread_id": "Thread-1", "execution_time": 0.017904043197631836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__location_name", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    \n        , cast(coalesce(convert_timezone('UTC', current_timestamp()), cast('1900-01-01' as date)) as date) as source_date\n    \n    , 'LOCATION' AS table_name\n    , 'Location ID' as drill_down_key\n    , coalesce(location_id, 'NULL') AS drill_down_value\n    , 'NAME' as field_name\n    , case when m.name is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(name as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.location m", "relation_name": "tuva.data_quality.location_name"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.416252Z", "completed_at": "2025-02-25T21:26:15.426443Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.427054Z", "completed_at": "2025-02-25T21:26:15.427059Z"}], "thread_id": "Thread-3", "execution_time": 0.012144088745117188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__location_parent_organization", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    \n        , cast(coalesce(convert_timezone('UTC', current_timestamp()), cast('1900-01-01' as date)) as date) as source_date\n    \n    , 'LOCATION' AS table_name\n    , 'Location ID' as drill_down_key\n    , coalesce(location_id, 'NULL') AS drill_down_value\n    , 'PARENT_ORGANIZATION' AS field_name\n    , case when m.parent_organization is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(parent_organization as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.location m", "relation_name": "tuva.data_quality.location_parent_organization"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.421367Z", "completed_at": "2025-02-25T21:26:15.427697Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.428326Z", "completed_at": "2025-02-25T21:26:15.428330Z"}], "thread_id": "Thread-2", "execution_time": 0.012417078018188477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__location_state", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    \n        , cast(coalesce(convert_timezone('UTC', current_timestamp()), cast('1900-01-01' as date)) as date) as source_date\n    \n    , 'LOCATION' AS table_name\n    , 'Location ID' as drill_down_key\n    , coalesce(location_id, 'NULL') AS drill_down_value\n    , 'STATE' as field_name\n    , case when m.state is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(state as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.location m", "relation_name": "tuva.data_quality.location_state"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.428961Z", "completed_at": "2025-02-25T21:26:15.447722Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.452042Z", "completed_at": "2025-02-25T21:26:15.452051Z"}], "thread_id": "Thread-1", "execution_time": 0.02468132972717285, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__location_zip_code", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    \n        , cast(coalesce(convert_timezone('UTC', current_timestamp()), cast('1900-01-01' as date)) as date) as source_date\n    \n    , 'LOCATION' AS table_name\n    , 'Location ID' as drill_down_key\n    , coalesce(location_id, 'NULL') AS drill_down_value\n    , 'ZIP_CODE' as field_name\n    , case when m.zip_code is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(zip_code as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.location m", "relation_name": "tuva.data_quality.location_zip_code"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.434408Z", "completed_at": "2025-02-25T21:26:15.452973Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.453542Z", "completed_at": "2025-02-25T21:26:15.453547Z"}], "thread_id": "Thread-3", "execution_time": 0.024924278259277344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.core__stg_clinical_encounter", "compiled": true, "compiled_code": "\n\nselect\n    cast(encounter_id as TEXT) as encounter_id\n  , cast(person_id as TEXT ) as person_id\n  , cast(encounter_type as TEXT) as encounter_type\n  , cast('clinical' as TEXT) as encounter_group\n  , try_cast( encounter_start_date as date ) as encounter_start_date\n  , try_cast( encounter_end_date as date ) as encounter_end_date\n  , cast(length_of_stay as integer) as length_of_stay\n  , cast(admit_source_code as TEXT) as admit_source_code\n  , cast(admit_source_description as TEXT) as admit_source_description\n  , cast(admit_type_code as TEXT) as admit_type_code\n  , cast(admit_type_description as TEXT) as admit_type_description\n  , cast(discharge_disposition_code as TEXT) as discharge_disposition_code\n  , cast(discharge_disposition_description as TEXT) as discharge_disposition_description\n  , cast(attending_provider_id as TEXT) as attending_provider_id\n  , cast(attending_provider_name as TEXT) as attending_provider_name\n  , cast(facility_id as TEXT) as facility_id\n  , cast(facility_name as TEXT) as facility_name\n  , cast(null as TEXT) as facility_type\n  , cast(null as integer) as observation_flag\n  , cast(null as integer) as lab_flag\n  , cast(null as integer) as dme_flag\n  , cast(null as integer) as ambulance_flag\n  , cast(null as integer) as pharmacy_flag\n  , cast(null as integer) as ed_flag\n  , cast(null as integer) as delivery_flag\n  , cast(null as TEXT) as delivery_type\n  , cast(null as integer) as newborn_flag\n  , cast(null as integer) as nicu_flag\n  , cast(primary_diagnosis_code_type as TEXT) as primary_diagnosis_code_type\n  , cast(primary_diagnosis_code as TEXT) as primary_diagnosis_code\n  , cast(primary_diagnosis_description as TEXT) as primary_diagnosis_description\n  , cast(drg_code_type as TEXT) as drg_code_type\n  , cast(drg_code as TEXT) as drg_code\n  , cast(drg_description as TEXT) as drg_description\n  , cast(paid_amount as numeric(28,6) ) as paid_amount\n  , cast(allowed_amount as numeric(28,6) ) as allowed_amount\n  , cast(charge_amount as numeric(28,6) ) as charge_amount\n  , cast(null as integer) as claim_count\n  , cast(null as integer) as inst_claim_count\n  , cast(null as integer) as prof_claim_count\n  , cast(null as TEXT) as source_model\n  , cast(data_source as TEXT) as data_source\n  , cast('2025-02-25 21:25:59.177756+00:00' as timestamp) as tuva_last_run\nfrom tuva.input_layer.encounter", "relation_name": "tuva.core._stg_clinical_encounter"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.447990Z", "completed_at": "2025-02-25T21:26:15.454024Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.454782Z", "completed_at": "2025-02-25T21:26:15.454788Z"}], "thread_id": "Thread-2", "execution_time": 0.02080392837524414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__encounter_admit_source_description", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(m.encounter_start_date,cast('1900-01-01' as date)) as source_date\n    , 'ENCOUNTER' AS table_name\n    , 'Encounter ID' as drill_down_key\n    , coalesce(encounter_id, 'NULL') AS drill_down_value\n    , 'ADMIT_SOURCE_DESCRIPTION' AS field_name\n    , case when m.admit_source_description is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(substring(admit_source_description, 1, 255) as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.encounter m", "relation_name": "tuva.data_quality.encounter_admit_source_description"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.455215Z", "completed_at": "2025-02-25T21:26:15.464810Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.465443Z", "completed_at": "2025-02-25T21:26:15.465451Z"}], "thread_id": "Thread-1", "execution_time": 0.012333154678344727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__encounter_admit_type_description", "compiled": true, "compiled_code": "\n\nSELECT\n    m.data_source\n    ,coalesce(m.encounter_start_date,cast('1900-01-01' as date)) as source_date\n    ,'ENCOUNTER' AS table_name\n    ,'Encounter ID' as drill_down_key\n    , coalesce(encounter_id, 'NULL') AS drill_down_value\n    ,'ADMIT_TYPE_DESCRIPTION' AS field_name\n    ,case when m.admit_type_description is not null then 'valid' else 'null' end as bucket_name\n    ,cast(null as TEXT) as invalid_reason\n    ,cast(substring(admit_type_description, 1, 255) as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.encounter m", "relation_name": "tuva.data_quality.encounter_admit_type_description"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.460552Z", "completed_at": "2025-02-25T21:26:15.470351Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.471089Z", "completed_at": "2025-02-25T21:26:15.471096Z"}], "thread_id": "Thread-3", "execution_time": 0.011855840682983398, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__encounter_allowed_amount", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(m.encounter_start_date,cast('1900-01-01' as date)) as source_date\n    , 'ENCOUNTER' AS table_name\n    , 'Encounter ID' as drill_down_key\n    , coalesce(encounter_id, 'NULL') AS drill_down_value\n    , 'ALLOWED_AMOUNT' AS field_name\n    , case when m.allowed_amount is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(allowed_amount as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.encounter m", "relation_name": "tuva.data_quality.encounter_allowed_amount"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.466027Z", "completed_at": "2025-02-25T21:26:15.472089Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.477706Z", "completed_at": "2025-02-25T21:26:15.477746Z"}], "thread_id": "Thread-2", "execution_time": 0.01754903793334961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__encounter_charge_amount", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(m.encounter_start_date,cast('1900-01-01' as date)) as source_date\n    , 'ENCOUNTER' AS table_name\n    , 'Encounter ID' as drill_down_key\n    , coalesce(encounter_id, 'NULL') AS drill_down_value\n    , 'CHARGE_AMOUNT' AS field_name\n    , case when m.charge_amount is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(charge_amount as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.encounter m", "relation_name": "tuva.data_quality.encounter_charge_amount"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.472309Z", "completed_at": "2025-02-25T21:26:15.483185Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.483691Z", "completed_at": "2025-02-25T21:26:15.483707Z"}], "thread_id": "Thread-1", "execution_time": 0.013059139251708984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__encounter_data_source", "compiled": true, "compiled_code": "\n\nSELECT\n    m.data_source\n    ,coalesce(m.encounter_start_date,cast('1900-01-01' as date)) as source_date\n    ,'ENCOUNTER' AS table_name\n    ,'Encounter ID' as drill_down_key\n    , coalesce(encounter_id, 'NULL') AS drill_down_value\n    ,'DATA_SOURCE' AS field_name\n    ,case when m.data_source is not null then 'valid' else 'null' end as bucket_name\n    ,cast(null as TEXT) as invalid_reason\n    ,cast(data_source as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.encounter m", "relation_name": "tuva.data_quality.encounter_data_source"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.478848Z", "completed_at": "2025-02-25T21:26:15.488393Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.489042Z", "completed_at": "2025-02-25T21:26:15.489048Z"}], "thread_id": "Thread-3", "execution_time": 0.011728048324584961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__encounter_discharge_disposition_description", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(m.encounter_start_date,cast('1900-01-01' as date)) as source_date\n    , 'ENCOUNTER' AS table_name\n    , 'Encounter ID' as drill_down_key\n    , coalesce(encounter_id, 'NULL') AS drill_down_value\n    , 'DISCHARGE_DISPOSITION_DESCRIPTION' AS field_name\n    , case when m.discharge_disposition_description is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(substring(discharge_disposition_description, 1, 255) as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.encounter m", "relation_name": "tuva.data_quality.encounter_discharge_disposition_description"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.484176Z", "completed_at": "2025-02-25T21:26:15.489985Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.495820Z", "completed_at": "2025-02-25T21:26:15.495828Z"}], "thread_id": "Thread-2", "execution_time": 0.013010025024414062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__encounter_drg_description", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(m.encounter_start_date,cast('1900-01-01' as date)) as source_date\n    , 'ENCOUNTER' AS table_name\n    , 'Encounter ID' as drill_down_key\n    , coalesce(encounter_id, 'NULL') AS drill_down_value\n    , 'DRG_DESCRIPTION' AS field_name\n    , case when m.drg_description is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(substring(drg_description, 1, 255) as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.encounter m", "relation_name": "tuva.data_quality.encounter_drg_description"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.490242Z", "completed_at": "2025-02-25T21:26:15.500708Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.501364Z", "completed_at": "2025-02-25T21:26:15.501370Z"}], "thread_id": "Thread-1", "execution_time": 0.012807846069335938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__encounter_encounter_end_date", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(m.encounter_start_date,cast('1900-01-01' as date)) as source_date\n    , 'ENCOUNTER' AS table_name\n    , 'Encounter ID' as drill_down_key\n    , coalesce(encounter_id, 'NULL') AS drill_down_value\n    , 'ENCOUNTER_END_DATE' AS field_name\n    , case\n        when m.encounter_end_date > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'invalid'\n        when m.encounter_end_date <= cast('1901-01-01' as date) then 'invalid'\n        when m.encounter_end_date < m.encounter_start_date then 'invalid'\n        when m.encounter_end_date is null then 'null'\n        else 'valid'\n    end as bucket_name\n    , case\n        when m.encounter_end_date > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'future'\n        when m.encounter_end_date <= cast('1901-01-01' as date) then 'too old'\n        when m.encounter_end_date < m.encounter_start_date then 'Encounter end date before encounter start date'\n        else null\n    end as invalid_reason\n    , cast(encounter_end_date as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.encounter m", "relation_name": "tuva.data_quality.encounter_encounter_end_date"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.496927Z", "completed_at": "2025-02-25T21:26:15.508711Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.510617Z", "completed_at": "2025-02-25T21:26:15.510624Z"}], "thread_id": "Thread-3", "execution_time": 0.01524806022644043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__encounter_encounter_id", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(m.encounter_start_date,cast('1900-01-01' as date)) as source_date\n    , 'ENCOUNTER' AS table_name\n    , 'Encounter ID' as drill_down_key\n    , coalesce(encounter_id, 'NULL') AS drill_down_value\n    , 'ENCOUNTER_ID' AS field_name\n    , case when m.encounter_id is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(encounter_id as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.encounter m", "relation_name": "tuva.data_quality.encounter_encounter_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.502450Z", "completed_at": "2025-02-25T21:26:15.516272Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.516951Z", "completed_at": "2025-02-25T21:26:15.516958Z"}], "thread_id": "Thread-2", "execution_time": 0.0160367488861084, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__encounter_encounter_start_date", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(m.encounter_start_date,cast('1900-01-01' as date)) as source_date\n    , 'ENCOUNTER' AS table_name\n    , 'Encounter ID' as drill_down_key\n    , coalesce(encounter_id, 'NULL') AS drill_down_value\n    , 'ENCOUNTER_START_DATE' AS field_name\n    , case\n        when m.encounter_start_date > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'invalid'\n        when m.encounter_start_date <= cast('1901-01-01' as date) then 'invalid'\n        when m.encounter_start_date > m.encounter_end_date then 'invalid'\n        when m.encounter_start_date is null then 'null'\n        else 'valid'\n    end as bucket_name\n    , case\n        when m.encounter_start_date > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'future'\n        when m.encounter_start_date <= cast('1901-01-01' as date) then 'too old'\n        when m.encounter_start_date > m.encounter_end_date then 'Encounter start date after encounter end date'\n        else null\n    end as invalid_reason\n    , cast(encounter_start_date as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.encounter m", "relation_name": "tuva.data_quality.encounter_encounter_start_date"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.511790Z", "completed_at": "2025-02-25T21:26:15.521761Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.522439Z", "completed_at": "2025-02-25T21:26:15.522447Z"}], "thread_id": "Thread-1", "execution_time": 0.01229405403137207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__encounter_length_of_stay", "compiled": true, "compiled_code": "\n\nSELECT\n    m.data_source\n    ,coalesce(m.encounter_start_date,cast('1900-01-01' as date)) as source_date\n    ,'ENCOUNTER' AS table_name\n    ,'Encounter ID' as drill_down_key\n    , coalesce(encounter_id, 'NULL') AS drill_down_value\n    ,'LENGTH_OF_STAY' AS field_name\n    ,case when m.length_of_stay is not null then 'valid' else 'null' end as bucket_name\n    ,cast(null as TEXT) as invalid_reason\n    ,cast(length_of_stay as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.encounter m", "relation_name": "tuva.data_quality.encounter_length_of_stay"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.517382Z", "completed_at": "2025-02-25T21:26:15.523978Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.528475Z", "completed_at": "2025-02-25T21:26:15.528485Z"}], "thread_id": "Thread-3", "execution_time": 0.012598037719726562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__encounter_paid_amount", "compiled": true, "compiled_code": "\n\nSELECT\n    m.data_source\n    ,coalesce(m.encounter_start_date,cast('1900-01-01' as date)) as source_date\n    ,'ENCOUNTER' AS table_name\n    ,'Encounter ID' as drill_down_key\n    , coalesce(encounter_id, 'NULL') AS drill_down_value\n    ,'PAID_AMOUNT' AS field_name\n    ,case when m.paid_amount is not null then 'valid' else 'null' end as bucket_name\n    ,cast(null as TEXT) as invalid_reason\n    ,cast(paid_amount as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.encounter m", "relation_name": "tuva.data_quality.encounter_paid_amount"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.524528Z", "completed_at": "2025-02-25T21:26:15.533876Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.534384Z", "completed_at": "2025-02-25T21:26:15.534390Z"}], "thread_id": "Thread-2", "execution_time": 0.011368274688720703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__encounter_patient_id", "compiled": true, "compiled_code": "\n\nSELECT\n    m.data_source\n    ,coalesce(m.encounter_start_date,cast('1900-01-01' as date)) as source_date\n    ,'ENCOUNTER' AS table_name\n    ,'Encounter ID' as drill_down_key\n    , coalesce(encounter_id, 'NULL') AS drill_down_value\n    ,'PATIENT_ID' AS field_name\n    ,case when m.patient_id is not null then 'valid' else 'null' end as bucket_name\n    ,cast(null as TEXT) as invalid_reason\n    ,cast(patient_id as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.encounter m", "relation_name": "tuva.data_quality.encounter_patient_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.529607Z", "completed_at": "2025-02-25T21:26:15.534861Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.545667Z", "completed_at": "2025-02-25T21:26:15.545675Z"}], "thread_id": "Thread-1", "execution_time": 0.021536827087402344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__encounter_primary_diagnosis_description", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(m.encounter_start_date,cast('1900-01-01' as date)) as source_date\n    , 'ENCOUNTER' AS table_name\n    , 'Encounter ID' as drill_down_key\n    , coalesce(encounter_id, 'NULL') AS drill_down_value\n    , 'PRIMARY_DIAGNOSIS_DESCRIPTION' AS field_name\n    , case when m.primary_diagnosis_description is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(substring(primary_diagnosis_description, 1, 255) as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.encounter m", "relation_name": "tuva.data_quality.encounter_primary_diagnosis_description"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.535072Z", "completed_at": "2025-02-25T21:26:15.549126Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.550135Z", "completed_at": "2025-02-25T21:26:15.550141Z"}], "thread_id": "Thread-3", "execution_time": 0.016755104064941406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.core__stg_clinical_lab_result", "compiled": true, "compiled_code": "\n\nselect\n    cast(lab_result_id as TEXT ) as lab_result_id\n    , cast(person_id as TEXT ) as person_id\n    , cast(patient_id as TEXT ) as patient_id\n    , cast(encounter_id as TEXT ) as encounter_id\n    , cast(accession_number as TEXT ) as accession_number\n    , cast(source_code_type as TEXT ) as source_code_type\n    , cast(source_code as TEXT ) as source_code\n    , cast(source_description as TEXT ) as source_description\n    , cast(source_component as TEXT ) as source_component\n    , cast(normalized_code_type as TEXT ) as normalized_code_type\n    , cast(normalized_code as TEXT ) as normalized_code\n    , cast(normalized_description as TEXT ) as normalized_description\n    , cast(normalized_component as TEXT ) as normalized_component\n    , cast(status as TEXT ) as status\n    , cast(result as TEXT ) as result\n    , try_cast( result_date as date ) as result_date\n    , try_cast( collection_date as date ) as collection_date\n    , cast(source_units as TEXT ) as source_units\n    , cast(normalized_units as TEXT ) as normalized_units\n    , cast(source_reference_range_low as TEXT ) as source_reference_range_low\n    , cast(source_reference_range_high as TEXT ) as source_reference_range_high\n    , cast(normalized_reference_range_low as TEXT ) as normalized_reference_range_low\n    , cast(normalized_reference_range_high as TEXT ) as normalized_reference_range_high\n    , cast(source_abnormal_flag as TEXT ) as source_abnormal_flag\n    , cast(normalized_abnormal_flag as TEXT ) as normalized_abnormal_flag\n    , cast(specimen as TEXT ) as specimen\n    , cast(ordering_practitioner_id as TEXT ) as ordering_practitioner_id\n    , cast(data_source as TEXT ) as data_source\n    , cast('2025-02-25 21:25:59.177756+00:00' as timestamp ) as tuva_last_run\nfrom tuva.input_layer.lab_result", "relation_name": "tuva.core._stg_clinical_lab_result"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.550618Z", "completed_at": "2025-02-25T21:26:15.561920Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.563290Z", "completed_at": "2025-02-25T21:26:15.563299Z"}], "thread_id": "Thread-2", "execution_time": 0.015237092971801758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__lab_result_accession_number", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.result_date,cast('1900-01-01' as date)) as source_date\n    , 'LAB_RESULT' AS table_name\n    , 'Lab Result ID' as drill_down_key\n    , coalesce(lab_result_id, 'NULL') AS drill_down_value\n    , 'ACCESSION_NUMBER' AS field_name\n    , case when m.accession_number is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(accession_number as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.lab_result m", "relation_name": "tuva.data_quality.lab_result_accession_number"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.556021Z", "completed_at": "2025-02-25T21:26:15.572423Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.573122Z", "completed_at": "2025-02-25T21:26:15.573129Z"}], "thread_id": "Thread-1", "execution_time": 0.023566246032714844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__lab_result_collection_date", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.result_date,cast('1900-01-01' as date)) as source_date\n    , 'LAB_RESULT' AS table_name\n    , 'Lab Result ID' as drill_down_key\n    , coalesce(lab_result_id, 'NULL') AS drill_down_value\n    , 'COLLECTION_DATE' AS field_name\n    , case\n        when m.collection_date > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'invalid'\n        when m.collection_date <= cast('1901-01-01' as date) then 'invalid'\n        when m.collection_date > m.result_date then 'invalid'\n        when m.collection_date is null then 'null'\n        else 'valid'\n    end as bucket_name\n    , case\n        when m.collection_date > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'future'\n        when m.collection_date <= cast('1901-01-01' as date) then 'too old'\n        when m.collection_date > m.result_date then 'Collection date after result date'\n        else null\n    end as invalid_reason\n    , cast(collection_date as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.lab_result m", "relation_name": "tuva.data_quality.lab_result_collection_date"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.567483Z", "completed_at": "2025-02-25T21:26:15.581271Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.589640Z", "completed_at": "2025-02-25T21:26:15.589648Z"}], "thread_id": "Thread-3", "execution_time": 0.02846693992614746, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__lab_result_data_source", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.result_date,cast('1900-01-01' as date)) as source_date\n    , 'LAB_RESULT' AS table_name\n    , 'Lab Result ID' as drill_down_key\n    , coalesce(lab_result_id, 'NULL') AS drill_down_value\n    , 'DATA_SOURCE' AS field_name\n    , case when m.data_source is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(data_source as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.lab_result m", "relation_name": "tuva.data_quality.lab_result_data_source"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.584412Z", "completed_at": "2025-02-25T21:26:15.594831Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.595405Z", "completed_at": "2025-02-25T21:26:15.595411Z"}], "thread_id": "Thread-2", "execution_time": 0.021577119827270508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__lab_result_encounter_id", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.result_date,cast('1900-01-01' as date)) as source_date\n    , 'LAB_RESULT' AS table_name\n    , 'Lab Result ID' as drill_down_key\n    , coalesce(lab_result_id, 'NULL') AS drill_down_value\n    , 'ENCOUNTER_ID' as field_name\n    , case when m.encounter_id is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(encounter_id as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.lab_result m", "relation_name": "tuva.data_quality.lab_result_encounter_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.590192Z", "completed_at": "2025-02-25T21:26:15.596512Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.600908Z", "completed_at": "2025-02-25T21:26:15.600914Z"}], "thread_id": "Thread-1", "execution_time": 0.020051956176757812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__lab_result_lab_result_id", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.result_date,cast('1900-01-01' as date)) as source_date\n    , 'LAB_RESULT' AS table_name\n    , 'Lab Result ID' as drill_down_key\n    , coalesce(lab_result_id, 'NULL') AS drill_down_value\n    , 'LAB_RESULT_ID' as field_name\n    , case when m.lab_result_id is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(lab_result_id as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.lab_result m", "relation_name": "tuva.data_quality.lab_result_lab_result_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.596764Z", "completed_at": "2025-02-25T21:26:15.606379Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.606991Z", "completed_at": "2025-02-25T21:26:15.606998Z"}], "thread_id": "Thread-3", "execution_time": 0.011965274810791016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__lab_result_normalized_abnormal_flag", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.result_date,cast('1900-01-01' as date)) as source_date\n    , 'LAB_RESULT' AS table_name\n    , 'Lab Result ID' as drill_down_key\n    , coalesce(lab_result_id, 'NULL') AS drill_down_value\n    , 'NORMALIZED_ABNORMAL_FLAG' as field_name\n    , case when m.normalized_abnormal_flag is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(normalized_abnormal_flag as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.lab_result m", "relation_name": "tuva.data_quality.lab_result_normalized_abnormal_flag"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.602046Z", "completed_at": "2025-02-25T21:26:15.612266Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.612979Z", "completed_at": "2025-02-25T21:26:15.612985Z"}], "thread_id": "Thread-2", "execution_time": 0.012519121170043945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__lab_result_normalized_description", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.result_date,cast('1900-01-01' as date)) as source_date\n    , 'LAB_RESULT' AS table_name\n    , 'Lab Result ID' as drill_down_key\n    , coalesce(lab_result_id, 'NULL') AS drill_down_value\n    , 'NORMALIZED_DESCRIPTION' AS field_name\n    , case when m.normalized_description is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(substring(normalized_description, 1, 255) as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.lab_result m", "relation_name": "tuva.data_quality.lab_result_normalized_description"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.607484Z", "completed_at": "2025-02-25T21:26:15.614021Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.614862Z", "completed_at": "2025-02-25T21:26:15.614867Z"}], "thread_id": "Thread-1", "execution_time": 0.008856058120727539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__lab_result_normalized_reference_range_high", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.result_date,cast('1900-01-01' as date)) as source_date\n    , 'LAB_RESULT' AS table_name\n    , 'Lab Result ID' as drill_down_key\n    , coalesce(lab_result_id, 'NULL') AS drill_down_value\n    , 'NORMALIZED_REFERENCE_RANGE_HIGH' as field_name\n    , case when m.normalized_reference_range_high is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(normalized_reference_range_high as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.lab_result m", "relation_name": "tuva.data_quality.lab_result_normalized_reference_range_high"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.615262Z", "completed_at": "2025-02-25T21:26:15.625056Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.625524Z", "completed_at": "2025-02-25T21:26:15.625533Z"}], "thread_id": "Thread-3", "execution_time": 0.012143850326538086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__lab_result_normalized_reference_range_low", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.result_date,cast('1900-01-01' as date)) as source_date\n    , 'LAB_RESULT' AS table_name\n    , 'Lab Result ID' as drill_down_key\n    , coalesce(lab_result_id, 'NULL') AS drill_down_value\n    , 'NORMALIZED_REFERENCE_RANGE_LOW' as field_name\n    , case when m.normalized_reference_range_low is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(normalized_reference_range_low as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.lab_result m", "relation_name": "tuva.data_quality.lab_result_normalized_reference_range_low"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.620933Z", "completed_at": "2025-02-25T21:26:15.630342Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.631179Z", "completed_at": "2025-02-25T21:26:15.631185Z"}], "thread_id": "Thread-2", "execution_time": 0.01675105094909668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__lab_result_normalized_units", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.result_date,cast('1900-01-01' as date)) as source_date\n    , 'LAB_RESULT' AS table_name\n    , 'Lab Result ID' as drill_down_key\n    , coalesce(lab_result_id, 'NULL') AS drill_down_value\n    , 'NORMALIZED_UNITS' as field_name\n    , case when m.normalized_units is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(normalized_units as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.lab_result m", "relation_name": "tuva.data_quality.lab_result_normalized_units"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.626107Z", "completed_at": "2025-02-25T21:26:15.632554Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.637088Z", "completed_at": "2025-02-25T21:26:15.637095Z"}], "thread_id": "Thread-1", "execution_time": 0.012456893920898438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__lab_result_patient_id", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.result_date,cast('1900-01-01' as date)) as source_date\n    , 'LAB_RESULT' AS table_name\n    , 'Lab Result ID' as drill_down_key\n    , coalesce(lab_result_id, 'NULL') AS drill_down_value\n    , 'PATIENT_ID' AS field_name\n    , case when m.patient_id is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(patient_id as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.lab_result m", "relation_name": "tuva.data_quality.lab_result_patient_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.633092Z", "completed_at": "2025-02-25T21:26:15.643742Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.644292Z", "completed_at": "2025-02-25T21:26:15.644299Z"}], "thread_id": "Thread-3", "execution_time": 0.012706995010375977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__lab_result_result", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.result_date,cast('1900-01-01' as date)) as source_date\n    , 'LAB_RESULT' AS table_name\n    , 'Lab Result ID' as drill_down_key\n    , coalesce(lab_result_id, 'NULL') AS drill_down_value\n    , 'RESULT' AS field_name\n    , case when m.result is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(result as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.lab_result m", "relation_name": "tuva.data_quality.lab_result_result"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.638159Z", "completed_at": "2025-02-25T21:26:15.648758Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.649425Z", "completed_at": "2025-02-25T21:26:15.649431Z"}], "thread_id": "Thread-2", "execution_time": 0.016707181930541992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__lab_result_result_date", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.result_date,cast('1900-01-01' as date)) as source_date\n    , 'LAB_RESULT' AS table_name\n    , 'Lab Result ID' as drill_down_key\n    , coalesce(lab_result_id, 'NULL') AS drill_down_value\n    , 'RESULT_DATE' as field_name\n    , case\n        when m.result_date > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'invalid'\n        when m.result_date <= cast('1901-01-01' as date) then 'invalid'\n        when m.result_date < m.collection_date then 'invalid'\n        when m.result_date is null then 'null'\n        else 'valid'\n    end as bucket_name\n    , case\n        when m.result_date > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'future'\n        when m.result_date <= cast('1901-01-01' as date) then 'too old'\n        when m.result_date < m.collection_date then 'Result date before collection date'\n        else null\n    end as invalid_reason\n    , cast(result_date as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.lab_result m", "relation_name": "tuva.data_quality.lab_result_result_date"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.644732Z", "completed_at": "2025-02-25T21:26:15.650384Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.651133Z", "completed_at": "2025-02-25T21:26:15.651138Z"}], "thread_id": "Thread-1", "execution_time": 0.0078089237213134766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__lab_result_source_abnormal_flag", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.result_date,cast('1900-01-01' as date)) as source_date\n    , 'LAB_RESULT' AS table_name\n    , 'Lab Result ID' as drill_down_key\n    , coalesce(lab_result_id, 'NULL') AS drill_down_value\n    , 'SOURCE_ABNORMAL_FLAG' AS field_name\n    , case when m.source_abnormal_flag is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(source_abnormal_flag as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.lab_result m", "relation_name": "tuva.data_quality.lab_result_source_abnormal_flag"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.651517Z", "completed_at": "2025-02-25T21:26:15.661227Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.664920Z", "completed_at": "2025-02-25T21:26:15.664929Z"}], "thread_id": "Thread-3", "execution_time": 0.015152931213378906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__lab_result_source_code", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.result_date,cast('1900-01-01' as date)) as source_date\n    , 'LAB_RESULT' AS table_name\n    , 'Lab Result ID' as drill_down_key\n    , coalesce(lab_result_id, 'NULL') AS drill_down_value\n    , 'SOURCE_CODE' AS field_name\n    , case when m.source_code is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(source_code as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.lab_result m", "relation_name": "tuva.data_quality.lab_result_source_code"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.656840Z", "completed_at": "2025-02-25T21:26:15.665462Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.666073Z", "completed_at": "2025-02-25T21:26:15.666077Z"}], "thread_id": "Thread-2", "execution_time": 0.015270233154296875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__lab_result_source_code_type", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.result_date,cast('1900-01-01' as date)) as source_date\n    , 'LAB_RESULT' AS table_name\n    , 'Lab Result ID' as drill_down_key\n    , coalesce(lab_result_id, 'NULL') AS drill_down_value\n    , 'SOURCE_CODE_TYPE' as field_name\n    , case when m.source_code_type is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(source_code_type as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.lab_result m", "relation_name": "tuva.data_quality.lab_result_source_code_type"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.661457Z", "completed_at": "2025-02-25T21:26:15.666737Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.667405Z", "completed_at": "2025-02-25T21:26:15.667408Z"}], "thread_id": "Thread-1", "execution_time": 0.006822109222412109, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__lab_result_source_component", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.result_date,cast('1900-01-01' as date)) as source_date\n    , 'LAB_RESULT' AS table_name\n    , 'Lab Result ID' as drill_down_key\n    , coalesce(lab_result_id, 'NULL') AS drill_down_value\n    , 'SOURCE_COMPONENT' AS field_name\n    , case when m.source_component is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(source_component as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.lab_result m", "relation_name": "tuva.data_quality.lab_result_source_component"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.668012Z", "completed_at": "2025-02-25T21:26:15.675885Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.680678Z", "completed_at": "2025-02-25T21:26:15.680686Z"}], "thread_id": "Thread-3", "execution_time": 0.014293909072875977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__lab_result_source_description", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.result_date,cast('1900-01-01' as date)) as source_date\n    , 'LAB_RESULT' AS table_name\n    , 'Lab Result ID' as drill_down_key\n    , coalesce(lab_result_id, 'NULL') AS drill_down_value\n    , 'SOURCE_DESCRIPTION' as field_name\n    , case when m.source_description is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(substring(source_description, 1, 255) as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.lab_result m", "relation_name": "tuva.data_quality.lab_result_source_description"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.672417Z", "completed_at": "2025-02-25T21:26:15.681414Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.682167Z", "completed_at": "2025-02-25T21:26:15.682172Z"}], "thread_id": "Thread-2", "execution_time": 0.014466047286987305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__lab_result_source_reference_range_high", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.result_date,cast('1900-01-01' as date)) as source_date\n    , 'LAB_RESULT' AS table_name\n    , 'Lab Result ID' as drill_down_key\n    , coalesce(lab_result_id, 'NULL') AS drill_down_value\n    , 'SOURCE_REFERENCE_RANGE_HIGH' AS field_name\n    , case when m.source_reference_range_high is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(source_reference_range_high as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.lab_result m", "relation_name": "tuva.data_quality.lab_result_source_reference_range_high"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.676165Z", "completed_at": "2025-02-25T21:26:15.681975Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.682808Z", "completed_at": "2025-02-25T21:26:15.682812Z"}], "thread_id": "Thread-1", "execution_time": 0.010720014572143555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__lab_result_source_reference_range_low", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.result_date,cast('1900-01-01' as date)) as source_date\n    , 'LAB_RESULT' AS table_name\n    , 'Lab Result ID' as drill_down_key\n    , coalesce(lab_result_id, 'NULL') AS drill_down_value\n    , 'SOURCE_REFERENCE_RANGE_LOW' AS field_name\n    , case when m.source_reference_range_low is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(source_reference_range_low as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.lab_result m", "relation_name": "tuva.data_quality.lab_result_source_reference_range_low"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.683439Z", "completed_at": "2025-02-25T21:26:15.689804Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.694571Z", "completed_at": "2025-02-25T21:26:15.694579Z"}], "thread_id": "Thread-3", "execution_time": 0.01296091079711914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__lab_result_source_units", "compiled": true, "compiled_code": "\n\n\nSELECT\n    m.data_source\n    ,coalesce(m.result_date,cast('1900-01-01' as date)) as source_date\n    ,'LAB_RESULT' AS table_name\n    ,'Lab Result ID' as drill_down_key\n    , coalesce(lab_result_id, 'NULL') AS drill_down_value\n    ,'SOURCE_UNITS' AS field_name\n    ,case when m.source_units is not null then 'valid' else 'null' end as bucket_name\n    ,cast(null as TEXT) as invalid_reason\n    ,cast(source_units as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.lab_result m", "relation_name": "tuva.data_quality.lab_result_source_units"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.690377Z", "completed_at": "2025-02-25T21:26:15.699322Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.700026Z", "completed_at": "2025-02-25T21:26:15.700032Z"}], "thread_id": "Thread-2", "execution_time": 0.012627840042114258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__lab_result_specimen", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.result_date,cast('1900-01-01' as date)) as source_date\n    , 'LAB_RESULT' AS table_name\n    , 'Lab Result ID' as drill_down_key\n    , coalesce(lab_result_id, 'NULL') AS drill_down_value\n    , 'SPECIMEN' as field_name\n    , case when m.specimen is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(specimen as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.lab_result m", "relation_name": "tuva.data_quality.lab_result_specimen"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.695028Z", "completed_at": "2025-02-25T21:26:15.700931Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.709461Z", "completed_at": "2025-02-25T21:26:15.709468Z"}], "thread_id": "Thread-1", "execution_time": 0.02125096321105957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__lab_result_status", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.result_date,cast('1900-01-01' as date)) as source_date\n    , 'LAB_RESULT' AS table_name\n    , 'Lab Result ID' as drill_down_key\n    , coalesce(lab_result_id, 'NULL') AS drill_down_value\n    , 'STATUS' as field_name\n    , case when m.status is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(status as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.lab_result m", "relation_name": "tuva.data_quality.lab_result_status"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.701456Z", "completed_at": "2025-02-25T21:26:15.711495Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.715464Z", "completed_at": "2025-02-25T21:26:15.715471Z"}], "thread_id": "Thread-3", "execution_time": 0.015822172164916992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.core__stg_clinical_medication", "compiled": true, "compiled_code": "\n\nselect\n    cast(medication_id as TEXT ) as medication_id\n    , cast(person_id as TEXT ) as person_id\n    , cast(patient_id as TEXT ) as patient_id\n    , cast(encounter_id as TEXT ) as encounter_id\n    , try_cast( dispensing_date as date ) as dispensing_date\n    , try_cast( prescribing_date as date ) as prescribing_date\n    , cast(source_code_type as TEXT ) as source_code_type\n    , cast(source_code as TEXT ) as source_code\n    , cast(source_description as TEXT ) as source_description\n    , cast(ndc_code as TEXT ) as ndc_code\n    , cast(ndc_description as TEXT ) as ndc_description\n    , cast(rxnorm_code as TEXT ) as rxnorm_code\n    , cast(rxnorm_description as TEXT ) as rxnorm_description \n    , cast(atc_code as TEXT ) as atc_code\n    , cast(atc_description as TEXT ) as atc_description\n    , cast(route as TEXT ) as route\n    , cast(strength as TEXT ) as strength\n    , cast(quantity as integer ) as quantity\n    , cast(quantity_unit as TEXT ) as quantity_unit\n    , cast(days_supply as integer ) as days_supply\n    , cast(practitioner_id as TEXT ) as practitioner_id\n    , cast(data_source as TEXT ) as data_source\n    , cast('2025-02-25 21:25:59.177756+00:00' as timestamp ) as tuva_last_run\nfrom tuva.input_layer.medication", "relation_name": "tuva.core._stg_clinical_medication"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.711702Z", "completed_at": "2025-02-25T21:26:15.719836Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.720366Z", "completed_at": "2025-02-25T21:26:15.720372Z"}], "thread_id": "Thread-2", "execution_time": 0.010287761688232422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__medication_atc_description", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.dispensing_date,cast('1900-01-01' as date)) as source_date\n    , 'MEDICATION' AS table_name\n    , 'Medication ID' as drill_down_key\n    , coalesce(medication_id, 'NULL') AS drill_down_value\n    , 'ATC_DESCRIPTION' as field_name\n    , case when m.atc_description is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(substring(atc_description, 1, 255) as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.medication m", "relation_name": "tuva.data_quality.medication_atc_description"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.715943Z", "completed_at": "2025-02-25T21:26:15.721023Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.724991Z", "completed_at": "2025-02-25T21:26:15.724997Z"}], "thread_id": "Thread-1", "execution_time": 0.013848066329956055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__medication_data_source", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.dispensing_date,cast('1900-01-01' as date)) as source_date\n    , 'MEDICATION' AS table_name\n    , 'Medication ID' as drill_down_key\n    , coalesce(medication_id, 'NULL') AS drill_down_value\n    , 'DATA_SOURCE' AS field_name\n    , case when m.data_source is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(data_source as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.medication m", "relation_name": "tuva.data_quality.medication_data_source"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.721490Z", "completed_at": "2025-02-25T21:26:15.726514Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.731283Z", "completed_at": "2025-02-25T21:26:15.731289Z"}], "thread_id": "Thread-3", "execution_time": 0.011276006698608398, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__medication_days_supply", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.dispensing_date,cast('1900-01-01' as date)) as source_date\n    , 'MEDICATION' AS table_name\n    , 'Medication ID' as drill_down_key\n    , coalesce(medication_id, 'NULL') AS drill_down_value\n    , 'DAYS_SUPPLY' AS field_name\n    , case when m.days_supply is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(days_supply as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.medication m", "relation_name": "tuva.data_quality.medication_days_supply"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.726722Z", "completed_at": "2025-02-25T21:26:15.736368Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.736864Z", "completed_at": "2025-02-25T21:26:15.736870Z"}], "thread_id": "Thread-2", "execution_time": 0.011537313461303711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__medication_dispensing_date", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.dispensing_date,cast('1900-01-01' as date)) as source_date\n    , 'MEDICATION' AS table_name\n    , 'Medication ID' as drill_down_key\n    , coalesce(medication_id, 'NULL') AS drill_down_value\n    , 'DISPENSING_DATE' as field_name\n    , case\n        when m.dispensing_date > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'invalid'\n        when m.dispensing_date <= cast('1901-01-01' as date) then 'invalid'\n        when m.dispensing_date < m.prescribing_date then 'invalid'\n        when m.dispensing_date is null then 'null'\n        else 'valid'\n    end as bucket_name\n    , case\n        when m.dispensing_date > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'future'\n        when m.dispensing_date <= cast('1901-01-01' as date) then 'too old'\n        when m.dispensing_date < m.prescribing_date then 'Dispensing date before prescribing date'\n        else null\n    end as invalid_reason\n    , cast(dispensing_date as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.medication m", "relation_name": "tuva.data_quality.medication_dispensing_date"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.731729Z", "completed_at": "2025-02-25T21:26:15.737229Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.737896Z", "completed_at": "2025-02-25T21:26:15.737900Z"}], "thread_id": "Thread-1", "execution_time": 0.011675834655761719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__medication_encounter_id", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.dispensing_date,cast('1900-01-01' as date)) as source_date\n    , 'MEDICATION' AS table_name\n    , 'Medication ID' as drill_down_key\n    , coalesce(medication_id, 'NULL') AS drill_down_value\n    , 'ENCOUNTER_ID' as field_name\n    , case when m.encounter_id is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(encounter_id as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.medication m", "relation_name": "tuva.data_quality.medication_encounter_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.738262Z", "completed_at": "2025-02-25T21:26:15.745820Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.746280Z", "completed_at": "2025-02-25T21:26:15.746286Z"}], "thread_id": "Thread-3", "execution_time": 0.009783029556274414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__medication_medication_id", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.dispensing_date,cast('1900-01-01' as date)) as source_date\n    , 'MEDICATION' AS table_name\n    , 'Medication ID' as drill_down_key\n    , coalesce(medication_id, 'NULL') AS drill_down_value\n    , 'MEDICATION_ID' AS field_name\n    , case when m.medication_id is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(medication_id as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.medication m", "relation_name": "tuva.data_quality.medication_medication_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.742652Z", "completed_at": "2025-02-25T21:26:15.750111Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.750615Z", "completed_at": "2025-02-25T21:26:15.750620Z"}], "thread_id": "Thread-2", "execution_time": 0.009064912796020508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__medication_ndc_code", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.dispensing_date,cast('1900-01-01' as date)) as source_date\n    , 'MEDICATION' AS table_name\n    , 'Medication ID' as drill_down_key\n    , coalesce(medication_id, 'NULL') AS drill_down_value\n    , 'NDC_CODE' as field_name\n    , case when m.ndc_code is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(ndc_code as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.medication m", "relation_name": "tuva.data_quality.medication_ndc_code"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.746672Z", "completed_at": "2025-02-25T21:26:15.751222Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.754821Z", "completed_at": "2025-02-25T21:26:15.754826Z"}], "thread_id": "Thread-1", "execution_time": 0.012498855590820312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__medication_patient_id", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.dispensing_date,cast('1900-01-01' as date)) as source_date\n    , 'MEDICATION' AS table_name\n    , 'Medication ID' as drill_down_key\n    , coalesce(medication_id, 'NULL') AS drill_down_value\n    , 'PATIENT_ID' as field_name\n    , case when m.patient_id is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(patient_id as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.medication m", "relation_name": "tuva.data_quality.medication_patient_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.751653Z", "completed_at": "2025-02-25T21:26:15.756145Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.760507Z", "completed_at": "2025-02-25T21:26:15.760512Z"}], "thread_id": "Thread-3", "execution_time": 0.010196208953857422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__medication_practitioner_id", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.dispensing_date,cast('1900-01-01' as date)) as source_date\n    , 'MEDICATION' AS table_name\n    , 'Medication ID' as drill_down_key\n    , coalesce(medication_id, 'NULL') AS drill_down_value\n    , 'PRACTITIONER_ID' as field_name\n    , case when m.practitioner_id is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(practitioner_id as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.medication m", "relation_name": "tuva.data_quality.medication_practitioner_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.756340Z", "completed_at": "2025-02-25T21:26:15.765233Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.765752Z", "completed_at": "2025-02-25T21:26:15.765757Z"}], "thread_id": "Thread-2", "execution_time": 0.010621070861816406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__medication_prescribing_date", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.dispensing_date,cast('1900-01-01' as date)) as source_date\n    , 'MEDICATION' AS table_name\n    , 'Medication ID' as drill_down_key\n    , coalesce(medication_id, 'NULL') AS drill_down_value\n    , 'PRESCRIBING_DATE' as field_name\n    , case\n        when m.prescribing_date > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'invalid'\n        when m.prescribing_date <= cast('1901-01-01' as date) then 'invalid'\n        when m.prescribing_date > m.dispensing_date then 'invalid'\n        when m.prescribing_date is null then 'null'\n        else 'valid'\n    end as bucket_name\n    , case\n        when m.prescribing_date > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'future'\n        when m.prescribing_date <= cast('1901-01-01' as date) then 'too old'\n        when m.prescribing_date > m.dispensing_date then 'Prescribing date after dispensing date'\n        else null\n    end as invalid_reason\n    , cast(prescribing_date as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.medication m", "relation_name": "tuva.data_quality.medication_prescribing_date"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.760903Z", "completed_at": "2025-02-25T21:26:15.766344Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.769985Z", "completed_at": "2025-02-25T21:26:15.769990Z"}], "thread_id": "Thread-1", "execution_time": 0.014122962951660156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__medication_quantity", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.dispensing_date,cast('1900-01-01' as date)) as source_date\n    , 'MEDICATION' AS table_name\n    , 'Medication ID' as drill_down_key\n    , coalesce(medication_id, 'NULL') AS drill_down_value\n    , 'QUANTITY' as field_name\n    , case when m.quantity is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(quantity as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.medication m", "relation_name": "tuva.data_quality.medication_quantity"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.766763Z", "completed_at": "2025-02-25T21:26:15.771309Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.774835Z", "completed_at": "2025-02-25T21:26:15.774840Z"}], "thread_id": "Thread-3", "execution_time": 0.009405851364135742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__medication_quantity_unit", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.dispensing_date,cast('1900-01-01' as date)) as source_date\n    , 'MEDICATION' AS table_name\n    , 'Medication ID' as drill_down_key\n    , coalesce(medication_id, 'NULL') AS drill_down_value\n    , 'QUANTITY_UNIT' as field_name\n    , case when m.quantity_unit is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(quantity_unit as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.medication m", "relation_name": "tuva.data_quality.medication_quantity_unit"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.771522Z", "completed_at": "2025-02-25T21:26:15.778691Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.779181Z", "completed_at": "2025-02-25T21:26:15.779186Z"}], "thread_id": "Thread-2", "execution_time": 0.008878946304321289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__medication_route", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.dispensing_date,cast('1900-01-01' as date)) as source_date\n    , 'MEDICATION' AS table_name\n    , 'Medication ID' as drill_down_key\n    , coalesce(medication_id, 'NULL') AS drill_down_value\n    , 'ROUTE' as field_name\n    , case when m.route is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(route as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.medication m", "relation_name": "tuva.data_quality.medication_route"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.775245Z", "completed_at": "2025-02-25T21:26:15.779543Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.780170Z", "completed_at": "2025-02-25T21:26:15.780173Z"}], "thread_id": "Thread-1", "execution_time": 0.009116172790527344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__medication_rxnorm_description", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.dispensing_date,cast('1900-01-01' as date)) as source_date\n    , 'MEDICATION' AS table_name\n    , 'Medication ID' as drill_down_key\n    , coalesce(medication_id, 'NULL') AS drill_down_value\n    , 'RXNORM_DESCRIPTION' as field_name\n    , case when m.rxnorm_description is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(substring(rxnorm_description, 1, 255) as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.medication m", "relation_name": "tuva.data_quality.medication_rxnorm_description"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.780518Z", "completed_at": "2025-02-25T21:26:15.788720Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.789181Z", "completed_at": "2025-02-25T21:26:15.789187Z"}], "thread_id": "Thread-3", "execution_time": 0.010369062423706055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__medication_source_code", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.dispensing_date,cast('1900-01-01' as date)) as source_date\n    , 'MEDICATION' AS table_name\n    , 'Medication ID' as drill_down_key\n    , coalesce(medication_id, 'NULL') AS drill_down_value\n    , 'SOURCE_CODE' as field_name\n    , case when m.source_code is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(source_code as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.medication m", "relation_name": "tuva.data_quality.medication_source_code"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.784702Z", "completed_at": "2025-02-25T21:26:15.793105Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.793573Z", "completed_at": "2025-02-25T21:26:15.793578Z"}], "thread_id": "Thread-2", "execution_time": 0.009911775588989258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__medication_source_code_type", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.dispensing_date,cast('1900-01-01' as date)) as source_date\n    , 'MEDICATION' AS table_name\n    , 'Medication ID' as drill_down_key\n    , coalesce(medication_id, 'NULL') AS drill_down_value\n    , 'SOURCE_CODE_TYPE' as field_name\n    , case when m.source_code_type is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(source_code_type as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.medication m", "relation_name": "tuva.data_quality.medication_source_code_type"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.789585Z", "completed_at": "2025-02-25T21:26:15.793968Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.794609Z", "completed_at": "2025-02-25T21:26:15.794612Z"}], "thread_id": "Thread-1", "execution_time": 0.010195016860961914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__medication_source_description", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.dispensing_date,cast('1900-01-01' as date)) as source_date\n    , 'MEDICATION' AS table_name\n    , 'Medication ID' as drill_down_key\n    , coalesce(medication_id, 'NULL') AS drill_down_value\n    , 'SOURCE_DESCRIPTION' as field_name\n    , case when m.source_description is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(substring(source_description, 1, 255) as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.medication m", "relation_name": "tuva.data_quality.medication_source_description"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.794962Z", "completed_at": "2025-02-25T21:26:15.805105Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.805705Z", "completed_at": "2025-02-25T21:26:15.805710Z"}], "thread_id": "Thread-3", "execution_time": 0.012446880340576172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__medication_strength", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.dispensing_date,cast('1900-01-01' as date)) as source_date\n    , 'MEDICATION' AS table_name\n    , 'Medication ID' as drill_down_key\n    , coalesce(medication_id, 'NULL') AS drill_down_value\n    , 'STRENGTH' as field_name\n    , case when m.strength is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(strength as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.medication m", "relation_name": "tuva.data_quality.medication_strength"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.799078Z", "completed_at": "2025-02-25T21:26:15.809542Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.810024Z", "completed_at": "2025-02-25T21:26:15.810029Z"}], "thread_id": "Thread-2", "execution_time": 0.011961698532104492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.core__stg_clinical_observation", "compiled": true, "compiled_code": "\n\n\nselect\n    cast(observation_id as TEXT ) as observation_id\n    , cast(person_id as TEXT ) as person_id\n    , cast(patient_id as TEXT ) as patient_id\n    , cast(encounter_id as TEXT ) as encounter_id\n    , cast(panel_id as TEXT ) as panel_id\n    , try_cast( observation_date as date ) as observation_date\n    , cast(observation_type as TEXT ) as observation_type\n    , cast(source_code_type as TEXT ) as source_code_type\n    , cast(source_code as TEXT ) as source_code\n    , cast(source_description as TEXT ) as source_description\n    , cast(normalized_code_type as TEXT ) as normalized_code_type\n    , cast(normalized_code as TEXT ) as normalized_code\n    , cast(normalized_description as TEXT ) as normalized_description\n    , cast(result as TEXT ) as result\n    , cast(source_units as TEXT ) as source_units\n    , cast(normalized_units as TEXT ) as normalized_units\n    , cast(source_reference_range_low as TEXT ) as source_reference_range_low\n    , cast(source_reference_range_high as TEXT ) as source_reference_range_high\n    , cast(normalized_reference_range_low as TEXT ) as normalized_reference_range_low\n    , cast(normalized_reference_range_high as TEXT ) as normalized_reference_range_high\n    , cast(data_source as TEXT ) as data_source\n    , cast('2025-02-25 21:25:59.177756+00:00' as timestamp ) as tuva_last_run\nfrom tuva.input_layer.observation", "relation_name": "tuva.core._stg_clinical_observation"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.806110Z", "completed_at": "2025-02-25T21:26:15.810421Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.811110Z", "completed_at": "2025-02-25T21:26:15.811113Z"}], "thread_id": "Thread-1", "execution_time": 0.012332916259765625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__observation_data_source", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.observation_date,cast('1900-01-01' as date)) as source_date\n    , 'OBSERVATION' AS table_name\n    , 'Observation ID' as drill_down_key\n    , coalesce(observation_id, 'NULL') AS drill_down_value\n    , 'DATA_SOURCE' as field_name\n    , case when m.data_source is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(data_source as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.observation m", "relation_name": "tuva.data_quality.observation_data_source"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.811468Z", "completed_at": "2025-02-25T21:26:15.816533Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.820081Z", "completed_at": "2025-02-25T21:26:15.820087Z"}], "thread_id": "Thread-3", "execution_time": 0.010389089584350586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__observation_encounter_id", "compiled": true, "compiled_code": "\n\nSELECT\n    m.data_source\n    ,coalesce(m.observation_date,cast('1900-01-01' as date)) as source_date\n    ,'OBSERVATION' AS table_name\n    ,'Observation ID' as drill_down_key\n    , coalesce(observation_id, 'NULL') AS drill_down_value\n    ,'ENCOUNTER_ID' as field_name\n    ,case when m.encounter_id is not null then 'valid' else 'null' end as bucket_name\n    ,cast(null as TEXT) as invalid_reason\n    ,cast(encounter_id as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.observation m", "relation_name": "tuva.data_quality.observation_encounter_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.816729Z", "completed_at": "2025-02-25T21:26:15.824153Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.824640Z", "completed_at": "2025-02-25T21:26:15.824645Z"}], "thread_id": "Thread-2", "execution_time": 0.009151935577392578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__observation_normalized_code", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.observation_date,cast('1900-01-01' as date)) as source_date\n    , 'OBSERVATION' AS table_name\n    , 'Observation ID' as drill_down_key\n    , coalesce(observation_id, 'NULL') AS drill_down_value\n    , 'NORMALIZED_CODE' as field_name\n    , case when m.normalized_code is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(normalized_code as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.observation m", "relation_name": "tuva.data_quality.observation_normalized_code"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.820503Z", "completed_at": "2025-02-25T21:26:15.825185Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.828782Z", "completed_at": "2025-02-25T21:26:15.828786Z"}], "thread_id": "Thread-1", "execution_time": 0.012532234191894531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__observation_normalized_code_type", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.observation_date,cast('1900-01-01' as date)) as source_date\n    , 'OBSERVATION' AS table_name\n    , 'Observation ID' as drill_down_key\n    , coalesce(observation_id, 'NULL') AS drill_down_value\n    , 'NORMALIZED_CODE_TYPE' AS field_name\n    , case when m.normalized_code_type is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(normalized_code_type as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.observation m", "relation_name": "tuva.data_quality.observation_normalized_code_type"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.825637Z", "completed_at": "2025-02-25T21:26:15.830128Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.833615Z", "completed_at": "2025-02-25T21:26:15.833620Z"}], "thread_id": "Thread-3", "execution_time": 0.009319067001342773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__observation_normalized_description", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.observation_date,cast('1900-01-01' as date)) as source_date\n    , 'OBSERVATION' AS table_name\n    , 'Observation ID' as drill_down_key\n    , coalesce(observation_id, 'NULL') AS drill_down_value\n    , 'NORMALIZED_DESCRIPTION' as field_name\n    , case when m.normalized_description is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(substring(normalized_description, 1, 255) as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.observation m", "relation_name": "tuva.data_quality.observation_normalized_description"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.830329Z", "completed_at": "2025-02-25T21:26:15.940379Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.943246Z", "completed_at": "2025-02-25T21:26:15.943253Z"}], "thread_id": "Thread-2", "execution_time": 0.11417174339294434, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__observation_normalized_reference_range_high", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.observation_date,cast('1900-01-01' as date)) as source_date\n    , 'OBSERVATION' AS table_name\n    , 'Observation ID' as drill_down_key\n    , coalesce(observation_id, 'NULL') AS drill_down_value\n    , 'NORMALIZED_REFERENCE_RANGE_HIGH' as field_name\n    , case when m.normalized_reference_range_high is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(normalized_reference_range_high as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.observation m", "relation_name": "tuva.data_quality.observation_normalized_reference_range_high"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.834017Z", "completed_at": "2025-02-25T21:26:15.942954Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.944282Z", "completed_at": "2025-02-25T21:26:15.944286Z"}], "thread_id": "Thread-1", "execution_time": 0.11443305015563965, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__observation_normalized_reference_range_low", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.observation_date,cast('1900-01-01' as date)) as source_date\n    , 'OBSERVATION' AS table_name\n    , 'Observation ID' as drill_down_key\n    , coalesce(observation_id, 'NULL') AS drill_down_value\n    , 'NORMALIZED_REFERENCE_RANGE_LOW' AS field_name\n    , case when m.normalized_reference_range_low is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(normalized_reference_range_low as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.observation m", "relation_name": "tuva.data_quality.observation_normalized_reference_range_low"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.945839Z", "completed_at": "2025-02-25T21:26:15.951380Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.957556Z", "completed_at": "2025-02-25T21:26:15.957566Z"}], "thread_id": "Thread-3", "execution_time": 0.0152587890625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__observation_normalized_units", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.observation_date,cast('1900-01-01' as date)) as source_date\n    , 'OBSERVATION' AS table_name\n    , 'Observation ID' as drill_down_key\n    , coalesce(observation_id, 'NULL') AS drill_down_value\n    , 'NORMALIZED_UNITS' as field_name\n    , case when m.normalized_units is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(normalized_units as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.observation m", "relation_name": "tuva.data_quality.observation_normalized_units"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.952238Z", "completed_at": "2025-02-25T21:26:15.963056Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.963605Z", "completed_at": "2025-02-25T21:26:15.963612Z"}], "thread_id": "Thread-2", "execution_time": 0.01323699951171875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__observation_observation_date", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.observation_date,cast('1900-01-01' as date)) as source_date\n    , 'OBSERVATION' AS table_name\n    , 'Observation ID' as drill_down_key\n    , coalesce(observation_id, 'NULL') AS drill_down_value\n    , 'OBSERVATION_DATE' as field_name\n    , case\n        when m.observation_date > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'invalid'\n        when m.observation_date <= cast('1901-01-01' as date) then 'invalid'\n        when m.observation_date is null then 'null'\n        else 'valid'\n    end as bucket_name\n    , case\n        when m.observation_date > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'future'\n        when m.observation_date <= cast('1901-01-01' as date) then 'too old'\n        else null\n    end as invalid_reason\n    , cast(observation_date as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.observation m", "relation_name": "tuva.data_quality.observation_observation_date"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.958161Z", "completed_at": "2025-02-25T21:26:15.968003Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.968709Z", "completed_at": "2025-02-25T21:26:15.968717Z"}], "thread_id": "Thread-1", "execution_time": 0.018021821975708008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__observation_observation_id", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.observation_date,cast('1900-01-01' as date)) as source_date\n    , 'OBSERVATION' AS table_name\n    , 'Observation ID' as drill_down_key\n    , coalesce(observation_id, 'NULL') AS drill_down_value\n    , 'OBSERVATION_ID' as field_name\n    , case when m.observation_id is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(observation_id as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.observation m", "relation_name": "tuva.data_quality.observation_observation_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.964103Z", "completed_at": "2025-02-25T21:26:15.969834Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.970644Z", "completed_at": "2025-02-25T21:26:15.970649Z"}], "thread_id": "Thread-3", "execution_time": 0.007982730865478516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__observation_observation_type", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.observation_date,cast('1900-01-01' as date)) as source_date\n    , 'OBSERVATION' AS table_name\n    , 'Observation ID' as drill_down_key\n    , coalesce(observation_id, 'NULL') AS drill_down_value\n    , 'OBSERVATION_TYPE' as field_name\n    , case when m.observation_type is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(observation_type as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.observation m", "relation_name": "tuva.data_quality.observation_observation_type"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.971023Z", "completed_at": "2025-02-25T21:26:15.984711Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.985076Z", "completed_at": "2025-02-25T21:26:15.985083Z"}], "thread_id": "Thread-2", "execution_time": 0.01593804359436035, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__observation_panel_id", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.observation_date,cast('1900-01-01' as date)) as source_date\n    , 'OBSERVATION' AS table_name\n    , 'Observation ID' as drill_down_key\n    , coalesce(observation_id, 'NULL') AS drill_down_value\n    , 'PANEL_ID' as field_name\n    , case when m.panel_id is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(panel_id as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.observation m", "relation_name": "tuva.data_quality.observation_panel_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.976497Z", "completed_at": "2025-02-25T21:26:15.985898Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.986456Z", "completed_at": "2025-02-25T21:26:15.986461Z"}], "thread_id": "Thread-1", "execution_time": 0.016168832778930664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__observation_patient_id", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.observation_date,cast('1900-01-01' as date)) as source_date\n    , 'OBSERVATION' AS table_name\n    , 'Observation ID' as drill_down_key\n    , coalesce(observation_id, 'NULL') AS drill_down_value\n    , 'PATIENT_ID' as field_name\n    , case when m.patient_id is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(patient_id as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.observation m", "relation_name": "tuva.data_quality.observation_patient_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.980874Z", "completed_at": "2025-02-25T21:26:15.986945Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.987702Z", "completed_at": "2025-02-25T21:26:15.987708Z"}], "thread_id": "Thread-3", "execution_time": 0.007541179656982422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__observation_result", "compiled": true, "compiled_code": "\n\n\nSELECT\n    m.data_source\n    ,coalesce(m.observation_date,cast('1900-01-01' as date)) as source_date\n    ,'OBSERVATION' AS table_name\n    ,'Observation ID' as drill_down_key\n    , coalesce(observation_id, 'NULL') AS drill_down_value\n    ,'RESULT' as field_name\n    ,case when m.result is not null then 'valid' else 'null' end as bucket_name\n    ,cast(null as TEXT) as invalid_reason\n    ,cast(substring(result, 1, 255) as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.observation m", "relation_name": "tuva.data_quality.observation_result"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.988181Z", "completed_at": "2025-02-25T21:26:15.997009Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:15.997577Z", "completed_at": "2025-02-25T21:26:15.997585Z"}], "thread_id": "Thread-2", "execution_time": 0.011538028717041016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__observation_source_code", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.observation_date,cast('1900-01-01' as date)) as source_date\n    , 'OBSERVATION' AS table_name\n    , 'Observation ID' as drill_down_key\n    , coalesce(observation_id, 'NULL') AS drill_down_value\n    , 'SOURCE_CODE' as field_name\n    , case when m.source_code is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(source_code as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.observation m", "relation_name": "tuva.data_quality.observation_source_code"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.993413Z", "completed_at": "2025-02-25T21:26:16.002130Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.002820Z", "completed_at": "2025-02-25T21:26:16.002828Z"}], "thread_id": "Thread-1", "execution_time": 0.010786056518554688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__observation_source_code_type", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.observation_date,cast('1900-01-01' as date)) as source_date\n    , 'OBSERVATION' AS table_name\n    , 'Observation ID' as drill_down_key\n    , coalesce(observation_id, 'NULL') AS drill_down_value\n    , 'SOURCE_CODE_TYPE' as field_name\n    , case when m.source_code_type is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(source_code_type as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.observation m", "relation_name": "tuva.data_quality.observation_source_code_type"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:15.998100Z", "completed_at": "2025-02-25T21:26:16.003498Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.008841Z", "completed_at": "2025-02-25T21:26:16.008848Z"}], "thread_id": "Thread-3", "execution_time": 0.015773773193359375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__observation_source_description", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.observation_date,cast('1900-01-01' as date)) as source_date\n    , 'OBSERVATION' AS table_name\n    , 'Observation ID' as drill_down_key\n    , coalesce(observation_id, 'NULL') AS drill_down_value\n    , 'SOURCE_DESCRIPTION' as field_name\n    , case when m.source_description is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(substring(source_description, 1, 255) as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.observation m", "relation_name": "tuva.data_quality.observation_source_description"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.003948Z", "completed_at": "2025-02-25T21:26:16.014157Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.014679Z", "completed_at": "2025-02-25T21:26:16.014687Z"}], "thread_id": "Thread-2", "execution_time": 0.012284040451049805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__observation_source_reference_range_high", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.observation_date,cast('1900-01-01' as date)) as source_date\n    , 'OBSERVATION' AS table_name\n    , 'Observation ID' as drill_down_key\n    , coalesce(observation_id, 'NULL') AS drill_down_value\n    , 'SOURCE_REFERENCE_RANGE_HIGH' as field_name\n    , case when m.source_reference_range_high is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(source_reference_range_high as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.observation m", "relation_name": "tuva.data_quality.observation_source_reference_range_high"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.010497Z", "completed_at": "2025-02-25T21:26:16.019266Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.019923Z", "completed_at": "2025-02-25T21:26:16.019929Z"}], "thread_id": "Thread-1", "execution_time": 0.010711908340454102, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__observation_source_reference_range_low", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.observation_date,cast('1900-01-01' as date)) as source_date\n    , 'OBSERVATION' AS table_name\n    , 'Observation ID' as drill_down_key\n    , coalesce(observation_id, 'NULL') AS drill_down_value\n    , 'SOURCE_REFERENCE_RANGE_LOW' as field_name\n    , case when m.source_reference_range_low is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(source_reference_range_low as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.observation m", "relation_name": "tuva.data_quality.observation_source_reference_range_low"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.015178Z", "completed_at": "2025-02-25T21:26:16.020557Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.026310Z", "completed_at": "2025-02-25T21:26:16.026319Z"}], "thread_id": "Thread-3", "execution_time": 0.016193151473999023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__observation_source_units", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.observation_date,cast('1900-01-01' as date)) as source_date\n    , 'OBSERVATION' AS TABLE_NAME\n    , 'Observation ID' as drill_down_key\n    , coalesce(observation_id, 'NULL') AS drill_down_value\n    , 'SOURCE_UNITS' as field_name\n    , case when m.source_units is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(source_units as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.observation m", "relation_name": "tuva.data_quality.observation_source_units"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.021047Z", "completed_at": "2025-02-25T21:26:16.032372Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.032944Z", "completed_at": "2025-02-25T21:26:16.032952Z"}], "thread_id": "Thread-2", "execution_time": 0.01348114013671875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.core__stg_clinical_practitioner", "compiled": true, "compiled_code": "\n\nselect\n    cast(practitioner_id as TEXT ) as practitioner_id\n    , cast(npi as TEXT ) as npi\n    , cast(first_name as TEXT ) as first_name\n    , cast(last_name as TEXT ) as last_name\n    , cast(practice_affiliation as TEXT ) as practice_affiliation\n    , cast(specialty as TEXT ) as specialty\n    , cast(sub_specialty as TEXT ) as sub_specialty\n    , cast(data_source as TEXT ) as data_source\n    , cast('2025-02-25 21:25:59.177756+00:00' as timestamp ) as tuva_last_run\nfrom tuva.input_layer.practitioner", "relation_name": "tuva.core._stg_clinical_practitioner"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.027918Z", "completed_at": "2025-02-25T21:26:16.039283Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.039971Z", "completed_at": "2025-02-25T21:26:16.039977Z"}], "thread_id": "Thread-1", "execution_time": 0.013221979141235352, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__practitioner_data_source", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    \n        , cast(coalesce(convert_timezone('UTC', current_timestamp()), cast('1900-01-01' as date)) as date) as source_date\n    \n    , 'PRACTITIONER' AS table_name\n    , 'Practitioner ID' as drill_down_key\n    , coalesce(practitioner_id, 'NULL') AS drill_down_value\n    , 'DATA_SOURCE' as field_name\n    , case when m.data_source is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(data_source as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.practitioner m", "relation_name": "tuva.data_quality.practitioner_data_source"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.033403Z", "completed_at": "2025-02-25T21:26:16.040639Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.045718Z", "completed_at": "2025-02-25T21:26:16.045727Z"}], "thread_id": "Thread-3", "execution_time": 0.018146991729736328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__practitioner_first_name", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    \n        , cast(coalesce(convert_timezone('UTC', current_timestamp()), cast('1900-01-01' as date)) as date) as source_date\n    \n    , 'PRACTITIONER' AS table_name\n    , 'Practitioner ID' as drill_down_key\n    , coalesce(practitioner_id, 'NULL') AS drill_down_value\n    , 'FIRST_NAME' as field_name\n    , case when m.first_name is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(first_name as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.practitioner m", "relation_name": "tuva.data_quality.practitioner_first_name"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.041176Z", "completed_at": "2025-02-25T21:26:16.052154Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.056905Z", "completed_at": "2025-02-25T21:26:16.056913Z"}], "thread_id": "Thread-2", "execution_time": 0.017390966415405273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__practitioner_last_name", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    \n        , cast(coalesce(convert_timezone('UTC', current_timestamp()), cast('1900-01-01' as date)) as date) as source_date\n    \n    , 'PRACTITIONER' AS table_name\n    , 'Practitioner ID' as drill_down_key\n    , coalesce(practitioner_id, 'NULL') AS drill_down_value\n    , 'LAST_NAME' as field_name\n    , case when m.last_name is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(last_name as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.practitioner m", "relation_name": "tuva.data_quality.practitioner_last_name"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.047428Z", "completed_at": "2025-02-25T21:26:16.057532Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.058172Z", "completed_at": "2025-02-25T21:26:16.058177Z"}], "thread_id": "Thread-1", "execution_time": 0.012019872665405273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__practitioner_practice_affiliation", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    \n        , cast(coalesce(convert_timezone('UTC', current_timestamp()), cast('1900-01-01' as date)) as date) as source_date\n    \n    , 'PRACTITIONER' AS table_name\n    , 'Practitioner ID' as drill_down_key\n    , coalesce(practitioner_id, 'NULL') AS drill_down_value\n    , 'PRACTICE_AFFILIATION' AS field_name\n    , case when m.practice_affiliation is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(practice_affiliation as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.practitioner m", "relation_name": "tuva.data_quality.practitioner_practice_affiliation"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.052433Z", "completed_at": "2025-02-25T21:26:16.058554Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.059414Z", "completed_at": "2025-02-25T21:26:16.059419Z"}], "thread_id": "Thread-3", "execution_time": 0.012327909469604492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__practitioner_practitioner_id", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    \n        , cast(coalesce(convert_timezone('UTC', current_timestamp()), cast('1900-01-01' as date)) as date) as source_date\n    \n    , 'PRACTITIONER' AS table_name\n    , 'Practitioner ID' as drill_down_key\n    , coalesce(practitioner_id, 'NULL') AS drill_down_value\n    , 'PRACTITIONER_ID' as field_name\n    , case when m.practitioner_id is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(practitioner_id as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.practitioner m", "relation_name": "tuva.data_quality.practitioner_practitioner_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.060746Z", "completed_at": "2025-02-25T21:26:16.083295Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.083648Z", "completed_at": "2025-02-25T21:26:16.083656Z"}], "thread_id": "Thread-2", "execution_time": 0.024918079376220703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__practitioner_specialty", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    \n        , cast(coalesce(convert_timezone('UTC', current_timestamp()), cast('1900-01-01' as date)) as date) as source_date\n    \n    , 'PRACTITIONER' AS table_name\n    , 'Practitioner ID' as drill_down_key\n    , coalesce(practitioner_id, 'NULL') AS drill_down_value\n    , 'SPECIALTY' as field_name\n    , case when m.specialty is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(specialty as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.practitioner m", "relation_name": "tuva.data_quality.practitioner_specialty"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.066187Z", "completed_at": "2025-02-25T21:26:16.084583Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.085255Z", "completed_at": "2025-02-25T21:26:16.085259Z"}], "thread_id": "Thread-1", "execution_time": 0.025176048278808594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__practitioner_sub_specialty", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    \n        , cast(coalesce(convert_timezone('UTC', current_timestamp()), cast('1900-01-01' as date)) as date) as source_date\n    \n    , 'PRACTITIONER' AS table_name\n    , 'Practitioner ID' as drill_down_key\n    , coalesce(practitioner_id, 'NULL') AS drill_down_value\n    , 'SUB_SPECIALTY' as field_name\n    , case when m.sub_specialty is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(sub_specialty as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.practitioner m", "relation_name": "tuva.data_quality.practitioner_sub_specialty"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.072118Z", "completed_at": "2025-02-25T21:26:16.085635Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.090440Z", "completed_at": "2025-02-25T21:26:16.090445Z"}], "thread_id": "Thread-3", "execution_time": 0.024741172790527344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.core__stg_clinical_patient", "compiled": true, "compiled_code": "\n\nwith tuva_last_run as(\n    select\n       cast('2025-02-25 21:25:59.177756+00:00' as timestamp ) as tuva_last_run_datetime\n       , cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date ) as tuva_last_run_date\n)\nSELECT\n      cast(person_id as TEXT ) as person_id\n    , cast(first_name as TEXT ) as first_name\n    , cast(last_name as TEXT ) as last_name\n    , cast(sex as TEXT ) as sex\n    , cast(race as TEXT ) as race\n    , try_cast( birth_date as date ) as birth_date\n    , try_cast( death_date as date ) as death_date\n    , cast(death_flag as integer ) as death_flag\n    , cast(social_security_number as TEXT ) as social_security_number\n    , cast(address as TEXT ) as address\n    , cast(city as TEXT ) as city\n    , cast(state as TEXT ) as state\n    , cast(zip_code as TEXT ) as zip_code\n    , cast(county as TEXT ) as county\n    , cast(latitude as float ) as latitude\n    , cast(longitude as float ) as longitude\n    , cast(phone as TEXT) as phone\n    , cast(data_source as TEXT ) as data_source\n    , cast(floor(datediff(\n        hour,\n        birth_date,\n        tuva_last_run_date\n        ) / 8760.0) as integer ) as age\n    , cast(\n        CASE\n            WHEN cast(floor(datediff(\n        hour,\n        birth_date,\n        tuva_last_run_date\n        ) / 8760.0) as integer ) < 10 THEN '0-9'\n            WHEN cast(floor(datediff(\n        hour,\n        birth_date,\n        tuva_last_run_date\n        ) / 8760.0) as integer ) < 20 THEN '10-19'\n            WHEN cast(floor(datediff(\n        hour,\n        birth_date,\n        tuva_last_run_date\n        ) / 8760.0) as integer ) < 30 THEN '20-29'\n            WHEN cast(floor(datediff(\n        hour,\n        birth_date,\n        tuva_last_run_date\n        ) / 8760.0) as integer ) < 40 THEN '30-39'\n            WHEN cast(floor(datediff(\n        hour,\n        birth_date,\n        tuva_last_run_date\n        ) / 8760.0) as integer ) < 50 THEN '40-49'\n            WHEN cast(floor(datediff(\n        hour,\n        birth_date,\n        tuva_last_run_date\n        ) / 8760.0) as integer ) < 60 THEN '50-59'\n            WHEN cast(floor(datediff(\n        hour,\n        birth_date,\n        tuva_last_run_date\n        ) / 8760.0) as integer ) < 70 THEN '60-69'\n            WHEN cast(floor(datediff(\n        hour,\n        birth_date,\n        tuva_last_run_date\n        ) / 8760.0) as integer ) < 80 THEN '70-79'\n            WHEN cast(floor(datediff(\n        hour,\n        birth_date,\n        tuva_last_run_date\n        ) / 8760.0) as integer ) < 90 THEN '80-89'\n            ELSE '90+'\n        END as TEXT\n    ) AS age_group\n    , tuva_last_run_datetime as tuva_last_run\nFROM tuva.input_layer.patient\ncross join tuva_last_run", "relation_name": "tuva.core._stg_clinical_patient"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.085838Z", "completed_at": "2025-02-25T21:26:16.091655Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.097472Z", "completed_at": "2025-02-25T21:26:16.097481Z"}], "thread_id": "Thread-2", "execution_time": 0.013223886489868164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__patient_address", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    \n        , cast(coalesce(convert_timezone('UTC', current_timestamp()), cast('1900-01-01' as date)) as date) as source_date\n    \n    , 'PATIENT' AS table_name\n    , 'Person ID' as drill_down_key\n    , coalesce(person_id, 'NULL') AS drill_down_value\n    , 'ADDRESS' as field_name\n    , case when m.address is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(address as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.patient m", "relation_name": "tuva.data_quality.patient_address"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.092077Z", "completed_at": "2025-02-25T21:26:16.104001Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.104477Z", "completed_at": "2025-02-25T21:26:16.104483Z"}], "thread_id": "Thread-1", "execution_time": 0.013640880584716797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__patient_birth_date", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    \n        , cast(coalesce(convert_timezone('UTC', current_timestamp()), cast('1900-01-01' as date)) as date) as source_date\n    \n    , 'PATIENT' AS table_name\n    , 'Person ID' as drill_down_key\n    , coalesce(person_id, 'NULL') AS drill_down_value\n    , 'BIRTH_DATE' AS field_name\n    , case\n        when m.birth_date > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'invalid'\n        when m.birth_date <= cast('1901-01-01' as date) then 'invalid'\n        when m.birth_date > m.death_date then 'invalid'\n        when m.birth_date is null then 'null'\n        else 'valid'\n    end as bucket_name\n    , case\n        when m.birth_date > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'future'\n        when m.birth_date <= cast('1901-01-01' as date) then 'too old'\n        when m.birth_date > m.death_date then 'Birth date after death date'\n        else null\n    end as invalid_reason\n    , cast(birth_date as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.patient m", "relation_name": "tuva.data_quality.patient_birth_date"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.098677Z", "completed_at": "2025-02-25T21:26:16.108854Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.109559Z", "completed_at": "2025-02-25T21:26:16.109567Z"}], "thread_id": "Thread-3", "execution_time": 0.017808914184570312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__patient_city", "compiled": true, "compiled_code": "\n\n\nSELECT\n    m.data_source\n    \n        , cast(coalesce(convert_timezone('UTC', current_timestamp()), cast('1900-01-01' as date)) as date) as source_date\n    \n    ,'PATIENT' AS table_name\n    ,'Person ID' as drill_down_key\n    , coalesce(person_id, 'NULL') AS drill_down_value\n    ,'CITY' AS field_name\n    ,case when m.city is not null then 'valid' else 'null' end as bucket_name\n    ,cast(null as TEXT) as invalid_reason\n    ,cast(city as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.patient m", "relation_name": "tuva.data_quality.patient_city"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.104946Z", "completed_at": "2025-02-25T21:26:16.110562Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.111272Z", "completed_at": "2025-02-25T21:26:16.111276Z"}], "thread_id": "Thread-2", "execution_time": 0.007664203643798828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__patient_county", "compiled": true, "compiled_code": "\n\n\nSELECT\n    m.data_source\n    \n        , cast(coalesce(convert_timezone('UTC', current_timestamp()), cast('1900-01-01' as date)) as date) as source_date\n    \n    ,'PATIENT' AS table_name\n    ,'Person ID' as drill_down_key\n    , coalesce(person_id, 'NULL') AS drill_down_value\n    ,'COUNTY' as field_name\n    ,case when m.county is not null then 'valid' else 'null' end as bucket_name\n    ,cast(null as TEXT) as invalid_reason\n    ,cast(county as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.patient m", "relation_name": "tuva.data_quality.patient_county"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.111637Z", "completed_at": "2025-02-25T21:26:16.121800Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.126436Z", "completed_at": "2025-02-25T21:26:16.126446Z"}], "thread_id": "Thread-1", "execution_time": 0.016518831253051758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__patient_data_source", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    \n        , cast(coalesce(convert_timezone('UTC', current_timestamp()), cast('1900-01-01' as date)) as date) as source_date\n    \n    , 'PATIENT' AS table_name\n    , 'Person ID' as drill_down_key\n    , coalesce(person_id, 'NULL') AS drill_down_value\n    , 'DATA_SOURCE' as field_name\n    , case when m.data_source is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(data_source as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.patient m", "relation_name": "tuva.data_quality.patient_data_source"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.116239Z", "completed_at": "2025-02-25T21:26:16.122072Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.126887Z", "completed_at": "2025-02-25T21:26:16.126890Z"}], "thread_id": "Thread-3", "execution_time": 0.01592230796813965, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__patient_death_date", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    \n        , cast(coalesce(convert_timezone('UTC', current_timestamp()), cast('1900-01-01' as date)) as date) as source_date\n    \n    , 'PATIENT' AS table_name\n    , 'Person ID' as drill_down_key\n    , coalesce(person_id, 'NULL') AS drill_down_value\n    , 'DEATH_DATE' AS field_name\n    , case\n        when m.death_date > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'invalid'\n        when m.death_date <= cast('1901-01-01' as date) then 'invalid'\n        when m.death_date > m.birth_date then 'invalid'\n        when m.death_date is null then 'null'\n        else 'valid'\n    end as bucket_name\n    , case\n        when m.death_date > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'future'\n        when m.death_date <= cast('1901-01-01' as date) then 'too old'\n        when m.death_date > m.birth_date then 'Death date after birth date'\n        else null\n    end as invalid_reason\n    , cast(death_date as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.patient m", "relation_name": "tuva.data_quality.patient_death_date"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.122266Z", "completed_at": "2025-02-25T21:26:16.128222Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.128916Z", "completed_at": "2025-02-25T21:26:16.128921Z"}], "thread_id": "Thread-2", "execution_time": 0.0077440738677978516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__patient_death_flag", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    \n        , cast(coalesce(convert_timezone('UTC', current_timestamp()), cast('1900-01-01' as date)) as date) as source_date\n    \n    , 'PATIENT' AS table_name\n    , 'Person ID' as drill_down_key\n    , coalesce(person_id, 'NULL') AS drill_down_value\n    , 'DEATH_FLAG' as field_name\n    , case when m.death_flag is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(death_flag as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.patient m", "relation_name": "tuva.data_quality.patient_death_flag"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.129514Z", "completed_at": "2025-02-25T21:26:16.139903Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.144173Z", "completed_at": "2025-02-25T21:26:16.144183Z"}], "thread_id": "Thread-1", "execution_time": 0.016343116760253906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__patient_first_name", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    \n        , cast(coalesce(convert_timezone('UTC', current_timestamp()), cast('1900-01-01' as date)) as date) as source_date\n    \n    , 'PATIENT' AS table_name\n    , 'Person ID' as drill_down_key\n    , coalesce(person_id, 'NULL') AS drill_down_value\n    , 'FIRST_NAME' as field_name\n    , case when m.first_name is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(first_name as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.patient m", "relation_name": "tuva.data_quality.patient_first_name"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.135141Z", "completed_at": "2025-02-25T21:26:16.144628Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.145194Z", "completed_at": "2025-02-25T21:26:16.145197Z"}], "thread_id": "Thread-3", "execution_time": 0.01680612564086914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__patient_last_name", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    \n        , cast(coalesce(convert_timezone('UTC', current_timestamp()), cast('1900-01-01' as date)) as date) as source_date\n    \n    , 'PATIENT' AS table_name\n    , 'Person ID' as drill_down_key\n    , coalesce(person_id, 'NULL') AS drill_down_value\n    , 'LAST_NAME' AS field_name\n    , case when m.last_name is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(last_name as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.patient m", "relation_name": "tuva.data_quality.patient_last_name"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.140155Z", "completed_at": "2025-02-25T21:26:16.146031Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.146761Z", "completed_at": "2025-02-25T21:26:16.146765Z"}], "thread_id": "Thread-2", "execution_time": 0.007620811462402344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__patient_latitude", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    \n        , cast(coalesce(convert_timezone('UTC', current_timestamp()), cast('1900-01-01' as date)) as date) as source_date\n    \n    , 'PATIENT' AS table_name\n    , 'Person ID' as drill_down_key\n    , coalesce(person_id, 'NULL') AS drill_down_value\n    , 'LATITUDE' as field_name\n    , case when m.latitude is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(latitude as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.patient m", "relation_name": "tuva.data_quality.patient_latitude"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.147421Z", "completed_at": "2025-02-25T21:26:16.157232Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.162750Z", "completed_at": "2025-02-25T21:26:16.162758Z"}], "thread_id": "Thread-1", "execution_time": 0.017213106155395508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__patient_longitude", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    \n        , cast(coalesce(convert_timezone('UTC', current_timestamp()), cast('1900-01-01' as date)) as date) as source_date\n    \n    , 'PATIENT' AS table_name\n    , 'Person ID' as drill_down_key\n    , coalesce(person_id, 'NULL') AS drill_down_value\n    , 'LONGITUDE' as field_name\n    , case when m.longitude is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(longitude as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.patient m", "relation_name": "tuva.data_quality.patient_longitude"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.152614Z", "completed_at": "2025-02-25T21:26:16.163550Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.164409Z", "completed_at": "2025-02-25T21:26:16.164415Z"}], "thread_id": "Thread-3", "execution_time": 0.017296791076660156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__patient_patient_id", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    \n        , cast(coalesce(convert_timezone('UTC', current_timestamp()), cast('1900-01-01' as date)) as date) as source_date\n    \n    , 'PATIENT' AS table_name\n    , 'Person ID' as drill_down_key\n    , coalesce(patient_id, 'NULL') AS drill_down_value\n    , 'PATIENT_ID' as field_name\n    , case when m.patient_id is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(patient_id as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.patient m", "relation_name": "tuva.data_quality.patient_patient_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.157508Z", "completed_at": "2025-02-25T21:26:16.164847Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.166157Z", "completed_at": "2025-02-25T21:26:16.166162Z"}], "thread_id": "Thread-2", "execution_time": 0.013916015625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__patient_state", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    \n        , cast(coalesce(convert_timezone('UTC', current_timestamp()), cast('1900-01-01' as date)) as date) as source_date\n    \n    , 'PATIENT' AS table_name\n    , 'Person ID' as drill_down_key\n    , coalesce(person_id, 'NULL') AS drill_down_value\n    , 'STATE' as field_name\n    , case when m.state is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(state as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.patient m", "relation_name": "tuva.data_quality.patient_state"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.166599Z", "completed_at": "2025-02-25T21:26:16.173468Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.182180Z", "completed_at": "2025-02-25T21:26:16.182188Z"}], "thread_id": "Thread-1", "execution_time": 0.01848602294921875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__patient_zip_code", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    \n        , cast(coalesce(convert_timezone('UTC', current_timestamp()), cast('1900-01-01' as date)) as date) as source_date\n    \n    , 'PATIENT' AS table_name\n    , 'Person ID' as drill_down_key\n    , coalesce(person_id, 'NULL') AS drill_down_value\n    , 'ZIP_CODE' as field_name\n    , case when m.zip_code is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(zip_code as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.patient m", "relation_name": "tuva.data_quality.patient_zip_code"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.174084Z", "completed_at": "2025-02-25T21:26:16.187103Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.187749Z", "completed_at": "2025-02-25T21:26:16.187755Z"}], "thread_id": "Thread-3", "execution_time": 0.0157320499420166, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.core__stg_clinical_procedure", "compiled": true, "compiled_code": "\n\nselect\n    cast(procedure_id as TEXT ) as procedure_id\n    , cast(person_id as TEXT ) as person_id\n    , cast(null as TEXT ) as member_id\n    , cast(patient_id as TEXT ) as patient_id\n    , cast(encounter_id as TEXT ) as encounter_id\n    , cast(claim_id as TEXT ) as claim_id\n    , try_cast( procedure_date as date ) as procedure_date\n    , cast(source_code_type as TEXT ) as source_code_type\n    , cast(source_code as TEXT ) as source_code\n    , cast(source_description as TEXT ) as source_description\n    , cast(normalized_code_type as TEXT ) as normalized_code_type\n    , cast(normalized_code as TEXT ) as normalized_code\n    , cast(normalized_description as TEXT ) as normalized_description\n    , cast(modifier_1 as TEXT ) as modifier_1\n    , cast(modifier_2 as TEXT ) as modifier_2\n    , cast(modifier_3 as TEXT ) as modifier_3\n    , cast(modifier_4 as TEXT ) as modifier_4\n    , cast(modifier_5 as TEXT ) as modifier_5\n    , cast(practitioner_id as TEXT ) as practitioner_id\n    , cast(data_source as TEXT ) as data_source\n    , cast('2025-02-25 21:25:59.177756+00:00' as timestamp ) as tuva_last_run\nfrom tuva.input_layer.procedure", "relation_name": "tuva.core._stg_clinical_procedure"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.182704Z", "completed_at": "2025-02-25T21:26:16.188721Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.194103Z", "completed_at": "2025-02-25T21:26:16.194111Z"}], "thread_id": "Thread-2", "execution_time": 0.020964860916137695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__procedure_claim_id", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.procedure_date,cast('1900-01-01' as date)) as source_date\n    , 'PROCEDURE' AS table_name\n    , 'Procedure ID' as drill_down_key\n    , coalesce(procedure_id, 'NULL') AS drill_down_value\n    , 'CLAIM_ID' as field_name\n    , case when m.claim_id is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(claim_id as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.procedure m", "relation_name": "tuva.data_quality.procedure_claim_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.189300Z", "completed_at": "2025-02-25T21:26:16.199367Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.199854Z", "completed_at": "2025-02-25T21:26:16.199860Z"}], "thread_id": "Thread-1", "execution_time": 0.012573003768920898, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__procedure_data_source", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.procedure_date,cast('1900-01-01' as date)) as source_date\n    , 'PROCEDURE' AS table_name\n    , 'Procedure ID' as drill_down_key\n    , coalesce(procedure_id, 'NULL') AS drill_down_value\n    , 'DATA_SOURCE' as field_name\n    , case when m.data_source is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(data_source as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.procedure m", "relation_name": "tuva.data_quality.procedure_data_source"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.195646Z", "completed_at": "2025-02-25T21:26:16.204258Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.204796Z", "completed_at": "2025-02-25T21:26:16.204802Z"}], "thread_id": "Thread-3", "execution_time": 0.010313987731933594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__procedure_encounter_id", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.procedure_date,cast('1900-01-01' as date)) as source_date\n    , 'PROCEDURE' AS table_name\n    , 'Procedure ID' as drill_down_key\n    , coalesce(procedure_id, 'NULL') AS drill_down_value\n    , 'ENCOUNTER_ID' as field_name\n    , case when m.encounter_id is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(encounter_id as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.procedure m", "relation_name": "tuva.data_quality.procedure_encounter_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.200294Z", "completed_at": "2025-02-25T21:26:16.205187Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.205958Z", "completed_at": "2025-02-25T21:26:16.205962Z"}], "thread_id": "Thread-2", "execution_time": 0.01065206527709961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__procedure_normalized_description", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.procedure_date,cast('1900-01-01' as date)) as source_date\n    , 'PROCEDURE' AS table_name\n    , 'Procedure ID' as drill_down_key\n    , coalesce(procedure_id, 'NULL') AS drill_down_value\n    , 'NORMALIZED_DESCRIPTION' AS field_name\n    , case when m.normalized_description is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(substring(normalized_description, 1, 255) as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.procedure m", "relation_name": "tuva.data_quality.procedure_normalized_description"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.206357Z", "completed_at": "2025-02-25T21:26:16.214787Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.215292Z", "completed_at": "2025-02-25T21:26:16.215298Z"}], "thread_id": "Thread-1", "execution_time": 0.010882139205932617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__procedure_patient_id", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.procedure_date,cast('1900-01-01' as date)) as source_date\n    , 'PROCEDURE' AS table_name\n    , 'Procedure ID' as drill_down_key\n    , coalesce(procedure_id, 'NULL') AS drill_down_value\n    , 'PATIENT_ID' AS field_name\n    , case when m.patient_id is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(patient_id as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.procedure m", "relation_name": "tuva.data_quality.procedure_patient_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.211202Z", "completed_at": "2025-02-25T21:26:16.221670Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.222207Z", "completed_at": "2025-02-25T21:26:16.222212Z"}], "thread_id": "Thread-3", "execution_time": 0.01232290267944336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__procedure_practitioner_id", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.procedure_date,cast('1900-01-01' as date)) as source_date\n    , 'PROCEDURE' AS table_name\n    , 'Procedure ID' as drill_down_key\n    , coalesce(procedure_id, 'NULL') AS drill_down_value\n    , 'PRACTITIONER_ID' AS field_name\n    , case when m.practitioner_id is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(practitioner_id as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.procedure m", "relation_name": "tuva.data_quality.procedure_practitioner_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.215732Z", "completed_at": "2025-02-25T21:26:16.223083Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.227381Z", "completed_at": "2025-02-25T21:26:16.227387Z"}], "thread_id": "Thread-2", "execution_time": 0.016522884368896484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__procedure_procedure_date", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.procedure_date,cast('1900-01-01' as date)) as source_date\n    , 'PROCEDURE' AS table_name\n    , 'Procedure ID' as drill_down_key\n    , coalesce(procedure_id, 'NULL') AS drill_down_value\n    , 'PROCEDURE_DATE' as field_name\n    , case\n        when m.procedure_date > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'invalid'\n        when m.procedure_date <= cast('1901-01-01' as date) then 'invalid'\n        when m.procedure_date is null then 'null'\n        else 'valid'\n    end as bucket_name\n    , case\n        when m.procedure_date > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'future'\n        when m.procedure_date <= cast('1901-01-01' as date) then 'too old'\n        else null\n    end as invalid_reason\n    , cast(procedure_date as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.procedure m", "relation_name": "tuva.data_quality.procedure_procedure_date"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.223281Z", "completed_at": "2025-02-25T21:26:16.231814Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.232372Z", "completed_at": "2025-02-25T21:26:16.232379Z"}], "thread_id": "Thread-1", "execution_time": 0.010518074035644531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__procedure_procedure_id", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.procedure_date,cast('1900-01-01' as date)) as source_date\n    , 'PROCEDURE' AS table_name\n    , 'Procedure ID' as drill_down_key\n    , coalesce(procedure_id, 'NULL') AS drill_down_value\n    , 'PROCEDURE_ID' AS field_name\n    , case when m.procedure_id is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(procedure_id as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.procedure m", "relation_name": "tuva.data_quality.procedure_procedure_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.228365Z", "completed_at": "2025-02-25T21:26:16.233390Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.237530Z", "completed_at": "2025-02-25T21:26:16.237536Z"}], "thread_id": "Thread-3", "execution_time": 0.010501861572265625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__procedure_source_code", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.procedure_date,cast('1900-01-01' as date)) as source_date\n    , 'PROCEDURE' AS table_name\n    , 'Procedure ID' as drill_down_key\n    , coalesce(procedure_id, 'NULL') AS drill_down_value\n    , 'SOURCE_CODE' as field_name\n    , case when m.source_code is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(source_code as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.procedure m", "relation_name": "tuva.data_quality.procedure_source_code"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.233593Z", "completed_at": "2025-02-25T21:26:16.242413Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.242906Z", "completed_at": "2025-02-25T21:26:16.242914Z"}], "thread_id": "Thread-2", "execution_time": 0.010945796966552734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__procedure_source_code_type", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.procedure_date,cast('1900-01-01' as date)) as source_date\n    , 'PROCEDURE' AS table_name\n    , 'Procedure ID' as drill_down_key\n    , coalesce(procedure_id, 'NULL') AS drill_down_value\n    , 'SOURCE_CODE_TYPE' as field_name\n    , case when m.source_code_type is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(source_code_type as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.procedure m", "relation_name": "tuva.data_quality.procedure_source_code_type"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.238485Z", "completed_at": "2025-02-25T21:26:16.245743Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.246354Z", "completed_at": "2025-02-25T21:26:16.246359Z"}], "thread_id": "Thread-1", "execution_time": 0.00918889045715332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__procedure_source_description", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.procedure_date,cast('1900-01-01' as date)) as source_date\n    , 'PROCEDURE' AS table_name\n    , 'Procedure ID' as drill_down_key\n    , coalesce(procedure_id, 'NULL') AS drill_down_value\n    , 'SOURCE_DESCRIPTION' as field_name\n    , case when m.source_description is not null then 'valid' else 'null' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(substring(source_description, 1, 255) as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.procedure m", "relation_name": "tuva.data_quality.procedure_source_description"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.243320Z", "completed_at": "2025-02-25T21:26:16.247487Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.251960Z", "completed_at": "2025-02-25T21:26:16.251966Z"}], "thread_id": "Thread-3", "execution_time": 0.00992894172668457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.input_layer.eligibility", "compiled": true, "compiled_code": "select\n      person_id\n    , member_id\n    , subscriber_id\n    , gender\n    , race\n    , birth_date\n    , death_date\n    , death_flag\n    , enrollment_start_date\n    , enrollment_end_date\n    , payer\n    , payer_type\n    , plan\n    , original_reason_entitlement_code\n    , dual_status_code\n    , medicare_status_code\n    , group_id\n    , group_name\n    , first_name\n    , last_name\n    , social_security_number\n    , subscriber_relation\n    , address\n    , city\n    , state\n    , zip_code\n    , phone\n    , data_source\n    , file_name\n    , file_date\n    , ingest_datetime\nfrom tuva._tuva_synthetic.eligibility_seed", "relation_name": "tuva.input_layer.eligibility"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.247883Z", "completed_at": "2025-02-25T21:26:16.255798Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.256251Z", "completed_at": "2025-02-25T21:26:16.256256Z"}], "thread_id": "Thread-2", "execution_time": 0.009536981582641602, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.input_layer.medical_claim", "compiled": true, "compiled_code": "select\n      claim_id\n    , claim_line_number\n    , claim_type\n    , person_id\n    , member_id\n    , payer\n    , plan\n    , claim_start_date\n    , claim_end_date\n    , claim_line_start_date\n    , claim_line_end_date\n    , admission_date\n    , discharge_date\n    , admit_source_code\n    , admit_type_code\n    , discharge_disposition_code\n    , place_of_service_code\n    , bill_type_code\n    , drg_code_type\n    , drg_code\n    , revenue_center_code\n    , service_unit_quantity\n    , hcpcs_code\n    , hcpcs_modifier_1\n    , hcpcs_modifier_2\n    , hcpcs_modifier_3\n    , hcpcs_modifier_4\n    , hcpcs_modifier_5\n    , rendering_npi\n    , rendering_tin\n    , billing_npi\n    , billing_tin\n    , facility_npi\n    , paid_date\n    , paid_amount\n    , allowed_amount\n    , charge_amount\n    , coinsurance_amount\n    , copayment_amount\n    , deductible_amount\n    , total_cost_amount\n    , diagnosis_code_type\n    , diagnosis_code_1\n    , diagnosis_code_2\n    , diagnosis_code_3\n    , diagnosis_code_4\n    , diagnosis_code_5\n    , diagnosis_code_6\n    , diagnosis_code_7\n    , diagnosis_code_8\n    , diagnosis_code_9\n    , diagnosis_code_10\n    , diagnosis_code_11\n    , diagnosis_code_12\n    , diagnosis_code_13\n    , diagnosis_code_14\n    , diagnosis_code_15\n    , diagnosis_code_16\n    , diagnosis_code_17\n    , diagnosis_code_18\n    , diagnosis_code_19\n    , diagnosis_code_20\n    , diagnosis_code_21\n    , diagnosis_code_22\n    , diagnosis_code_23\n    , diagnosis_code_24\n    , diagnosis_code_25\n    , diagnosis_poa_1\n    , diagnosis_poa_2\n    , diagnosis_poa_3\n    , diagnosis_poa_4\n    , diagnosis_poa_5\n    , diagnosis_poa_6\n    , diagnosis_poa_7\n    , diagnosis_poa_8\n    , diagnosis_poa_9\n    , diagnosis_poa_10\n    , diagnosis_poa_11\n    , diagnosis_poa_12\n    , diagnosis_poa_13\n    , diagnosis_poa_14\n    , diagnosis_poa_15\n    , diagnosis_poa_16\n    , diagnosis_poa_17\n    , diagnosis_poa_18\n    , diagnosis_poa_19\n    , diagnosis_poa_20\n    , diagnosis_poa_21\n    , diagnosis_poa_22\n    , diagnosis_poa_23\n    , diagnosis_poa_24\n    , diagnosis_poa_25\n    , procedure_code_type\n    , procedure_code_1\n    , procedure_code_2\n    , procedure_code_3\n    , procedure_code_4\n    , procedure_code_5\n    , procedure_code_6\n    , procedure_code_7\n    , procedure_code_8\n    , procedure_code_9\n    , procedure_code_10\n    , procedure_code_11\n    , procedure_code_12\n    , procedure_code_13\n    , procedure_code_14\n    , procedure_code_15\n    , procedure_code_16\n    , procedure_code_17\n    , procedure_code_18\n    , procedure_code_19\n    , procedure_code_20\n    , procedure_code_21\n    , procedure_code_22\n    , procedure_code_23\n    , procedure_code_24\n    , procedure_code_25\n    , procedure_date_1\n    , procedure_date_2\n    , procedure_date_3\n    , procedure_date_4\n    , procedure_date_5\n    , procedure_date_6\n    , procedure_date_7\n    , procedure_date_8\n    , procedure_date_9\n    , procedure_date_10\n    , procedure_date_11\n    , procedure_date_12\n    , procedure_date_13\n    , procedure_date_14\n    , procedure_date_15\n    , procedure_date_16\n    , procedure_date_17\n    , procedure_date_18\n    , procedure_date_19\n    , procedure_date_20\n    , procedure_date_21\n    , procedure_date_22\n    , procedure_date_23\n    , procedure_date_24\n    , procedure_date_25\n    , in_network_flag\n    , data_source\n    , file_name\n    , file_date\n    , ingest_datetime\nfrom tuva._tuva_synthetic.medical_claim_seed", "relation_name": "tuva.input_layer.medical_claim"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.253293Z", "completed_at": "2025-02-25T21:26:16.259056Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.260341Z", "completed_at": "2025-02-25T21:26:16.260347Z"}], "thread_id": "Thread-1", "execution_time": 0.012778043746948242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.input_layer.pharmacy_claim", "compiled": true, "compiled_code": "select\n      claim_id\n    , claim_line_number\n    , person_id\n    , member_id\n    , payer\n    , plan\n    , prescribing_provider_npi\n    , dispensing_provider_npi\n    , dispensing_date\n    , ndc_code\n    , quantity\n    , days_supply\n    , refills\n    , paid_date\n    , paid_amount\n    , allowed_amount\n    , charge_amount\n    , coinsurance_amount\n    , copayment_amount\n    , deductible_amount\n    , in_network_flag\n    , data_source\n    , file_name\n    , file_date\n    , ingest_datetime\nfrom tuva._tuva_synthetic.pharmacy_claim_seed", "relation_name": "tuva.input_layer.pharmacy_claim"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.256638Z", "completed_at": "2025-02-25T21:26:16.261407Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.262474Z", "completed_at": "2025-02-25T21:26:16.262478Z"}], "thread_id": "Thread-3", "execution_time": 0.007036924362182617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.input_layer.provider_attribution", "compiled": true, "compiled_code": "select\n      person_id\n    , year_month\n    , payer\n    , plan\n    , data_source\n    , payer_attributed_provider\n    , payer_attributed_provider_practice\n    , payer_attributed_provider_organization\n    , payer_attributed_provider_lob\n    , custom_attributed_provider\n    , custom_attributed_provider_practice\n    , custom_attributed_provider_organization\n    , custom_attributed_provider_lob\nfrom tuva._tuva_synthetic.provider_attribution_seed", "relation_name": "tuva.input_layer.provider_attribution"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.262841Z", "completed_at": "2025-02-25T21:26:16.273802Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.274336Z", "completed_at": "2025-02-25T21:26:16.274344Z"}], "thread_id": "Thread-2", "execution_time": 0.013614892959594727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ccsr__dx_vertical_pivot", "compiled": true, "compiled_code": "\n\nwith codes as (\n    \n    select\n          icd_10_cm_code as code\n        , icd_10_cm_code_description as code_description\n        -- loop to generate columns for CCSR categories 1-6\n        , ccsr_category_1\n        , ccsr_category_1_description\n        , ccsr_category_2\n        , ccsr_category_2_description\n        , ccsr_category_3\n        , ccsr_category_3_description\n        , ccsr_category_4\n        , ccsr_category_4_description\n        , ccsr_category_5\n        , ccsr_category_5_description\n        , ccsr_category_6\n        , ccsr_category_6_description\n        , default_ccsr_category_ip\n        , default_ccsr_category_op\n    from tuva.ccsr._value_set_dxccsr_v2023_1_cleaned_map\n\n)\n\n, long_union as (\n    -- generate select & union statements to pivot category columns to rows\n    \n    select \n          code\n        , code_description\n        , substring(ccsr_category_1, 1, 3) as ccsr_parent_category\n        , ccsr_category_1 as ccsr_category\n        , ccsr_category_1_description as ccsr_category_description\n        , 1 as ccsr_category_rank\n        , CASE WHEN ccsr_category_1 = default_ccsr_category_ip THEN 1 ELSE 0 END as is_ip_default_category\n        , CASE WHEN ccsr_category_1 = default_ccsr_category_op THEN 1 ELSE 0 END as is_op_default_category\n    from codes \n    union all\n    select \n          code\n        , code_description\n        , substring(ccsr_category_2, 1, 3) as ccsr_parent_category\n        , ccsr_category_2 as ccsr_category\n        , ccsr_category_2_description as ccsr_category_description\n        , 2 as ccsr_category_rank\n        , CASE WHEN ccsr_category_2 = default_ccsr_category_ip THEN 1 ELSE 0 END as is_ip_default_category\n        , CASE WHEN ccsr_category_2 = default_ccsr_category_op THEN 1 ELSE 0 END as is_op_default_category\n    from codes \n    union all\n    select \n          code\n        , code_description\n        , substring(ccsr_category_3, 1, 3) as ccsr_parent_category\n        , ccsr_category_3 as ccsr_category\n        , ccsr_category_3_description as ccsr_category_description\n        , 3 as ccsr_category_rank\n        , CASE WHEN ccsr_category_3 = default_ccsr_category_ip THEN 1 ELSE 0 END as is_ip_default_category\n        , CASE WHEN ccsr_category_3 = default_ccsr_category_op THEN 1 ELSE 0 END as is_op_default_category\n    from codes \n    union all\n    select \n          code\n        , code_description\n        , substring(ccsr_category_4, 1, 3) as ccsr_parent_category\n        , ccsr_category_4 as ccsr_category\n        , ccsr_category_4_description as ccsr_category_description\n        , 4 as ccsr_category_rank\n        , CASE WHEN ccsr_category_4 = default_ccsr_category_ip THEN 1 ELSE 0 END as is_ip_default_category\n        , CASE WHEN ccsr_category_4 = default_ccsr_category_op THEN 1 ELSE 0 END as is_op_default_category\n    from codes \n    union all\n    select \n          code\n        , code_description\n        , substring(ccsr_category_5, 1, 3) as ccsr_parent_category\n        , ccsr_category_5 as ccsr_category\n        , ccsr_category_5_description as ccsr_category_description\n        , 5 as ccsr_category_rank\n        , CASE WHEN ccsr_category_5 = default_ccsr_category_ip THEN 1 ELSE 0 END as is_ip_default_category\n        , CASE WHEN ccsr_category_5 = default_ccsr_category_op THEN 1 ELSE 0 END as is_op_default_category\n    from codes \n    union all\n    select \n          code\n        , code_description\n        , substring(ccsr_category_6, 1, 3) as ccsr_parent_category\n        , ccsr_category_6 as ccsr_category\n        , ccsr_category_6_description as ccsr_category_description\n        , 6 as ccsr_category_rank\n        , CASE WHEN ccsr_category_6 = default_ccsr_category_ip THEN 1 ELSE 0 END as is_ip_default_category\n        , CASE WHEN ccsr_category_6 = default_ccsr_category_op THEN 1 ELSE 0 END as is_op_default_category\n    from codes \n    \n\n)\n\nselect distinct\n    *,\n    '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom long_union\n-- as not all diagnosis codes have multiple categories, we can discard nulls\nwhere ccsr_category is not null", "relation_name": "tuva.ccsr.dx_vertical_pivot"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.269541Z", "completed_at": "2025-02-25T21:26:16.274763Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.277986Z", "completed_at": "2025-02-25T21:26:16.277992Z"}], "thread_id": "Thread-1", "execution_time": 0.015844106674194336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ccsr__procedure_category_map", "compiled": true, "compiled_code": "\n\nselect \n     icd_10_pcs as code\n    , icd_10_pcs_description as code_description\n    , prccsr as ccsr_category\n    , substring(prccsr, 1, 3) as ccsr_parent_category\n    , prccsr_description as ccsr_category_description\n    , clinical_domain\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ccsr._value_set_prccsr_v2023_1_cleaned_map", "relation_name": "tuva.ccsr.procedure_category_map"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.274980Z", "completed_at": "2025-02-25T21:26:16.279313Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.286074Z", "completed_at": "2025-02-25T21:26:16.286083Z"}], "thread_id": "Thread-3", "execution_time": 0.012740135192871094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.clinical_concept_library__value_set_member_relevant_fields", "compiled": true, "compiled_code": "with value_set_member_relevant_fields as (\nselect \n  aa.concept_id,\n  aa.concept_name,\n  aa.concept_type,\n  \n  bb.value_set_member_id,\n  bb.code,\n  bb.coding_system_id,\n  bb.include_descendants,\n\n  cc.coding_system_name\n  \nfrom tuva.clinical_concept_library.clinical_concepts aa\n\nleft join tuva.clinical_concept_library.value_set_members bb\non aa.concept_id = bb.concept_id\n\nleft join tuva.clinical_concept_library.coding_systems cc\non bb.coding_system_id = cc.coding_system_id\n)\n\n\nselect *\nfrom value_set_member_relevant_fields", "relation_name": "tuva.clinical_concept_library.value_set_member_relevant_fields"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.279814Z", "completed_at": "2025-02-25T21:26:16.291571Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.293114Z", "completed_at": "2025-02-25T21:26:16.293121Z"}], "thread_id": "Thread-2", "execution_time": 0.014701128005981445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.not_null_ed_classification__johnston_icd10_icd10.d04e7f84c7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect icd10\nfrom tuva.ed_classification._value_set_johnston_icd10\nwhere icd10 is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.287101Z", "completed_at": "2025-02-25T21:26:16.296638Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.298321Z", "completed_at": "2025-02-25T21:26:16.298327Z"}], "thread_id": "Thread-1", "execution_time": 0.018858909606933594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.unique_ed_classification__johnston_icd10_icd10.3d55f2b2dd", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    icd10 as unique_field,\n    count(*) as n_records\n\nfrom tuva.ed_classification._value_set_johnston_icd10\nwhere icd10 is not null\ngroup by icd10\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.293524Z", "completed_at": "2025-02-25T21:26:16.299249Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.300090Z", "completed_at": "2025-02-25T21:26:16.300094Z"}], "thread_id": "Thread-3", "execution_time": 0.008861064910888672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.not_null_ed_classification__johnston_icd9_icd9.a7feea49c0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect icd9\nfrom tuva.ed_classification._value_set_johnston_icd9\nwhere icd9 is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.302603Z", "completed_at": "2025-02-25T21:26:16.311067Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.314840Z", "completed_at": "2025-02-25T21:26:16.314848Z"}], "thread_id": "Thread-2", "execution_time": 0.015930891036987305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.unique_ed_classification__johnston_icd9_icd9.08c1dc4617", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    icd9 as unique_field,\n    count(*) as n_records\n\nfrom tuva.ed_classification._value_set_johnston_icd9\nwhere icd9 is not null\ngroup by icd9\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.306729Z", "completed_at": "2025-02-25T21:26:16.315859Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.316411Z", "completed_at": "2025-02-25T21:26:16.316416Z"}], "thread_id": "Thread-1", "execution_time": 0.016004085540771484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.pharmacy__int_brand_with_generic_available", "compiled": true, "compiled_code": "\n\nselect distinct \n    product_rxcui as brand_with_generic_available\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.pharmacy.rxnorm_generic_available\nwhere \n    ndc_product_tty in ('SCD', 'GPCK')\n    \n        and cast(product_startmarketingdate as date) <= current_date\n", "relation_name": "tuva.pharmacy._int_brand_with_generic_available"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.311310Z", "completed_at": "2025-02-25T21:26:16.316830Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.317541Z", "completed_at": "2025-02-25T21:26:16.317545Z"}], "thread_id": "Thread-3", "execution_time": 0.011192083358764648, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.mart_review__quality_measures_value_set", "compiled": true, "compiled_code": "\n\nselect *    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.quality_measures._value_set_measures p", "relation_name": "tuva.data_quality.mart_review__quality_measures_value_set"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.317905Z", "completed_at": "2025-02-25T21:26:16.332313Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.338150Z", "completed_at": "2025-02-25T21:26:16.338158Z"}], "thread_id": "Thread-2", "execution_time": 0.02210712432861328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.quality_measures__int_adh_diabetes__performance_period", "compiled": true, "compiled_code": "/*\n    set performance period end to the end of the current calendar year\n    or use the quality_measures_period_end variable if provided\n*/\n\nwith period_end as (\n\n    select\n        cast(\n        \n\n    dateadd(\n        day,\n        -1,\n        \n\n    dateadd(\n        year,\n        1,\n        date_trunc('year', convert_timezone('UTC', current_timestamp()))\n        )\n\n\n        )\n\n\n        as date)\n        \n         as performance_period_end\n         \n)\n\n/*\n    set performance period begin to a year and a day prior\n    for a complete calendar year\n*/\n, period_begin as (\n\n    select\n          performance_period_end\n        , \n\n    dateadd(\n        day,\n        1,\n        \n\n    dateadd(\n        year,\n        -1,\n        performance_period_end\n        )\n\n\n        )\n\n as performance_period_begin\n    from period_end\n\n)\n\nselect\n      cast((select id\nfrom tuva.quality_measures._value_set_measures\nwhere id = 'ADH-Diabetes') as TEXT) as measure_id\n    , cast((select name\nfrom tuva.quality_measures._value_set_measures\nwhere id = 'ADH-Diabetes') as TEXT) as measure_name\n    , cast((select version\nfrom tuva.quality_measures._value_set_measures\nwhere id = 'ADH-Diabetes') as TEXT) as measure_version\n    , cast(performance_period_begin as date) as performance_period_begin\n    , cast(performance_period_end as date) as performance_period_end\nfrom period_begin", "relation_name": "tuva.quality_measures._int_adh_diabetes__performance_period"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.324953Z", "completed_at": "2025-02-25T21:26:16.338629Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.339151Z", "completed_at": "2025-02-25T21:26:16.339155Z"}], "thread_id": "Thread-1", "execution_time": 0.015352725982666016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.quality_measures__int_adh_statins__performance_period", "compiled": true, "compiled_code": "/*\n    set performance period end to the end of the current calendar year\n    or use the quality_measures_period_end variable if provided\n*/\n\nwith period_end as (\n\n    select\n        cast(\n        \n\n    dateadd(\n        day,\n        -1,\n        \n\n    dateadd(\n        year,\n        1,\n        date_trunc('year', convert_timezone('UTC', current_timestamp()))\n        )\n\n\n        )\n\n\n        as date)\n        \n         as performance_period_end\n\n)\n\n/*\n    set performance period begin to following day of 1 year prior\n*/\n\n, period_begin as (\n\n    select\n          performance_period_end\n        , \n\n    dateadd(\n        day,\n        1,\n        \n\n    dateadd(\n        year,\n        -1,\n        performance_period_end\n        )\n\n\n        )\n\n as performance_period_begin\n    from period_end\n\n)\n\nselect\n      cast((\n  select id\n  from tuva.quality_measures._value_set_measures\n  where id = 'ADH-Statins'\n) as TEXT) as measure_id\n    , cast((\n  select name\n  from tuva.quality_measures._value_set_measures\n  where id = 'ADH-Statins'\n) as TEXT) as measure_name\n    , cast((\n  select version\n  from tuva.quality_measures._value_set_measures\n  where id = 'ADH-Statins'\n) as TEXT) as measure_version\n    , cast(performance_period_begin as date) as performance_period_begin\n    , cast(performance_period_end as date) as performance_period_end\nfrom period_begin", "relation_name": "tuva.quality_measures._int_adh_statins__performance_period"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.332574Z", "completed_at": "2025-02-25T21:26:16.339528Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.340220Z", "completed_at": "2025-02-25T21:26:16.340224Z"}], "thread_id": "Thread-3", "execution_time": 0.015583038330078125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.quality_measures__int_adhras__performance_period", "compiled": true, "compiled_code": "/*\n    set performance period end to the end of the current calendar year\n    or use the quality_measures_period_end variable if provided\n*/\n\nwith period_end as (\n\n    select\n        cast(\n        \n\n    dateadd(\n        day,\n        -1,\n        \n\n    dateadd(\n        year,\n        1,\n        date_trunc('year', convert_timezone('UTC', current_timestamp()))\n        )\n\n\n        )\n\n\n        as date)\n        \n         as performance_period_end\n\n)\n\n/*\n    set performance period begin to following day of 1 year prior\n*/\n\n, period_begin as (\n\n    select\n          performance_period_end\n        , \n\n    dateadd(\n        day,\n        1,\n        \n\n    dateadd(\n        year,\n        -1,\n        performance_period_end\n        )\n\n\n        )\n\n as performance_period_begin\n    from period_end\n\n)\n\nselect\n      cast((\n  select id\n  from tuva.quality_measures._value_set_measures\n  where id = 'ADH-RAS'\n) as TEXT) as measure_id\n    , cast((\n  select name\n  from tuva.quality_measures._value_set_measures\n  where id = 'ADH-RAS'\n) as TEXT) as measure_name\n    , cast((\n  select version\n  from tuva.quality_measures._value_set_measures\n  where id = 'ADH-RAS'\n) as TEXT) as measure_version\n    , cast(performance_period_begin as date) as performance_period_begin\n    , cast(performance_period_end as date) as performance_period_end\nfrom period_begin", "relation_name": "tuva.quality_measures._int_adhras__performance_period"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.341234Z", "completed_at": "2025-02-25T21:26:16.357978Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.358239Z", "completed_at": "2025-02-25T21:26:16.358244Z"}], "thread_id": "Thread-2", "execution_time": 0.0185849666595459, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.quality_measures__int_cqm130__performance_period", "compiled": true, "compiled_code": "/*\n    set performance period end to the end of the current calendar year\n    or use the quality_measures_period_end variable if provided\n*/\nwith period_end as (\n\n    select\n        cast(\n        \n\n    dateadd(\n        day,\n        -1,\n        \n\n    dateadd(\n        year,\n        1,\n        date_trunc('year', convert_timezone('UTC', current_timestamp()))\n        )\n\n\n        )\n\n\n        as date)\n        \n         as performance_period_end\n)\n\n/*\n    set performance period begin to following day of 1 year prior\n*/\n\n, period_begin as (\n\n    select\n          performance_period_end\n        , \n\n    dateadd(\n        day,\n        1,\n        \n\n    dateadd(\n        year,\n        -1,\n        performance_period_end\n        )\n\n\n        )\n\n as performance_period_begin\n    from period_end\n\n)\n\nselect\n      cast((select id\nfrom tuva.quality_measures._value_set_measures\nwhere id = 'CQM130') as TEXT) as measure_id\n    , cast((select name\nfrom tuva.quality_measures._value_set_measures\nwhere id = 'CQM130') as TEXT) as measure_name\n    , cast((select version\nfrom tuva.quality_measures._value_set_measures\nwhere id = 'CQM130') as TEXT) as measure_version\n    , cast(performance_period_begin as date) as performance_period_begin\n    , cast(performance_period_end as date) as performance_period_end\nfrom period_begin", "relation_name": "tuva.quality_measures._int_cqm130__performance_period"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.347254Z", "completed_at": "2025-02-25T21:26:16.358863Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.359531Z", "completed_at": "2025-02-25T21:26:16.359534Z"}], "thread_id": "Thread-1", "execution_time": 0.018815040588378906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.quality_measures__int_cqm438__performance_period", "compiled": true, "compiled_code": "/*\n    set performance period end to the end of the current calendar year\n    or use the quality_measures_period_end variable if provided\n*/\nwith period_end as (\n\n    select\n        cast(\n        \n\n    dateadd(\n        day,\n        -1,\n        \n\n    dateadd(\n        year,\n        1,\n        date_trunc('year', convert_timezone('UTC', current_timestamp()))\n        )\n\n\n        )\n\n\n        as date)\n        \n         as performance_period_end\n         \n)\n\n/*\n    set performance period begin to a year and a day prior\n    for a complete calendar year\n*/\n, period_begin as (\n\n    select\n          performance_period_end\n        , \n\n    dateadd(\n        day,\n        1,\n        \n\n    dateadd(\n        year,\n        -1,\n        performance_period_end\n        )\n\n\n        )\n\n as performance_period_begin\n    from period_end\n\n)\n\nselect\n      cast((select id\nfrom tuva.quality_measures._value_set_measures\nwhere id = 'CQM438') as TEXT) as measure_id\n    , cast((select name\nfrom tuva.quality_measures._value_set_measures\nwhere id = 'CQM438') as TEXT) as measure_name\n    , cast((select version\nfrom tuva.quality_measures._value_set_measures\nwhere id = 'CQM438') as TEXT) as measure_version\n    , cast(performance_period_begin as date) as performance_period_begin\n    , cast(performance_period_end as date) as performance_period_end\nfrom period_begin", "relation_name": "tuva.quality_measures._int_cqm438__performance_period"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.352794Z", "completed_at": "2025-02-25T21:26:16.359313Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.360060Z", "completed_at": "2025-02-25T21:26:16.360064Z"}], "thread_id": "Thread-3", "execution_time": 0.013139009475708008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.quality_measures__int_nqf0420__performance_period", "compiled": true, "compiled_code": "/*\n    set performance period end to the end of the current calendar year\n    or use the quality_measures_period_end variable if provided\n*/\nwith period_end as (\n\n    select\n        cast(\n        \n\n    dateadd(\n        day,\n        -1,\n        \n\n    dateadd(\n        year,\n        1,\n        date_trunc('year', convert_timezone('UTC', current_timestamp()))\n        )\n\n\n        )\n\n\n        as date)\n        \n         as performance_period_end\n         \n)\n\n/*\n    set performance period begin to following day of 1 year prior\n*/\n, period_begin as (\n\n    select\n          performance_period_end\n        , \n\n    dateadd(\n        day,\n        1,\n        \n\n    dateadd(\n        year,\n        -1,\n        performance_period_end\n        )\n\n\n        )\n\n as performance_period_begin\n    from period_end\n\n)\n\nselect\n      cast((select id\nfrom tuva.quality_measures._value_set_measures\nwhere id = 'NQF0420') as TEXT) as measure_id\n    , cast((select name\nfrom tuva.quality_measures._value_set_measures\nwhere id = 'NQF0420') as TEXT) as measure_name\n    , cast((select version\nfrom tuva.quality_measures._value_set_measures\nwhere id = 'NQF0420') as TEXT) as measure_version\n    , cast(performance_period_begin as date) as performance_period_begin\n    , cast(performance_period_end as date) as performance_period_end\nfrom period_begin", "relation_name": "tuva.quality_measures._int_nqf0420__performance_period"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.360665Z", "completed_at": "2025-02-25T21:26:16.371133Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.374400Z", "completed_at": "2025-02-25T21:26:16.374406Z"}], "thread_id": "Thread-2", "execution_time": 0.015366792678833008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.quality_measures__int_supd__performance_period", "compiled": true, "compiled_code": "/*\n    set performance period end to the end of the current calendar year\n    or use the quality_measures_period_end variable if provided\n*/\n\nwith period_end as (\n\n    select\n        cast(\n        \n\n    dateadd(\n        day,\n        -1,\n        \n\n    dateadd(\n        year,\n        1,\n        date_trunc('year', convert_timezone('UTC', current_timestamp()))\n        )\n\n\n        )\n\n\n        as date)\n        \n         as performance_period_end\n         \n)\n\n/*\n    set performance period begin to following day of 1 year prior\n*/\n, period_begin as (\n\n    select\n          performance_period_end\n        , \n\n    dateadd(\n        day,\n        1,\n        \n\n    dateadd(\n        year,\n        -1,\n        performance_period_end\n        )\n\n\n        )\n\n as performance_period_begin\n    from period_end\n\n)\n\nselect\n      cast((select id\nfrom tuva.quality_measures._value_set_measures\nwhere id = 'SUPD') as TEXT) as measure_id\n    , cast((select name\nfrom tuva.quality_measures._value_set_measures\nwhere id = 'SUPD') as TEXT) as measure_name\n    , cast((select version\nfrom tuva.quality_measures._value_set_measures\nwhere id = 'SUPD') as TEXT) as measure_version\n    , cast(performance_period_begin as date) as performance_period_begin\n    , cast(performance_period_end as date) as performance_period_end\nfrom period_begin", "relation_name": "tuva.quality_measures._int_supd__performance_period"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.367992Z", "completed_at": "2025-02-25T21:26:16.375103Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.375779Z", "completed_at": "2025-02-25T21:26:16.375783Z"}], "thread_id": "Thread-1", "execution_time": 0.008788347244262695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__condition_normalized_code_type", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(m.recorded_date,cast('1900-01-01' as date)) as source_date\n    , 'CONDITION' AS table_name\n    , 'Condition ID' as drill_down_key\n    , coalesce(condition_id, 'NULL') AS drill_down_value\n    , 'NORMALIZED_CODE_TYPE' AS field_name\n    , case when term.code_type is not null then 'valid'\n           when m.normalized_code_type is not null then 'invalid'\n           else 'null'\n    end as bucket_name\n    , case when m.normalized_code_type is not null and term.code_type is null\n           then 'Normalized Code Type does not join to Terminology code_type table'\n           else null end as invalid_reason\n    , cast(normalized_code_type as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.condition m\nleft join tuva.reference_data.code_type as term on m.normalized_code_type = term.code_type", "relation_name": "tuva.data_quality.condition_normalized_code_type"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.371326Z", "completed_at": "2025-02-25T21:26:16.375572Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.376353Z", "completed_at": "2025-02-25T21:26:16.376358Z"}], "thread_id": "Thread-3", "execution_time": 0.009170770645141602, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__encounter_primary_diagnosis_code_type", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(m.encounter_start_date,cast('1900-01-01' as date)) as source_date\n    , 'ENCOUNTER' AS table_name\n    , 'Encounter ID' as drill_down_key\n    , coalesce(encounter_id, 'NULL') AS drill_down_value\n    , 'PRIMARY_DIAGNOSIS_CODE_TYPE' AS field_name\n    , case when term.code_type is not null then 'valid'\n          when m.primary_diagnosis_code_type is not null then 'invalid'\n          else 'null'\n    end as bucket_name\n    , case when m.primary_diagnosis_code_type is not null and term.code_type is null\n          then 'Primary Diagnosis Code Type does not join to Terminology code_type table'\n          else null end as invalid_reason\n    , cast(primary_diagnosis_code_type as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.encounter m\nleft join tuva.reference_data.code_type term on m.primary_diagnosis_code_type = term.code_type", "relation_name": "tuva.data_quality.encounter_primary_diagnosis_code_type"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.377059Z", "completed_at": "2025-02-25T21:26:16.381305Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.388689Z", "completed_at": "2025-02-25T21:26:16.388695Z"}], "thread_id": "Thread-2", "execution_time": 0.01340794563293457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__lab_result_normalized_code_type", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.result_date,cast('1900-01-01' as date)) as source_date\n    , 'LAB_RESULT' AS table_name\n    , 'Lab Result ID' as drill_down_key\n    , coalesce(lab_result_id, 'NULL') AS drill_down_value\n    , 'NORMALIZED_CODE_TYPE' as field_name\n    , case when term.code_type is not null then 'valid'\n          when m.normalized_code_type is not null then 'invalid'\n          else 'null'\n    end as bucket_name\n    , case when m.normalized_code_type is not null and term.code_type is null\n           then 'Normalized code type does not join to Terminology code_type table'\n           else null end as invalid_reason\n    , cast(normalized_code_type as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.lab_result m\nleft join tuva.reference_data.code_type term on m.normalized_code_type = term.code_type", "relation_name": "tuva.data_quality.lab_result_normalized_code_type"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.381486Z", "completed_at": "2025-02-25T21:26:16.389937Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.393644Z", "completed_at": "2025-02-25T21:26:16.393650Z"}], "thread_id": "Thread-1", "execution_time": 0.013323068618774414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__procedure_normalized_code_type", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.procedure_date,cast('1900-01-01' as date)) as source_date\n    , 'PROCEDURE' AS table_name\n    , 'Procedure ID' as drill_down_key\n    , coalesce(procedure_id, 'NULL') AS drill_down_value\n    , 'NORMALIZED_CODE_TYPE' as field_name\n    , case when term.code_type is not null then 'valid'\n           when m.normalized_code_type is not null then 'invalid'\n           else 'null'\n    end as bucket_name\n    , case when m.normalized_code_type is not null and term.code_type is null\n           then 'Normalized code type does not join to Terminology code_type table'\n           else null end as invalid_reason\n    , cast(normalized_code_type as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.procedure m\nleft join tuva.reference_data.code_type term on m.normalized_code_type = term.code_type", "relation_name": "tuva.data_quality.procedure_normalized_code_type"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.384572Z", "completed_at": "2025-02-25T21:26:16.390139Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.394036Z", "completed_at": "2025-02-25T21:26:16.394039Z"}], "thread_id": "Thread-3", "execution_time": 0.013418912887573242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.mart_review__calendar_month", "compiled": true, "compiled_code": "\n\n\nselect distinct\ncast(year_month_int as TEXT) as year_month\n, full_date\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.reference_data.calendar c\nwhere day = 1", "relation_name": "tuva.data_quality.mart_review__calendar_month"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.390317Z", "completed_at": "2025-02-25T21:26:16.395218Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.395917Z", "completed_at": "2025-02-25T21:26:16.395921Z"}], "thread_id": "Thread-2", "execution_time": 0.006482362747192383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__encounter_admit_source_code", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(m.encounter_start_date,cast('1900-01-01' as date)) as source_date\n    , 'ENCOUNTER' AS table_name\n    , 'Encounter ID' as drill_down_key\n    , coalesce(encounter_id, 'NULL') AS drill_down_value\n    , 'ADMIT_SOURCE_CODE' AS field_name\n    , case when term.admit_source_code is not null then 'valid'\n           when m.admit_source_code is not null then 'invalid'\n           else 'null'\n    end as bucket_name\n    , case when m.admit_source_code is not null and term.admit_source_code is null\n           then 'Admit source code does not join to Terminology admit source table'\n           else null end as invalid_reason\n    , cast(m.admit_source_code as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.encounter m\nleft join tuva.terminology.admit_source term on m.admit_source_code = term.admit_source_code", "relation_name": "tuva.data_quality.encounter_admit_source_code"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.396483Z", "completed_at": "2025-02-25T21:26:16.403584Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.406878Z", "completed_at": "2025-02-25T21:26:16.406883Z"}], "thread_id": "Thread-1", "execution_time": 0.011960983276367188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__encounter_admit_type_code", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(m.encounter_start_date,cast('1900-01-01' as date)) as source_date\n    , 'ENCOUNTER' AS table_name\n    , 'Encounter ID' as drill_down_key\n    , coalesce(encounter_id, 'NULL') AS drill_down_value\n    , 'ADMIT_TYPE_CODE' AS field_name\n    , case when term.admit_type_code is not null then 'valid'\n          when m.admit_type_code is not null then 'invalid'\n          else 'null'\n    end as bucket_name\n    , case when m.admit_type_code is not null and term.admit_type_code is null\n          then 'Admit Type Code does not join to Terminology admit_type table'\n          else null end as invalid_reason\n    , cast(m.admit_type_code as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.encounter m\nleft join tuva.terminology.admit_type term on m.admit_type_code = term.admit_type_code", "relation_name": "tuva.data_quality.encounter_admit_type_code"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.399904Z", "completed_at": "2025-02-25T21:26:16.407250Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.407775Z", "completed_at": "2025-02-25T21:26:16.407779Z"}], "thread_id": "Thread-3", "execution_time": 0.012436151504516602, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__encounter_discharge_disposition_code", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(m.encounter_start_date,cast('1900-01-01' as date)) as source_date\n    , 'ENCOUNTER' AS table_name\n    , 'Encounter ID' as drill_down_key\n    , coalesce(encounter_id, 'NULL') AS drill_down_value\n    , 'DISCHARGE_DISPOSITION_CODE' AS field_name\n    , case when term.discharge_disposition_code is not null then 'valid'\n           when m.discharge_disposition_code is not null then 'invalid'\n           else 'null'\n    end as bucket_name\n    , case when m.discharge_disposition_code is not null and term.discharge_disposition_code is null\n           then 'Discharge Disposition Code does not join to Terminology discharge_disposition table'\n           else null end as invalid_reason\n    , cast(m.discharge_disposition_code as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.encounter m\nleft join tuva.terminology.discharge_disposition term on m.discharge_disposition_code = term.discharge_disposition_code", "relation_name": "tuva.data_quality.encounter_discharge_disposition_code"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.403807Z", "completed_at": "2025-02-25T21:26:16.408398Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.409067Z", "completed_at": "2025-02-25T21:26:16.409072Z"}], "thread_id": "Thread-2", "execution_time": 0.006051063537597656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__encounter_encounter_type", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(m.encounter_start_date,cast('1900-01-01' as date)) as source_date\n    , 'ENCOUNTER' AS table_name\n    , 'Encounter ID' as drill_down_key\n    , coalesce(encounter_id, 'NULL') AS drill_down_value\n    , 'ENCOUNTER_TYPE' AS field_name\n    , case when term.encounter_type is not null then 'valid'\n          when m.encounter_type is not null then 'invalid'\n          else 'null'\n    end as bucket_name\n    , case when m.encounter_type is not null and term.encounter_type is null\n          then 'Encounter type does not join to Terminology encounter_type table'\n          else null end as invalid_reason\n    , cast(m.encounter_type as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.encounter m\nleft join tuva.terminology.encounter_type term on m.encounter_type = term.encounter_type", "relation_name": "tuva.data_quality.encounter_encounter_type"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.409677Z", "completed_at": "2025-02-25T21:26:16.418647Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.421961Z", "completed_at": "2025-02-25T21:26:16.421968Z"}], "thread_id": "Thread-1", "execution_time": 0.013856172561645508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__patient_sex", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    \n        , cast(coalesce(convert_timezone('UTC', current_timestamp()), cast('1900-01-01' as date)) as date) as source_date\n    \n    , 'PATIENT' AS table_name\n    , 'Person ID' as drill_down_key\n    , coalesce(person_id, 'NULL') AS drill_down_value\n    , 'SEX' as field_name\n    , case when term.gender is not null then 'valid'\n           when m.sex is not null then 'invalid'\n           else 'null'\n    end as bucket_name\n    , case when m.sex is not null and term.gender is null\n           then 'Sex does not join to Terminology gender table'\n           else null end as invalid_reason\n    , cast(sex as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.patient m\nleft join tuva.terminology.gender term on m.sex = term.gender", "relation_name": "tuva.data_quality.patient_sex"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.415245Z", "completed_at": "2025-02-25T21:26:16.422401Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.422883Z", "completed_at": "2025-02-25T21:26:16.422887Z"}], "thread_id": "Thread-3", "execution_time": 0.013499975204467773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__procedure_modifier_1", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.procedure_date,cast('1900-01-01' as date)) as SOURCE_DATE\n    , 'PROCEDURE' AS table_name\n    , 'Procedure ID' as drill_down_key\n    , coalesce(procedure_id, 'NULL') AS drill_down_value\n    , 'MODIFIER_1' as field_name\n    , case when term.hcpcs is not null then 'valid'\n           when m.modifier_1 is not null then 'invalid'\n           else 'null'\n    end as bucket_name\n    , case when m.modifier_1 is not null and term.hcpcs is null\n           then 'Modifier 1 does not join to Terminology hcpcs_level_2 table'\n           else null end as invalid_reason\n    , cast(modifier_1 as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.procedure m\nleft join tuva.terminology.hcpcs_level_2 term on m.modifier_1 = term.hcpcs", "relation_name": "tuva.data_quality.procedure_modifier_1"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.418879Z", "completed_at": "2025-02-25T21:26:16.423452Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.424079Z", "completed_at": "2025-02-25T21:26:16.424082Z"}], "thread_id": "Thread-2", "execution_time": 0.009140968322753906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__procedure_modifier_2", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.procedure_date,cast('1900-01-01' as date)) as source_date\n    , 'PROCEDURE' AS table_name\n    , 'Procedure ID' as drill_down_key\n    , coalesce(procedure_id, 'NULL') AS drill_down_value\n    , 'MODIFIER_2' as field_name\n    , case when term.hcpcs is not null then 'valid'\n           when m.modifier_2 is not null then 'invalid'\n           else 'null'\n    end as bucket_name\n    , case when m.modifier_2 is not null and term.hcpcs is null\n           then 'Modifier 2 does not join to Terminology hcpcs_level_2 table'\n           else null end as invalid_reason\n    , cast(modifier_2 as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.procedure m\nleft join tuva.terminology.hcpcs_level_2 term on m.modifier_2 = term.hcpcs", "relation_name": "tuva.data_quality.procedure_modifier_2"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.424648Z", "completed_at": "2025-02-25T21:26:16.431965Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.435254Z", "completed_at": "2025-02-25T21:26:16.435260Z"}], "thread_id": "Thread-1", "execution_time": 0.012080907821655273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__procedure_modifier_3", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.procedure_date,cast('1900-01-01' as date)) as source_date\n    , 'PROCEDURE' AS table_name\n    , 'Procedure ID' as drill_down_key\n    , coalesce(procedure_id, 'NULL') AS drill_down_value\n    , 'MODIFIER_3' as field_name\n    , case when term.hcpcs is not null then 'valid'\n           when m.modifier_3 is not null then 'invalid'\n           else 'null'\n    end as bucket_name\n    , case when m.modifier_3 is not null and term.hcpcs is null\n           then 'Modifier 3 does not join to Terminology hcpcs_level_2 table'\n           else null end as invalid_reason\n    , cast(modifier_3 as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.procedure m\nleft join tuva.terminology.hcpcs_level_2 term on m.modifier_3 = term.hcpcs", "relation_name": "tuva.data_quality.procedure_modifier_3"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.428602Z", "completed_at": "2025-02-25T21:26:16.435914Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.436597Z", "completed_at": "2025-02-25T21:26:16.436600Z"}], "thread_id": "Thread-3", "execution_time": 0.012228012084960938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__procedure_modifier_4", "compiled": true, "compiled_code": "\n\n\nSELECT\n    m.data_source\n    ,coalesce(m.procedure_date,cast('1900-01-01' as date)) as source_date\n    ,'PROCEDURE' AS table_name\n    ,'Procedure ID' as drill_down_key\n    , coalesce(procedure_id, 'NULL') AS drill_down_value\n    ,'MODIFIER_4' as field_name\n    ,case when term.hcpcs is not null then 'valid'\n          when m.modifier_4 is not null then 'invalid'\n          else 'null'\n    end as bucket_name\n    ,case when m.modifier_4 is not null and term.hcpcs is null\n          then 'Modifier 4 does not join to Terminology hcpcs_level_2 table'\n    else null end as invalid_reason\n    ,cast(modifier_4 as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.procedure m\nleft join tuva.terminology.hcpcs_level_2 term on m.modifier_4 = term.hcpcs", "relation_name": "tuva.data_quality.procedure_modifier_4"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.432208Z", "completed_at": "2025-02-25T21:26:16.436397Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.437138Z", "completed_at": "2025-02-25T21:26:16.437142Z"}], "thread_id": "Thread-2", "execution_time": 0.008828163146972656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__procedure_modifier_5", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.procedure_date,cast('1900-01-01' as date)) as source_date\n    , 'PROCEDURE' AS table_name\n    , 'Procedure ID' as drill_down_key\n    , coalesce(procedure_id, 'NULL') AS drill_down_value\n    , 'MODIFIER_5' as field_name\n    , case when term.hcpcs is not null then 'valid'\n           when m.modifier_5 is not null then 'invalid'\n           else 'null'\n    end as bucket_name\n    , case when m.modifier_5 is not null and term.hcpcs is null\n           then 'Modifier 5 does not join to Terminology hcpcs_level_2 table'\n           else null end as invalid_reason\n    , cast(modifier_5 as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.procedure m\nleft join tuva.terminology.hcpcs_level_2 term on m.modifier_5 = term.hcpcs", "relation_name": "tuva.data_quality.procedure_modifier_5"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.437734Z", "completed_at": "2025-02-25T21:26:16.443162Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.452490Z", "completed_at": "2025-02-25T21:26:16.452496Z"}], "thread_id": "Thread-1", "execution_time": 0.016397953033447266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__condition_normalized_code", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(m.recorded_date,cast('1900-01-01' as date)) as source_date\n    , 'CONDITION' AS table_name\n    , 'Condition ID' as drill_down_key\n    , coalesce(condition_id, 'NULL') AS drill_down_value\n    , 'NORMALIZED_CODE' AS field_name\n    , case when term.icd_10_cm is not null then 'valid'\n          when m.normalized_code is not null then 'invalid'\n          else 'null'\n    end as bucket_name\n    , case when m.normalized_code is not null and term.icd_10_cm is null\n           then 'Normalized code does not join to Terminology icd_10_cm table'\n           else null end as invalid_reason\n    , cast(normalized_code as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.condition m\nleft join tuva.terminology.icd_10_cm term on m.normalized_code = term.icd_10_cm", "relation_name": "tuva.data_quality.condition_normalized_code"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.446498Z", "completed_at": "2025-02-25T21:26:16.453714Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.457265Z", "completed_at": "2025-02-25T21:26:16.457271Z"}], "thread_id": "Thread-2", "execution_time": 0.014802932739257812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__procedure_normalized_code", "compiled": true, "compiled_code": "\n\nwith icd9 as (\n    SELECT\n          m.data_source\n        , coalesce(m.procedure_date,cast('1900-01-01' as date)) as source_date\n        , 'PROCEDURE' AS table_name\n        , 'Procedure ID' as drill_down_key\n        , coalesce(procedure_id, 'NULL') AS drill_down_value\n        , 'NORMALIZED_CODE' as field_name\n        , case when term.icd_9_pcs is not null then 'valid'\n               when m.normalized_code is not null then 'invalid'\n               else 'null'\n        end as bucket_name\n        , case when m.normalized_code is not null and term.icd_9_pcs is null\n               then 'Normalized code does not join to Terminology icd_9_pcs table'\n               else null end as invalid_reason\n        , cast(normalized_code as TEXT) as field_value\n    from tuva.input_layer.procedure m\n    left join tuva.terminology.icd_9_pcs term on m.normalized_code = term.icd_9_pcs\n    where\n        m.normalized_code_type = 'icd-9-pcs'\n),\nicd10 as (\n    SELECT\n      m.data_source\n    , coalesce(m.procedure_date,cast('1900-01-01' as date)) as source_date\n    , 'PROCEDURE' AS table_name\n    , 'Procedure ID' as drill_down_key\n    , coalesce(procedure_id, 'NULL') AS drill_down_value\n    , 'NORMALIZED_CODE' as field_name\n    , case when term.icd_10_pcs is not null then 'valid'\n           when m.normalized_code is not null then 'invalid'\n           else 'null'\n    end as bucket_name\n    , case when m.normalized_code is not null and term.icd_10_pcs is null\n           then 'Normalized code does not join to Terminology icd_10_pcs table'\n           else null end as invalid_reason\n    , cast(normalized_code as TEXT) as field_value\nfrom tuva.input_layer.procedure m\nleft join tuva.terminology.icd_10_pcs term on m.normalized_code = term.icd_10_pcs\nwhere\n    m.normalized_code_type = 'icd_10_pcs'\n),\nhcpcs_level_2 as (\n    SELECT\n      m.data_source\n    , coalesce(m.procedure_date,cast('1900-01-01' as date)) as source_date\n    , 'PROCEDURE' AS table_name\n    , 'Procedure ID' as drill_down_key\n    , coalesce(procedure_id, 'NULL') AS drill_down_value\n    , 'NORMALIZED_CODE' as field_name\n    , case when term.hcpcs is not null then 'valid'\n           when m.normalized_code is not null then 'invalid'\n           else 'null'\n    end as bucket_name\n    , case when m.normalized_code is not null and term.hcpcs is null\n           then 'Normalized code does not join to Terminology hcpcs_level_2 table'\n           else null end as invalid_reason\n    , cast(normalized_code as TEXT) as field_value\nfrom tuva.input_layer.procedure m\nleft join tuva.terminology.hcpcs_level_2 term on m.normalized_code = term.hcpcs\nwhere\n    m.normalized_code_type = 'hcpcs_level_2'\n),\n\nothers as (\n    SELECT\n      m.data_source\n    , coalesce(m.procedure_date,cast('1900-01-01' as date)) as source_date\n    , 'PROCEDURE' AS table_name\n    , 'Procedure ID' as drill_down_key\n    , coalesce(procedure_id, 'NULL') AS drill_down_value\n    , 'NORMALIZED_CODE' as field_name\n    , 'null' as bucket_name\n    , 'code type does not have a matching code terminology table' as invalid_reason\n    , cast(normalized_code as TEXT) as field_value\nfrom tuva.input_layer.procedure m\nwhere\n    m.normalized_code_type not in ('icd-9-pcs', 'icd-10-pcs','hcpcs_level_2')\n)\n\nSELECT *, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run FROM icd9\n\nunion all\n\nSELECT * , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run FROM icd10\n\nunion all\n\nSELECT * , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run FROM hcpcs_level_2\n\nunion all\n\nSELECT * , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run FROM others", "relation_name": "tuva.data_quality.procedure_normalized_code"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.443354Z", "completed_at": "2025-02-25T21:26:16.457034Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.457942Z", "completed_at": "2025-02-25T21:26:16.457947Z"}], "thread_id": "Thread-3", "execution_time": 0.01576089859008789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__encounter_primary_diagnosis_code", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(m.encounter_start_date,cast('1900-01-01' as date)) as source_date\n    , 'ENCOUNTER' AS table_name\n    , 'Encounter ID' as drill_down_key\n    , coalesce(encounter_id, 'NULL') AS drill_down_value\n    , 'PRIMARY_DIAGNOSIS_CODE' AS field_name\n    , case when term.icd_10_cm is not null then 'valid'\n          when m.primary_diagnosis_code is not null then 'invalid'\n          else 'null'\n    end as bucket_name\n    , case when m.primary_diagnosis_code is not null and term.icd_10_cm is null\n          then 'Primary diagnosis code does not join to Terminology icd_10_cm table'\n    else null end as invalid_reason\n    , cast(primary_diagnosis_code as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.encounter m\nleft join tuva.terminology.icd_10_cm term on m.primary_diagnosis_code = term.icd_10_cm", "relation_name": "tuva.data_quality.encounter_primary_diagnosis_code"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.453906Z", "completed_at": "2025-02-25T21:26:16.459307Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.460924Z", "completed_at": "2025-02-25T21:26:16.460929Z"}], "thread_id": "Thread-1", "execution_time": 0.007704973220825195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__lab_result_normalized_code", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.result_date,cast('1900-01-01' as date)) as source_date\n    , 'LAB_RESULT' AS table_name\n    , 'Lab Result ID' as drill_down_key\n    , coalesce(lab_result_id, 'NULL') AS drill_down_value\n    , 'NORMALIZED_CODE' as field_name\n    , case when term.loinc is not null then 'valid'\n          when m.normalized_code is not null then 'invalid'\n          else 'null'\n    end as bucket_name\n    , case when m.normalized_code is not null and term.loinc is null\n           then 'Normalized code does not join to Terminology loinc table'\n           else null end as invalid_reason\n    , cast(normalized_code as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.lab_result m\nleft join tuva.terminology.loinc term on m.normalized_code = term.loinc", "relation_name": "tuva.data_quality.lab_result_normalized_code"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.462279Z", "completed_at": "2025-02-25T21:26:16.474421Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.474961Z", "completed_at": "2025-02-25T21:26:16.474967Z"}], "thread_id": "Thread-2", "execution_time": 0.014586210250854492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__lab_result_normalized_component", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.result_date,cast('1900-01-01' as date)) as source_date\n    , 'LAB_RESULT' AS table_name\n    , 'Lab Result ID' as drill_down_key\n    , coalesce(lab_result_id, 'NULL') AS drill_down_value\n    , 'NORMALIZED_COMPONENT' as field_name\n    , case when term.loinc is not null then 'valid'\n          when m.normalized_component is not null then 'invalid'\n          else 'null'\n    end as bucket_name\n    , case when m.normalized_component is not null and term.loinc is null\n           then 'Normalized component does not join to Terminology loinc table'\n           else null end as invalid_reason\n    , cast(normalized_component as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.lab_result m\nleft join tuva.terminology.loinc term on m.normalized_component = term.loinc", "relation_name": "tuva.data_quality.lab_result_normalized_component"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.465819Z", "completed_at": "2025-02-25T21:26:16.474656Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.475777Z", "completed_at": "2025-02-25T21:26:16.475781Z"}], "thread_id": "Thread-3", "execution_time": 0.01514434814453125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__encounter_drg_code", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(m.encounter_start_date,cast('1900-01-01' as date)) as source_date\n    , 'ENCOUNTER' AS table_name\n    , 'Encounter ID' as drill_down_key\n    , coalesce(encounter_id, 'NULL') AS drill_down_value\n    , 'DRG_CODE' AS field_name\n    , case when term.ms_drg_code is not null then 'valid'\n          when m.drg_code is not null then 'invalid'\n          else 'null'\n    end as bucket_name\n    , case when m.drg_code is not null and term.ms_drg_code is null\n          then 'DRG Code does not join to Terminology ms_drg table'\n          else null end as invalid_reason\n    , cast(m.drg_code as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.encounter m\nleft join tuva.terminology.ms_drg term on m.drg_code = term.ms_drg_code", "relation_name": "tuva.data_quality.encounter_drg_code"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.471087Z", "completed_at": "2025-02-25T21:26:16.475480Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.476466Z", "completed_at": "2025-02-25T21:26:16.476470Z"}], "thread_id": "Thread-1", "execution_time": 0.006102800369262695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__medication_ndc_description", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.dispensing_date,cast('1900-01-01' as date)) as source_date\n    , 'MEDICATION' AS table_name\n    , 'Medication ID' as drill_down_key\n    , coalesce(medication_id, 'NULL') AS drill_down_value\n    , 'NDC_DESCRIPTION' as field_name\n    , case when term.ndc is not null then 'valid'\n           when m.ndc_code is not null then 'invalid'\n           else 'null'\n    end as bucket_name\n    , case when m.ndc_code is not null and term.ndc is null\n           then 'NDC code type does not join to Terminology ndc table'\n           else null end as invalid_reason\n    , cast(substring(ndc_description, 1, 255) as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.medication m\nleft join tuva.terminology.ndc term on m.ndc_code = term.ndc", "relation_name": "tuva.data_quality.medication_ndc_description"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.478573Z", "completed_at": "2025-02-25T21:26:16.488445Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.488675Z", "completed_at": "2025-02-25T21:26:16.488681Z"}], "thread_id": "Thread-2", "execution_time": 0.011499881744384766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__condition_present_on_admit_code", "compiled": true, "compiled_code": "\n\nSELECT\n    m.data_source\n    ,coalesce(m.recorded_date,cast('1900-01-01' as date)) as source_date\n    ,'CONDITION' AS table_name\n    ,'Condition ID' as drill_down_key\n    , coalesce(condition_id, 'NULL') AS drill_down_value\n    ,'PRESENT_ON_ADMIT_CODE' AS field_name\n    ,case when term.present_on_admit_code is not null then 'valid'\n          when m.present_on_admit_code is not null then 'invalid'\n          else 'null'\n    end as bucket_name\n    ,case when m.present_on_admit_code is not null and term.present_on_admit_code is null\n          then 'Present On Admit Code does not join to Terminology present_on_admission table'\n          else null\n    end as invalid_reason\n    ,cast(m.present_on_admit_code as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.condition m\nleft join tuva.terminology.present_on_admission term on m.present_on_admit_code = term.present_on_admit_code", "relation_name": "tuva.data_quality.condition_present_on_admit_code"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.482175Z", "completed_at": "2025-02-25T21:26:16.494243Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.494719Z", "completed_at": "2025-02-25T21:26:16.494728Z"}], "thread_id": "Thread-3", "execution_time": 0.017071962356567383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__encounter_attending_provider_id", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(m.encounter_start_date,cast('1900-01-01' as date)) as source_date\n    , 'ENCOUNTER' AS table_name\n    , 'Encounter ID' as drill_down_key\n    , coalesce(encounter_id, 'NULL') AS drill_down_value\n    , 'ATTENDING_PROVIDER_ID' AS field_name\n    , case when term.npi is not null then 'valid'\n          when m.attending_provider_id is not null then 'invalid'\n          else 'null'\n    end as bucket_name\n    , case when m.attending_provider_id is not null and term.npi is null\n          then 'Attending provider ID does not join to Terminology provider table'\n          else null end as invalid_reason\n    , cast(attending_provider_id as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.encounter m\nleft join tuva.terminology.provider term on m.attending_provider_id = term.npi", "relation_name": "tuva.data_quality.encounter_attending_provider_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.485344Z", "completed_at": "2025-02-25T21:26:16.494463Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.495177Z", "completed_at": "2025-02-25T21:26:16.495180Z"}], "thread_id": "Thread-1", "execution_time": 0.01706981658935547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__encounter_facility_id", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(m.encounter_start_date,cast('1900-01-01' as date)) as source_date\n    , 'ENCOUNTER' AS table_name\n    , 'Encounter ID' as drill_down_key\n    , coalesce(encounter_id, 'NULL') AS drill_down_value\n    , 'FACILITY_ID' AS field_name\n    , case when term.npi is not null then 'valid'\n          when m.facility_id is not null then 'invalid'\n          else 'null'\n    end as bucket_name\n    , case when m.facility_id is not null and term.npi is null\n          then 'Facility NPI does not join to Terminology provider table'\n          else null end as invalid_reason\n    , cast(facility_id as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.encounter m\nleft join tuva.terminology.provider term on m.facility_id = term.npi", "relation_name": "tuva.data_quality.encounter_facility_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.489831Z", "completed_at": "2025-02-25T21:26:16.496087Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.496808Z", "completed_at": "2025-02-25T21:26:16.496812Z"}], "thread_id": "Thread-2", "execution_time": 0.0075109004974365234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__lab_result_ordering_practitioner_id", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.result_date,cast('1900-01-01' as date)) as source_date\n    , 'LAB_RESULT' AS table_name\n    , 'Lab Result ID' as drill_down_key\n    , coalesce(lab_result_id, 'NULL') AS drill_down_value\n    , 'ORDERING_PRACTITIONER_ID' as field_name\n    , case when term.npi is not null then 'valid'\n          when m.ordering_practitioner_id is not null then 'invalid'\n          else 'null'\n    end as bucket_name\n    , case when m.ordering_practitioner_id is not null and term.npi is null\n           then 'Ordering practitioner ID does not join to Terminology provider table'\n           else null end as invalid_reason\n    , cast(ordering_practitioner_id as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.lab_result m\nleft join tuva.terminology.provider term on m.ordering_practitioner_id = term.npi", "relation_name": "tuva.data_quality.lab_result_ordering_practitioner_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.497894Z", "completed_at": "2025-02-25T21:26:16.511499Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.511732Z", "completed_at": "2025-02-25T21:26:16.511739Z"}], "thread_id": "Thread-3", "execution_time": 0.015499114990234375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__location_npi", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    \n        , cast(coalesce(convert_timezone('UTC', current_timestamp()), cast('1900-01-01' as date)) as date) as source_date\n    \n    , 'LOCATION' AS table_name\n    , 'Location ID' as drill_down_key\n    , coalesce(location_id, 'NULL') AS drill_down_value\n    , 'NPI' as field_name\n    , case when term.npi is not null then 'valid'\n          when m.npi is not null then 'invalid'\n          else 'null'\n    end as bucket_name\n    , case when m.npi is not null and term.npi is null\n          then 'NPI does not join to Terminology provider table'\n    else null end as invalid_reason\n    , cast(m.npi as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.location m\nleft join tuva.terminology.provider term on m.npi = term.npi", "relation_name": "tuva.data_quality.location_npi"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.503059Z", "completed_at": "2025-02-25T21:26:16.512406Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.513040Z", "completed_at": "2025-02-25T21:26:16.513044Z"}], "thread_id": "Thread-1", "execution_time": 0.016527891159057617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__practitioner_npi", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    \n        , cast(coalesce(convert_timezone('UTC', current_timestamp()), cast('1900-01-01' as date)) as date) as source_date\n    \n    , 'PRACTITIONER' AS table_name\n    , 'Practitioner ID' as drill_down_key\n    , coalesce(practitioner_id, 'NULL') AS drill_down_value\n    , 'NPI' as field_name\n    , case when term.npi is not null then 'valid'\n           when m.npi is not null then 'invalid'\n           else 'null'\n    end as bucket_name\n    , case when m.npi is not null and term.npi is null\n           then 'NPI does not join to Terminology provider table'\n           else null end as invalid_reason\n    , cast(m.npi as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.practitioner m\nleft join tuva.terminology.provider term on m.npi = term.npi", "relation_name": "tuva.data_quality.practitioner_npi"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.507549Z", "completed_at": "2025-02-25T21:26:16.512857Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.513626Z", "completed_at": "2025-02-25T21:26:16.513630Z"}], "thread_id": "Thread-2", "execution_time": 0.006821870803833008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__patient_race", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    \n        , cast(coalesce(convert_timezone('UTC', current_timestamp()), cast('1900-01-01' as date)) as date) as source_date\n    \n    , 'PATIENT' AS table_name\n    , 'Person ID' as drill_down_key\n    , coalesce(person_id, 'NULL') AS drill_down_value\n    , 'RACE' as field_name\n    , case when term.description is not null then 'valid'\n           when m.race is not null then 'invalid'\n           else 'null'\n    end as bucket_name\n    , case when m.race is not null and term.description is null\n           then 'Race description does not join to Terminology race table'\n           else null end as invalid_reason\n    , cast(race as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.patient m\nleft join tuva.terminology.race term on m.race = term.description", "relation_name": "tuva.data_quality.patient_race"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.514225Z", "completed_at": "2025-02-25T21:26:16.519207Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.527369Z", "completed_at": "2025-02-25T21:26:16.527375Z"}], "thread_id": "Thread-3", "execution_time": 0.01483607292175293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__medication_atc_code", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.dispensing_date,cast('1900-01-01' as date)) as source_date\n    , 'MEDICATION' AS table_name\n    , 'Medication ID' as drill_down_key\n    , coalesce(medication_id, 'NULL') AS drill_down_value\n    , 'ATC_CODE' as field_name\n    , case when coalesce(term_1.atc_1_name,term_2.atc_2_name,term_3.atc_3_name,term_4.atc_4_name) is not null then 'valid'\n           when m.atc_code is not null then 'invalid'\n           else 'null'\n    end as bucket_name\n    , case when m.atc_code is not null and coalesce(term_1.atc_1_name,term_2.atc_2_name,term_3.atc_3_name,term_4.atc_4_name) is null\n           then 'ATC Code does not join to Terminology rxnorm_to_atc table on any atc level'\n           else null end as invalid_reason\n    , cast(atc_code as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.medication m\nleft join tuva.terminology.rxnorm_to_atc term_1 on m.atc_code = term_1.atc_1_name\nleft join tuva.terminology.rxnorm_to_atc term_2 on m.atc_code = term_2.atc_2_name\nleft join tuva.terminology.rxnorm_to_atc term_3 on m.atc_code = term_3.atc_3_name\nleft join tuva.terminology.rxnorm_to_atc term_4 on m.atc_code = term_4.atc_4_name", "relation_name": "tuva.data_quality.medication_atc_code"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.523609Z", "completed_at": "2025-02-25T21:26:16.528646Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.532740Z", "completed_at": "2025-02-25T21:26:16.532744Z"}], "thread_id": "Thread-2", "execution_time": 0.014334917068481445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__primary_keys_condition_condition_id", "compiled": true, "compiled_code": "\n\nWITH valid_conditions AS (\n    SELECT\n        *\n    FROM\n        tuva.data_quality.condition_condition_id\n    WHERE\n        bucket_name = 'valid'\n)\n, uniqueness_check as (\n        SELECT\n                field_value,\n                COUNT(*) AS duplicate_count\n        FROM\n                valid_conditions\n        GROUP BY\n                field_value\n        HAVING\n                COUNT(*) > 1\n)\n\n, random_sample AS (\n    SELECT\n        data_source,\n        source_date,\n        table_name,\n        drill_down_key,\n        drill_down_value,\n        field_name,\n        field_value,\n        bucket_name,\n        row_number() over (order by drill_down_key) as row_number_value\n    FROM\n        tuva.data_quality.condition_condition_id\n    WHERE\n        bucket_name = 'valid'\n\n)\n\n, duplicates_summary AS (\n    SELECT\n        a.data_source,\n        a.source_date,\n        a.table_name,\n        a.drill_down_key,\n        a.drill_down_value,\n        a.field_name,\n        a.field_value,\n        a.bucket_name,\n        b.duplicate_count,\n        row_number() over (order by drill_down_key) as row_number_value\n    FROM\n        tuva.data_quality.condition_condition_id a\n    inner JOIN\n        uniqueness_check b on a.field_value = b.field_value\n)\n\nSELECT\n    *\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nFROM\n    duplicates_summary\nwhere row_number_value <= 5\n\nunion all\n\nSELECT\n    *,\n    0 as duplicate_count\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nFROM\n    random_sample\nWHERE\n    row_number_value <= 5\n    and NOT EXISTS (SELECT 1 FROM duplicates_summary)", "relation_name": "tuva.data_quality.primary_keys_condition_condition_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.519388Z", "completed_at": "2025-02-25T21:26:16.532546Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.533162Z", "completed_at": "2025-02-25T21:26:16.533166Z"}], "thread_id": "Thread-1", "execution_time": 0.015044927597045898, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__medication_rxnorm_code", "compiled": true, "compiled_code": "\n\n\nSELECT\n      m.data_source\n    , coalesce(m.dispensing_date,cast('1900-01-01' as date)) as source_date\n    , 'MEDICATION' AS table_name\n    , 'Medication ID' as drill_down_key\n    , coalesce(medication_id, 'NULL') AS drill_down_value\n    , 'RXNORM_CODE' as field_name\n    , case when term.rxcui is not null then 'valid'\n           when m.rxnorm_code is not null then 'invalid'\n           else 'null'\n    end as bucket_name\n    , case when m.rxnorm_code is not null and term.rxcui is null\n           then 'RX norm code does not join to Terminology rxnorm_to_atc table'\n           else null end as invalid_reason\n    , cast(rxnorm_code as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.medication m\nleft join tuva.terminology.rxnorm_to_atc term on m.rxnorm_code = term.rxcui", "relation_name": "tuva.data_quality.medication_rxnorm_code"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.528845Z", "completed_at": "2025-02-25T21:26:16.534036Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.534752Z", "completed_at": "2025-02-25T21:26:16.534756Z"}], "thread_id": "Thread-3", "execution_time": 0.006616115570068359, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__primary_keys_location_location_id", "compiled": true, "compiled_code": "\n\nWITH valid_conditions AS (\n    SELECT\n        *\n    FROM\n        tuva.data_quality.location_location_id\n    WHERE\n        bucket_name = 'valid'\n)\n, uniqueness_check as (\n        SELECT\n                field_value,\n                COUNT(*) AS duplicate_count\n        FROM\n                valid_conditions\n        GROUP BY\n                field_value\n        HAVING\n                COUNT(*) > 1\n)\n\n, random_sample AS (\n    SELECT\n        data_source,\n        source_date,\n        table_name,\n        drill_down_key,\n        drill_down_value,\n        field_name,\n        field_value,\n        bucket_name,\n        row_number() over (order by drill_down_key) as row_number_value\n    FROM\n        tuva.data_quality.location_location_id\n    WHERE\n        bucket_name = 'valid'\n\n)\n\n, duplicates_summary AS (\n    SELECT\n        a.data_source,\n        a.source_date,\n        a.table_name,\n        a.drill_down_key,\n        a.drill_down_value,\n        a.field_name,\n        a.field_value,\n        a.bucket_name,\n        b.duplicate_count,\n        row_number() over (order by drill_down_key) as row_number_value\n    FROM\n        tuva.data_quality.location_location_id a\n    JOIN\n        uniqueness_check b on a.field_value = b.field_value\n)\n\nSELECT\n    *\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nFROM\n    duplicates_summary\nwhere row_number_value <= 5\n\nunion all\n\nSELECT\n    *,\n    0 as duplicate_count\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nFROM\n    random_sample\nWHERE\n    row_number_value <= 5\n    and NOT EXISTS (SELECT 1 FROM duplicates_summary)", "relation_name": "tuva.data_quality.primary_keys_location_location_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.535742Z", "completed_at": "2025-02-25T21:26:16.547596Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.548006Z", "completed_at": "2025-02-25T21:26:16.548011Z"}], "thread_id": "Thread-2", "execution_time": 0.013813257217407227, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__primary_keys_encounter_encounter_id", "compiled": true, "compiled_code": "\n\nWITH valid_conditions AS (\n    SELECT\n        *\n    FROM\n        tuva.data_quality.encounter_encounter_id\n    WHERE\n        bucket_name = 'valid'\n)\n, uniqueness_check as (\n        SELECT\n                field_value,\n                COUNT(*) AS duplicate_count\n        FROM\n                valid_conditions\n        GROUP BY\n                field_value\n        HAVING\n                COUNT(*) > 1\n)\n\n, random_sample AS (\n    SELECT\n        data_source,\n        source_date,\n        table_name,\n        drill_down_key,\n        drill_down_value,\n        field_name,\n        field_value,\n        bucket_name,\n        row_number() over (order by drill_down_key) as row_number_value\n    FROM\n        tuva.data_quality.encounter_encounter_id\n    WHERE\n        bucket_name = 'valid'\n\n)\n\n, duplicates_summary AS (\n    SELECT\n        a.data_source,\n        a.source_date,\n        a.table_name,\n        a.drill_down_key,\n        a.drill_down_value,\n        a.field_name,\n        a.field_value,\n        a.bucket_name,\n        b.duplicate_count,\n        row_number() over (order by drill_down_key) as row_number_value\n    FROM\n        tuva.data_quality.encounter_encounter_id a\n    JOIN\n        uniqueness_check b on a.field_value = b.field_value\n)\n\nSELECT\n    *\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nFROM\n    duplicates_summary\nwhere row_number_value <= 5\n\nunion all\n\nSELECT\n    *,\n    0 as duplicate_count\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nFROM\n    random_sample\nWHERE\n    row_number_value <= 5\n    and NOT EXISTS (SELECT 1 FROM duplicates_summary)", "relation_name": "tuva.data_quality.primary_keys_encounter_encounter_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.539518Z", "completed_at": "2025-02-25T21:26:16.547807Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.548422Z", "completed_at": "2025-02-25T21:26:16.548425Z"}], "thread_id": "Thread-1", "execution_time": 0.013947010040283203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.core__lab_result", "compiled": true, "compiled_code": "\n\n\n\n\nselect\n      labs.lab_result_id\n    , labs.person_id\n    , labs.patient_id\n    , labs.encounter_id\n    , labs.accession_number\n    , labs.source_code_type\n    , labs.source_code\n    , labs.source_description\n    , labs.source_component\n    , case\n        when labs.normalized_code_type is not null then labs.normalized_code_type\n        when loinc.loinc is not null then 'loinc'\n        when snomed_ct.snomed_ct is not null then 'snomed-ct'\n        else null end as normalized_code_type\n    , coalesce(\n        labs.normalized_code\n        , loinc.loinc\n        , snomed_ct.snomed_ct\n        ) as normalized_code\n    , coalesce(\n        labs.normalized_description\n        , loinc.long_common_name\n        , snomed_ct.description\n        ) normalized_description\n    , case when coalesce(labs.normalized_code, labs.normalized_description) is not null then 'manual'\n         when coalesce(loinc.loinc,snomed_ct.snomed_ct) is not null then 'automatic'\n         end as mapping_method\n    , labs.normalized_component\n    , labs.status\n    , labs.result\n    , labs.result_date\n    , labs.collection_date\n    , labs.source_units\n    , labs.normalized_units\n    , labs.source_reference_range_low\n    , labs.source_reference_range_high\n    , labs.normalized_reference_range_low\n    , labs.normalized_reference_range_high\n    , labs.source_abnormal_flag\n    , labs.normalized_abnormal_flag\n    , labs.specimen\n    , labs.ordering_practitioner_id\n    , labs.data_source\n    , labs.tuva_last_run\nFrom tuva.core._stg_clinical_lab_result as labs\nleft join tuva.terminology.loinc loinc\n    on labs.source_code_type = 'loinc'\n        and labs.source_code = loinc.loinc\nleft join tuva.terminology.snomed_ct snomed_ct\n    on labs.source_code_type = 'snomed-ct'\n        and labs.source_code = snomed_ct.snomed_ct\n\n ", "relation_name": "tuva.core.lab_result"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.543876Z", "completed_at": "2025-02-25T21:26:16.548777Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.549494Z", "completed_at": "2025-02-25T21:26:16.549497Z"}], "thread_id": "Thread-3", "execution_time": 0.0062520503997802734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__primary_keys_lab_result_lab_result_id", "compiled": true, "compiled_code": "\n\nWITH valid_conditions AS (\n    SELECT\n        *\n    FROM\n        tuva.data_quality.lab_result_lab_result_id\n    WHERE\n        bucket_name = 'valid'\n)\n, uniqueness_check as (\n        SELECT\n                field_value,\n                COUNT(*) AS duplicate_count\n        FROM\n                valid_conditions\n        GROUP BY\n                field_value\n        HAVING\n                COUNT(*) > 1\n)\n\n, random_sample AS (\n    SELECT\n        data_source,\n        source_date,\n        table_name,\n        drill_down_key,\n        drill_down_value,\n        field_name,\n        field_value,\n        bucket_name,\n        row_number() over (order by drill_down_key) as row_number_value\n    FROM\n        tuva.data_quality.lab_result_lab_result_id\n    WHERE\n        bucket_name = 'valid'\n)\n\n, duplicates_summary AS (\n    SELECT\n        a.data_source,\n        a.source_date,\n        a.table_name,\n        a.drill_down_key,\n        a.drill_down_value,\n        a.field_name,\n        a.field_value,\n        a.bucket_name,\n        b.duplicate_count,\n        row_number() over (order by drill_down_key) as row_number_value\n    FROM\n        tuva.data_quality.lab_result_lab_result_id a\n    JOIN\n        uniqueness_check b on a.field_value = b.field_value\n)\n\nSELECT\n    *\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nFROM\n    duplicates_summary\nwhere row_number_value <= 5\n\nunion all\n\nSELECT\n    *,\n    0 as duplicate_count\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nFROM\n    random_sample\nWHERE\n    row_number_value <= 5\n    and NOT EXISTS (SELECT 1 FROM duplicates_summary)", "relation_name": "tuva.data_quality.primary_keys_lab_result_lab_result_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.551177Z", "completed_at": "2025-02-25T21:26:16.565795Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.566021Z", "completed_at": "2025-02-25T21:26:16.566028Z"}], "thread_id": "Thread-2", "execution_time": 0.016215085983276367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.core__medication", "compiled": true, "compiled_code": "\n\n\nwith source_mapping as (\n\n    select\n     meds.medication_id\n   , meds.person_id\n   , meds.patient_id\n   , meds.encounter_id\n   , meds.dispensing_date\n   , meds.prescribing_date\n   , meds.source_code_type\n   , meds.source_code\n   , meds.source_description\n   , coalesce(\n       meds.ndc_code\n       , ndc.ndc\n       ) as ndc_code\n   ,  coalesce(\n       meds.ndc_description\n       , ndc.fda_description\n       , ndc.rxnorm_description\n       ) as ndc_description\n   , case\n        when meds.ndc_code is not null then 'manual'\n        when ndc.ndc is not null then 'automatic'\n        end as ndc_mapping_method\n   , coalesce(\n        meds.rxnorm_code\n        , rxatc.rxcui\n        ) as rxnorm_code\n   , coalesce(\n       meds.rxnorm_description\n       , rxatc.rxnorm_description\n       ) as rxnorm_description\n   , case\n        when meds.rxnorm_code is not null then 'manual'\n        when rxatc.rxcui is not null then 'automatic'\n        end as rxnorm_mapping_method\n   , coalesce(\n        meds.atc_code\n        , rxatc.atc_3_code\n        ) as atc_code\n   , coalesce(\n        meds.atc_description\n        , rxatc.atc_4_name\n        ) as atc_description\n   , case\n        when meds.atc_code is not null then 'manual'\n        when rxatc.atc_3_name is not null then 'automatic'\n        end as atc_mapping_method\n   , meds.route\n   , meds.strength\n   , meds.quantity\n   , meds.quantity_unit\n   , meds.days_supply\n   , meds.practitioner_id\n   , meds.data_source\n   , meds.tuva_last_run\nfrom tuva.core._stg_clinical_medication meds\n    left join tuva.terminology.ndc ndc\n        on meds.source_code_type = 'ndc'\n        and meds.source_code = ndc.ndc\n    left join tuva.terminology.rxnorm_to_atc rxatc\n        on meds.source_code_type = 'rxnorm'\n        and meds.source_code = rxatc.rxcui\n\n\n\n   )\n\n\n-- add auto rxnorm + atc\nselect\n     sm.medication_id\n   , sm.person_id\n   , sm.encounter_id\n   , sm.dispensing_date\n   , sm.prescribing_date\n   , sm.source_code_type\n   , sm.source_code\n   , sm.source_description\n   , sm.ndc_code\n   , sm.ndc_description\n   , sm.ndc_mapping_method\n   , coalesce(\n        sm.rxnorm_code\n        , ndc.rxcui\n        ) as rxnorm_code\n   , coalesce(\n        sm.rxnorm_description\n        , ndc.rxnorm_description\n        ) as rxnorm_description\n   , case\n        when sm.rxnorm_mapping_method is not null then sm.rxnorm_mapping_method\n        when ndc.rxcui is not null then 'automatic'\n        end as rxnorm_mapping_method\n   , coalesce(\n        sm.atc_code\n        , rxatc.atc_3_code\n        ) as atc_code\n   , coalesce(\n        sm.atc_description\n        , rxatc.atc_3_name\n        ) as atc_description\n   , case\n        when sm.atc_mapping_method is not null then sm.atc_mapping_method\n        when rxatc.atc_3_name is not null then 'automatic'\n        end as atc_mapping_method\n   , sm.route\n   , sm.strength\n   , sm.quantity\n   , sm.quantity_unit\n   , sm.days_supply\n   , sm.practitioner_id\n   , sm.data_source\n   , sm.tuva_last_run\nfrom source_mapping sm\n    left join tuva.terminology.ndc ndc\n        on sm.ndc_code = ndc.ndc\n    left join tuva.terminology.rxnorm_to_atc rxatc\n        on coalesce( sm.rxnorm_code, ndc.rxcui ) = rxatc.rxcui", "relation_name": "tuva.core.medication"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.560780Z", "completed_at": "2025-02-25T21:26:16.570927Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.571443Z", "completed_at": "2025-02-25T21:26:16.571448Z"}], "thread_id": "Thread-3", "execution_time": 0.020550012588500977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.core__observation", "compiled": true, "compiled_code": "\n\n\nselect\n      obs.observation_id\n    , obs.person_id\n    , obs.patient_id\n    , obs.encounter_id\n    , obs.panel_id\n    , obs.observation_date\n    , obs.observation_type\n    , obs.source_code_type\n    , obs.source_code\n    , obs.source_description\n    , case\n        when obs.normalized_code_type is not null then obs.normalized_code_type\n        when icd10cm.icd_10_cm is not null then 'icd-10-cm'\n        when icd9cm.icd_9_cm is not null then 'icd-9-cm'\n        when icd10pcs.icd_10_pcs is not null then 'icd-10-pcs'\n        when icd9pcs.icd_9_pcs is not null then 'icd-10-pcs'\n        when hcpcs.hcpcs is not null then 'hcpcs'\n        when snomed_ct.snomed_ct is not null then 'snomed-ct'\n        when loinc.loinc is not null then 'loinc'\n        end as normalized_code_type\n  , coalesce(\n        obs.normalized_code\n      , icd10cm.icd_10_cm\n      , icd9cm.icd_9_cm\n      , icd10pcs.icd_10_pcs\n      , icd9pcs.icd_9_pcs\n      , hcpcs.hcpcs\n      , snomed_ct.snomed_ct\n      , loinc.loinc\n      ) as normalized_code\n      , coalesce(\n        obs.normalized_description\n      , icd10cm.short_description\n      , icd9cm.short_description\n      , icd10pcs.description\n      , icd9pcs.short_description\n      , hcpcs.short_description\n      , snomed_ct.description\n      , loinc.long_common_name\n      ) as normalized_description\n     , case\n         when coalesce(obs.normalized_code, obs.normalized_description) is not null then 'manual'\n         when coalesce(\n            icd10cm.icd_10_cm\n          , icd9cm.icd_9_cm\n          , icd10pcs.icd_10_pcs\n          , icd9pcs.icd_9_pcs\n          , hcpcs.hcpcs\n          , snomed_ct.snomed_ct\n          , loinc.loinc) is not null then 'automatic'\n         end as mapping_method\n    , obs.result\n    , obs.source_units\n    , obs.normalized_units\n    , obs.source_reference_range_low\n    , obs.source_reference_range_high\n    , obs.normalized_reference_range_low\n    , obs.normalized_reference_range_high\n    , obs.data_source\n    , obs.tuva_last_run\nfrom tuva.core._stg_clinical_observation obs\nleft join tuva.terminology.icd_10_cm icd10cm\n    on obs.source_code_type = 'icd-10-cm'\n        and replace(obs.source_code,'.','') = icd10cm.icd_10_cm\nleft join tuva.terminology.icd_9_cm icd9cm\n    on obs.source_code_type = 'icd-9-cm'\n        and replace(obs.source_code,'.','') = icd9cm.icd_9_cm\nleft join tuva.terminology.icd_10_pcs icd10pcs\n    on obs.source_code_type = 'icd-10-pcs'\n        and obs.source_code = icd10pcs.icd_10_pcs\nleft join tuva.terminology.icd_9_pcs icd9pcs\n    on obs.source_code_type = 'icd-9-pcs'\n        and replace(obs.source_code,'.','') = icd9pcs.icd_9_pcs\nleft join tuva.terminology.hcpcs_level_2 hcpcs\n    on obs.source_code_type = 'hcpcs'\n        and obs.source_code = hcpcs.hcpcs\nleft join tuva.terminology.snomed_ct snomed_ct\n    on obs.source_code_type = 'snomed-ct'\n        and obs.source_code = snomed_ct.snomed_ct\nleft join tuva.terminology.loinc loinc\n    on obs.source_code_type = 'loinc'\n        and obs.source_code = loinc.loinc\n\n", "relation_name": "tuva.core.observation"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.556746Z", "completed_at": "2025-02-25T21:26:16.571143Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.571826Z", "completed_at": "2025-02-25T21:26:16.571829Z"}], "thread_id": "Thread-1", "execution_time": 0.021752119064331055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__primary_keys_medication_medication_id", "compiled": true, "compiled_code": "\n\nWITH valid_conditions AS (\n    SELECT\n        *\n    FROM\n        tuva.data_quality.medication_medication_id\n    WHERE\n        bucket_name = 'valid'\n)\n, uniqueness_check as (\n        SELECT\n                field_value,\n                COUNT(*) AS duplicate_count\n        FROM\n                valid_conditions\n        GROUP BY\n                field_value\n        HAVING\n                COUNT(*) > 1\n)\n\n, random_sample AS (\n    SELECT\n        data_source,\n        source_date,\n        table_name,\n        drill_down_key,\n        drill_down_value,\n        field_name,\n        field_value,\n        bucket_name,\n        row_number() over (order by drill_down_key) as row_number_value\n    FROM\n        tuva.data_quality.medication_medication_id\n    WHERE\n        bucket_name = 'valid'\n)\n\n, duplicates_summary AS (\n    SELECT\n        a.data_source,\n        a.source_date,\n        a.table_name,\n        a.drill_down_key,\n        a.drill_down_value,\n        a.field_name,\n        a.field_value,\n        a.bucket_name,\n        b.duplicate_count,\n        row_number() over (order by drill_down_key) as row_number_value\n    FROM\n        tuva.data_quality.medication_medication_id a\n    JOIN\n        uniqueness_check b on a.field_value = b.field_value\n)\n\nSELECT\n    *\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nFROM\n    duplicates_summary\nwhere row_number_value <= 5\n\nunion all\n\nSELECT\n    *,\n    0 as duplicate_count\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nFROM\n    random_sample\nWHERE\n    row_number_value <= 5\n    and NOT EXISTS (SELECT 1 FROM duplicates_summary)", "relation_name": "tuva.data_quality.primary_keys_medication_medication_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.567081Z", "completed_at": "2025-02-25T21:26:16.572167Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.572938Z", "completed_at": "2025-02-25T21:26:16.572941Z"}], "thread_id": "Thread-2", "execution_time": 0.0063211917877197266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__primary_keys_observation_observation_id", "compiled": true, "compiled_code": "\n\nWITH valid_conditions AS (\n    SELECT\n        *\n    FROM\n        tuva.data_quality.observation_observation_id\n    WHERE\n        bucket_name = 'valid'\n)\n, uniqueness_check as (\n        SELECT\n                field_value,\n                COUNT(*) AS duplicate_count\n        FROM\n                valid_conditions\n        GROUP BY\n                field_value\n        HAVING\n                COUNT(*) > 1\n)\n\n, random_sample AS (\n    SELECT\n        data_source,\n        source_date,\n        table_name,\n        drill_down_key,\n        drill_down_value,\n        field_name,\n        field_value,\n        bucket_name,\n        row_number() over (order by drill_down_key) as row_number_value\n    FROM\n        tuva.data_quality.observation_observation_id\n    WHERE\n        bucket_name = 'valid'\n)\n\n, duplicates_summary AS (\n    SELECT\n        a.data_source,\n        a.source_date,\n        a.table_name,\n        a.drill_down_key,\n        a.drill_down_value,\n        a.field_name,\n        a.field_value,\n        a.bucket_name,\n        b.duplicate_count,\n        row_number() over (order by drill_down_key) as row_number_value\n    FROM\n        tuva.data_quality.observation_observation_id a\n    JOIN\n        uniqueness_check b on a.field_value = b.field_value\n)\n\nSELECT\n    *\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nFROM\n    duplicates_summary\nwhere row_number_value <= 5\n\nunion all\n\nSELECT\n    *,\n    0 as duplicate_count\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nFROM\n    random_sample\nWHERE\n    row_number_value <= 5\n    and NOT EXISTS (SELECT 1 FROM duplicates_summary)", "relation_name": "tuva.data_quality.primary_keys_observation_observation_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.578556Z", "completed_at": "2025-02-25T21:26:16.587644Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.587872Z", "completed_at": "2025-02-25T21:26:16.587878Z"}], "thread_id": "Thread-1", "execution_time": 0.01445317268371582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__primary_keys_patient_patient_id", "compiled": true, "compiled_code": "\n\nWITH valid_conditions AS (\n    SELECT\n        *\n    FROM\n        tuva.data_quality.patient_patient_id\n    WHERE\n        bucket_name = 'valid'\n)\n, uniqueness_check as (\n        SELECT\n                field_value,\n                COUNT(*) AS duplicate_count\n        FROM\n                valid_conditions\n        GROUP BY\n                field_value\n        HAVING\n                COUNT(*) > 1\n)\n\n, random_sample AS (\n    SELECT\n        data_source,\n        source_date,\n        table_name,\n        drill_down_key,\n        drill_down_value,\n        field_name,\n        field_value,\n        bucket_name,\n        row_number() over (order by drill_down_key) as row_number_value\n    FROM\n        tuva.data_quality.patient_patient_id\n    WHERE\n        bucket_name = 'valid'\n\n)\n\n, duplicates_summary AS (\n    SELECT\n        a.data_source,\n        a.source_date,\n        a.table_name,\n        a.drill_down_key,\n        a.drill_down_value,\n        a.field_name,\n        a.field_value,\n        a.bucket_name,\n        b.duplicate_count,\n        row_number() over (order by drill_down_key) as row_number_value\n    FROM\n        tuva.data_quality.patient_patient_id a\n    JOIN\n        uniqueness_check b on a.field_value = b.field_value\n)\n\nSELECT\n    *\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nFROM\n    duplicates_summary\nwhere row_number_value <= 5\n\nunion all\n\nSELECT\n    *,\n    0 as duplicate_count\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nFROM\n    random_sample\nWHERE\n    row_number_value <= 5\n    and NOT EXISTS (SELECT 1 FROM duplicates_summary)", "relation_name": "tuva.data_quality.primary_keys_patient_patient_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.583738Z", "completed_at": "2025-02-25T21:26:16.589890Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.594992Z", "completed_at": "2025-02-25T21:26:16.595001Z"}], "thread_id": "Thread-2", "execution_time": 0.020570993423461914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__primary_keys_procedure_procedure_id", "compiled": true, "compiled_code": "\n\nWITH valid_conditions AS (\n    SELECT\n        *\n    FROM\n        tuva.data_quality.procedure_procedure_id\n    WHERE\n        bucket_name = 'valid'\n)\n, uniqueness_check as (\n        SELECT\n                field_value,\n                COUNT(*) AS duplicate_count\n        FROM\n                valid_conditions\n        GROUP BY\n                field_value\n        HAVING\n                COUNT(*) > 1\n)\n\n, random_sample AS (\n    SELECT\n        data_source,\n        source_date,\n        table_name,\n        drill_down_key,\n        drill_down_value,\n        field_name,\n        field_value,\n        bucket_name,\n        row_number() over (order by drill_down_key) as row_number_value\n    FROM\n        tuva.data_quality.procedure_procedure_id\n    WHERE\n        bucket_name = 'valid'\n)\n\n, duplicates_summary AS (\n    SELECT\n        a.data_source,\n        a.source_date,\n        a.table_name,\n        a.drill_down_key,\n        a.drill_down_value,\n        a.field_name,\n        a.field_value,\n        a.bucket_name,\n        b.duplicate_count,\n        row_number() over (order by drill_down_key) as row_number_value\n    FROM\n        tuva.data_quality.procedure_procedure_id a\n    JOIN\n        uniqueness_check b on a.field_value = b.field_value\n)\n\nSELECT\n    *\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nFROM\n    duplicates_summary\nwhere row_number_value <= 5\n\nunion all\n\nSELECT\n    *,\n    0 as duplicate_count\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nFROM\n    random_sample\nWHERE\n    row_number_value <= 5\n    and NOT EXISTS (SELECT 1 FROM duplicates_summary)", "relation_name": "tuva.data_quality.primary_keys_procedure_procedure_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.574742Z", "completed_at": "2025-02-25T21:26:16.595419Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.596253Z", "completed_at": "2025-02-25T21:26:16.596257Z"}], "thread_id": "Thread-3", "execution_time": 0.023061037063598633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__primary_keys_practitioner_practitioner_id", "compiled": true, "compiled_code": "\n\nWITH valid_conditions AS (\n    SELECT\n        *\n    FROM\n        tuva.data_quality.practitioner_practitioner_id\n    WHERE\n        bucket_name = 'valid'\n)\n, uniqueness_check as (\n        SELECT\n                field_value,\n                COUNT(*) AS duplicate_count\n        FROM\n                valid_conditions\n        GROUP BY\n                field_value\n        HAVING\n                COUNT(*) > 1\n)\n\n, random_sample AS (\n    SELECT\n        data_source,\n        source_date,\n        table_name,\n        drill_down_key,\n        drill_down_value,\n        field_name,\n        field_value,\n        bucket_name,\n        row_number() over (order by drill_down_key) as row_number_value\n    FROM\n        tuva.data_quality.practitioner_practitioner_id\n    WHERE\n        bucket_name = 'valid'\n)\n\n, duplicates_summary AS (\n    SELECT\n        a.data_source,\n        a.source_date,\n        a.table_name,\n        a.drill_down_key,\n        a.drill_down_value,\n        a.field_name,\n        a.field_value,\n        a.bucket_name,\n        b.duplicate_count,\n        row_number() over (order by drill_down_key) as row_number_value\n    FROM\n        tuva.data_quality.practitioner_practitioner_id a\n    JOIN\n        uniqueness_check b on a.field_value = b.field_value\n)\n\nSELECT\n    *\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nFROM\n    duplicates_summary\nwhere row_number_value <= 5\n\nunion all\n\nSELECT\n    *,\n    0 as duplicate_count\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nFROM\n    random_sample\nWHERE\n    row_number_value <= 5\n    and NOT EXISTS (SELECT 1 FROM duplicates_summary)", "relation_name": "tuva.data_quality.primary_keys_practitioner_practitioner_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.590080Z", "completed_at": "2025-02-25T21:26:16.596738Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.598363Z", "completed_at": "2025-02-25T21:26:16.598368Z"}], "thread_id": "Thread-1", "execution_time": 0.009881734848022461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__eligibility_address", "compiled": true, "compiled_code": "\n\nSELECT DISTINCT \n    m.data_source\n    ,coalesce(cast(m.enrollment_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'eligibility' as table_name\n    ,'Member ID | Enrollment Start Date' AS drill_down_key\n    ,coalesce(m.member_id, 'NULL') as drill_down_value\n    ,'ELIGIBILITY' AS claim_type\n    ,'ADDRESS' AS field_name\n    ,case when m.address is  null then 'null'\n                             else 'valid' end as bucket_name\n    ,cast(null as TEXT) as invalid_reason\n    ,CAST(address as TEXT) AS field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nFROM tuva.input_layer.eligibility m", "relation_name": "tuva.data_quality.eligibility_address"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.599551Z", "completed_at": "2025-02-25T21:26:16.615996Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.616294Z", "completed_at": "2025-02-25T21:26:16.616301Z"}], "thread_id": "Thread-2", "execution_time": 0.01930093765258789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__eligibility_birth_date", "compiled": true, "compiled_code": "\n\nWITH base as (\n    SELECT * \n    FROM tuva.input_layer.eligibility\n\n),\nunique_field as (\n    SELECT DISTINCT member_id\n        ,cast(birth_date as TEXT) as field\n        ,data_source\n    FROM base\n),\nclaim_grain as (\n    SELECT member_id\n        ,data_source\n        ,count(*) as frequency\n    from unique_field\n    GROUP BY member_id\n        ,data_source\n),\nclaim_agg as (\nSELECT\n    member_id,\n    data_source,\n    \n    listagg(\n        coalesce(field, 'null'),\n        ', '\n        )\n        within group (order by field desc) AS field_aggregated\nFROM\n    unique_field\nGROUP BY\n    data_source,\n    member_id\n)\nSELECT DISTINCT\n    m.data_source\n    ,coalesce(cast(m.enrollment_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'ELIGIBILITY' AS table_name\n    ,'Member ID' AS drill_down_key\n    ,coalesce(m.member_id, 'NULL') as drill_down_value\n    ,'ELIGIBILITY' AS claim_type\n    ,'BIRTH_DATE' AS field_name\n    ,CASE \n        WHEN cg.frequency > 1 THEN 'multiple'\n        WHEN m.birth_date > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) THEN 'invalid'\n        WHEN m.birth_date <= cast('1901-01-01' as date) THEN 'invalid'\n        WHEN m.birth_date IS NULL THEN 'null'\n        ELSE 'valid' \n    END AS bucket_name\n    ,CASE \n        WHEN cg.frequency > 1 THEN 'multiple'\n        WHEN m.birth_date > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) THEN 'future'\n        WHEN m.birth_date <= cast('1901-01-01' as date) THEN 'too old'\n        else null\n    END AS invalid_reason\n,CAST(\n  substr(agg.field_aggregated, 1, 255)\n as TEXT) AS field_value\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nFROM base m\nleft join claim_grain cg on m.member_id = cg.member_id and m.data_source = cg.data_source\nleft join claim_agg agg on m.member_id = agg.member_id and m.data_source = agg.data_source", "relation_name": "tuva.data_quality.eligibility_birth_date"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.611041Z", "completed_at": "2025-02-25T21:26:16.617531Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.626145Z", "completed_at": "2025-02-25T21:26:16.626154Z"}], "thread_id": "Thread-1", "execution_time": 0.02022409439086914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__eligibility_data_source", "compiled": true, "compiled_code": "\n\nSELECT DISTINCT -- to bring to claim_ID grain \n    m.data_source\n    ,coalesce(cast(m.enrollment_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'ELIGIBILITY' AS table_name\n    ,'Member ID | Enrollment Start Date' AS drill_down_key\n        ,coalesce(m.member_id, 'NULL') as drill_down_value\n    ,'ELIGIBILITY' AS claim_type\n    ,'DATA_SOURCE' AS field_name\n    ,case when m.data_source is not null then 'valid' else 'null' end as bucket_name\n    ,cast(null as TEXT) as invalid_reason\n    ,cast(data_source as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nFROM tuva.input_layer.eligibility m", "relation_name": "tuva.data_quality.eligibility_data_source"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.606504Z", "completed_at": "2025-02-25T21:26:16.623784Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.626636Z", "completed_at": "2025-02-25T21:26:16.626641Z"}], "thread_id": "Thread-3", "execution_time": 0.027682781219482422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__eligibility_city", "compiled": true, "compiled_code": "\n\nSELECT DISTINCT \n    m.data_source\n    ,coalesce(cast(m.enrollment_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'ELIGIBILITY' AS table_name\n    ,'Member ID | Enrollment Start Date' AS drill_down_key\n        ,coalesce(m.member_id, 'NULL') as drill_down_value\n    ,'ELIGIBILITY' AS claim_type\n    ,'CITY' AS field_name\n    ,case when m.race is  null then 'null'\n                             else 'valid' end as bucket_name\n    ,cast(null as TEXT) as invalid_reason\n    ,CAST(city as TEXT) AS field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nFROM tuva.input_layer.eligibility m", "relation_name": "tuva.data_quality.eligibility_city"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.617748Z", "completed_at": "2025-02-25T21:26:16.627993Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.628629Z", "completed_at": "2025-02-25T21:26:16.628633Z"}], "thread_id": "Thread-2", "execution_time": 0.011711835861206055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__eligibility_date_checks", "compiled": true, "compiled_code": "\n\nwith eligibility_spans as(\n    select distinct\n        member_id || '-' || enrollment_start_date || '-' || enrollment_end_date || '-' || payer || '-' || plan as eligibility_span_id\n        , enrollment_start_date\n        , enrollment_end_date\n    from tuva.input_layer.eligibility\n)\n\n, missing_start_date as (\n    select\n        'Missing enrollment_start_date' as data_quality_check,\n        count(*) as result_count\n    from eligibility_spans\n    where enrollment_start_date is null\n),\n\nmissing_end_date as (\n    select\n        'Missing enrollment_end_date' as data_quality_check,\n        count(*) as result_count\n    from eligibility_spans\n    where enrollment_end_date is null\n),\n\ninvalid_start_date as (\n    select\n        'Enrollment_start_date populated with something other than a date' as data_quality_check,\n        count(*) as result_count\n    from eligibility_spans\n    where enrollment_start_date is not null\n    and not try_cast( enrollment_start_date as date ) is not null\n),\n\ninvalid_end_date as (\n    select\n        'Enrollment_end_date populated with something other than a date' as data_quality_check,\n        count(*) as result_count\n    from eligibility_spans\n    where enrollment_end_date is not null\n    and not try_cast( enrollment_end_date as date ) is not null\n),\n\nstart_after_end as (\n    select\n        'Enrollment_start_date after enrollment_end_date' as data_quality_check,\n        count(*) as result_count\n    from eligibility_spans\n    where enrollment_start_date > enrollment_end_date\n),\n\nfuture_end_date as (\n    select\n        'Future enrollment_end_date' as data_quality_check,\n        count(*) as result_count\n    from eligibility_spans\n    \n        where enrollment_end_date > current_date\n    \n\n),\n\nnonsensical_dates as (\n    select\n        'Nonsensical dates' as data_quality_check,\n        count(*) as result_count\n    from eligibility_spans\n    where enrollment_start_date < '1900-01-01'\n    or enrollment_end_date < '1900-01-01'\n    or enrollment_start_date > '2100-01-01'\n)\n\nselect *, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run from missing_start_date\nunion all\nselect *, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run from missing_end_date\nunion all\nselect *, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run from invalid_start_date\nunion all\nselect *, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run from invalid_end_date\nunion all\nselect *, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run from start_after_end\nunion all\nselect *, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run from future_end_date\nunion all\nselect *, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run from nonsensical_dates", "relation_name": "tuva.data_quality.eligibility_date_checks"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.629209Z", "completed_at": "2025-02-25T21:26:16.649534Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.649803Z", "completed_at": "2025-02-25T21:26:16.649812Z"}], "thread_id": "Thread-1", "execution_time": 0.022166967391967773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__eligibility_death_date", "compiled": true, "compiled_code": "\n\nWITH base as (\n    SELECT * \n    FROM tuva.input_layer.eligibility\n\n),\nunique_field as (\n    select distinct member_id\n        ,cast(death_date as TEXT) as field\n        ,data_source\n    from base\n),\nclaim_grain as (\n    select member_id\n        ,data_source\n        ,count(*) as frequency\n    from unique_field\n    group by member_id\n        ,data_source\n),\nclaim_agg as (\nselect\n    member_id,\n    data_source,\n    \n    listagg(\n        coalesce(field, 'null'),\n        ', '\n        )\n        within group (order by field desc) as field_aggregated\nfrom\n    unique_field\ngroup by\n    data_source,\n    member_id\n)\nselect distinct\n    m.data_source\n    ,coalesce(cast(m.enrollment_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'ELIGIBILITY' AS table_name\n    ,'Member ID' AS drill_down_key\n    ,coalesce(m.member_id, 'NULL') as drill_down_value\n    ,'ELIGIBILITY' AS claim_type\n    ,'DEATH_DATE' AS field_name\n    ,case\n        when cg.frequency > 1 then 'multiple'\n        when m.death_date > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'invalid'\n        when m.death_date <= cast('1901-01-01' as date) then 'invalid'\n        when m.death_date <= m.birth_date then 'invalid'\n        when m.death_date is null then 'null'\n        else 'valid'\n    end as bucket_name\n    ,case\n        when cg.frequency > 1 then 'multiple'\n        when m.death_date > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'future'\n        when m.death_date <= cast('1901-01-01' as date) then 'too old'\n        when m.death_date <= m.birth_date then 'death date before birth date'\n        else null\n    end as invalid_reason\n    ,cast(\n  substr(agg.field_aggregated, 1, 255)\n as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom base m\nleft join claim_grain cg on m.member_id = cg.member_id and m.data_source = cg.data_source\nleft join claim_agg agg on m.member_id = agg.member_id and m.data_source = agg.data_source", "relation_name": "tuva.data_quality.eligibility_death_date"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.635476Z", "completed_at": "2025-02-25T21:26:16.650514Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.651008Z", "completed_at": "2025-02-25T21:26:16.651012Z"}], "thread_id": "Thread-3", "execution_time": 0.0228879451751709, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__eligibility_death_flag", "compiled": true, "compiled_code": "\n\nSELECT DISTINCT\n    m.data_source\n    ,coalesce(cast(m.enrollment_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'ELIGIBILITY' AS table_name\n    ,'Member ID' AS drill_down_key\n    ,coalesce(m.member_id, 'NULL') as drill_down_value\n    ,'ELIGIBILITY' AS claim_type\n    ,'DEATH_FLAG' AS field_name\n    ,case\n        when cast(m.death_flag as TEXT) in ('1','0') then 'valid'\n        when m.death_flag is null then 'null'\n        else 'invalid'\n        end as bucket_name\n    ,cast(null as TEXT) as invalid_reason\n    ,cast(death_flag as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.eligibility m", "relation_name": "tuva.data_quality.eligibility_death_flag"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.639899Z", "completed_at": "2025-02-25T21:26:16.655733Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.656284Z", "completed_at": "2025-02-25T21:26:16.656290Z"}], "thread_id": "Thread-2", "execution_time": 0.017040014266967773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__eligibility_demographics", "compiled": true, "compiled_code": "\n\n\nwith eligibility_spans as(\n    select distinct\n        member_id || '-' || enrollment_start_date || '-' || enrollment_end_date || '-' || payer || '-' || plan as eligibility_span_id\n        , person_id\n        , birth_date\n        , gender\n    from tuva.input_layer.eligibility\n)\n\n, missing_birth_date as(\n    select\n    'Missing birthday' as data_quality_check\n    , count(distinct eligibility_span_id) as result_count\n    from eligibility_spans\n    where birth_date is null\n)\n, invalid_birth_date as(\n    select\n    'Birthday is not a valid date' as data_quality_check\n    , count(distinct eligibility_span_id) as result_count\n    from eligibility_spans e\n    left join tuva.reference_data.calendar c\n        on e.birth_date = c.full_date\n    where c.full_date is null\n)\n, future_birth_date as(\n    select\n    'Birthday is in the future' as data_quality_check\n    , count(distinct eligibility_span_id) as result_count\n    from eligibility_spans\n    \n        where birth_date > current_date\n    \n)\n, past_birth_date as(\n    select\n    'Birthday is too far in the past' as data_quality_check\n    , count(distinct eligibility_span_id) as result_count\n    from eligibility_spans\n    \n        where cast(floor(datediff(\n        hour,\n        birth_date,\n        current_date\n        ) / 8760.0) as integer ) > 110\n    \n\n)\n, multiple_birth_date as(\n    select\n    'Patient has multiple birthdays' as data_quality_check\n    , count(distinct person_id) as result_count\n    from(\n        select\n            person_id\n            , birth_date\n            , rank() over (partition by person_id, birth_date order by birth_date) as rank_birth_date\n        from eligibility_spans e\n        where birth_date is not null\n    )x\nwhere rank_birth_date > 1\n)\n, missing_gender as(\n    select\n    'Missing gender' as data_quality_check\n    , count(distinct eligibility_span_id) as result_count\n    from eligibility_spans\n    where birth_date is null\n)\n, invalid_gender as(\n    select\n    'Patient gender does not join to terminology table' as data_quality_check\n    , count(distinct eligibility_span_id) as result_count\n    from eligibility_spans\n    where birth_date is null\n)\n\nselect *, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run from missing_birth_date\nunion all\nselect *, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run from invalid_birth_date\nunion all\nselect *, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run from future_birth_date\nunion all\nselect *, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run from past_birth_date\nunion all\nselect *, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run from multiple_birth_date\nunion all\nselect *, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run from missing_gender\nunion all\nselect *, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run from invalid_gender", "relation_name": "tuva.data_quality.eligibility_demographics"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.651889Z", "completed_at": "2025-02-25T21:26:16.661228Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.661798Z", "completed_at": "2025-02-25T21:26:16.661804Z"}], "thread_id": "Thread-1", "execution_time": 0.011115074157714844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__eligibility_dq_stage", "compiled": true, "compiled_code": "\n\nwith month_start_and_end_dates as (\n  select\n      year_month_int as year_month\n    , min(full_date) as month_start_date\n    , max(full_date) as month_end_date\n  from tuva.reference_data.calendar\n  group by year_month_int\n)\n\nselect distinct\n    a.person_id\n  , b.year_month\n  , b.month_start_date\n  , b.month_end_date\n  , a.payer\n  , a.plan\n  , data_source\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.eligibility a\ninner join month_start_and_end_dates b\n  on a.enrollment_start_date <= b.month_end_date\n  and a.enrollment_end_date >= b.month_start_date", "relation_name": "tuva.data_quality.data_quality__eligibility_dq_stage"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.657235Z", "completed_at": "2025-02-25T21:26:16.662766Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.667147Z", "completed_at": "2025-02-25T21:26:16.667154Z"}], "thread_id": "Thread-3", "execution_time": 0.011252880096435547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__eligibility_dual_status_code", "compiled": true, "compiled_code": "\n\nSELECT DISTINCT\n    m.data_source\n    ,coalesce(cast(m.enrollment_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'ELIGIBILITY' AS table_name\n    ,'Member ID | Enrollment Start Date' AS drill_down_key\n        ,coalesce(m.member_id, 'NULL') as drill_down_value\n    ,'ELIGIBILITY' AS claim_type\n    ,'DUAL_STATUS_CODE' AS field_name\n    ,case when m.dual_status_code is null then 'null'\n          when term.dual_status_code is null then 'invalid'\n                             else 'valid' end as bucket_name\n    ,case\n        when m.dual_status_code is not null and term.dual_status_code is null then 'Dual Status Code does not join to Terminology Medicare Dual Eligibility table'\n        else null\n    end as invalid_reason\n    , m.dual_status_code || '|' || coalesce(term.dual_status_description,'') as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.eligibility m\nleft join tuva.terminology.medicare_dual_eligibility term on m.dual_status_code = term.dual_status_code", "relation_name": "tuva.data_quality.eligibility_dual_status_code"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.662994Z", "completed_at": "2025-02-25T21:26:16.672091Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.672539Z", "completed_at": "2025-02-25T21:26:16.672544Z"}], "thread_id": "Thread-2", "execution_time": 0.011132001876831055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__eligibility_end_date", "compiled": true, "compiled_code": "\n\nSELECT DISTINCT\n    m.data_source\n    ,coalesce(cast(m.enrollment_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'ELIGIBILITY' AS table_name\n    ,'Member ID' AS drill_down_key\n    ,coalesce(m.member_id,'NULL') AS drill_down_value\n    ,'ELIGIBILITY' AS claim_type\n    ,'ENROLLMENT_END_DATE' AS field_name\n    ,case\n        when m.enrollment_end_date <= cast('1901-01-01' as date) then 'invalid'\n        when m.enrollment_end_date < m.enrollment_start_date then 'invalid'\n        when m.enrollment_end_date is null then 'null'\n        else 'valid'\n    end as bucket_name\n    ,case\n\n        when m.enrollment_end_date <= cast('1901-01-01' as date) then 'too old'\n        when m.enrollment_end_date < m.enrollment_start_date then 'end date before start date'\n        else null\n    end as invalid_reason\n    ,cast(enrollment_end_date as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.eligibility m", "relation_name": "tuva.data_quality.eligibility_end_date"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.668132Z", "completed_at": "2025-02-25T21:26:16.672939Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.678154Z", "completed_at": "2025-02-25T21:26:16.678160Z"}], "thread_id": "Thread-1", "execution_time": 0.01137995719909668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__eligibility_first_name", "compiled": true, "compiled_code": "\n\nSELECT DISTINCT \n    m.data_source\n    ,coalesce(cast(m.enrollment_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'ELIGIBILITY' AS table_name\n    ,'Member ID | Enrollment Start Date' AS drill_down_key\n    ,coalesce(m.member_id, 'NULL') as drill_down_value\n    ,'ELIGIBILITY' AS claim_type\n    ,'FIRST_NAME' AS field_name\n    ,case when m.first_name is null then 'null'\n                             else 'valid' end as bucket_name\n    ,cast(null as TEXT) as invalid_reason\n    ,cast(first_name as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.eligibility m", "relation_name": "tuva.data_quality.eligibility_first_name"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.673144Z", "completed_at": "2025-02-25T21:26:16.679328Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.683255Z", "completed_at": "2025-02-25T21:26:16.683260Z"}], "thread_id": "Thread-3", "execution_time": 0.01147913932800293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__eligibility_gender", "compiled": true, "compiled_code": "\n\nSELECT DISTINCT \n    m.data_source\n    ,coalesce(cast(m.enrollment_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'ELIGIBILITY' AS table_name\n    ,'Member ID | Enrollment Start Date' AS drill_down_key\n    ,coalesce(m.member_id, 'NULL') as drill_down_value\n    ,'ELIGIBILITY' AS claim_type\n    ,'GENDER' AS field_name\n    ,case when m.gender is  null then 'null'\n          when term.gender is null then 'invalid'\n                             else 'valid' end as bucket_name\n    ,case\n        when m.gender is not null and term.gender is null then 'Gender does not join to Terminology Gender table'\n        else null\n    end as invalid_reason\n    ,cast(m.gender as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.eligibility m\nleft join tuva.terminology.gender term on m.gender = term.gender", "relation_name": "tuva.data_quality.eligibility_gender"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.679740Z", "completed_at": "2025-02-25T21:26:16.688000Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.688454Z", "completed_at": "2025-02-25T21:26:16.688459Z"}], "thread_id": "Thread-2", "execution_time": 0.009914875030517578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__eligibility_last_name", "compiled": true, "compiled_code": "\n\nSELECT DISTINCT \n    m.data_source\n    ,coalesce(cast(m.enrollment_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'ELIGIBILITY' AS table_name\n    ,'Member ID | Enrollment Start Date' AS drill_down_key\n    ,coalesce(m.member_id, 'NULL') as drill_down_value\n    ,'ELIGIBILITY' AS claim_type\n    ,'LAST_NAME' AS field_name\n    ,case when m.last_name is null then 'null'\n                             else 'valid' end as bucket_name\n    ,cast(null as TEXT) as invalid_reason\n    ,cast(last_name as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.eligibility m", "relation_name": "tuva.data_quality.eligibility_last_name"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.684134Z", "completed_at": "2025-02-25T21:26:16.692235Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.692746Z", "completed_at": "2025-02-25T21:26:16.692750Z"}], "thread_id": "Thread-1", "execution_time": 0.013297796249389648, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__eligibility_medicare_status_code", "compiled": true, "compiled_code": "\n\nSELECT DISTINCT \n    m.data_source\n    ,coalesce(cast(m.enrollment_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'ELIGIBILITY' AS table_name\n    ,'Member ID | Enrollment Start Date' AS drill_down_key\n    ,coalesce(m.member_id, 'NULL') as drill_down_value\n    ,'ELIGIBILITY' AS claim_type\n    ,'MEDICARE_STATUS_CODE' AS field_name\n    ,case when m.medicare_status_code is null then 'null'\n          when term.medicare_status_code is null then 'invalid'\n                             else 'valid' end as bucket_name\n    ,case\n        when m.medicare_status_code is not null and term.medicare_status_code is null then 'Medicare Status Code does not join to Terminology Medicare Status table'\n        else null\n    end as invalid_reason\n    , m.medicare_status_code || '|' || coalesce(term.medicare_status_description,'') as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.eligibility m\nleft join tuva.terminology.medicare_status term on m.medicare_status_code = term.medicare_status_code", "relation_name": "tuva.data_quality.eligibility_medicare_status_code"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.688840Z", "completed_at": "2025-02-25T21:26:16.693586Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.694191Z", "completed_at": "2025-02-25T21:26:16.694194Z"}], "thread_id": "Thread-3", "execution_time": 0.006476640701293945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__eligibility_member_id", "compiled": true, "compiled_code": "\n\nSELECT DISTINCT -- to bring to claim_ID grain \n    m.data_source\n    ,coalesce(cast(m.enrollment_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'ELIGIBILITY' AS table_name\n    ,'Member ID | Enrollment Start Date' AS drill_down_key\n    ,coalesce(m.member_id, 'NULL') as drill_down_value\n    ,'ELIGIBILITY' AS claim_type\n    ,'MEMBER_ID' AS field_name\n    ,case when m.member_id is not null then 'valid' else 'null' end as bucket_name\n    ,cast(null as TEXT) as invalid_reason\n    ,cast(member_id as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.eligibility m", "relation_name": "tuva.data_quality.eligibility_member_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.694528Z", "completed_at": "2025-02-25T21:26:16.704588Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.705007Z", "completed_at": "2025-02-25T21:26:16.705013Z"}], "thread_id": "Thread-2", "execution_time": 0.011948823928833008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__eligibility_missing_payer", "compiled": true, "compiled_code": "\n\nwith eligibility_spans as(\n    select distinct\n        member_id || '-' || enrollment_start_date || '-' || enrollment_end_date || '-' || payer || '-' || plan as eligibility_span_id\n        , payer\n        , payer_type\n    from tuva.input_layer.eligibility\n)\n\n, missing_payer_type as(\n    select\n        'Missing payer type' as data_quality_check\n        , count(distinct eligibility_span_id) as result_count\n    from eligibility_spans\n    where payer_type is null\n)\n, missing_payer_name as(\n    select\n        'Missing payer name' as data_quality_check\n        , count(distinct eligibility_span_id) as result_count\n    from eligibility_spans\n    where payer is null\n)\n, invalid_payer_type as(\n    select\n        'Payer type does not join to terminology table' as data_quality_check\n        , count(distinct eligibility_span_id) as result_count\n    from eligibility_spans e\n    left join tuva.terminology.payer_type pt\n        on e.payer_type = pt.payer_type\n    where pt.payer_type is null\n)\n\nselect * , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run from missing_payer_type\nunion all\nselect * , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run from missing_payer_name\nunion all\nselect * , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run from invalid_payer_type", "relation_name": "tuva.data_quality.eligibility_missing_payer"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.699869Z", "completed_at": "2025-02-25T21:26:16.709142Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.709682Z", "completed_at": "2025-02-25T21:26:16.709687Z"}], "thread_id": "Thread-1", "execution_time": 0.015777111053466797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__eligibility_missing_person_id", "compiled": true, "compiled_code": "\n\n\nwith eligibility_spans as(\n    select distinct\n        member_id || '-' || enrollment_start_date || '-' || enrollment_end_date || '-' || payer || '-' || plan as eligibility_span_id\n        , person_id\n    from tuva.input_layer.eligibility\n)\n\nselect\n    'Missing person_id' as data_quality_check\n    ,count(*) as result_count\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom eligibility_spans\nwhere\n    person_id is null or person_id = ''", "relation_name": "tuva.data_quality.eligibility_missing_person_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.705378Z", "completed_at": "2025-02-25T21:26:16.710264Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.714231Z", "completed_at": "2025-02-25T21:26:16.714235Z"}], "thread_id": "Thread-3", "execution_time": 0.010035037994384766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__eligibility_original_reason_entitlement_code", "compiled": true, "compiled_code": "\n\nSELECT DISTINCT \n    m.data_source\n    ,coalesce(cast(m.enrollment_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'ELIGIBILITY' AS table_name\n    ,'Member ID | Enrollment Start Date' AS drill_down_key\n    ,coalesce(m.member_id, 'NULL') as drill_down_value\n    ,'ELIGIBILITY' AS claim_type\n    ,'ORIGINAL_REASON_ENTITLEMENT_CODE' AS field_name\n    ,case when m.original_reason_entitlement_code is null then 'null'\n          when term.original_reason_entitlement_code is null then 'invalid'\n                             else 'valid' end as bucket_name\n    ,case\n        when m.original_reason_entitlement_code is not null and term.original_reason_entitlement_code is null then 'Original Reason Entitlement Code does not join to Terminology Original Reason Entitlement Code table'\n        else null\n    end as invalid_reason\n    , m.original_reason_entitlement_code || '|' || coalesce(term.original_reason_entitlement_description,'') as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.eligibility m\nleft join tuva.terminology.medicare_orec term on m.original_reason_entitlement_code = term.original_reason_entitlement_code", "relation_name": "tuva.data_quality.eligibility_original_reason_entitlement_code"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.710718Z", "completed_at": "2025-02-25T21:26:16.715574Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.719398Z", "completed_at": "2025-02-25T21:26:16.719403Z"}], "thread_id": "Thread-2", "execution_time": 0.010026931762695312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__eligibility_payer", "compiled": true, "compiled_code": "\n\nSELECT DISTINCT\n    m.data_source\n    ,coalesce(cast(m.enrollment_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'ELIGIBILITY' AS table_name\n    ,'Member ID | Enrollment Start Date' AS drill_down_key\n    ,coalesce(m.member_id, 'NULL') as drill_down_value\n    ,'ELIGIBILITY' AS claim_type\n    ,'PAYER' AS field_name\n    ,case when m.payer is not null then 'valid' else 'null' end as bucket_name\n    ,cast(null as TEXT) as invalid_reason\n    ,cast(payer as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.eligibility m", "relation_name": "tuva.data_quality.eligibility_payer"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.715758Z", "completed_at": "2025-02-25T21:26:16.723456Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.723891Z", "completed_at": "2025-02-25T21:26:16.723896Z"}], "thread_id": "Thread-1", "execution_time": 0.009341955184936523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__eligibility_payer_type", "compiled": true, "compiled_code": "\n\nSELECT DISTINCT \n    m.data_source\n    ,coalesce(cast(m.enrollment_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'ELIGIBILITY' AS table_name\n    ,'Member ID | Enrollment Start Date' AS drill_down_key\n    ,coalesce(m.member_id, 'NULL') as drill_down_value\n    ,'ELIGIBILITY' AS claim_type\n    ,'PAYER_TYPE' AS field_name\n    ,case when m.payer_type is  null then 'null'\n          when term.payer_type is null then 'invalid'\n                             else 'valid' end as bucket_name\n    ,case\n        when m.payer_type is not null and term.payer_type is null then 'Payer Type does not join to Terminology Payer Type table'\n        else null\n    end as invalid_reason\n    ,cast(m.payer_type as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.eligibility m\nleft join tuva.terminology.payer_type term on m.payer_type = term.payer_type", "relation_name": "tuva.data_quality.eligibility_payer_type"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.719799Z", "completed_at": "2025-02-25T21:26:16.724680Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.729590Z", "completed_at": "2025-02-25T21:26:16.729595Z"}], "thread_id": "Thread-3", "execution_time": 0.01428675651550293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__eligibility_person_id", "compiled": true, "compiled_code": "\n\nSELECT DISTINCT\n    m.data_source\n    ,coalesce(cast(m.enrollment_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'ELIGIBILITY' AS table_name\n    ,'Member ID | Enrollment Start Date' AS drill_down_key\n    ,coalesce(m.member_id, 'NULL') as drill_down_value\n    ,'ELIGIBILITY' AS claim_type\n    ,'PERSON_ID' AS field_name\n    ,case when m.person_id is not null then 'valid' else 'null' end as bucket_name\n    ,cast(null as TEXT) as invalid_reason\n    ,cast(person_id as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.eligibility m", "relation_name": "tuva.data_quality.eligibility_person_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.724877Z", "completed_at": "2025-02-25T21:26:16.734109Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.734594Z", "completed_at": "2025-02-25T21:26:16.734599Z"}], "thread_id": "Thread-2", "execution_time": 0.010996818542480469, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__eligibility_phone", "compiled": true, "compiled_code": "\n\nSELECT DISTINCT \n    m.data_source\n    ,coalesce(cast(m.enrollment_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'ELIGIBILITY' AS table_name\n    ,'Member ID | Enrollment Start Date' AS drill_down_key\n    ,coalesce(m.member_id, 'NULL') as drill_down_value\n    ,'ELIGIBILITY' AS claim_type\n    ,'PHONE' AS field_name\n    ,case when m.phone is null then 'null'\n                             else 'valid' end as bucket_name\n    ,cast(null as TEXT) as invalid_reason\n    ,cast(phone as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.eligibility m", "relation_name": "tuva.data_quality.eligibility_phone"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.730493Z", "completed_at": "2025-02-25T21:26:16.735422Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.739386Z", "completed_at": "2025-02-25T21:26:16.739390Z"}], "thread_id": "Thread-1", "execution_time": 0.010096073150634766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__eligibility_plan", "compiled": true, "compiled_code": "\n\nSELECT DISTINCT\n    m.data_source\n    ,coalesce(cast(m.enrollment_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'ELIGIBILITY' AS table_name\n    ,'Member ID | Enrollment Start Date' AS drill_down_key\n    ,coalesce(m.member_id, 'NULL') as drill_down_value\n    ,'ELIGIBILITY' AS claim_type\n    ,'PLAN' AS field_name\n    ,case when m.plan is not null then 'valid' else 'null' end as bucket_name\n    ,cast(null as TEXT) as invalid_reason\n    ,cast(m.plan as TEXT) as field_value\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.eligibility m", "relation_name": "tuva.data_quality.eligibility_plan"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.735664Z", "completed_at": "2025-02-25T21:26:16.744688Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.745447Z", "completed_at": "2025-02-25T21:26:16.745453Z"}], "thread_id": "Thread-3", "execution_time": 0.011195898056030273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__eligibility_race", "compiled": true, "compiled_code": "\n\nSELECT DISTINCT -- to bring to claim_ID grain \n    m.data_source\n    ,coalesce(cast(m.enrollment_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'ELIGIBILITY' AS table_name\n    ,'Member ID | Enrollment Start Date' AS drill_down_key\n    ,coalesce(m.member_id, 'NULL') as drill_down_value\n    ,'ELIGIBILITY' AS claim_type\n    ,'RACE' AS field_name\n    ,case when m.race is  null then 'null'\n          when r.description is  null then 'invalid'\n                             else 'valid' end as bucket_name\n    ,case\n        when m.race is not null and r.description is null then 'Race does not join to terminology race table'\n        else null\n    end as invalid_reason\n    ,cast(race as TEXT) as field_value\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.eligibility m\nleft join tuva.terminology.race r on m.race=r.description", "relation_name": "tuva.data_quality.eligibility_race"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.740283Z", "completed_at": "2025-02-25T21:26:16.746740Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.751625Z", "completed_at": "2025-02-25T21:26:16.751631Z"}], "thread_id": "Thread-2", "execution_time": 0.012537002563476562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__eligibility_start_date", "compiled": true, "compiled_code": "\n\nSELECT DISTINCT\n    m.data_source\n    ,coalesce(cast(m.enrollment_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'ELIGIBILITY' AS table_name\n    ,'Member ID' AS drill_down_key\n    ,coalesce(m.member_id, 'NULL') as drill_down_value\n    ,'ELIGIBILITY' AS claim_type\n    ,'ENROLLMENT_START_DATE' AS field_name\n    ,case\n        when m.enrollment_start_date > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'invalid'\n        when m.enrollment_start_date <= cast('1901-01-01' as date) then 'invalid'\n        when m.enrollment_start_date is null then 'null'\n        else 'valid'\n    end as bucket_name\n    ,case\n        when m.enrollment_start_date > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'future'\n        when m.enrollment_start_date <= cast('1901-01-01' as date) then 'too old'\n    else null\n    end as invalid_reason\n    ,cast(enrollment_start_date as TEXT) as field_value\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.eligibility m", "relation_name": "tuva.data_quality.eligibility_start_date"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.746977Z", "completed_at": "2025-02-25T21:26:16.752729Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.758867Z", "completed_at": "2025-02-25T21:26:16.758873Z"}], "thread_id": "Thread-1", "execution_time": 0.014044761657714844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__eligibility_state", "compiled": true, "compiled_code": "\n\nSELECT DISTINCT \n    m.data_source\n    ,coalesce(cast(m.enrollment_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'ELIGIBILITY' AS table_name\n    ,'Member ID | Enrollment Start Date' AS drill_down_key\n    ,coalesce(m.member_id, 'NULL') as drill_down_value\n    ,'ELIGIBILITY' AS claim_type\n    ,'STATE' AS field_name\n    ,case when m.state is  null then 'null'\n          when term.ssa_fips_state_name is null then 'invalid'\n                             else 'valid' end as bucket_name\n    ,case\n        when m.state is not null and term.ssa_fips_state_name is null then 'State does not join to Terminology SSA_FIPS_STATE table'\n        else null\n    end as invalid_reason\n    ,cast(state as TEXT) as field_value\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.eligibility m\nleft join tuva.reference_data.ssa_fips_state as term on m.state = term.ssa_fips_state_name", "relation_name": "tuva.data_quality.eligibility_state"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.753061Z", "completed_at": "2025-02-25T21:26:16.763835Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.764556Z", "completed_at": "2025-02-25T21:26:16.764563Z"}], "thread_id": "Thread-3", "execution_time": 0.013241052627563477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__eligibility_trend", "compiled": true, "compiled_code": "\n\nwith eligibility_spans as(\n    select distinct\n        member_id || '-' || enrollment_start_date || '-' || enrollment_end_date || '-' || payer || '-' || plan as eligibility_span_id\n        , enrollment_start_date\n        , enrollment_end_date\n    from tuva.input_layer.eligibility\n)\n, month_start_and_end_dates as (\n  select\n    year || \n\n    case when 2 = 0\n        then ''\n    else\n        right(\n            '0' || month,\n            2\n        )\n    end as year_month\n    , min(full_date) as month_start_date\n    , max(full_date) as month_end_date\n  from tuva.reference_data.calendar\n  group by year, month, year_month\n)\n, member_months as (\n    select distinct\n        eligibility_span_id\n        , year_month\n    from eligibility_spans es\n    inner join month_start_and_end_dates d\n        on es.enrollment_start_date <= d.month_end_date\n        and es.enrollment_end_date >= d.month_start_date\n)\n\n\nselect\n    year_month\n    , count(distinct eligibility_span_id) as member_months\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom member_months\ngroup by\n    year_month", "relation_name": "tuva.data_quality.eligibility_trend"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.760107Z", "completed_at": "2025-02-25T21:26:16.765439Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.768661Z", "completed_at": "2025-02-25T21:26:16.768667Z"}], "thread_id": "Thread-2", "execution_time": 0.010193347930908203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__eligibility_zip_code", "compiled": true, "compiled_code": "\n\nSELECT DISTINCT -- to bring to claim_ID grain\n    m.data_source\n    ,coalesce(cast(m.enrollment_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'ELIGIBILITY' AS table_name\n    ,'Member ID | Enrollment Start Date' AS drill_down_key\n    ,coalesce(m.member_id, 'NULL') as drill_down_value\n    ,'ELIGIBILITY' AS claim_type\n    ,'ZIP_CODE' AS field_name\n    \n    ,case when m.zip_code is  null then 'null'\n          when length(m.zip_code) in  (5,9,10) then 'valid'\n                             else 'invalid' end as bucket_name\n    ,case\n        when m.zip_code is not null and length(m.zip_code) NOT IN (5,9,10) then 'Invalid Zip Code Length'\n        else null\n     end as invalid_reason\n    \n    ,cast(zip_code as TEXT) as field_value\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.eligibility m", "relation_name": "tuva.data_quality.eligibility_zip_code"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.774912Z", "completed_at": "2025-02-25T21:26:16.790819Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.791697Z", "completed_at": "2025-02-25T21:26:16.791705Z"}], "thread_id": "Thread-2", "execution_time": 0.021902799606323242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__claim_allowed_amount", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'MEDICAL_CLAIM' AS table_name\n    , 'Claim ID | Claim Line Number' AS drill_down_key\n    , coalesce(cast(m.claim_id as TEXT), 'null') || '|' || coalesce(cast(m.claim_line_number as TEXT), 'null') as drill_down_value\n    , m.claim_type as claim_type\n    , 'ALLOWED_AMOUNT' AS field_name\n    , case when m.allowed_amount is null then 'null'\n                                    else 'valid' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(allowed_amount as TEXT) as field_value\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.medical_claim m", "relation_name": "tuva.data_quality.claim_allowed_amount"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.780055Z", "completed_at": "2025-02-25T21:26:16.792892Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.793581Z", "completed_at": "2025-02-25T21:26:16.793586Z"}], "thread_id": "Thread-1", "execution_time": 0.014225006103515625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__claim_charge_amount", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'MEDICAL_CLAIM' AS table_name\n    , 'Claim ID | Claim Line Number' AS drill_down_key\n    , coalesce(cast(m.claim_id as TEXT), 'null') || '|' || coalesce(cast(m.claim_line_number as TEXT), 'null') as drill_down_value\n    , m.claim_type as claim_type\n    , 'CHARGE_AMOUNT' AS field_name\n    , case when m.charge_amount is null then 'null'\n                                    else 'valid' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(charge_amount as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.medical_claim m", "relation_name": "tuva.data_quality.claim_charge_amount"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.794034Z", "completed_at": "2025-02-25T21:26:16.822674Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.823170Z", "completed_at": "2025-02-25T21:26:16.823183Z"}], "thread_id": "Thread-3", "execution_time": 0.031032085418701172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__claim_claim_id", "compiled": true, "compiled_code": "\n\nSELECT DISTINCT -- to bring to claim_ID grain \n    m.data_source\n    ,coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'MEDICAL_CLAIM' AS table_name\n    ,'Claim ID' as drill_down_key\n    ,coalesce(m.claim_id, 'NULL') AS drill_down_value\n    ,m.claim_type as claim_type\n    ,'CLAIM_ID' AS field_name\n    ,case when m.claim_id is not null then 'valid' else 'null' end as bucket_name\n    ,cast(null as TEXT) as invalid_reason\n    ,cast(member_id as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.medical_claim m", "relation_name": "tuva.data_quality.claim_claim_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.801316Z", "completed_at": "2025-02-25T21:26:16.824882Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.825412Z", "completed_at": "2025-02-25T21:26:16.825419Z"}], "thread_id": "Thread-2", "execution_time": 0.032169342041015625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__claim_claim_line_end_date", "compiled": true, "compiled_code": "\n\nwith tuva_last_run as(\n\n    select cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) as tuva_last_run\n\n)\n\nSELECT\n      m.data_source\n    , coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'MEDICAL_CLAIM' AS table_name\n    , 'Claim ID | Claim Line Number' AS drill_down_key\n    , coalesce(cast(m.claim_id as TEXT), 'null') || '|' || coalesce(cast(m.claim_line_number as TEXT), 'null') as drill_down_value\n    , m.claim_type as claim_type\n    , 'CLAIM_LINE_END_DATE' AS field_name\n    , case\n        when m.claim_line_end_date > tuva_last_run then 'invalid'\n        when m.claim_line_end_date < \n\n    dateadd(\n        year,\n        -10,\n        cte.tuva_last_run\n        )\n\n then 'invalid'\n        when m.claim_line_end_date > m.claim_line_end_date then 'invalid'\n        when m.claim_line_end_date is null then 'null'\n        else 'valid'\n    end as bucket_name\n    , case\n        when m.claim_line_end_date > tuva_last_run then 'future'\n        when m.claim_line_end_date < \n\n    dateadd(\n        year,\n        -10,\n        cte.tuva_last_run\n        )\n\n then 'too old'\n        when m.claim_line_end_date > m.claim_end_date then 'line date greater than claim date'\n        else null\n    end as invalid_reason\n    , cast(claim_line_end_date as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.medical_claim m\ncross join tuva_last_run cte", "relation_name": "tuva.data_quality.claim_claim_line_end_date"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.816551Z", "completed_at": "2025-02-25T21:26:16.831870Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.833377Z", "completed_at": "2025-02-25T21:26:16.833384Z"}], "thread_id": "Thread-1", "execution_time": 0.020288944244384766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__claim_claim_line_number", "compiled": true, "compiled_code": "\n\nSELECT\n    m.data_source\n    ,coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'MEDICAL_CLAIM' AS table_name\n    ,'Claim ID' as drill_down_key\n    ,coalesce(claim_id, 'NULL') AS drill_down_value\n    ,m.claim_type as claim_type\n    ,'CLAIM_LINE_NUMBER' AS field_name\n    ,case when m.claim_line_number is not null then 'valid' else 'null' end as bucket_name\n    ,cast(null as TEXT) as invalid_reason\n    ,cast(member_id as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.medical_claim m", "relation_name": "tuva.data_quality.claim_claim_line_number"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.825994Z", "completed_at": "2025-02-25T21:26:16.841241Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.841764Z", "completed_at": "2025-02-25T21:26:16.841772Z"}], "thread_id": "Thread-3", "execution_time": 0.01754593849182129, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__claim_claim_line_start_date", "compiled": true, "compiled_code": "\n\nwith tuva_last_run as(\n\n    select cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) as tuva_last_run\n\n)\nSELECT\n      m.data_source\n    , coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'MEDICAL_CLAIM' AS table_name\n    , 'Claim ID | Claim Line Number' AS drill_down_key\n    , coalesce(cast(m.claim_id as TEXT), 'null') || '|' || coalesce(cast(m.claim_line_number as TEXT), 'null') as drill_down_value\n    , m.claim_type as claim_type\n    , 'CLAIM_LINE_START_DATE' AS field_name\n    , case\n        when m.claim_line_start_date > tuva_last_run then 'invalid'\n        when m.claim_line_start_date < \n\n    dateadd(\n        year,\n        -10,\n        cte.tuva_last_run\n        )\n\n then 'invalid'\n        when m.claim_line_start_date < m.claim_start_date then 'invalid'\n        when m.claim_line_start_date is null then 'null'\n        else 'valid'\n    end as bucket_name\n    , case\n        when m.claim_line_start_date > tuva_last_run then 'future'\n        when m.claim_line_start_date < \n\n    dateadd(\n        year,\n        -10,\n        cte.tuva_last_run\n        )\n\n then 'too old'\n        when m.claim_line_start_date < m.claim_start_date then 'line date less than than claim date'\n        else null\n    end as invalid_reason\n    , cast(claim_line_start_date as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.medical_claim m\ncross join tuva_last_run cte", "relation_name": "tuva.data_quality.claim_claim_line_start_date"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.835386Z", "completed_at": "2025-02-25T21:26:16.847103Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.847674Z", "completed_at": "2025-02-25T21:26:16.847680Z"}], "thread_id": "Thread-2", "execution_time": 0.013746976852416992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__claim_claim_type", "compiled": true, "compiled_code": "\n\nSELECT DISTINCT -- to bring to claim_ID grain \n    m.data_source\n    ,coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'MEDICAL_CLAIM' AS table_name\n    ,'Claim ID' as drill_down_key\n,coalesce(claim_id, 'NULL') AS drill_down_value\n    ,m.claim_type as claim_type\n    ,'CLAIM_TYPE' AS field_name\n    ,case when m.claim_type is null then 'null'\n          when term.claim_type is null then 'invalid'\n                             else 'valid' end as bucket_name\n    ,case\n        when m.claim_type is not null and term.claim_type is null then 'Claim Type does not join to Terminology Claim Type table'\n        else null\n    end as invalid_reason\n    ,cast(m.claim_type as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.medical_claim m\nleft join tuva.terminology.claim_type term on m.claim_type = term.claim_type", "relation_name": "tuva.data_quality.claim_claim_type"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.842199Z", "completed_at": "2025-02-25T21:26:16.848263Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.853461Z", "completed_at": "2025-02-25T21:26:16.853469Z"}], "thread_id": "Thread-1", "execution_time": 0.01857590675354004, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__claim_coinsurance_amount", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'MEDICAL_CLAIM' AS table_name\n    , 'Claim ID | Claim Line Number' AS drill_down_key\n    , coalesce(cast(m.claim_id as TEXT), 'null') || '|' || coalesce(cast(m.claim_line_number as TEXT), 'null') as drill_down_value\n    , m.claim_type as claim_type\n    , 'COINSURANCE_AMOUNT' AS field_name\n    , case when m.coinsurance_amount is null then 'null'\n                                    else 'valid' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(coinsurance_amount as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.medical_claim m", "relation_name": "tuva.data_quality.claim_coninsurance_amount"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.848709Z", "completed_at": "2025-02-25T21:26:16.860258Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.861046Z", "completed_at": "2025-02-25T21:26:16.861054Z"}], "thread_id": "Thread-3", "execution_time": 0.013818740844726562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__claim_copayment_amount", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'MEDICAL_CLAIM' AS table_name\n    , 'Claim ID | Claim Line Number' AS drill_down_key\n    , coalesce(cast(m.claim_id as TEXT), 'null') || '|' || coalesce(cast(m.claim_line_number as TEXT), 'null') as drill_down_value\n    , m.claim_type as claim_type\n    , 'COPAYMENT_AMOUNT' AS field_name\n    , case when m.copayment_amount is null then 'null'\n                                    else 'valid' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(copayment_amount as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.medical_claim m", "relation_name": "tuva.data_quality.claim_copayment_amount"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.855379Z", "completed_at": "2025-02-25T21:26:16.867685Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.868724Z", "completed_at": "2025-02-25T21:26:16.868732Z"}], "thread_id": "Thread-2", "execution_time": 0.014777183532714844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__claim_data_source", "compiled": true, "compiled_code": "\n\nSELECT DISTINCT -- to bring to claim_ID grain \n    m.data_source\n    ,coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'MEDICAL_CLAIM' AS table_name\n    ,'Claim ID' as drill_down_key\n    ,coalesce(m.claim_id, 'NULL') AS drill_down_value\n    ,m.claim_type as claim_type\n    ,'DATA_SOURCE' AS field_name\n    ,case when m.data_source is not null then 'valid' else 'null' end as bucket_name\n    ,cast(null as TEXT) as invalid_reason\n    ,cast(data_source as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.medical_claim m", "relation_name": "tuva.data_quality.claim_data_source"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.861733Z", "completed_at": "2025-02-25T21:26:16.870269Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.871225Z", "completed_at": "2025-02-25T21:26:16.871231Z"}], "thread_id": "Thread-1", "execution_time": 0.016286373138427734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__claim_deductible_amount", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'MEDICAL_CLAIM' AS table_name\n    , 'Claim ID | Claim Line Number' AS drill_down_key\n     , coalesce(cast(m.claim_id as TEXT), 'null') || '|' || coalesce(cast(m.claim_line_number as TEXT), 'null') as drill_down_value\n    , m.claim_type as claim_type\n    , 'DEDUCTIBLE_AMOUNT' AS field_name\n    , case when m.deductible_amount is null then 'null'\n                                    else 'valid' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(deductible_amount as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.medical_claim m", "relation_name": "tuva.data_quality.claim_deductible_amount"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.871637Z", "completed_at": "2025-02-25T21:26:16.879358Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.884118Z", "completed_at": "2025-02-25T21:26:16.884126Z"}], "thread_id": "Thread-3", "execution_time": 0.01579594612121582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__claim_diagnosis_code_type", "compiled": true, "compiled_code": "\n\nSELECT DISTINCT -- to bring to claim_ID grain \n    m.data_source\n    ,coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'MEDICAL_CLAIM' AS table_name\n    ,'Claim ID' as drill_down_key\n    ,coalesce(m.claim_id, 'NULL') AS drill_down_value\n    ,m.claim_type as claim_type\n    ,'DIAGNOSIS_CODE_TYPE' AS field_name\n    ,case when m.diagnosis_code_type is null then 'null'\n          when term.code_type is null then 'invalid'\n                             else 'valid' end as bucket_name\n    ,case\n        when m.diagnosis_code_type is not null and term.code_type is null then 'Diagnosis Code Type does not join to Terminology Code Type table'\n        else null\n    end as invalid_reason\n    ,cast(m.diagnosis_code_type as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.medical_claim m\nleft join tuva.reference_data.code_type term on m.diagnosis_code_type = term.code_type", "relation_name": "tuva.data_quality.claim_diagnosis_code_type"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.879600Z", "completed_at": "2025-02-25T21:26:16.889978Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.890544Z", "completed_at": "2025-02-25T21:26:16.890549Z"}], "thread_id": "Thread-2", "execution_time": 0.013821125030517578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__claim_drg_code_type", "compiled": true, "compiled_code": "\n\nSELECT DISTINCT -- to bring to claim_ID grain \n    m.data_source\n    ,coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'MEDICAL_CLAIM' AS table_name\n    ,'Claim ID' as drill_down_key\n    ,coalesce(m.claim_id, 'NULL') AS drill_down_value\n    ,m.claim_type as claim_type\n    ,'DRG_CODE_TYPE' AS field_name\n    ,case when m.drg_code_type is null then 'null'\n          when term.code_type is null then 'invalid'\n                             else 'valid' end as bucket_name\n    ,case\n        when m.drg_code_type is not null and term.code_type is null then 'DRG Code Type does not join to Terminology Code Type table'\n        else null\n    end as invalid_reason\n    ,cast(m.drg_code_type as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.medical_claim m\nleft join tuva.reference_data.code_type term on m.drg_code_type = term.code_type", "relation_name": "tuva.dbt_sarah.data_quality__claim_drg_code_type"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.884798Z", "completed_at": "2025-02-25T21:26:16.890930Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.891572Z", "completed_at": "2025-02-25T21:26:16.891576Z"}], "thread_id": "Thread-1", "execution_time": 0.012646913528442383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__claim_hcpcs_code", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'MEDICAL_CLAIM' AS table_name\n    , 'Claim ID | Claim Line Number' AS drill_down_key\n    , coalesce(cast(m.claim_id as TEXT), 'null') || '|' || coalesce(cast(m.claim_line_number as TEXT), 'null') as drill_down_value\n    , m.claim_type as claim_type\n    , 'HCPCS_CODE' AS field_name\n    , case\n          when term.hcpcs is not null then 'valid'\n          when m.hcpcs_code is not null then 'invalid'\n          else 'null'\n    end as bucket_name\n    , case\n        when m.hcpcs_code is not null and term.hcpcs is null then 'HCPCS does not join to Terminology HCPCS_LEVEL_2 table'\n        else null\n     end as invalid_reason\n    , m.hcpcs_code || '|' || coalesce(term.short_description, '') as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\n    from tuva.input_layer.medical_claim m\nleft join tuva.terminology.hcpcs_level_2 as term on m.hcpcs_code = term.hcpcs", "relation_name": "tuva.data_quality.claim_hcpcs_code"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.891958Z", "completed_at": "2025-02-25T21:26:16.901151Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.901629Z", "completed_at": "2025-02-25T21:26:16.901636Z"}], "thread_id": "Thread-3", "execution_time": 0.01148676872253418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__claim_member_id", "compiled": true, "compiled_code": "\n\nSELECT DISTINCT -- to bring to claim_ID grain \n    m.data_source\n    ,coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'MEDICAL_CLAIM' AS table_name\n    ,'Claim ID' AS drill_down_key\n    ,coalesce(m.claim_id, 'NULL') AS drill_down_value\n    ,m.claim_type as claim_type\n    ,'MEMBER_ID' AS field_name\n    ,case when m.member_id is not null then 'valid' else 'null' end as bucket_name\n    ,cast(null as TEXT) as invalid_reason\n    ,cast(member_id as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.medical_claim m", "relation_name": "tuva.data_quality.claim_member_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.896743Z", "completed_at": "2025-02-25T21:26:16.909200Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.912978Z", "completed_at": "2025-02-25T21:26:16.912984Z"}], "thread_id": "Thread-2", "execution_time": 0.01736617088317871, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__claim_paid_amount", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'MEDICAL_CLAIM' AS table_name\n    , 'Claim ID | Claim Line Number' AS drill_down_key\n    , coalesce(cast(m.claim_id as TEXT), 'null') || '|' || coalesce(cast(m.claim_line_number as TEXT), 'null') as drill_down_value\n    , m.claim_type as claim_type\n    , 'PAID_AMOUNT' AS field_name\n    , case when m.paid_amount is null then 'null'\n                                    else 'valid' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(paid_amount as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.medical_claim m", "relation_name": "tuva.data_quality.claim_paid_amount"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.902056Z", "completed_at": "2025-02-25T21:26:16.914213Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.918144Z", "completed_at": "2025-02-25T21:26:16.918150Z"}], "thread_id": "Thread-1", "execution_time": 0.021737098693847656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__claim_paid_date", "compiled": true, "compiled_code": "\n\nwith tuva_last_run as(\n\n     select cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) as tuva_last_run\n\n)\nSELECT\n      m.data_source\n    , coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'MEDICAL_CLAIM' AS table_name\n    , 'Claim ID | Claim Line Number' AS drill_down_key\n    , coalesce(cast(m.claim_id as TEXT), 'null') || '|' || coalesce(cast(m.claim_line_number as TEXT), 'null') as drill_down_value\n    , m.claim_type as claim_type\n    , 'PAID_DATE' AS field_name\n    , case\n        when m.paid_date > tuva_last_run then 'invalid'\n        when m.paid_date < \n\n    dateadd(\n        year,\n        -10,\n        cte.tuva_last_run\n        )\n\n then 'invalid'\n        when m.paid_date < m.claim_start_date then 'invalid'\n        when m.paid_date is null then 'null'\n        else 'valid'\n    end as bucket_name\n    , case\n        when m.paid_date > tuva_last_run then 'future'\n        when m.paid_date < \n\n    dateadd(\n        year,\n        -10,\n        cte.tuva_last_run\n        )\n\n then 'too old'\n        when m.paid_date < m.claim_start_date then 'paid date before claim start date'\n        else null\n    end as invalid_reason\n    , cast(claim_line_start_date as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.medical_claim m\ncross join tuva_last_run cte", "relation_name": "tuva.data_quality.claim_paid_date"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.909418Z", "completed_at": "2025-02-25T21:26:16.917925Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.918571Z", "completed_at": "2025-02-25T21:26:16.918575Z"}], "thread_id": "Thread-3", "execution_time": 0.010859966278076172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__claim_payer", "compiled": true, "compiled_code": "\n\nSELECT DISTINCT -- to bring to claim_ID grain \n    m.data_source\n    ,coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'MEDICAL_CLAIM' AS table_name\n    ,'Claim ID' AS drill_down_key\n,coalesce(claim_id, 'NULL') AS drill_down_value\n    ,m.claim_type as claim_type\n    ,'PAYER' AS field_name\n    ,case when m.payer is not null then 'valid' else 'null' end as bucket_name\n    ,cast(null as TEXT) as invalid_reason\n    ,cast(payer as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.medical_claim m", "relation_name": "tuva.data_quality.claim_payer"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.914403Z", "completed_at": "2025-02-25T21:26:16.919452Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.920075Z", "completed_at": "2025-02-25T21:26:16.920078Z"}], "thread_id": "Thread-2", "execution_time": 0.006371974945068359, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__claim_person_id", "compiled": true, "compiled_code": "\n\nSELECT DISTINCT -- to bring to claim_ID grain \n    m.data_source\n    ,coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'MEDICAL_CLAIM' AS table_name\n    ,'Claim ID' AS drill_down_key\n,coalesce(claim_id, 'NULL') AS drill_down_value\n    ,m.claim_type as claim_type\n    ,'PERSON_ID' AS field_name\n    ,case when m.person_id is not null then 'valid' else 'null' end as bucket_name\n    ,cast(null as TEXT) as invalid_reason\n    ,cast(person_id as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.medical_claim m", "relation_name": "tuva.data_quality.claim_person_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.921060Z", "completed_at": "2025-02-25T21:26:16.933398Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.933898Z", "completed_at": "2025-02-25T21:26:16.933906Z"}], "thread_id": "Thread-1", "execution_time": 0.014367103576660156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__claim_plan", "compiled": true, "compiled_code": "\n\nSELECT DISTINCT -- to bring to claim_ID grain\n    m.data_source\n    ,coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'MEDICAL_CLAIM' AS table_name\n    ,'Claim ID' AS drill_down_key\n,coalesce(claim_id, 'NULL') AS drill_down_value\n    ,m.claim_type as claim_type\n    ,'PLAN' AS field_name\n    ,case when m.plan is not null then 'valid' else 'null' end as bucket_name\n    ,cast(null as TEXT) as invalid_reason\n    ,cast(plan as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.medical_claim m", "relation_name": "tuva.data_quality.claim_plan"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.924817Z", "completed_at": "2025-02-25T21:26:16.933648Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.934351Z", "completed_at": "2025-02-25T21:26:16.934355Z"}], "thread_id": "Thread-3", "execution_time": 0.01455998420715332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__claim_total_cost_amount", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'MEDICAL_CLAIM' AS table_name\n    , 'Claim ID | Claim Line Number' AS drill_down_key\n    , coalesce(cast(m.claim_id as TEXT), 'null') || '|' || coalesce(cast(m.claim_line_number as TEXT), 'null') as drill_down_value\n    , m.claim_type as claim_type\n    , 'TOTAL_COST_AMOUNT' AS field_name\n    , case when m.total_cost_amount is null then 'null'\n                                    else 'valid' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(total_cost_amount as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.medical_claim m", "relation_name": "tuva.data_quality.claim_total_cost_amount"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.929359Z", "completed_at": "2025-02-25T21:26:16.935074Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.935790Z", "completed_at": "2025-02-25T21:26:16.935794Z"}], "thread_id": "Thread-2", "execution_time": 0.007091999053955078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__claim_type_summary", "compiled": true, "compiled_code": "select\n    data_source\n    ,claim_type\n    ,count(distinct claim_id) as claim_count\n    ,sum(paid_amount) as paid_amount\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.medical_claim\ngroup by\n    data_source\n    ,claim_type\n\n", "relation_name": "tuva.data_quality.claim_type_summary"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.955028Z", "completed_at": "2025-02-25T21:26:16.965396Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.965623Z", "completed_at": "2025-02-25T21:26:16.965629Z"}], "thread_id": "Thread-3", "execution_time": 0.02956700325012207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__inpatient_dq_stage", "compiled": true, "compiled_code": "\n\nwith drg_requirement as (\n  select distinct\n      mc.claim_id\n  from tuva.input_layer.medical_claim as mc\n  left join tuva.terminology.ms_drg as msdrg\n    on mc.drg_code = msdrg.ms_drg_code\n  where mc.claim_type = 'institutional'\n    and msdrg.ms_drg_code is not null\n)\n\n, bill_type_requirement as (\n  select distinct\n      claim_id\n  from tuva.input_layer.medical_claim\n  where claim_type = 'institutional'\n    and substring(bill_type_code, 1, 2) in (\n      '11'  -- hospital inpatient \n    , '12'  -- hospital inpatient \n    )\n)\n\nselect distinct\n    a.claim_id\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.medical_claim as a\ninner join bill_type_requirement as d\n  on a.claim_id = d.claim_id\n\n\nunion distinct\n\n\nselect distinct\n    a.claim_id\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.medical_claim as a\ninner join drg_requirement as c\n  on a.claim_id = c.claim_id", "relation_name": "tuva.data_quality.data_quality__inpatient_dq_stage"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.960060Z", "completed_at": "2025-02-25T21:26:16.966774Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.967268Z", "completed_at": "2025-02-25T21:26:16.967272Z"}], "thread_id": "Thread-2", "execution_time": 0.017741680145263672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__institutional_bill_type_code", "compiled": true, "compiled_code": "\n\nwith base as (\n    select *\n    from tuva.input_layer.medical_claim\n    where claim_type = 'institutional'\n),\n\nunique_field as (\n    select distinct claim_id\n        , base.bill_type_code || '|' || coalesce(term.bill_type_description, '') as field\n        , data_source\n    from base\n    left join tuva.terminology.bill_type as term on base.bill_type_code = term.bill_type_code\n),\n\nclaim_grain as (\n    select claim_id\n        , data_source\n        , count(*) as frequency\n    from unique_field\n    group by claim_id\n        , data_source\n),\n\nclaim_agg as (\nselect\n      claim_id\n    , data_source\n    , \n    listagg(\n        coalesce(field, 'null'),\n        ', '\n        )\n        within group (order by field desc) as field_aggregated\nfrom\n    unique_field\ngroup by\n      claim_id\n    , data_source\n\t)\n\nselect distinct -- to bring to claim_id grain\n      m.data_source\n    , coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'MEDICAL_CLAIM' AS table_name\n    , 'Claim ID' AS drill_down_key\n    , coalesce(m.claim_id, 'NULL') AS drill_down_value\n    , 'institutional' AS claim_type\n    , 'BILL_TYPE_CODE' AS field_name\n    , case when cg.frequency > 1                then 'multiple'\n          when term.bill_type_code is not null then 'valid'\n          when m.bill_type_code is not null    then 'invalid'\n                                               else 'null' end as bucket_name\n    , case\n        when m.bill_type_code is not null\n            and term.bill_type_code is null\n            and cg.frequency = 1\n            then 'Bill Type Code does not join to Terminology Bill_Type table'\n        else null\n    end as invalid_reason\n    , cast(\n  substr(agg.field_aggregated, 1, 255)\n as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom base m\nleft join claim_grain cg on m.claim_id = cg.claim_id and m.data_source = cg.data_source\nleft join tuva.terminology.bill_type as term on m.bill_type_code = term.bill_type_code\nleft join claim_agg agg on m.claim_id = agg.claim_id and m.data_source = agg.data_source", "relation_name": "tuva.data_quality.institutional_bill_type_code"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.967649Z", "completed_at": "2025-02-25T21:26:16.979880Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.980155Z", "completed_at": "2025-02-25T21:26:16.980162Z"}], "thread_id": "Thread-3", "execution_time": 0.013912200927734375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__institutional_billing_npi", "compiled": true, "compiled_code": "\n\nwith base as (\n    select *\n    from tuva.input_layer.medical_claim\n    where claim_type = 'institutional'\n),\nunique_field as (\n    select distinct claim_id\n        ,cast(billing_npi as TEXT) as field\n        ,data_source\n    from base\n),\nclaim_grain as (\n    select claim_id\n        ,data_source\n        ,count(*) as frequency\n    from unique_field\n    group by claim_id\n        ,data_source\n),\nclaim_agg as (\nselect\n    claim_id,\n    data_source,\n    \n    listagg(\n        coalesce(field, 'null'),\n        ', '\n        )\n        within group (order by field desc) as field_aggregated\nfrom\n    unique_field\ngroup by\n    claim_id,\n    data_source\n\t)\nselect distinct -- to bring to claim_id grain\n    m.data_source\n    ,coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'MEDICAL_CLAIM' AS table_name\n    ,'Claim ID' AS drill_down_key\n    ,coalesce(m.claim_id, 'NULL') AS drill_down_value\n    ,'institutional' AS claim_type\n    ,'BILLING_NPI' AS field_name\n    ,case when cg.frequency > 1                then 'multiple'\n          when term.npi is not null            then 'valid'\n          when m.billing_npi is not null      then 'invalid'\n                                               else 'null' end as bucket_name\n    ,case\n        when cg.frequency = 1\n            and m.billing_npi is not null\n            and term.npi is null\n            then 'NPI is not in Terminology Provider table'\n        else null\n    end as invalid_reason\n    ,cast(\n  substr(agg.field_aggregated, 1, 255)\n as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom base m\nleft join claim_grain cg on m.claim_id = cg.claim_id and m.data_source = cg.data_source\nleft join tuva.terminology.provider as term on m.billing_npi = term.npi\nleft join claim_agg agg on m.claim_id = agg.claim_id and m.data_source = agg.data_source", "relation_name": "tuva.data_quality.institutional_billing_npi"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.973400Z", "completed_at": "2025-02-25T21:26:16.981070Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.981467Z", "completed_at": "2025-02-25T21:26:16.981470Z"}], "thread_id": "Thread-2", "execution_time": 0.008877038955688477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__institutional_claim_end_date", "compiled": true, "compiled_code": "\n\nwith base as (\n    select *\n    from tuva.input_layer.medical_claim\n    where claim_type = 'institutional'\n)\n, tuva_last_run as(\n    select cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) as tuva_last_run\n)\n,unique_field as (\n    select distinct claim_id\n        ,cast(claim_end_date as TEXT) as field\n        ,data_source\n    from base\n),\nclaim_grain as (\n    select claim_id\n        ,data_source\n        ,count(*) as frequency\n    from unique_field\n    group by claim_id\n        ,data_source\n),\nclaim_agg as (\nselect\n    claim_id,\n    data_source,\n    \n    listagg(\n        coalesce(field, 'null'),\n        ', '\n        )\n        within group (order by field desc) as field_aggregated\nfrom\n    unique_field\ngroup by\n    claim_id,\n    data_source\n\t)\nselect distinct -- to bring to claim_id grain\n    m.data_source\n    ,coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'MEDICAL_CLAIM' AS table_name\n    ,'Claim ID' AS drill_down_key\n    ,coalesce(m.claim_id, 'NULL') AS drill_down_value\n    ,'institutional' AS claim_type\n    ,'CLAIM_END_DATE' AS field_name\n    ,case\n        when cg.frequency > 1 then 'multiple'\n        when m.claim_end_date > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'invalid'\n        when m.claim_end_date < \n\n    dateadd(\n        year,\n        -10,\n        cte.tuva_last_run\n        )\n\n then 'invalid'\n        when m.claim_end_date < m.claim_start_date then 'invalid'\n        when m.claim_end_date is null then 'null'\n        else 'valid'\n    end as bucket_name\n    ,case\n        when cg.frequency > 1 then 'multiple'\n        when m.claim_end_date > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'future'\n        when m.claim_end_date < \n\n    dateadd(\n        year,\n        -10,\n        cte.tuva_last_run\n        )\n\n then 'too old'\n        when m.claim_end_date < m.claim_start_date then 'claim end date before claim start date'\n        else null\n        end as invalid_reason\n    ,cast(\n  substr(agg.field_aggregated, 1, 255)\n as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom base m\nleft join claim_grain cg on m.claim_id = cg.claim_id and m.data_source = cg.data_source\nleft join claim_agg agg on m.claim_id = agg.claim_id and m.data_source = agg.data_source\ncross join tuva_last_run cte", "relation_name": "tuva.data_quality.institutional_claim_end_date"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.981816Z", "completed_at": "2025-02-25T21:26:16.993641Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.993941Z", "completed_at": "2025-02-25T21:26:16.993948Z"}], "thread_id": "Thread-3", "execution_time": 0.013177871704101562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__institutional_claim_start_date", "compiled": true, "compiled_code": "\n\nwith base as (\n    select *\n    from tuva.input_layer.medical_claim\n    where claim_type = 'institutional'\n)\n, tuva_last_run as(\n    select cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) as tuva_last_run\n)\n,unique_field as (\n    select distinct claim_id\n        ,cast(claim_start_date as TEXT) as field\n        ,data_source\n    from base\n),\nclaim_grain as (\n    select claim_id\n        ,data_source\n        ,count(*) as frequency\n    from unique_field\n    group by claim_id\n        ,data_source\n),\nclaim_agg as (\nselect\n    claim_id,\n    data_source,\n    \n    listagg(\n        coalesce(field, 'null'),\n        ', '\n        )\n        within group (order by field desc) as field_aggregated\nfrom\n    unique_field\ngroup by\n    claim_id,\n    data_source\n\t)\nselect distinct -- to bring to claim_id grain\n    m.data_source\n    ,coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'MEDICAL_CLAIM' AS table_name\n    ,'Claim ID' AS drill_down_key\n    ,coalesce(m.claim_id, 'NULL') AS drill_down_value\n    ,'institutional' AS claim_type\n    ,'CLAIM_START_DATE' AS field_name\n    ,case\n        when cg.frequency > 1 then 'multiple'\n        when m.claim_start_date > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'invalid'\n        when m.claim_start_date < \n\n    dateadd(\n        year,\n        -10,\n        cte.tuva_last_run\n        )\n\n then 'invalid'\n        when m.claim_start_date is null then 'null'\n        else 'valid'\n    end as bucket_name\n    ,case\n        when cg.frequency > 1 then 'multiple'\n        when m.claim_start_date > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'future'\n        when m.claim_start_date < \n\n    dateadd(\n        year,\n        -10,\n        cte.tuva_last_run\n        )\n\n then 'too old'\n        else null\n        end as invalid_reason\n    ,cast(\n  substr(agg.field_aggregated, 1, 255)\n as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom base m\nleft join claim_grain cg on m.claim_id = cg.claim_id and m.data_source = cg.data_source\nleft join claim_agg agg on m.claim_id = agg.claim_id and m.data_source = agg.data_source\ncross join tuva_last_run cte", "relation_name": "tuva.data_quality.institutional_claim_start_date"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.989125Z", "completed_at": "2025-02-25T21:26:16.994878Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:16.995287Z", "completed_at": "2025-02-25T21:26:16.995290Z"}], "thread_id": "Thread-2", "execution_time": 0.006821870803833008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__institutional_diagnosis_code_1", "compiled": true, "compiled_code": "\n\nwith base as (\n    select *\n    from tuva.input_layer.medical_claim\n    where claim_type = 'institutional'\n),\n\nunique_field as (\n    select distinct claim_id\n        , diagnosis_code_1 || '|' || coalesce(term.short_description, '') as field\n        , data_source\n    from base\n    left join tuva.terminology.icd_10_cm as term on base.diagnosis_code_1 = term.icd_10_cm\n),\n\nclaim_grain as (\n    select claim_id\n        , data_source\n        , count(*) as frequency\n    from unique_field\n    group by claim_id\n        , data_source\n),\n\nclaim_agg as (\nselect\n      claim_id\n    , data_source\n    , \n    listagg(\n        coalesce(field, 'null'),\n        ', '\n        )\n        within group (order by field desc) as field_aggregated\nfrom\n    unique_field\ngroup by\n      claim_id\n    , data_source\n\t)\n\nselect distinct -- to bring to claim_id grain\n      m.data_source\n    , coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'MEDICAL_CLAIM' AS table_name\n    , 'Claim ID' AS drill_down_key\n    , coalesce(m.claim_id, 'NULL') AS drill_down_value\n    , 'institutional' AS claim_type\n    , 'DIAGNOSIS_CODE_1' AS field_name\n    , case when cg.frequency > 1                then 'multiple'\n          when term.icd_10_cm is not null      then 'valid'\n          when m.diagnosis_code_1 is not null  then 'invalid'\n        else 'null'\n    end as bucket_name\n    , case\n        when cg.frequency = 1\n            and m.diagnosis_code_1 is not null\n            and term.icd_10_cm is null\n            then 'Diagnosis Code is not in Terminology ICD_10_CM table'\n        else null\n    end as invalid_reason\n    , cast(\n  substr(agg.field_aggregated, 1, 255)\n as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom base m\nleft join claim_grain cg on m.claim_id = cg.claim_id and m.data_source = cg.data_source\nleft join tuva.terminology.icd_10_cm as term on m.diagnosis_code_1 = term.icd_10_cm\nleft join claim_agg agg on m.claim_id = agg.claim_id and m.data_source = agg.data_source", "relation_name": "tuva.data_quality.institutional_diagnosis_code_1"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.995635Z", "completed_at": "2025-02-25T21:26:17.005890Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.006117Z", "completed_at": "2025-02-25T21:26:17.006123Z"}], "thread_id": "Thread-3", "execution_time": 0.011537790298461914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__institutional_diagnosis_code_2", "compiled": true, "compiled_code": "\n\nwith base as (\n    select *\n    from tuva.input_layer.medical_claim\n    where claim_type = 'institutional'\n),\n\nunique_field as (\n    select distinct claim_id\n        , diagnosis_code_2 || '|' || coalesce(term.short_description, '') as field\n        , data_source\n    from base\n    left join tuva.terminology.icd_10_cm as term on base.diagnosis_code_2 = term.icd_10_cm\n),\n\nclaim_grain as (\n    select claim_id\n        , data_source\n        , count(*) as frequency\n    from unique_field\n    group by claim_id\n        , data_source\n),\n\nclaim_agg as (\nselect\n      claim_id\n    , data_source\n    , \n    listagg(\n        coalesce(field, 'null'),\n        ', '\n        )\n        within group (order by field desc) as field_aggregated\nfrom\n    unique_field\ngroup by\n      claim_id\n    , data_source\n\t)\n\nselect distinct -- to bring to claim_id grain\n      m.data_source\n    , coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'MEDICAL_CLAIM' AS table_name\n    , 'Claim ID' AS drill_down_key\n    , coalesce(m.claim_id, 'NULL') AS drill_down_value\n    , 'institutional' AS claim_type\n    , 'DIAGNOSIS_CODE_2' AS field_name\n    , case when cg.frequency > 1                then 'multiple'\n          when term.icd_10_cm is not null      then 'valid'\n          when m.diagnosis_code_2 is not null  then 'invalid'\n                                               else 'null' end as bucket_name\n    , case\n        when cg.frequency = 1\n            and m.diagnosis_code_2 is not null\n            and term.icd_10_cm is null\n            then 'Diagnosis Code is not in Terminology ICD_10_CM table'\n        else null\n    end as invalid_reason\n    , cast(\n  substr(agg.field_aggregated, 1, 255)\n as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom base m\nleft join claim_grain cg on m.claim_id = cg.claim_id and m.data_source = cg.data_source\nleft join tuva.terminology.icd_10_cm as term on m.diagnosis_code_2 = term.icd_10_cm\nleft join claim_agg agg on m.claim_id = agg.claim_id and m.data_source = agg.data_source", "relation_name": "tuva.data_quality.institutional_diagnosis_code_2"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.001537Z", "completed_at": "2025-02-25T21:26:17.007003Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.007406Z", "completed_at": "2025-02-25T21:26:17.007409Z"}], "thread_id": "Thread-2", "execution_time": 0.0063610076904296875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__institutional_diagnosis_code_3", "compiled": true, "compiled_code": "\n\nwith base as (\n    select *\n    from tuva.input_layer.medical_claim\n    where claim_type = 'institutional'\n),\n\nunique_field as (\n    select distinct claim_id\n        , diagnosis_code_3 || '|' || coalesce(term.short_description, '') as field\n        , data_source\n    from base\n    left join tuva.terminology.icd_10_cm as term on base.diagnosis_code_3 = term.icd_10_cm\n),\n\nclaim_grain as (\n    select claim_id\n        , data_source\n        , count(*) as frequency\n    from unique_field\n    group by claim_id\n        , data_source\n),\n\nclaim_agg as (\nselect\n      claim_id\n    , data_source\n    , \n    listagg(\n        coalesce(field, 'null'),\n        ', '\n        )\n        within group (order by field desc) as field_aggregated\nfrom\n    unique_field\ngroup by\n      claim_id\n    , data_source\n\t)\n\nselect distinct -- to bring to claim_id grain\n      m.data_source\n    , coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'MEDICAL_CLAIM' AS table_name\n    , 'Claim ID' AS drill_down_key\n    , coalesce(m.claim_id, 'NULL') AS drill_down_value\n    , 'institutional' AS claim_type\n    , 'DIAGNOSIS_CODE_3' AS field_name\n    , case when cg.frequency > 1                then 'multiple'\n          when term.icd_10_cm is not null      then 'valid'\n          when m.diagnosis_code_3 is not null  then 'invalid'\n                                               else 'null' end as bucket_name\n    , case\n        when cg.frequency = 1\n            and m.diagnosis_code_3 is not null\n            and term.icd_10_cm is null\n            then 'Diagnosis Code is not in Terminology ICD_10_CM table'\n        else null\n    end as invalid_reason\n    , cast(\n  substr(agg.field_aggregated, 1, 255)\n as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom base m\nleft join claim_grain cg on m.claim_id = cg.claim_id and m.data_source = cg.data_source\nleft join tuva.terminology.icd_10_cm as term on m.diagnosis_code_3 = term.icd_10_cm\nleft join claim_agg agg on m.claim_id = agg.claim_id and m.data_source = agg.data_source", "relation_name": "tuva.data_quality.institutional_diagnosis_code_3"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.007757Z", "completed_at": "2025-02-25T21:26:17.017012Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.017241Z", "completed_at": "2025-02-25T21:26:17.017246Z"}], "thread_id": "Thread-3", "execution_time": 0.010554790496826172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__institutional_discharge_disposition_code", "compiled": true, "compiled_code": "\n\nwith base as (\n    select *\n    from tuva.input_layer.medical_claim\n    where claim_type = 'institutional'\n),\n\nunique_field as (\n    select distinct claim_id\n        , base.discharge_disposition_code || '|' || coalesce(term.discharge_disposition_description, '') as field\n        , data_source\n    from base\n    left join tuva.terminology.discharge_disposition as term on base.discharge_disposition_code = term.discharge_disposition_code\n),\n\nclaim_grain as (\n    select claim_id\n        , data_source\n        , count(*) as frequency\n    from unique_field\n    group by claim_id\n        , data_source\n),\n\nclaim_agg as (\nselect\n      claim_id\n    , data_source\n    , \n    listagg(\n        coalesce(field, 'null'),\n        ', '\n        )\n        within group (order by field desc) as field_aggregated\nfrom\n    unique_field\ngroup by\n      claim_id\n    , data_source\n\t)\n\nselect distinct -- to bring to claim_id grain\n      m.data_source\n    , coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'MEDICAL_CLAIM' AS table_name\n    , 'Claim ID' AS drill_down_key\n    , coalesce(m.claim_id, 'NULL') AS drill_down_value\n    , 'institutional' AS claim_type\n    , 'DISCHARGE_DISPOSITION_CODE' AS field_name\n    , case when cg.frequency > 1                then 'multiple'\n          when term.discharge_disposition_code is not null then 'valid'\n          when m.discharge_disposition_code is not null    then 'invalid'\n                                               else 'null' end as bucket_name\n    , case\n        when cg.frequency = 1\n            and m.discharge_disposition_code is not null\n            and term.discharge_disposition_code is null\n            then 'Discharge Disposition Code does not join to Terminology Discharge_Disposition Table'\n        else null\n    end as invalid_reason\n    , cast(\n  substr(agg.field_aggregated, 1, 255)\n as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom base m\nleft join claim_grain cg on m.claim_id = cg.claim_id and m.data_source = cg.data_source\nleft join tuva.terminology.discharge_disposition as term on m.discharge_disposition_code = term.discharge_disposition_code\nleft join claim_agg agg on m.claim_id = agg.claim_id and m.data_source = agg.data_source", "relation_name": "tuva.data_quality.institutional_discharge_disposition_code"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.012936Z", "completed_at": "2025-02-25T21:26:17.017873Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.018311Z", "completed_at": "2025-02-25T21:26:17.018315Z"}], "thread_id": "Thread-2", "execution_time": 0.005863189697265625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__institutional_facility_npi", "compiled": true, "compiled_code": "\n\nwith base as (\n    select *\n    from tuva.input_layer.medical_claim\n    where claim_type = 'institutional'\n),\nunique_field as (\n    select distinct claim_id\n        ,cast(facility_npi as TEXT) as field\n        ,data_source\n    from base\n),\nclaim_grain as (\n    select claim_id\n        ,data_source\n        ,count(*) as frequency\n    from unique_field\n    group by claim_id\n        ,data_source\n),\nclaim_agg as (\nselect\n    claim_id,\n    data_source,\n    \n    listagg(\n        coalesce(field, 'null'),\n        ', '\n        )\n        within group (order by field desc) as field_aggregated\nfrom\n    unique_field\ngroup by\n    claim_id,\n    data_source\n\t)\nselect distinct -- to bring to claim_id grain\n    m.data_source\n    ,coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'MEDICAL_CLAIM' AS table_name\n    ,'Claim ID' AS drill_down_key\n    ,coalesce(m.claim_id, 'NULL') AS drill_down_value\n    ,'institutional' AS claim_type\n    ,'FACILITY_NPI' AS field_name\n    ,case when cg.frequency > 1                then 'multiple'\n          when term.npi is not null then 'valid'\n          when m.facility_npi is not null    then 'invalid'\n                                               else 'null' end as bucket_name\n    ,case\n        when cg.frequency = 1\n            and m.facility_npi is not null\n            and term.npi is null\n            then 'NPI not in Terminology Provider Table'\n        else null\n    end as invalid_reason\n    ,cast(\n  substr(agg.field_aggregated, 1, 255)\n as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom base m\nleft join claim_grain cg on m.claim_id = cg.claim_id and m.data_source = cg.data_source\nleft join tuva.terminology.provider as term on m.facility_npi = term.npi\nleft join claim_agg agg on m.claim_id = agg.claim_id and m.data_source = agg.data_source", "relation_name": "tuva.data_quality.institutional_facility_npi"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.019112Z", "completed_at": "2025-02-25T21:26:17.028437Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.028671Z", "completed_at": "2025-02-25T21:26:17.028676Z"}], "thread_id": "Thread-3", "execution_time": 0.010667085647583008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__institutional_present_on_admission_1", "compiled": true, "compiled_code": "\n\nwith base as (\n    select *\n    from tuva.input_layer.medical_claim\n    where claim_type = 'institutional'\n\n),\nunique_field as (\n    select distinct claim_id\n        ,cast(diagnosis_poa_1 as TEXT)  as field\n        ,data_source\n    from base\n\n),\nclaim_grain as (\n    select claim_id\n        ,data_source\n        ,count(*) as frequency\n    from unique_field\n    group by claim_id\n        ,data_source\n),\nclaim_agg as (\nselect\n    claim_id,\n    data_source,\n    \n    listagg(\n        coalesce(field, 'null'),\n        ', '\n        )\n        within group (order by field desc) as field_aggregated\nfrom\n    unique_field\ngroup by\n    claim_id,\n    data_source\n\t)\nselect distinct -- to bring to claim_id grain\n    m.data_source\n    ,coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'MEDICAL_CLAIM' AS table_name\n    ,'Claim ID' AS drill_down_key\n    ,coalesce(m.claim_id, 'NULL') AS drill_down_value\n    ,'institutional' AS claim_type\n    ,'DIAGNOSIS_POA_1' AS field_name\n       ,case when cg.frequency > 1                then 'multiple'\n        when m.diagnosis_poa_1 in ('y','n')       then 'valid'\n        when m.diagnosis_poa_1 is null            then 'null'\n                                                  else 'invalid' end as bucket_name\n    ,cast(null as TEXT) as invalid_reason\n    ,cast(\n  substr(agg.field_aggregated, 1, 255)\n as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom base m\nleft join claim_grain cg on m.claim_id = cg.claim_id and m.data_source = cg.data_source\nleft join claim_agg agg on m.claim_id = agg.claim_id and m.data_source = agg.data_source", "relation_name": "tuva.data_quality.institutional_present_on_admission_1"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.023536Z", "completed_at": "2025-02-25T21:26:17.029559Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.029967Z", "completed_at": "2025-02-25T21:26:17.029970Z"}], "thread_id": "Thread-2", "execution_time": 0.006961822509765625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__institutional_present_on_admission_2", "compiled": true, "compiled_code": "\n\nwith base as (\n    select *\n    from tuva.input_layer.medical_claim\n    where claim_type = 'institutional'\n),\nunique_field as (\n    select distinct claim_id\n        ,cast(diagnosis_poa_2 as TEXT)  as field\n        ,data_source\n    from base\n\n),\nclaim_grain as (\n    select claim_id\n        ,data_source\n        ,count(*) as frequency\n    from unique_field\n    group by claim_id\n        ,data_source\n),\nclaim_agg as (\nselect\n    claim_id,\n    data_source,\n    \n    listagg(\n        coalesce(field, 'null'),\n        ', '\n        )\n        within group (order by field desc) as field_aggregated\nfrom\n    unique_field\ngroup by\n    claim_id,\n    data_source\n\t)\nselect distinct -- to bring to claim_id grain\n    m.data_source\n    ,coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'MEDICAL_CLAIM' AS table_name\n    ,'Claim ID' AS drill_down_key\n    ,coalesce(m.claim_id, 'NULL') AS drill_down_value\n    ,'institutional' AS claim_type\n    ,'DIAGNOSIS_POA_2' AS field_name\n       ,case when cg.frequency > 1                then 'multiple'\n        when m.diagnosis_poa_2 in ('y','n')       then 'valid'\n        when m.diagnosis_poa_2 is null            then 'null'\n                                                  else 'invalid' end as bucket_name\n    ,cast(null as TEXT) as invalid_reason\n    ,cast(\n  substr(agg.field_aggregated, 1, 255)\n as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom base m\nleft join claim_grain cg on m.claim_id = cg.claim_id and m.data_source = cg.data_source\nleft join claim_agg agg on m.claim_id = agg.claim_id and m.data_source = agg.data_source", "relation_name": "tuva.data_quality.institutional_present_on_admission_2"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.030319Z", "completed_at": "2025-02-25T21:26:17.039128Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.039340Z", "completed_at": "2025-02-25T21:26:17.039344Z"}], "thread_id": "Thread-3", "execution_time": 0.010066032409667969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__institutional_present_on_admission_3", "compiled": true, "compiled_code": "\n\nwith base as (\n    select *\n    from tuva.input_layer.medical_claim\n    where claim_type = 'institutional'\n),\nunique_field as (\n    select distinct claim_id\n        ,cast(diagnosis_poa_3 as TEXT)  as field\n        ,data_source\n    from base\n\n),\nclaim_grain as (\n    select claim_id\n        ,data_source\n        ,count(*) as frequency\n    from unique_field\n    group by claim_id\n        ,data_source\n),\nclaim_agg as (\nselect\n    claim_id,\n    data_source,\n    \n    listagg(\n        coalesce(field, 'null'),\n        ', '\n        )\n        within group (order by field desc) as field_aggregated\nfrom\n    unique_field\ngroup by\n    claim_id,\n    data_source\n\t)\nselect distinct -- to bring to claim_id grain\n    m.data_source\n    ,coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'MEDICAL_CLAIM' AS table_name\n    ,'Claim ID' AS drill_down_key\n    ,coalesce(m.claim_id, 'NULL') AS drill_down_value\n    ,'institutional' AS claim_type\n    ,'DIAGNOSIS_POA_3' AS field_name\n       ,case when cg.frequency > 1                then 'multiple'\n        when m.diagnosis_poa_3 in ('y','n')       then 'valid'\n        when m.diagnosis_poa_3 is null            then 'null'\n                                                  else 'invalid' end as bucket_name\n    ,cast(null as TEXT) as invalid_reason\n    ,cast(\n  substr(agg.field_aggregated, 1, 255)\n as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom base m\nleft join claim_grain cg on m.claim_id = cg.claim_id and m.data_source = cg.data_source\nleft join claim_agg agg on m.claim_id = agg.claim_id and m.data_source = agg.data_source", "relation_name": "tuva.data_quality.institutional_present_on_admission_3"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.035129Z", "completed_at": "2025-02-25T21:26:17.039948Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.040376Z", "completed_at": "2025-02-25T21:26:17.040379Z"}], "thread_id": "Thread-2", "execution_time": 0.005731821060180664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__institutional_rendering_npi", "compiled": true, "compiled_code": "\n\nwith base as (\n    select *\n    from tuva.input_layer.medical_claim\n    where claim_type = 'institutional'\n),\nunique_field as (\n    select distinct claim_id\n        ,cast(facility_npi as TEXT) as field\n        ,data_source\n    from base\n),\nclaim_grain as (\n    select claim_id\n        ,data_source\n        ,count(*) as frequency\n    from unique_field\n    group by claim_id\n        ,data_source\n),\nclaim_agg as (\nselect\n    claim_id,\n    data_source,\n    \n    listagg(\n        coalesce(field, 'null'),\n        ', '\n        )\n        within group (order by field desc) as field_aggregated\nfrom\n    unique_field\ngroup by\n    claim_id,\n    data_source\n\t)\nselect distinct -- to bring to claim_id grain\n    m.data_source\n    ,coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'MEDICAL_CLAIM' AS table_name\n    ,'Claim ID' AS drill_down_key\n    ,coalesce(m.claim_id, 'NULL') AS drill_down_value\n    ,'institutional' AS claim_type\n    ,'RENDERING_NPI' AS field_name\n    ,case when cg.frequency > 1                then 'multiple'\n          when term.npi is not null            then 'valid'\n          when m.rendering_npi is not null      then 'invalid'\n                                               else 'null' end as bucket_name\n    ,case\n        when cg.frequency = 1\n            and m.rendering_npi is not null\n            and term.npi is null\n        then 'provider npi does not join to terminology provider table'\n        else null\n    end as invalid_reason\n    ,cast(\n  substr(agg.field_aggregated, 1, 255)\n as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom base m\nleft join claim_grain cg on m.claim_id = cg.claim_id and m.data_source = cg.data_source\nleft join tuva.terminology.provider as term on m.rendering_npi = term.npi\nleft join claim_agg agg on m.claim_id = agg.claim_id and m.data_source = agg.data_source", "relation_name": "tuva.data_quality.institutional_rendering_npi"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.041159Z", "completed_at": "2025-02-25T21:26:17.050652Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.051010Z", "completed_at": "2025-02-25T21:26:17.051018Z"}], "thread_id": "Thread-3", "execution_time": 0.010938882827758789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__institutional_revenue_center_code", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'MEDICAL_CLAIM' AS table_name\n    , 'Claim ID | Claim Line Number' AS drill_down_key\n    , coalesce(cast(m.claim_id as TEXT), 'null') || '|' || coalesce(cast(m.claim_line_number as TEXT), 'null') as drill_down_value\n    , 'institutional' AS claim_type\n    , 'REVENUE_CENTER_CODE' AS field_name\n    , case\n          when term.revenue_center_code is not null then 'valid'\n          when m.revenue_center_code is not null    then 'invalid'\n                                                    else 'null' end as bucket_name\n    , case\n        when m.revenue_center_code is not null\n            and term.revenue_center_code is null\n            then 'Revenue center code does not join to Terminology Revenue Center table'\n        else null\n    end as invalid_reason\n    , m.revenue_center_code || '|' || coalesce(term.revenue_center_description, '') as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\n    from tuva.input_layer.medical_claim m\nleft join tuva.terminology.revenue_center as term on m.revenue_center_code = term.revenue_center_code", "relation_name": "tuva.data_quality.institutional_revenue_center_code"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.045891Z", "completed_at": "2025-02-25T21:26:17.052123Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.055961Z", "completed_at": "2025-02-25T21:26:17.055966Z"}], "thread_id": "Thread-2", "execution_time": 0.010718822479248047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__institutional_service_unit_quantity", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'MEDICAL_CLAIM' AS table_name\n    , 'Claim ID | Claim Line Number' AS drill_down_key\n    , coalesce(cast(m.claim_id as TEXT), 'null') || '|' || coalesce(cast(m.claim_line_number as TEXT), 'null') as drill_down_value\n    , m.claim_type as claim_type\n    , 'service_unit_quantity' as field_name\n    , case when m.service_unit_quantity is null then 'null'\n                                    else 'valid' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(service_unit_quantity as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.medical_claim m", "relation_name": "tuva.data_quality.institutional_service_unit_quantity"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.052323Z", "completed_at": "2025-02-25T21:26:17.057099Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.061037Z", "completed_at": "2025-02-25T21:26:17.061043Z"}], "thread_id": "Thread-3", "execution_time": 0.009443044662475586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__medical_claim_claim_line_fields", "compiled": true, "compiled_code": "\n\nwith medical_claim as (\n  select\n      m.claim_id\n    , max(case when hcpc.hcpcs is null and m.hcpcs_code is not null then 1 else 0 end) as invalid_hcpcs_code\n    , max(case when m.claim_type = 'professional' and pos.place_of_service_code is null and m.place_of_service_code is not null then 1 else 0 end) as invalid_place_of_service_code\n    , max(case when m.claim_type = 'institutional' and rev.revenue_center_code is null and m.revenue_center_code is not null then 1 else 0 end) as invalid_revenue_center_code\n    , max(case when m.hcpcs_code is null then 1 else 0 end) as missing_hcpcs_code\n    , max(case when m.claim_type = 'professional' and m.place_of_service_code is null then 1 else 0 end) as missing_place_of_service_code\n    , max(case when m.claim_type = 'institutional' and m.revenue_center_code is null then 1 else 0 end) as missing_revenue_center_code\n  from tuva.input_layer.medical_claim as m\n  left join tuva.terminology.hcpcs_level_2 as hcpc\n    on m.hcpcs_code = hcpc.hcpcs\n  left join tuva.terminology.place_of_service as pos\n    on m.place_of_service_code = pos.place_of_service_code\n  left join tuva.terminology.revenue_center as rev\n    on m.revenue_center_code = rev.revenue_center_code\n  group by m.claim_id\n)\n\n, final as (\n  select\n      'invalid hcpcs_code' as data_quality_check\n    , sum(invalid_hcpcs_code) as result_count\n  from medical_claim\n  \n  union all\n\n  select\n      'invalid place_of_service_code' as data_quality_check\n    , sum(invalid_place_of_service_code) as result_count\n  from medical_claim\n\n  union all\n\n  select\n      'invalid revenue_center_code' as data_quality_check\n    , sum(invalid_revenue_center_code) as result_count\n  from medical_claim\n\n  union all\n\n  select\n      'missing hcpcs_code' as data_quality_check\n    , sum(missing_hcpcs_code) as result_count\n  from medical_claim\n\n  union all\n\n  select\n      'missing place_of_service_code' as data_quality_check\n    , sum(missing_place_of_service_code) as result_count\n  from medical_claim\n\n  union all\n\n  select\n      'missing revenue_center_code' as data_quality_check\n    , sum(missing_revenue_center_code) as result_count\n  from medical_claim\n)\n\nselect\n    *\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom final", "relation_name": "tuva.data_quality.medical_claim_claim_line_fields"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.057292Z", "completed_at": "2025-02-25T21:26:17.062299Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.066334Z", "completed_at": "2025-02-25T21:26:17.066339Z"}], "thread_id": "Thread-2", "execution_time": 0.00972604751586914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__medical_claim_provider_npi", "compiled": true, "compiled_code": "\n\nwith medical_claim as (\n    select\n        m.claim_id\n      , max(case when term.npi is null and m.rendering_npi is not null then 1 else 0 end) as invalid_rendering_npi\n      , max(case when term2.npi is null and m.billing_npi is not null then 1 else 0 end) as invalid_billing_npi\n      , max(case when term3.npi is null and m.facility_npi is not null then 1 else 0 end) as invalid_facility_npi\n\n      , max(case when m.rendering_npi is null then 1 else 0 end) as missing_rendering_npi\n      , max(case when m.billing_npi is null then 1 else 0 end) as missing_billing_npi\n      , max(case when m.facility_npi is null then 1 else 0 end) as missing_facility_npi\n\n      , count(distinct m.rendering_npi) as rendering_npi_count\n      , count(distinct m.billing_npi) as billing_npi_count\n      , count(distinct m.facility_npi) as facility_npi_count\n\n      , max(case when term.entity_type_code = '2' then 1 else 0 end) as wrong_entity_type_rendering_npi\n      , max(case when term3.entity_type_code = '1' then 1 else 0 end) as wrong_entity_type_facility_npi\n\n    from tuva.input_layer.medical_claim as m\n    left join tuva.terminology.provider as term\n      on m.rendering_npi = term.npi\n    left join tuva.terminology.provider as term2\n      on m.billing_npi  = term2.npi\n    left join tuva.terminology.provider as term3\n      on m.facility_npi = term3.npi\n    group by\n        m.claim_id\n)\n\n,final as (\nselect\n    'invalid rendering_npi' as data_quality_check\n  , sum(invalid_rendering_npi) as result_count\nfrom medical_claim\n\nunion all\n\nselect\n    'invalid billing_npi' as data_quality_check\n  , sum(invalid_billing_npi) as result_count\nfrom medical_claim\n\nunion all\n\nselect\n    'invalid facility_npi' as data_quality_check\n  , sum(invalid_facility_npi) as result_count\nfrom medical_claim\n\nunion all\n\nselect\n    'missing rendering_npi' as data_quality_check\n  , sum(missing_rendering_npi) as result_count\nfrom medical_claim\n\nunion all\n\nselect\n    'missing billing_npi' as data_quality_check\n  , sum(missing_billing_npi) as result_count\nfrom medical_claim\n\nunion all\n\nselect\n    'missing facility_npi' as data_quality_check\n  , sum(missing_facility_npi) as result_count\nfrom medical_claim\n\nunion all\n\nselect\n    'wrong entity type rendering_npi' as data_quality_check\n  , sum(wrong_entity_type_rendering_npi) as result_count\nfrom medical_claim\n\nunion all\n\nselect\n    'wrong entity type facility_npi' as data_quality_check\n  , sum(wrong_entity_type_facility_npi) as result_count\nfrom medical_claim\n\nunion all\n\nselect\n    'multiple rendering_npi values' as data_quality_check\n  , count(distinct claim_id) as result_count\nfrom medical_claim\nwhere rendering_npi_count > 1\n\nunion all\n\nselect\n    'multiple billing_npi values' as data_quality_check\n  , count(distinct claim_id) as result_count\nfrom medical_claim\nwhere billing_npi_count > 1\n\nunion all\n\nselect\n    'multiple facility_npi values' as data_quality_check\n  , count(distinct claim_id) as result_count\nfrom medical_claim\nwhere facility_npi_count > 1\n)\n\nselect *\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom final", "relation_name": "tuva.data_quality.medical_claim_provider_npi"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.062498Z", "completed_at": "2025-02-25T21:26:17.067510Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.071755Z", "completed_at": "2025-02-25T21:26:17.071760Z"}], "thread_id": "Thread-3", "execution_time": 0.009961128234863281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__medical_claim_volume_and_dollars", "compiled": true, "compiled_code": "\n\nwith range_cte as (\n  select\n      min(claim_start_date) as first_date\n    \n      , current_date as last_date\n    \n  from tuva.input_layer.medical_claim p\n)\n\n, date_cte as (\n  select distinct\n      year_month_int\n  from tuva.reference_data.calendar c\n  inner join range_cte r\n    on c.full_date between r.first_date and r.last_date\n)\n\n, medical_claim as (\n  select\n      c.year_month_int\n    , count(distinct p.claim_id) as claim_volume\n    , sum(p.paid_amount) as paid_amount\n  from tuva.input_layer.medical_claim p\n  left join tuva.reference_data.calendar c\n    on p.claim_start_date = c.full_date\n  group by\n      c.year_month_int\n)\n\nselect\n    d.year_month_int as year_month\n  , coalesce(claim_volume, 0) as claim_volume\n  , coalesce(paid_amount, 0) as paid_amount\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom date_cte d\nleft join medical_claim m\n  on d.year_month_int = m.year_month_int", "relation_name": "tuva.data_quality.medical_claim_volume_and_dollars"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.067691Z", "completed_at": "2025-02-25T21:26:17.072874Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.080099Z", "completed_at": "2025-02-25T21:26:17.080104Z"}], "thread_id": "Thread-2", "execution_time": 0.013097047805786133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__professional_billing_npi", "compiled": true, "compiled_code": "\n\nwith base as (\n    select *\n    from tuva.input_layer.medical_claim\n    where claim_type = 'professional'\n)\n\nselect\n      m.data_source\n    , coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'MEDICAL_CLAIM' AS table_name\n    , 'Claim ID | Claim Line Number' AS drill_down_key\n    , coalesce(cast(m.claim_id as TEXT), 'null') || '|' || coalesce(cast(m.claim_line_number as TEXT), 'null') as drill_down_value\n    , 'professional' AS claim_type\n    , 'BILLING_NPI' AS field_name\n    , case when term.npi is not null          then        'valid'\n          when m.billing_npi is not null    then 'invalid'\n                                             else 'null' end as bucket_name\n    , case\n        when m.billing_npi is not null\n            and term.npi is null\n            then 'Billing NPI does not join to Terminology Provider Table'\n        else null\n    end as invalid_reason\n    , cast(m.billing_npi as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom base m\nleft join tuva.terminology.provider as term on m.billing_npi = term.npi", "relation_name": "tuva.data_quality.professional_billing_npi"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.073072Z", "completed_at": "2025-02-25T21:26:17.081262Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.087156Z", "completed_at": "2025-02-25T21:26:17.087163Z"}], "thread_id": "Thread-3", "execution_time": 0.014779090881347656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__professional_claim_end_date", "compiled": true, "compiled_code": "\n\nwith base as (\n    select *\n    from tuva.input_layer.medical_claim\n    where claim_type = 'professional'\n)\n, tuva_last_run as(\n    select cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) as tuva_last_run\n)\n ,unique_field as (\n    select distinct claim_id\n        ,cast(claim_end_date as TEXT) as field\n        ,data_source\n    from base\n),\nclaim_grain as (\n    select claim_id\n        ,data_source\n        ,count(*) as frequency\n    from unique_field\n    group by claim_id\n        ,data_source\n),\nclaim_agg as (\nselect\n    claim_id,\n    data_source,\n    \n    listagg(\n        coalesce(field, 'null'),\n        ', '\n        )\n        within group (order by field desc) as field_aggregated\nfrom\n    unique_field\ngroup by\n    claim_id,\n    data_source\n\t)\nselect\n    m.data_source\n    ,coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'MEDICAL_CLAIM' AS table_name\n    ,'Claim ID' AS drill_down_key\n    ,coalesce(m.claim_id,'NULL') AS drill_down_value\n    ,'professional' AS claim_type\n    ,'CLAIM_END_DATE' AS field_name\n    ,case\n        when cg.frequency > 1 then 'multiple'\n        when m.claim_end_date > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'invalid'\n        when m.claim_end_date < \n\n    dateadd(\n        year,\n        -10,\n        cte.tuva_last_run\n        )\n\n then 'invalid'\n        when m.claim_end_date < m.claim_start_date then 'invalid'\n        when m.claim_end_date is null then 'null'\n        else 'valid'\n    end as bucket_name\n    ,case\n        when cg.frequency > 1 then 'multiple'\n        when m.claim_end_date > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'future'\n        when m.claim_end_date < \n\n    dateadd(\n        year,\n        -10,\n        cte.tuva_last_run\n        )\n\n then 'too old'\n        when m.claim_end_date < m.claim_start_date then 'claim end date before start date'\n        when m.claim_end_date is null then null\n        else 'valid'\n    end as invalid_reason\n    ,cast(\n  substr(agg.field_aggregated, 1, 255)\n as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom base m\nleft join claim_grain cg on m.claim_id = cg.claim_id and m.data_source = cg.data_source\nleft join claim_agg agg on m.claim_id = agg.claim_id and m.data_source = agg.data_source\ncross join tuva_last_run cte", "relation_name": "tuva.data_quality.professional_claim_end_date"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.081450Z", "completed_at": "2025-02-25T21:26:17.094244Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.094497Z", "completed_at": "2025-02-25T21:26:17.094504Z"}], "thread_id": "Thread-2", "execution_time": 0.013751029968261719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__professional_claim_start_date", "compiled": true, "compiled_code": "\n\nwith base as (\n    select *\n    from tuva.input_layer.medical_claim\n    where claim_type = 'professional'\n)\n, tuva_last_run as(\n    select cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) as tuva_last_run\n)\n, unique_field as (\n    select distinct claim_id\n        ,cast(claim_start_date as TEXT) as field\n        ,data_source\n    from base\n),\nclaim_grain as (\n    select claim_id\n        ,data_source\n        ,count(*) as frequency\n    from unique_field\n    group by claim_id\n        ,data_source\n),\nclaim_agg as (\nselect\n    claim_id,\n    data_source,\n    \n    listagg(\n        coalesce(field, 'null'),\n        ', '\n        )\n        within group (order by field desc) as field_aggregated\nfrom\n    unique_field\ngroup by\n    claim_id,\n    data_source\n\t)\nselect\n    m.data_source\n    ,coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'MEDICAL_CLAIM' AS table_name\n    ,'Claim ID' AS drill_down_key\n    ,coalesce(m.claim_id,'NULL') AS drill_down_value\n    ,'professional' AS claim_type\n    ,'CLAIM_START_DATE' AS field_name\n    ,case\n        when cg.frequency > 1 then 'multiple'\n        when m.claim_start_date > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'invalid'\n        when m.claim_start_date < \n\n    dateadd(\n        year,\n        -10,\n        cte.tuva_last_run\n        )\n\n then 'invalid'\n        when m.claim_start_date is null then 'null'\n        else 'valid'\n    end as bucket_name\n    ,case\n        when cg.frequency > 1 then 'multiple'\n        when m.claim_start_date > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'future'\n        when m.claim_start_date < \n\n    dateadd(\n        year,\n        -10,\n        cte.tuva_last_run\n        )\n\n then 'too old'\n        else null\n    end as invalid_reason\n    ,cast(\n  substr(agg.field_aggregated, 1, 255)\n as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom base m\nleft join claim_grain cg on m.claim_id = cg.claim_id and m.data_source = cg.data_source\nleft join claim_agg agg on m.claim_id = agg.claim_id and m.data_source = agg.data_source\ncross join tuva_last_run cte", "relation_name": "tuva.data_quality.professional_claim_start_date"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.089517Z", "completed_at": "2025-02-25T21:26:17.096120Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.102078Z", "completed_at": "2025-02-25T21:26:17.102086Z"}], "thread_id": "Thread-3", "execution_time": 0.013509273529052734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__professional_diagnosis_code_1", "compiled": true, "compiled_code": "\n\nwith base as (\n    select *\n    from tuva.input_layer.medical_claim\n    where claim_type = 'professional'\n)\n\nselect\n      m.data_source\n    , coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'MEDICAL_CLAIM' AS table_name\n    , 'Claim ID | Claim Line Number' AS drill_down_key\n    , coalesce(cast(m.claim_id as TEXT), 'null') || '|' || coalesce(cast(m.claim_line_number as TEXT), 'null') as drill_down_value\n    , 'professional' AS claim_type\n    , 'DIAGNOSIS_CODE_1' AS field_name\n    , case when term.icd_10_cm is not null          then 'valid'\n          when m.diagnosis_code_1 is not null      then 'invalid'\n                                                   else 'null' end as bucket_name\n    , case\n        when m.diagnosis_code_1 is not null\n            and term.icd_10_cm is null\n            then 'Diagnosis Code does not join to Terminology ICD_10_CM table'\n        else null\n    end as invalid_reason\n    , m.diagnosis_code_1 || '|' || coalesce(term.short_description, '') as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom base m\nleft join tuva.terminology.icd_10_cm as term on m.diagnosis_code_1 = term.icd_10_cm", "relation_name": "tuva.data_quality.professional_diagnosis_code_1"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.097269Z", "completed_at": "2025-02-25T21:26:17.105741Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.106202Z", "completed_at": "2025-02-25T21:26:17.106208Z"}], "thread_id": "Thread-2", "execution_time": 0.011075258255004883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__professional_diagnosis_code_2", "compiled": true, "compiled_code": "\n\nwith base as (\n    select *\n    from tuva.input_layer.medical_claim\n    where claim_type = 'professional'\n)\n\nselect\n      m.data_source\n    , coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'MEDICAL_CLAIM' AS table_name\n    , 'Claim ID | Claim Line Number' AS drill_down_key\n    , coalesce(cast(m.claim_id as TEXT), 'null') || '|' || coalesce(cast(m.claim_line_number as TEXT), 'null') as drill_down_value\n    , 'professional' AS claim_type\n    , 'DIAGNOSIS_CODE_2' AS field_name\n    , case when term.icd_10_cm is not null          then 'valid'\n          when m.diagnosis_code_2 is not null      then 'invalid'\n                                                   else 'null' end as bucket_name\n    , case\n        when m.diagnosis_code_2 is not null\n            and term.icd_10_cm is null\n            then 'Diagnosis Code does not join to Terminology ICD_10_CM table'\n        else null\n    end as invalid_reason\n    , m.diagnosis_code_2 || '|' || coalesce(term.short_description, '') as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom base m\nleft join tuva.terminology.icd_10_cm as term on m.diagnosis_code_2 = term.icd_10_cm", "relation_name": "tuva.data_quality.professional_diagnosis_code_2"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.106598Z", "completed_at": "2025-02-25T21:26:17.118221Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.118615Z", "completed_at": "2025-02-25T21:26:17.118623Z"}], "thread_id": "Thread-3", "execution_time": 0.013280868530273438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__professional_diagnosis_code_3", "compiled": true, "compiled_code": "\n\nwith base as (\n    select *\n    from tuva.input_layer.medical_claim\n    where claim_type = 'professional'\n)\n\nselect\n      m.data_source\n    , coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'MEDICAL_CLAIM' AS table_name\n    , 'Claim ID | Claim Line Number' AS drill_down_key\n    , coalesce(cast(m.claim_id as TEXT), 'null') || '|' || coalesce(cast(m.claim_line_number as TEXT), 'null') as drill_down_value\n    , 'professional' AS claim_type\n    , 'DIAGNOSIS_CODE_3' AS field_name\n    , case when term.icd_10_cm is not null          then 'valid'\n          when m.diagnosis_code_3 is not null      then 'invalid'\n                                                   else 'null' end as bucket_name\n    , case\n        when m.diagnosis_code_3 is not null\n            and term.icd_10_cm is null\n            then 'Diagnosis Code does not join to Terminology ICD_10_CM table'\n        else null\n    end as invalid_reason\n    , m.diagnosis_code_3 || '|' || coalesce(term.short_description, '') as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom base m\nleft join tuva.terminology.icd_10_cm as term on m.diagnosis_code_3 = term.icd_10_cm", "relation_name": "tuva.data_quality.professional_diagnosis_code_3"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.119787Z", "completed_at": "2025-02-25T21:26:17.126057Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.126374Z", "completed_at": "2025-02-25T21:26:17.126380Z"}], "thread_id": "Thread-3", "execution_time": 0.0071468353271484375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__professional_place_of_service_code", "compiled": true, "compiled_code": "\n\nwith base as (\n    select *\n    from tuva.input_layer.medical_claim\n    where claim_type = 'professional'\n)\n\nselect\n      m.data_source\n    , coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'MEDICAL_CLAIM' AS table_name\n    , 'Claim ID | Claim Line Number' AS drill_down_key\n    , coalesce(cast(m.claim_id as TEXT), 'null') || '|' || coalesce(cast(m.claim_line_number as TEXT), 'null') as drill_down_value\n    , 'professional' AS claim_type\n    , 'PLACE_OF_SERVICE_CODE' AS field_name\n    , case when term.place_of_service_code is not null then 'valid'\n          when m.place_of_service_code is not null    then 'invalid'\n                                               else 'null' end as bucket_name\n    , case\n        when m.place_of_service_code is not null\n            and term.place_of_service_code is null\n            then 'Place of Service Code does not join to Terminology Place of Service table'\n        else null\n    end as invalid_reason\n    , m.place_of_service_code || '|' || coalesce(term.place_of_service_description, '') as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom base m\nleft join tuva.terminology.place_of_service as term on m.place_of_service_code = term.place_of_service_code", "relation_name": "tuva.data_quality.professional_place_of_service_code"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.113010Z", "completed_at": "2025-02-25T21:26:17.127609Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.128658Z", "completed_at": "2025-02-25T21:26:17.128664Z"}], "thread_id": "Thread-2", "execution_time": 0.016352176666259766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__professional_facility_npi", "compiled": true, "compiled_code": "\n\nwith base as (\n    select *\n    from tuva.input_layer.medical_claim\n    where claim_type = 'professional'\n)\n\nselect\n      m.data_source\n    , coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'MEDICAL_CLAIM' AS table_name\n    , 'Claim ID | Claim Line Number' AS drill_down_key\n    , coalesce(cast(m.claim_id as TEXT), 'null') || '|' || coalesce(cast(m.claim_line_number as TEXT), 'null') as drill_down_value\n    , 'professional' AS claim_type\n    , 'FACILITY_NPI' AS field_name\n    , case when term.npi is not null          then        'valid'\n          when m.facility_npi is not null    then 'invalid'\n                                             else 'null' end as bucket_name\n    , case\n        when m.facility_npi is not null\n            and term.npi is null\n            then 'Facility NPI does not join to Terminology Provider Table'\n        else null\n    end as invalid_reason\n    , cast(m.facility_npi as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom base m\nleft join tuva.terminology.provider as term on m.facility_npi = term.npi", "relation_name": "tuva.data_quality.professional_facility_npi"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.134693Z", "completed_at": "2025-02-25T21:26:17.143237Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.143506Z", "completed_at": "2025-02-25T21:26:17.143513Z"}], "thread_id": "Thread-3", "execution_time": 0.014373064041137695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__professional_rendering_npi", "compiled": true, "compiled_code": "\n\nwith base as (\n    select *\n    from tuva.input_layer.medical_claim\n    where claim_type = 'professional'\n)\n\nselect\n      m.data_source\n    , coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'MEDICAL_CLAIM' AS table_name\n    , 'Claim ID | Claim Line Number' AS drill_down_key\n    , coalesce(cast(m.claim_id as TEXT), 'null') || '|' || coalesce(cast(m.claim_line_number as TEXT), 'null') as drill_down_value\n    , 'professional' AS claim_type\n    , 'RENDERING_NPI' AS field_name\n    , case when term.npi is not null          then        'valid'\n          when m.rendering_npi is not null    then 'invalid'\n                                             else 'null' end as bucket_name\n    , case\n        when m.rendering_npi is not null\n            and term.npi is null\n            then 'Rendering Provider NPI does not join to Terminology Provider table'\n        else null\n    end as invalid_reason\n    , cast(m.rendering_npi as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom base m\nleft join tuva.terminology.provider as term on m.rendering_npi = term.npi", "relation_name": "tuva.data_quality.professional_rendering_npi"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.148517Z", "completed_at": "2025-02-25T21:26:17.152471Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.152915Z", "completed_at": "2025-02-25T21:26:17.152920Z"}], "thread_id": "Thread-2", "execution_time": 0.0049669742584228516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.medical_claim_expanded", "compiled": true, "compiled_code": "\n\n\nselect *\nfrom tuva.input_layer.medical_claim", "relation_name": "tuva.claims_expanded.medical_claim_expanded"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.157155Z", "completed_at": "2025-02-25T21:26:17.178711Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.178947Z", "completed_at": "2025-02-25T21:26:17.178952Z"}], "thread_id": "Thread-2", "execution_time": 0.022341012954711914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__claim_date_trends", "compiled": true, "compiled_code": "\n\nwith date_stage as(\n\n    select\n        date_field\n        , year || \n\n    case when 2 = 0\n        then ''\n    else\n        right(\n            '0' || month,\n            2\n        )\n    end as year_month\n        , result_count\n    from\n    (\n        select\n            'claim_start_date' as date_field\n            , cast(date_part('year', claim_start_date) as TEXT) as year\n            , cast(date_part('month', claim_start_date) as TEXT) as month\n            , count(distinct claim_id) as result_count\n        from tuva.input_layer.medical_claim\n        group by\n            cast(date_part('year', claim_start_date) as TEXT)\n            , cast(date_part('month', claim_start_date) as TEXT)\n    )x\n\n    union all\n\n    select\n        date_field\n        , year || \n\n    case when 2 = 0\n        then ''\n    else\n        right(\n            '0' || month,\n            2\n        )\n    end as year_month\n        , result_count\n    from\n    (\n        select\n            'claim_end_date' as date_field\n            , cast(date_part('year', claim_end_date) as TEXT) as year\n            , cast(date_part('month', claim_end_date) as TEXT) as month\n            , count(distinct claim_id) as result_count\n        from tuva.input_layer.medical_claim\n        group by\n            cast(date_part('year', claim_end_date) as TEXT)\n            , cast(date_part('month', claim_end_date) as TEXT)\n    )x\n\n    union all\n\n    select\n        date_field\n        , year || \n\n    case when 2 = 0\n        then ''\n    else\n        right(\n            '0' || month,\n            2\n        )\n    end as year_month\n        , result_count\n    from\n    (\n        select\n            'admission_date' as date_field\n            , cast(date_part('year', admission_date) as TEXT) as year\n            , cast(date_part('month', admission_date) as TEXT) as month\n            , count(distinct claim_id) as result_count\n        from tuva.input_layer.medical_claim\n        group by\n            cast(date_part('year', admission_date) as TEXT)\n            , cast(date_part('month', admission_date) as TEXT)\n    )x\n\n    union all\n\n    select\n        date_field\n        , year || \n\n    case when 2 = 0\n        then ''\n    else\n        right(\n            '0' || month,\n            2\n        )\n    end as year_month\n        , result_count\n    from\n    (\n        select\n            'discharge_date' as date_field\n            , cast(date_part('year', discharge_date) as TEXT) as year\n            , cast(date_part('month', discharge_date) as TEXT) as month\n            , count(distinct claim_id) as result_count\n        from tuva.input_layer.medical_claim\n        group by\n            cast(date_part('year', discharge_date) as TEXT)\n            , cast(date_part('month', discharge_date) as TEXT)\n    )x\n\n    union all\n\n    select\n        date_field\n        , year || \n\n    case when 2 = 0\n        then ''\n    else\n        right(\n            '0' || month,\n            2\n        )\n    end as year_month\n        , result_count\n    from\n    (\n        select\n            'medical paid_date' as date_field\n            , cast(date_part('year', paid_date) as TEXT) as year\n            , cast(date_part('month', paid_date) as TEXT) as month\n            , count(distinct claim_id) as result_count\n        from tuva.input_layer.medical_claim\n        group by\n            cast(date_part('year', paid_date) as TEXT)\n            , cast(date_part('month', paid_date) as TEXT)\n    )x\n\n    union all\n\n    select\n        date_field\n        , year || \n\n    case when 2 = 0\n        then ''\n    else\n        right(\n            '0' || month,\n            2\n        )\n    end as year_month\n        , result_count\n    from\n    (\n        select\n            'dispensing_date' as date_field\n            , cast(date_part('year', dispensing_date) as TEXT) as year\n            , cast(date_part('month', dispensing_date) as TEXT) as month\n            , count(distinct claim_id) as result_count\n        from tuva.input_layer.pharmacy_claim\n        group by\n            cast(date_part('year', dispensing_date) as TEXT)\n            , cast(date_part('month', dispensing_date) as TEXT)\n    )x\n\n    union all\n\n    select\n        date_field\n        , year || \n\n    case when 2 = 0\n        then ''\n    else\n        right(\n            '0' || month,\n            2\n        )\n    end as year_month\n        , result_count\n    from\n    (\n        select\n            'pharmacy paid_date' as date_field\n            , cast(date_part('year', paid_date) as TEXT) as year\n            , cast(date_part('month', paid_date) as TEXT) as month\n            , count(distinct claim_id) as result_count\n        from tuva.input_layer.pharmacy_claim\n        group by\n            cast(date_part('year', paid_date) as TEXT)\n            , cast(date_part('month', paid_date) as TEXT)\n    )x\n\n)\n\n\n, all_date_range as (\n    select distinct\n        replace(cal.year_month,'-','') as year_month\n    from tuva.reference_data.calendar cal\n    where (cal.year_month >= (select min(year_month) from date_stage)\n    and cal.year_month <= (select max(year_month) from date_stage))\n\n)\n\nselect\n    cast(all_date.year_month as integer ) as year_month\n    , coalesce(claim_start.result_count,0) as claim_start_date\n    , coalesce(claim_end.result_count,0) as claim_end_date\n    , coalesce(admission_date.result_count,0) as admission_date\n    , coalesce(discharge_date.result_count,0) as discharge_date\n    , coalesce(med_paid_date.result_count,0) as medical_paid_date\n    , coalesce(dispensing_date.result_count,0) as dispensing_date\n    , coalesce(pharm_paid_date.result_count,0) as pharmacy_paid_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom all_date_range all_date\nleft join date_stage claim_start\n    on all_date.year_month = claim_start.year_month\n    and claim_start.date_field = 'claim_start_date'\nleft join date_stage claim_end\n    on all_date.year_month = claim_end.year_month\n    and claim_end.date_field = 'claim_end_date'\nleft join date_stage admission_date\n    on all_date.year_month = admission_date.year_month\n    and admission_date.date_field = 'admission_date'\nleft join date_stage discharge_date\n    on all_date.year_month = discharge_date.year_month\n    and discharge_date.date_field = 'discharge_date'\nleft join date_stage med_paid_date\n    on all_date.year_month = med_paid_date.year_month\n    and med_paid_date.date_field = 'medical paid_date'\nleft join date_stage dispensing_date\n    on all_date.year_month = dispensing_date.year_month\n    and dispensing_date.date_field = 'dispensing_date'\nleft join date_stage pharm_paid_date\n    on all_date.year_month = pharm_paid_date.year_month\n    and pharm_paid_date.date_field = 'pharmacy paid_date'", "relation_name": "tuva.data_quality.claim_date_trends"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.175320Z", "completed_at": "2025-02-25T21:26:17.179819Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.180217Z", "completed_at": "2025-02-25T21:26:17.180221Z"}], "thread_id": "Thread-3", "execution_time": 0.005418062210083008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__claim_percent", "compiled": true, "compiled_code": "\n\n\nwith cte as \n(\nselect sum(paid_amount) as paid_amount\n,claim_type\nfrom tuva.input_layer.medical_claim\ngroup by claim_type\n\nunion all\n\nselect sum(paid_amount) as paid_amount\n,'pharmacy' as claim_type\nfrom tuva.input_layer.pharmacy_claim\n)\n\n,total_cte as \n(\nselect sum(paid_amount) as total_paid_amount\nfrom cte\n)\n\nselect claim_type\n,paid_amount/total_paid_amount as percent_of_total_paid\nfrom cte\ncross join total_cte", "relation_name": "tuva.data_quality.data_quality_claim_percent"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.180566Z", "completed_at": "2025-02-25T21:26:17.188366Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.188593Z", "completed_at": "2025-02-25T21:26:17.188599Z"}], "thread_id": "Thread-2", "execution_time": 0.00909113883972168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__pharmacy_allowed_amount", "compiled": true, "compiled_code": "\n\nSELECT DISTINCT -- to bring to claim_ID grain\n      m.data_source\n    , coalesce(cast(m.paid_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'PHARMACY_CLAIM' AS table_name\n    , 'Claim ID | Claim Line Number' AS drill_down_key\n    , coalesce(cast(m.claim_id as TEXT), 'null') || '|' || coalesce(cast(m.claim_line_number as TEXT), 'null') as drill_down_value\n    , 'PHARMACY' AS claim_type\n    , 'ALLOWED_AMOUNT' AS field_name\n    , case when m.allowed_amount is null          then        'null'\n                                              else 'valid' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(allowed_amount as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.pharmacy_claim m", "relation_name": "tuva.data_quality.pharmacy_allowed_amount"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.185377Z", "completed_at": "2025-02-25T21:26:17.189469Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.189869Z", "completed_at": "2025-02-25T21:26:17.189872Z"}], "thread_id": "Thread-3", "execution_time": 0.004972934722900391, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__pharmacy_claim_date_checks", "compiled": true, "compiled_code": "\n\nwith pharmacy_claim as (\n  select\n      claim_id\n    , max(case when paid_date is null then 1 else 0 end) as missing_paid_date\n    , max(case when dispensing_date is null then 1 else 0 end) as missing_dispensing_date\n  from tuva.input_layer.pharmacy_claim\n  group by\n      claim_id\n)\n\n, final as (\n  select\n      'missing pharmacy_claim paid_date' as data_quality_check\n    , sum(missing_paid_date) as result_count\n  from pharmacy_claim\n\n  union all\n\n  select\n      'missing dispensing_date' as data_quality_check\n    , sum(missing_dispensing_date) as result_count\n  from pharmacy_claim\n)\n\nselect\n    *\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom final", "relation_name": "tuva.data_quality.pharmacy_claim_date_checks"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.190223Z", "completed_at": "2025-02-25T21:26:17.199159Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.199370Z", "completed_at": "2025-02-25T21:26:17.199375Z"}], "thread_id": "Thread-2", "execution_time": 0.01018381118774414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__pharmacy_claim_id", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(cast(m.paid_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'PHARMACY_CLAIM' AS table_name\n    , 'Claim ID | Claim Line Number' AS drill_down_key\n    , coalesce(cast(m.claim_id as TEXT), 'null') || '|' || coalesce(cast(m.claim_line_number as TEXT), 'null') as drill_down_value\n    , 'PHARMACY' AS claim_type\n    , 'CLAIM_ID' AS field_name\n    , case\n        when m.claim_id is null then 'null' else 'valid' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(member_id as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.pharmacy_claim m", "relation_name": "tuva.data_quality.pharmacy_claim_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.195122Z", "completed_at": "2025-02-25T21:26:17.200241Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.200617Z", "completed_at": "2025-02-25T21:26:17.200621Z"}], "thread_id": "Thread-3", "execution_time": 0.0060122013092041016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__pharmacy_claim_line_number", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(cast(m.paid_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'PHARMACY_CLAIM' AS table_name\n    , 'Claim ID | Claim Line Number' AS drill_down_key\n    , coalesce(cast(m.claim_id as TEXT), 'null') || '|' || coalesce(cast(m.claim_line_number as TEXT), 'null') as drill_down_value\n    , 'PHARMACY' AS claim_type\n    , 'CLAIM_LINE_NUMBER' AS field_name\n    , case\n        when m.claim_line_number is null then 'null' else 'valid' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(member_id as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.pharmacy_claim m", "relation_name": "tuva.data_quality.pharmacy_claim_line_number"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.200960Z", "completed_at": "2025-02-25T21:26:17.208862Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.209105Z", "completed_at": "2025-02-25T21:26:17.209110Z"}], "thread_id": "Thread-2", "execution_time": 0.009176015853881836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__pharmacy_claim_ndc", "compiled": true, "compiled_code": "\n\nwith pharmacy_claim as (\n  select\n      claim_id\n    , max(case when term.ndc is null and m.ndc_code is not null then 1 else 0 end) as invalid_ndc\n    , max(case when m.ndc_code is null then 1 else 0 end) as missing_ndc\n  from tuva.input_layer.pharmacy_claim m\n  left join tuva.terminology.ndc as term\n    on m.ndc_code = term.ndc\n  group by\n      claim_id\n)\n\n, final as (\n  select\n      'missing ndc' as data_quality_check\n    , sum(missing_ndc) as result_count\n  from pharmacy_claim\n\n  union all\n\n  select\n      'invalid ndc' as data_quality_check\n    , sum(invalid_ndc) as result_count\n  from pharmacy_claim\n)\n\nselect\n    *\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom final", "relation_name": "tuva.data_quality.pharmacy_claim_ndc"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.205552Z", "completed_at": "2025-02-25T21:26:17.210034Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.210458Z", "completed_at": "2025-02-25T21:26:17.210462Z"}], "thread_id": "Thread-3", "execution_time": 0.005390167236328125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__pharmacy_claim_npi", "compiled": true, "compiled_code": "\n\nwith pharmacy_claim as (\n    select\n        m.claim_id\n      , max(case when term.npi is null and m.prescribing_provider_npi is not null then 1 else 0 end) as invalid_prescribing_npi\n      , max(case when m.prescribing_provider_npi is null then 1 else 0 end) as missing_prescribing_npi\n      , max(case when term.entity_type_code = '2' then 1 else 0 end) as wrong_entity_type_prescribing_npi\n      , max(case when term2.npi is null and m.dispensing_provider_npi is not null then 1 else 0 end) as invalid_dispensing_npi\n      , max(case when m.dispensing_provider_npi is null then 1 else 0 end) as missing_dispensing_npi\n      , max(case when term2.entity_type_code = '1' then 1 else 0 end) as wrong_entity_type_dispensing_npi\n    from tuva.input_layer.pharmacy_claim as m\n    left join tuva.terminology.provider as term\n      on m.prescribing_provider_npi = term.npi\n    left join tuva.terminology.provider as term2\n      on m.dispensing_provider_npi  = term2.npi\n    group by\n        m.claim_id\n)\n\n,final as (\nselect\n    'invalid prescribing_npi' as data_quality_check\n  , sum(invalid_prescribing_npi) as result_count\nfrom pharmacy_claim\n\nunion all\n\nselect\n    'missing prescribing_npi' as data_quality_check\n  , sum(missing_prescribing_npi) as result_count\nfrom pharmacy_claim\n\nunion all\n\nselect\n    'wrong entity type prescribing_npi' as data_quality_check\n  , sum(wrong_entity_type_prescribing_npi) as result_count\nfrom pharmacy_claim\n\nunion all\n\nselect\n    'invalid dispensing_npi' as data_quality_check\n  , sum(invalid_dispensing_npi) as result_count\nfrom pharmacy_claim\n\nunion all\n\nselect\n    'missing dispensing_npi' as data_quality_check\n  , sum(missing_dispensing_npi) as result_count\nfrom pharmacy_claim\n\nunion all\n\nselect\n    'wrong entity type dispensing_npi' as data_quality_check\n  , sum(wrong_entity_type_dispensing_npi) as result_count\nfrom pharmacy_claim\n)\n\nselect *\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom final", "relation_name": "tuva.data_quality.pharmacy_claim_npi"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.210822Z", "completed_at": "2025-02-25T21:26:17.217772Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.217983Z", "completed_at": "2025-02-25T21:26:17.217989Z"}], "thread_id": "Thread-2", "execution_time": 0.008276939392089844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__pharmacy_claim_prescription_details", "compiled": true, "compiled_code": "\n\nwith pharmacy_claim as (\n  select\n      claim_id\n    , max(case \n        when quantity is null then 1\n        when quantity = 0 then 1\n        else 0\n      end) as missing_quantity\n    , max(case \n        when days_supply is null then 1\n        when days_supply = 0 then 1\n        else 0\n      end) as missing_days_supply\n    , max(case \n        when refills is null then 1\n        else 0\n      end) as missing_refills\n  from tuva.input_layer.pharmacy_claim m\n  group by\n      claim_id\n)\n\n, final as (\n  select\n      'missing quantity' as data_quality_check\n    , sum(missing_quantity) as result_count\n  from pharmacy_claim\n\n  union all\n\n  select\n      'missing days supply' as data_quality_check\n    , sum(missing_days_supply) as result_count\n  from pharmacy_claim\n\n  union all\n\n  select\n      'missing refills' as data_quality_check\n    , sum(missing_refills) as result_count\n  from pharmacy_claim\n)\n\nselect\n    *\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom final", "relation_name": "tuva.data_quality.pharmacy_claim_prescription_details"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.214684Z", "completed_at": "2025-02-25T21:26:17.218825Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.219207Z", "completed_at": "2025-02-25T21:26:17.219211Z"}], "thread_id": "Thread-3", "execution_time": 0.0050280094146728516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__pharmacy_claim_volume_and_dollars", "compiled": true, "compiled_code": "\n\nselect\n    c.year_month_int as year_month\n  , count(distinct p.claim_id) as claim_volume\n  , sum(p.paid_amount) as paid_amount\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.pharmacy_claim p\nleft join tuva.reference_data.calendar c\n  on coalesce(p.paid_date, p.dispensing_date) = c.full_date\ngroup by\n    c.year_month_int", "relation_name": "tuva.data_quality.pharmacy_claim_volume_and_dollars"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.219564Z", "completed_at": "2025-02-25T21:26:17.229169Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.229412Z", "completed_at": "2025-02-25T21:26:17.229418Z"}], "thread_id": "Thread-2", "execution_time": 0.010876178741455078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__pharmacy_coinsurance_amount", "compiled": true, "compiled_code": "\n\nSELECT DISTINCT -- to bring to claim_ID grain\n      m.data_source\n    , coalesce(cast(m.paid_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'PHARMACY_CLAIM' AS table_name\n    , 'Claim ID | Claim Line Number' AS drill_down_key\n    , coalesce(cast(m.claim_id as TEXT), 'null') || '|' || coalesce(cast(m.claim_line_number as TEXT), 'null') as drill_down_value\n    , 'PHARMACY' AS claim_type\n    , 'COINSURANCE_AMOUNT' AS field_name\n    , case when m.coinsurance_amount is null          then        'null'\n                                              else 'valid' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(coinsurance_amount as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.pharmacy_claim m", "relation_name": "tuva.data_quality.pharmacy_coinsurance_amount"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.224362Z", "completed_at": "2025-02-25T21:26:17.230236Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.230690Z", "completed_at": "2025-02-25T21:26:17.230693Z"}], "thread_id": "Thread-3", "execution_time": 0.006821155548095703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__pharmacy_copayment_amount", "compiled": true, "compiled_code": "\n\nSELECT DISTINCT -- to bring to claim_ID grain\n      m.data_source\n    , coalesce(cast(m.paid_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'PHARMACY_CLAIM' AS table_name\n    , 'Claim ID | Claim Line Number' AS drill_down_key\n    , coalesce(cast(m.claim_id as TEXT), 'null') || '|' || coalesce(cast(m.claim_line_number as TEXT), 'null') as drill_down_value\n    , 'PHARMACY' AS claim_type\n    , 'COPAYMENT_AMOUNT' AS field_name\n    , case when m.copayment_amount is null then 'null'\n                                           else 'valid' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(copayment_amount as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.pharmacy_claim m", "relation_name": "tuva.data_quality.pharmacy_copayment_amount"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.231028Z", "completed_at": "2025-02-25T21:26:17.340693Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.341292Z", "completed_at": "2025-02-25T21:26:17.341301Z"}], "thread_id": "Thread-2", "execution_time": 0.11143088340759277, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__pharmacy_data_source", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(cast(m.paid_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'PHARMACY_CLAIM' AS table_name\n    , 'Claim ID | Claim Line Number' AS drill_down_key\n    , coalesce(cast(m.claim_id as TEXT), 'null') || '|' || coalesce(cast(m.claim_line_number as TEXT), 'null') as drill_down_value\n    , 'PHARMACY' AS claim_type\n    , 'DATA_SOURCE' AS field_name\n    , case\n        when m.data_source is null then 'null' else 'valid' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(data_source as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.pharmacy_claim m", "relation_name": "tuva.data_quality.pharmacy_data_source"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.335128Z", "completed_at": "2025-02-25T21:26:17.343088Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.344041Z", "completed_at": "2025-02-25T21:26:17.344048Z"}], "thread_id": "Thread-3", "execution_time": 0.01701188087463379, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__pharmacy_days_supply", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(cast(m.paid_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'PHARMACY_CLAIM' AS table_name\n    , 'Claim ID | Claim Line Number' AS drill_down_key\n    , coalesce(cast(m.claim_id as TEXT), 'null') || '|' || coalesce(cast(m.claim_line_number as TEXT), 'null') as drill_down_value\n    , 'PHARMACY' AS claim_type\n    , 'DAYS_SUPPLY' AS field_name\n    , case\n        when m.days_supply is null then 'null' else 'valid' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(days_supply as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.pharmacy_claim m", "relation_name": "tuva.data_quality.pharmacy_days_supply"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.344625Z", "completed_at": "2025-02-25T21:26:17.357641Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.358080Z", "completed_at": "2025-02-25T21:26:17.358088Z"}], "thread_id": "Thread-2", "execution_time": 0.015459060668945312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__pharmacy_deductible_amount", "compiled": true, "compiled_code": "\n\nSELECT DISTINCT -- to bring to claim_ID grain\n      m.data_source\n    , coalesce(cast(m.paid_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'PHARMACY_CLAIM' AS table_name\n    , 'Claim ID | Claim Line Number' AS drill_down_key\n    , coalesce(cast(m.claim_id as TEXT), 'null') || '|' || coalesce(cast(m.claim_line_number as TEXT), 'null') as drill_down_value\n    , 'PHARMACY' AS claim_type\n    , 'DEDUCTIBLE_AMOUNT' AS field_name\n    , case when m.deductible_amount is null then 'null'\n                                            else 'valid' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(deductible_amount as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.pharmacy_claim m", "relation_name": "tuva.data_quality.pharmacy_deductible_amount"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.351366Z", "completed_at": "2025-02-25T21:26:17.365503Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.365943Z", "completed_at": "2025-02-25T21:26:17.365952Z"}], "thread_id": "Thread-3", "execution_time": 0.01540994644165039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__pharmacy_dispensing_date", "compiled": true, "compiled_code": "\nwith tuva_last_run as(\n    select cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) as tuva_last_run\n)\n\nSELECT\n      m.data_source\n    , coalesce(cast(m.paid_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'PHARMACY_CLAIM' AS table_name\n    , 'Claim ID | Claim Line Number' AS drill_down_key\n    , coalesce(cast(m.claim_id as TEXT), 'null') || '|' || coalesce(cast(m.claim_line_number as TEXT), 'null') as drill_down_value\n    , 'PHARMACY' AS claim_type\n    , 'DISPENSING_DATE' AS field_name\n    , case\n        when m.dispensing_date > tuva_last_run then 'invalid'\n        when m.dispensing_date < \n\n    dateadd(\n        year,\n        -10,\n        cte.tuva_last_run\n        )\n\n then 'invalid'\n        when m.dispensing_date is null then 'null'\n        else 'valid'\n    end as bucket_name\n    , case\n        when m.dispensing_date > tuva_last_run then 'future'\n        when m.dispensing_date < \n\n    dateadd(\n        year,\n        -10,\n        cte.tuva_last_run\n        )\n\n then 'too old'\n        else null\n        end as invalid_reason\n    , cast(dispensing_date as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.pharmacy_claim m\ncross join tuva_last_run cte", "relation_name": "tuva.data_quality.pharmacy_dispensing_date"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.359601Z", "completed_at": "2025-02-25T21:26:17.367133Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.367597Z", "completed_at": "2025-02-25T21:26:17.367602Z"}], "thread_id": "Thread-2", "execution_time": 0.008589982986450195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__pharmacy_dispensing_provider_npi", "compiled": true, "compiled_code": "\n\nSELECT DISTINCT -- to bring to claim_ID grain\n      m.data_source\n    , coalesce(cast(m.paid_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'PHARMACY_CLAIM' AS table_name\n    , 'Claim ID | Claim Line Number' AS drill_down_key\n    , coalesce(cast(m.claim_id as TEXT), 'null') || '|' || coalesce(cast(m.claim_line_number as TEXT), 'null') as drill_down_value\n    , 'PHARMACY' AS claim_type\n    , 'DISPENSING_PROVIDER_NPI' AS field_name\n    , case when term.npi is not null                     then        'valid'\n          when m.dispensing_provider_npi is not null    then 'invalid'\n                                                        else 'null'\n                                                        end as bucket_name\n    , case\n        when m.dispensing_provider_npi is not null\n            and term.npi is null\n            then 'dispensing provider npi does not join to terminology provider table'\n        else null\n    end as invalid_reason\n    , cast(m.dispensing_provider_npi as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.pharmacy_claim m\nleft join tuva.terminology.provider as term on m.dispensing_provider_npi = term.npi", "relation_name": "tuva.data_quality.pharmacy_dispensing_provider_npi"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.368047Z", "completed_at": "2025-02-25T21:26:17.379242Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.379513Z", "completed_at": "2025-02-25T21:26:17.379520Z"}], "thread_id": "Thread-3", "execution_time": 0.01285409927368164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__pharmacy_member_id", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(cast(m.paid_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'PHARMACY_CLAIM' AS table_name\n    , 'Claim ID | Claim Line Number' AS drill_down_key\n    , coalesce(cast(m.claim_id as TEXT), 'null') || '|' || coalesce(cast(m.claim_line_number as TEXT), 'null') as drill_down_value\n    , 'PHARMACY' AS claim_type\n    , 'MEMBER_ID' AS field_name\n    , case\n        when m.member_id is null then 'null' else 'valid' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(member_id as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.pharmacy_claim m", "relation_name": "tuva.data_quality.pharmacy_member_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.374079Z", "completed_at": "2025-02-25T21:26:17.380513Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.380963Z", "completed_at": "2025-02-25T21:26:17.380968Z"}], "thread_id": "Thread-2", "execution_time": 0.007506847381591797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__pharmacy_ndc_code", "compiled": true, "compiled_code": "\n\nSELECT DISTINCT -- to bring to claim_ID grain\n      m.data_source\n    , coalesce(cast(m.paid_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'PHARMACY_CLAIM' AS table_name\n    , 'Claim ID | Claim Line Number' AS drill_down_key\n    , coalesce(cast(m.claim_id as TEXT), 'null') || '|' || coalesce(cast(m.claim_line_number as TEXT), 'null') as drill_down_value\n    , 'PHARMACY' AS claim_type\n    , 'NDC_CODE' AS field_name\n    , case when term.ndc is not null          then        'valid'\n          when m.ndc_code is not null        then 'invalid'\n                                             else 'null' end as bucket_name\n    , case\n        when m.ndc_code is not null\n            and term.ndc is null\n            then 'NDC Code does not join to Terminology NDC table'\n        else null\n    end as invalid_reason\n    , m.ndc_code || '|' || coalesce(term.rxnorm_description, term.fda_description, '') as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.pharmacy_claim m\nleft join tuva.terminology.ndc as term on m.ndc_code = term.ndc", "relation_name": "tuva.data_quality.pharmacy_ndc_code"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.381354Z", "completed_at": "2025-02-25T21:26:17.393723Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.394413Z", "completed_at": "2025-02-25T21:26:17.394419Z"}], "thread_id": "Thread-3", "execution_time": 0.014230966567993164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__pharmacy_paid_amount", "compiled": true, "compiled_code": "\n\nSELECT DISTINCT -- to bring to claim_ID grain\n      m.data_source\n    , coalesce(cast(m.paid_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'PHARMACY_CLAIM' AS table_name\n    , 'Claim ID | Claim Line Number' AS drill_down_key\n    , coalesce(cast(m.claim_id as TEXT), 'null') || '|' || coalesce(cast(m.claim_line_number as TEXT), 'null') as drill_down_value\n    , 'PHARMACY' AS claim_type\n    , 'PAID_AMOUNT' AS field_name\n    , case when m.paid_amount is null          then        'null'\n                                              else 'valid' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(paid_amount as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.pharmacy_claim m", "relation_name": "tuva.data_quality.pharmacy_paid_amount"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.387300Z", "completed_at": "2025-02-25T21:26:17.395681Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.400449Z", "completed_at": "2025-02-25T21:26:17.400457Z"}], "thread_id": "Thread-2", "execution_time": 0.013792991638183594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__pharmacy_paid_date", "compiled": true, "compiled_code": "\nwith tuva_last_run as(\n     select cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) as tuva_last_run\n)\n\nSELECT\n      m.data_source\n    , coalesce(cast(m.paid_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'PHARMACY_CLAIM' AS table_name\n    , 'Claim ID | Claim Line Number' AS drill_down_key\n    , coalesce(cast(m.claim_id as TEXT), 'null') || '|' || coalesce(cast(m.claim_line_number as TEXT), 'null') as drill_down_value\n    , 'PHARMACY' AS claim_type\n    , 'PAID_DATE' AS field_name\n    , case\n        when m.paid_date > tuva_last_run then 'invalid'\n        when m.paid_date < \n\n    dateadd(\n        year,\n        -10,\n        cte.tuva_last_run\n        )\n\n then 'invalid'\n        when m.paid_date is null then 'null'\n        else 'valid'\n    end as bucket_name\n    , case\n        when m.paid_date > tuva_last_run then 'future'\n        when m.paid_date < \n\n    dateadd(\n        year,\n        -10,\n        cte.tuva_last_run\n        )\n\n then 'too old'\n        else null\n        end as invalid_reason\n    , cast(paid_date as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.pharmacy_claim m\ncross join tuva_last_run cte", "relation_name": "tuva.data_quality.pharmacy_paid_date"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.395911Z", "completed_at": "2025-02-25T21:26:17.401830Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.407109Z", "completed_at": "2025-02-25T21:26:17.407117Z"}], "thread_id": "Thread-3", "execution_time": 0.012044906616210938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__pharmacy_payer", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(cast(m.paid_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'PHARMACY_CLAIM' AS table_name\n    , 'Claim ID | Claim Line Number' AS drill_down_key\n    , coalesce(cast(m.claim_id as TEXT), 'null') || '|' || coalesce(cast(m.claim_line_number as TEXT), 'null') as drill_down_value\n    , 'PHARMACY' AS claim_type\n    , 'PAYER' AS field_name\n    , case\n        when m.payer is null then 'null' else 'valid' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(payer as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.pharmacy_claim m", "relation_name": "tuva.data_quality.pharmacy_payer"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.402055Z", "completed_at": "2025-02-25T21:26:17.413943Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.414300Z", "completed_at": "2025-02-25T21:26:17.414308Z"}], "thread_id": "Thread-2", "execution_time": 0.013135194778442383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__pharmacy_person_id", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(cast(m.paid_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'PHARMACY_CLAIM' AS table_name\n    , 'Claim ID | Claim Line Number' AS drill_down_key\n    , coalesce(cast(m.claim_id as TEXT), 'null') || '|' || coalesce(cast(m.claim_line_number as TEXT), 'null') as drill_down_value\n    , 'PHARMACY' AS claim_type\n    , 'PERSON_ID' AS field_name\n    , case\n        when m.person_id is null then 'null' else 'valid' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(person_id as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.pharmacy_claim m", "relation_name": "tuva.data_quality.pharmacy_person_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.408487Z", "completed_at": "2025-02-25T21:26:17.415499Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.415965Z", "completed_at": "2025-02-25T21:26:17.415971Z"}], "thread_id": "Thread-3", "execution_time": 0.008065938949584961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__pharmacy_plan", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(cast(m.paid_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'PHARMACY_CLAIM' AS table_name\n    , 'Claim ID | Claim Line Number' AS drill_down_key\n    , coalesce(cast(m.claim_id as TEXT), 'null') || '|' || coalesce(cast(m.claim_line_number as TEXT), 'null') as drill_down_value\n    , 'PHARMACY' AS claim_type\n    , 'PLAN' AS field_name\n    , case\n        when m.plan is null then 'null' else 'valid' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(plan as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.pharmacy_claim m", "relation_name": "tuva.data_quality.pharmacy_plan"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.416408Z", "completed_at": "2025-02-25T21:26:17.428812Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.429313Z", "completed_at": "2025-02-25T21:26:17.429322Z"}], "thread_id": "Thread-2", "execution_time": 0.014230012893676758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__pharmacy_prescribing_provider_npi", "compiled": true, "compiled_code": "\n\nSELECT DISTINCT -- to bring to claim_ID grain\n      m.data_source\n    , coalesce(cast(m.paid_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'PHARMACY_CLAIM' AS table_name\n    , 'Claim ID | Claim Line Number' AS drill_down_key\n    , coalesce(cast(m.claim_id as TEXT), 'null') || '|' || coalesce(cast(m.claim_line_number as TEXT), 'null') as drill_down_value\n    , 'PHARMACY' AS claim_type\n    , 'PRESCRIBING_PROVIDER_NPI' AS field_name\n    , case when term.npi is not null          then        'valid'\n          when m.prescribing_provider_npi is not null    then 'invalid'\n                                             else 'null' end as bucket_name\n    , case\n        when m.prescribing_provider_npi is not null\n            and term.npi is null\n            then 'Prescribing Provider NPI does not join to Terminology Provider table'\n        else null\n    end as invalid_reason\n    , cast(m.prescribing_provider_npi as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.pharmacy_claim m\nleft join tuva.terminology.provider as term on m.prescribing_provider_npi = term.npi", "relation_name": "tuva.data_quality.pharmacy_prescribing_provider_npi"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.422513Z", "completed_at": "2025-02-25T21:26:17.430694Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.431179Z", "completed_at": "2025-02-25T21:26:17.431184Z"}], "thread_id": "Thread-3", "execution_time": 0.009266138076782227, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__pharmacy_quantity", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(cast(m.paid_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'PHARMACY_CLAIM' AS table_name\n    , 'Claim ID | Claim Line Number' AS drill_down_key\n    , coalesce(cast(m.claim_id as TEXT), 'null') || '|' || coalesce(cast(m.claim_line_number as TEXT), 'null') as drill_down_value\n    , 'PHARMACY' AS claim_type\n    , 'PAID_DATE' AS field_name\n    , case\n        when m.quantity is null then 'null' else 'valid' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(quantity as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.pharmacy_claim m", "relation_name": "tuva.data_quality.pharmacy_quantity"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.431588Z", "completed_at": "2025-02-25T21:26:17.443407Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.443670Z", "completed_at": "2025-02-25T21:26:17.443678Z"}], "thread_id": "Thread-2", "execution_time": 0.013390302658081055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__pharmacy_refills", "compiled": true, "compiled_code": "\n\nSELECT\n      m.data_source\n    , coalesce(cast(m.paid_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'PHARMACY_CLAIM' AS table_name\n    , 'Claim ID | Claim Line Number' AS drill_down_key\n    , coalesce(cast(m.claim_id as TEXT), 'null') || '|' || coalesce(cast(m.claim_line_number as TEXT), 'null') as drill_down_value\n    , 'PHARMACY' AS claim_type\n    , 'REFILLS' AS field_name\n    , case\n        when m.refills is null then 'null' else 'valid' end as bucket_name\n    , cast(null as TEXT) as invalid_reason\n    , cast(refills as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.pharmacy_claim m", "relation_name": "tuva.data_quality.pharmacy_refills"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.437918Z", "completed_at": "2025-02-25T21:26:17.445071Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.450002Z", "completed_at": "2025-02-25T21:26:17.450012Z"}], "thread_id": "Thread-3", "execution_time": 0.01288914680480957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__primary_key_check", "compiled": true, "compiled_code": "\n\nwith pharmacy as (\n  select\n      claim_id\n    , claim_line_number\n    , data_source\n    , count(*) as result_count\n  from tuva.input_layer.pharmacy_claim p\n  group by\n      claim_id\n    , claim_line_number\n    , data_source\n  having count(*) > 1\n)\n\n, medical as (\n  select\n      claim_id\n    , claim_line_number\n    , data_source\n    , count(*) as result_count\n  from tuva.input_layer.medical_claim p\n  group by\n      claim_id\n    , claim_line_number\n    , data_source\n  having count(*) > 1\n)\n\n, eligibility as (\n  select\n      person_id\n    , enrollment_start_date\n    , enrollment_end_date\n    , plan\n    , data_source\n    , count(*) as result_count\n  from tuva.input_layer.eligibility p\n  group by\n      person_id\n    , enrollment_start_date\n    , enrollment_end_date\n    , plan\n    , data_source\n  having count(*) > 1\n)\n\n, final as (\n  select\n      'pk errors pharmacy claim' as data_quality_check\n    , coalesce(sum(result_count), 0) as result_count\n  from pharmacy\n\n  union all\n\n  select\n      'pk errors medical claim' as data_quality_check\n    , coalesce(sum(result_count), 0) as result_count\n  from medical\n\n  union all\n\n  select\n      'pk errors eligibility' as data_quality_check\n    , coalesce(sum(result_count), 0) as result_count\n  from eligibility\n)\n\nselect\n    *\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom final", "relation_name": "tuva.data_quality.primary_key_check"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.445288Z", "completed_at": "2025-02-25T21:26:17.454627Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.455012Z", "completed_at": "2025-02-25T21:26:17.455019Z"}], "thread_id": "Thread-2", "execution_time": 0.01061701774597168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__raw_summary", "compiled": true, "compiled_code": "\n\nwith cte as (\n    select \n        'input_layer' as source\n      , 'eligibility' as table_name\n      , count(*) as row_count\n      , count(distinct person_id) as unique_check\n      , 'Unique Patient Count' as unique_check_desc\n      , 2 as table_order\n    from tuva.input_layer.eligibility\n\n    union all\n\n    select \n        'raw_data' as source\n      , 'eligibility' as table_name\n      , null as row_count\n      , null as unique_check\n      , 'Unique Patient Count' as unique_check_desc\n      , 1 as table_order\n    from tuva.input_layer.eligibility\n\n    union all\n\n    select \n        'input_layer' as source\n      , 'medical_claim' as table_name\n      , count(*) as row_count\n      , count(distinct claim_id) as unique_check\n      , 'Unique Claim Count' as unique_check_desc\n      , 4 as table_order\n    from tuva.input_layer.medical_claim\n\n    union all\n\n    select \n        'raw_data' as source\n      , 'medical_claim' as table_name\n      , null as row_count\n      , null as unique_check\n      , 'Unique Claim Count' as unique_check_desc\n      , 3 as table_order\n    from tuva.input_layer.medical_claim\n\n    union all\n\n    select \n        'input_layer' as source\n      , 'pharmacy_claim' as table_name\n      , count(*) as row_count\n      , count(distinct claim_id) as unique_check\n      , 'Unique Claim Count' as unique_check_desc\n      , 6 as table_order\n    from tuva.input_layer.pharmacy_claim\n\n    union all\n\n    select \n        'raw_data' as source\n      , 'pharmacy_claim' as table_name\n      , null as row_count\n      , null as unique_check\n      , 'Unique Claim Count' as unique_check_desc\n      , 5 as table_order\n    from tuva.input_layer.pharmacy_claim\n)\n\nselect\n    cte.*\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom cte", "relation_name": "tuva.data_quality.raw_summary"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.475159Z", "completed_at": "2025-02-25T21:26:17.520209Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.535147Z", "completed_at": "2025-02-25T21:26:17.535156Z"}], "thread_id": "Thread-2", "execution_time": 0.06064796447753906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__data_quality_clinical_detail", "compiled": true, "compiled_code": "\n\nWITH CTE as (\nSELECT * FROM tuva.data_quality.condition_claim_id\n\nunion all\n\nSELECT * FROM tuva.data_quality.condition_condition_id\n\nunion all\n\nSELECT * FROM tuva.data_quality.condition_condition_rank\n\nunion all\n\nSELECT * FROM tuva.data_quality.condition_condition_type\n\nunion all\n\nSELECT * FROM tuva.data_quality.condition_data_source\n\nunion all\n\nSELECT * FROM tuva.data_quality.condition_encounter_id\n\nunion all\n\nSELECT * FROM tuva.data_quality.condition_normalized_code_type\n\nunion all\n\nSELECT * FROM tuva.data_quality.condition_normalized_code\n\nunion all\n\nSELECT * FROM tuva.data_quality.condition_normalized_description\n\nunion all\n\nSELECT * FROM tuva.data_quality.condition_onset_date\n\nunion all\n\nSELECT * FROM tuva.data_quality.condition_patient_id\n\nunion all\n\nSELECT * FROM tuva.data_quality.condition_present_on_admit_code\n\nunion all\n\nSELECT * FROM tuva.data_quality.condition_present_on_admit_description\n\nunion all\n\nSELECT * FROM tuva.data_quality.condition_recorded_date\n\nunion all\n\nSELECT * FROM tuva.data_quality.condition_resolved_date\n\nunion all\n\nSELECT * FROM tuva.data_quality.condition_source_code\n\nunion all\n\nSELECT * FROM tuva.data_quality.condition_source_code_type\n\nunion all\n\nSELECT * FROM tuva.data_quality.condition_source_description\n\nunion all\n\nSELECT * FROM tuva.data_quality.condition_status\n\nunion all\n\nSELECT * FROM tuva.data_quality.encounter_admit_source_code\n\nunion all\n\nSELECT * FROM tuva.data_quality.encounter_admit_source_description\n\nunion all\n\nSELECT * FROM tuva.data_quality.encounter_admit_type_code\n\nunion all\n\nSELECT * FROM tuva.data_quality.encounter_admit_type_description\n\nunion all\n\nSELECT * FROM tuva.data_quality.encounter_allowed_amount\n\nunion all\n\nSELECT * FROM tuva.data_quality.encounter_attending_provider_id\n\nunion all\n\nSELECT * FROM tuva.data_quality.encounter_charge_amount\n\nunion all\n\nSELECT * FROM tuva.data_quality.encounter_data_source\n\nunion all\n\nSELECT * FROM tuva.data_quality.encounter_discharge_disposition_code\n\nunion all\n\nSELECT * FROM tuva.data_quality.encounter_discharge_disposition_description\n\nunion all\n\nSELECT * FROM tuva.data_quality.encounter_encounter_end_date\n\nunion all\n\nSELECT * FROM tuva.data_quality.encounter_encounter_id\n\nunion all\n\nSELECT * FROM tuva.data_quality.encounter_encounter_start_date\n\nunion all\n\nSELECT * FROM tuva.data_quality.encounter_encounter_type\n\nunion all\n\nSELECT * FROM tuva.data_quality.encounter_facility_id\n\nunion all\n\nSELECT * FROM tuva.data_quality.encounter_length_of_stay\n\nunion all\n\nSELECT * FROM tuva.data_quality.encounter_drg_code\n\nunion all\n\nSELECT * FROM tuva.data_quality.encounter_drg_description\n\nunion all\n\nSELECT * FROM tuva.data_quality.encounter_paid_amount\n\nunion all\n\nSELECT * FROM tuva.data_quality.encounter_patient_id\n\nunion all\n\nSELECT * FROM tuva.data_quality.encounter_primary_diagnosis_code\n\nunion all\n\nSELECT * FROM tuva.data_quality.encounter_primary_diagnosis_code_type\n\nunion all\n\nSELECT * FROM tuva.data_quality.encounter_primary_diagnosis_description\n\nunion all\n\nSELECT * FROM tuva.data_quality.practitioner_practice_affiliation\n\nunion all\n\nSELECT * FROM tuva.data_quality.practitioner_sub_specialty\n\nunion all\n\nSELECT * FROM tuva.data_quality.practitioner_last_name\n\nunion all\n\nSELECT * FROM tuva.data_quality.practitioner_practitioner_id\n\nunion all\n\nSELECT * FROM tuva.data_quality.practitioner_data_source\n\nunion all\n\nSELECT * FROM tuva.data_quality.practitioner_npi\n\nunion all\n\nSELECT * FROM tuva.data_quality.practitioner_first_name\n\nunion all\n\nSELECT * FROM tuva.data_quality.practitioner_specialty\n\nunion all\n\nSELECT * FROM tuva.data_quality.location_parent_organization\n\nunion all\n\nSELECT * FROM tuva.data_quality.location_latitude\n\nunion all\n\nSELECT * FROM tuva.data_quality.location_facility_type\n\nunion all\n\nSELECT * FROM tuva.data_quality.location_zip_code\n\nunion all\n\nSELECT * FROM tuva.data_quality.location_data_source\n\nunion all\n\nSELECT * FROM tuva.data_quality.location_city\n\nunion all\n\nSELECT * FROM tuva.data_quality.location_npi\n\nunion all\n\nSELECT * FROM tuva.data_quality.location_location_id\n\nunion all\n\nSELECT * FROM tuva.data_quality.location_longitude\n\nunion all\n\nSELECT * FROM tuva.data_quality.location_address\n\nunion all\n\nSELECT * FROM tuva.data_quality.location_state\n\nunion all\n\nSELECT * FROM tuva.data_quality.location_name\n\nunion all\n\nSELECT * FROM tuva.data_quality.procedure_normalized_code_type\n\nunion all\n\nSELECT * FROM tuva.data_quality.procedure_normalized_description\n\nunion all\n\nSELECT * FROM tuva.data_quality.procedure_procedure_id\n\nunion all\n\nSELECT * FROM tuva.data_quality.procedure_claim_id\n\nunion all\n\nSELECT * FROM tuva.data_quality.procedure_source_code\n\nunion all\n\nSELECT * FROM tuva.data_quality.procedure_source_code_type\n\nunion all\n\nSELECT * FROM tuva.data_quality.procedure_source_description\n\nunion all\n\nSELECT * FROM tuva.data_quality.procedure_practitioner_id\n\nunion all\n\nSELECT * FROM tuva.data_quality.procedure_data_source\n\nunion all\n\nSELECT * FROM tuva.data_quality.procedure_patient_id\n\nunion all\n\nSELECT * FROM tuva.data_quality.procedure_procedure_date\n\nunion all\n\nSELECT * FROM tuva.data_quality.procedure_encounter_id\n\nunion all\n\nSELECT * FROM tuva.data_quality.procedure_modifier_5\n\nunion all\n\nSELECT * FROM tuva.data_quality.procedure_modifier_4\n\nunion all\n\nSELECT * FROM tuva.data_quality.procedure_normalized_code\n\nunion all\n\nSELECT * FROM tuva.data_quality.procedure_modifier_1\n\nunion all\n\nSELECT * FROM tuva.data_quality.procedure_modifier_3\n\nunion all\n\nSELECT * FROM tuva.data_quality.procedure_modifier_2\n\nunion all\n\nSELECT * FROM tuva.data_quality.lab_result_source_abnormal_flag\n\nunion all\n\nSELECT * FROM tuva.data_quality.lab_result_specimen\n\nunion all\n\nSELECT * FROM tuva.data_quality.lab_result_source_reference_range_low\n\nunion all\n\nSELECT * FROM tuva.data_quality.lab_result_source_units\n\nunion all\n\nSELECT * FROM tuva.data_quality.lab_result_lab_result_id\n\nunion all\n\nSELECT * FROM tuva.data_quality.lab_result_collection_date\n\nunion all\n\nSELECT * FROM tuva.data_quality.lab_result_normalized_component\n\nunion all\n\nSELECT * FROM tuva.data_quality.lab_result_ordering_practitioner_id\n\nunion all\n\nSELECT * FROM tuva.data_quality.lab_result_result\n\nunion all\n\nSELECT * FROM tuva.data_quality.lab_result_source_code_type\n\nunion all\n\nSELECT * FROM tuva.data_quality.lab_result_normalized_description\n\nunion all\n\nSELECT * FROM tuva.data_quality.lab_result_normalized_reference_range_low\n\nunion all\n\nSELECT * FROM tuva.data_quality.lab_result_normalized_reference_range_high\n\nunion all\n\nSELECT * FROM tuva.data_quality.lab_result_normalized_code\n\nunion all\n\nSELECT * FROM tuva.data_quality.lab_result_source_description\n\nunion all\n\nSELECT * FROM tuva.data_quality.lab_result_status\n\nunion all\n\nSELECT * FROM tuva.data_quality.lab_result_accession_number\n\nunion all\n\nSELECT * FROM tuva.data_quality.lab_result_result_date\n\nunion all\n\nSELECT * FROM tuva.data_quality.lab_result_normalized_abnormal_flag\n\nunion all\n\nSELECT * FROM tuva.data_quality.lab_result_data_source\n\nunion all\n\nSELECT * FROM tuva.data_quality.lab_result_normalized_units\n\nunion all\n\nSELECT * FROM tuva.data_quality.lab_result_normalized_code_type\n\nunion all\n\nSELECT * FROM tuva.data_quality.lab_result_source_reference_range_high\n\nunion all\n\nSELECT * FROM tuva.data_quality.lab_result_source_code\n\nunion all\n\nSELECT * FROM tuva.data_quality.lab_result_patient_id\n\nunion all\n\nSELECT * FROM tuva.data_quality.lab_result_source_component\n\nunion all\n\nSELECT * FROM tuva.data_quality.lab_result_encounter_id\n\nunion all\n\nSELECT * FROM tuva.data_quality.patient_sex\n\nunion all\n\nSELECT * FROM tuva.data_quality.patient_state\n\nunion all\n\nSELECT * FROM tuva.data_quality.patient_city\n\nunion all\n\nSELECT * FROM tuva.data_quality.patient_longitude\n\nunion all\n\nSELECT * FROM tuva.data_quality.patient_county\n\nunion all\n\nSELECT * FROM tuva.data_quality.patient_race\n\nunion all\n\nSELECT * FROM tuva.data_quality.patient_death_flag\n\nunion all\n\nSELECT * FROM tuva.data_quality.patient_address\n\nunion all\n\nSELECT * FROM tuva.data_quality.patient_data_source\n\nunion all\n\nSELECT * FROM tuva.data_quality.patient_zip_code\n\nunion all\n\nSELECT * FROM tuva.data_quality.patient_first_name\n\nunion all\n\nSELECT * FROM tuva.data_quality.patient_last_name\n\nunion all\n\nSELECT * FROM tuva.data_quality.patient_latitude\n\nunion all\n\nSELECT * FROM tuva.data_quality.patient_birth_date\n\nunion all\n\nSELECT * FROM tuva.data_quality.patient_death_date\n\nunion all\n\nSELECT * FROM tuva.data_quality.patient_patient_id\n\nunion all\n\nSELECT * FROM tuva.data_quality.medication_rxnorm_code\n\nunion all\n\nSELECT * FROM tuva.data_quality.medication_source_code\n\nunion all\n\nSELECT * FROM tuva.data_quality.medication_atc_code\n\nunion all\n\nSELECT * FROM tuva.data_quality.medication_dispensing_date\n\nunion all\n\nSELECT * FROM tuva.data_quality.medication_prescribing_date\n\nunion all\n\nSELECT * FROM tuva.data_quality.medication_days_supply\n\nunion all\n\nSELECT * FROM tuva.data_quality.medication_strength\n\nunion all\n\nSELECT * FROM tuva.data_quality.medication_patient_id\n\nunion all\n\nSELECT * FROM tuva.data_quality.medication_rxnorm_description\n\nunion all\n\nSELECT * FROM tuva.data_quality.medication_encounter_id\n\nunion all\n\nSELECT * FROM tuva.data_quality.medication_data_source\n\nunion all\n\nSELECT * FROM tuva.data_quality.medication_atc_description\n\nunion all\n\nSELECT * FROM tuva.data_quality.medication_quantity_unit\n\nunion all\n\nSELECT * FROM tuva.data_quality.medication_source_description\n\nunion all\n\nSELECT * FROM tuva.data_quality.medication_ndc_code\n\nunion all\n\nSELECT * FROM tuva.data_quality.medication_medication_id\n\nunion all\n\nSELECT * FROM tuva.data_quality.medication_source_code_type\n\nunion all\n\nSELECT * FROM tuva.data_quality.medication_ndc_description\n\nunion all\n\nSELECT * FROM tuva.data_quality.medication_quantity\n\nunion all\n\nSELECT * FROM tuva.data_quality.medication_practitioner_id\n\nunion all\n\nSELECT * FROM tuva.data_quality.medication_route\n\nunion all\n\nSELECT * FROM tuva.data_quality.observation_source_code\n\nunion all\n\nSELECT * FROM tuva.data_quality.observation_normalized_reference_range_high\n\nunion all\n\nSELECT * FROM tuva.data_quality.observation_source_units\n\nunion all\n\nSELECT * FROM tuva.data_quality.observation_observation_type\n\nunion all\n\nSELECT * FROM tuva.data_quality.observation_normalized_code\n\nunion all\n\nSELECT * FROM tuva.data_quality.observation_normalized_description\n\nunion all\n\nSELECT * FROM tuva.data_quality.observation_data_source\n\nunion all\n\nSELECT * FROM tuva.data_quality.observation_panel_id\n\nunion all\n\nSELECT * FROM tuva.data_quality.observation_observation_id\n\nunion all\n\nSELECT * FROM tuva.data_quality.observation_source_reference_range_low\n\nunion all\n\nSELECT * FROM tuva.data_quality.observation_result\n\nunion all\n\nSELECT * FROM tuva.data_quality.observation_source_code_type\n\nunion all\n\nSELECT * FROM tuva.data_quality.observation_normalized_reference_range_low\n\nunion all\n\nSELECT * FROM tuva.data_quality.observation_observation_date\n\nunion all\n\nSELECT * FROM tuva.data_quality.observation_encounter_id\n\nunion all\n\nSELECT * FROM tuva.data_quality.observation_source_description\n\nunion all\n\nSELECT * FROM tuva.data_quality.observation_source_reference_range_high\n\nunion all\n\nSELECT * FROM tuva.data_quality.observation_normalized_units\n\nunion all\n\nSELECT * FROM tuva.data_quality.observation_normalized_code_type\n\nunion all\n\nSELECT * FROM tuva.data_quality.observation_patient_id\n\n)\n\nSELECT\n    data_source,\n    cast(source_date as TEXT) as source_date,\n    table_name,\n    drill_down_key,\n    drill_down_value,\n    field_name,\n    bucket_name,\n    invalid_reason,\n    field_value,\n    tuva_last_run,\n    dense_rank() over (order by data_source, table_name, field_name) + 100000 as summary_sk\nFROM CTE", "relation_name": "tuva.data_quality.data_quality_clinical_detail"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.547381Z", "completed_at": "2025-02-25T21:26:17.558012Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.558298Z", "completed_at": "2025-02-25T21:26:17.558308Z"}], "thread_id": "Thread-3", "execution_time": 0.02063584327697754, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.not_null_core__lab_result_person_id.7a2d5de504", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect person_id\nfrom tuva.core.lab_result\nwhere person_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.554174Z", "completed_at": "2025-02-25T21:26:17.559798Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.568017Z", "completed_at": "2025-02-25T21:26:17.568025Z"}], "thread_id": "Thread-2", "execution_time": 0.014925003051757812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.unique_core__lab_result_lab_result_id.0ee4fe47af", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    lab_result_id as unique_field,\n    count(*) as n_records\n\nfrom tuva.core.lab_result\nwhere lab_result_id is not null\ngroup by lab_result_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.578311Z", "completed_at": "2025-02-25T21:26:17.585509Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.585734Z", "completed_at": "2025-02-25T21:26:17.585740Z"}], "thread_id": "Thread-3", "execution_time": 0.008034944534301758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.not_null_core__medication_person_id.0518de594e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect person_id\nfrom tuva.core.medication\nwhere person_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.582528Z", "completed_at": "2025-02-25T21:26:17.586573Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.587076Z", "completed_at": "2025-02-25T21:26:17.587081Z"}], "thread_id": "Thread-2", "execution_time": 0.005076169967651367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.unique_core__medication_medication_id.124fd11fa1", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    medication_id as unique_field,\n    count(*) as n_records\n\nfrom tuva.core.medication\nwhere medication_id is not null\ngroup by medication_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.604673Z", "completed_at": "2025-02-25T21:26:17.611423Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.611691Z", "completed_at": "2025-02-25T21:26:17.611699Z"}], "thread_id": "Thread-3", "execution_time": 0.007914066314697266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.not_null_core__observation_person_id.5c5e5baf32", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect person_id\nfrom tuva.core.observation\nwhere person_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.608379Z", "completed_at": "2025-02-25T21:26:17.612623Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.613050Z", "completed_at": "2025-02-25T21:26:17.613054Z"}], "thread_id": "Thread-2", "execution_time": 0.005197763442993164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.unique_core__observation_observation_id.ff5f21de59", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    observation_id as unique_field,\n    count(*) as n_records\n\nfrom tuva.core.observation\nwhere observation_id is not null\ngroup by observation_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.613418Z", "completed_at": "2025-02-25T21:26:17.623196Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.623490Z", "completed_at": "2025-02-25T21:26:17.623499Z"}], "thread_id": "Thread-3", "execution_time": 0.011203765869140625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__unique_value_examples", "compiled": true, "compiled_code": "\n\nSELECT * FROM tuva.data_quality.primary_keys_condition_condition_id\n\nunion all\n\nSELECT * FROM tuva.data_quality.primary_keys_encounter_encounter_id\n\nunion all\n\nSELECT * FROM tuva.data_quality.primary_keys_lab_result_lab_result_id\n\nunion all\n\nSELECT * FROM tuva.data_quality.primary_keys_location_location_id\n\nunion all\n\nSELECT * FROM tuva.data_quality.primary_keys_medication_medication_id\n\nunion all\n\nSELECT * FROM tuva.data_quality.primary_keys_observation_observation_id\n\nunion all\n\nSELECT * FROM tuva.data_quality.primary_keys_patient_patient_id\n\nunion all\n\nSELECT * FROM tuva.data_quality.primary_keys_practitioner_practitioner_id\n\nunion all\n\nSELECT * FROM tuva.data_quality.primary_keys_procedure_procedure_id", "relation_name": "tuva.data_quality.unique_value_examples"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.617991Z", "completed_at": "2025-02-25T21:26:17.624586Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.625058Z", "completed_at": "2025-02-25T21:26:17.625063Z"}], "thread_id": "Thread-2", "execution_time": 0.007678985595703125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__medical_claim_person_id", "compiled": true, "compiled_code": "\n\nwith medical as (\n  select\n      claim_id\n    , count(distinct p.person_id) as person_id_count\n    , max(case when p.person_id is null then 1 else 0 end) as missing_person_id\n    , max(\n        case \n          when startdts.month_start_date is null then 1\n          when enddts.month_start_date is null then 1\n          else 0\n        end\n      ) as missing_eligibility\n  from tuva.input_layer.medical_claim p\n  left join tuva.data_quality.data_quality__eligibility_dq_stage startdts\n    on p.person_id = startdts.person_id\n    and p.claim_start_date between startdts.month_start_date and startdts.month_end_date\n  left join tuva.data_quality.data_quality__eligibility_dq_stage enddts\n    on p.person_id = enddts.person_id\n    and p.claim_end_date between enddts.month_start_date and enddts.month_end_date\n  group by\n      claim_id\n)\n\n, final as (\n  select\n      'multiple medical_claim person_ids' as data_quality_check\n    , sum(case when person_id_count > 1 then 1 else 0 end) as result_count\n  from medical\n\n  union all\n\n  select\n      'missing medical_claim person_id' as data_quality_check\n    , sum(missing_person_id) as result_count\n  from medical\n\n  union all\n\n  select\n      'orphaned medical_claim claims' as data_quality_check\n    , sum(missing_eligibility) as result_count\n  from medical\n)\n\nselect\n    *\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom final", "relation_name": "tuva.data_quality.medical_claim_person_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.625472Z", "completed_at": "2025-02-25T21:26:17.636410Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.640397Z", "completed_at": "2025-02-25T21:26:17.640405Z"}], "thread_id": "Thread-3", "execution_time": 0.016184091567993164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__pharmacy_claim_person_id", "compiled": true, "compiled_code": "\n\nwith pharmacy as (\n  select\n      claim_id\n    , count(distinct p.person_id) as person_id_count\n    , max(case when p.person_id is null then 1 else 0 end) as missing_person_id\n    , max(case when e.month_start_date is null then 1 else 0 end) as missing_eligibility\n  from tuva.input_layer.pharmacy_claim p\n  left join tuva.data_quality.data_quality__eligibility_dq_stage e\n    on p.person_id = e.person_id\n    and coalesce(p.paid_date, p.dispensing_date) between e.month_start_date and e.month_end_date\n  group by\n      claim_id\n)\n\n, final as (\n  select\n      'multiple pharmacy_claim person_ids' as data_quality_check\n    , sum(case when person_id_count > 1 then 1 else 0 end) as result_count\n  from pharmacy\n\n  union all\n\n  select\n      'missing pharmacy_claim person_id' as data_quality_check\n    , sum(missing_person_id) as result_count\n  from pharmacy\n\n  union all\n\n  select\n      'orphaned pharmacy_claim claims' as data_quality_check\n    , sum(missing_eligibility) as result_count\n  from pharmacy\n)\n\nselect\n    *\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom final", "relation_name": "tuva.data_quality.pharmacy_claim_person_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.630105Z", "completed_at": "2025-02-25T21:26:17.641744Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.645707Z", "completed_at": "2025-02-25T21:26:17.645713Z"}], "thread_id": "Thread-2", "execution_time": 0.01622605323791504, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.normalized_input__int_eligibility_dates_normalize", "compiled": true, "compiled_code": "\n\n\nwith __dbt__cte__normalized_input__stg_eligibility as (\n\n\n\nselect\n      person_id\n    , person_id || coalesce(data_source,'') || coalesce(payer,'') || coalesce(plan,'') || coalesce(cast(enrollment_start_date as TEXT),'') || coalesce(cast(enrollment_end_date as TEXT),'') as person_id_key\n    , member_id\n    , subscriber_id\n    , gender\n    , race\n    , birth_date\n    , death_date\n    , death_flag\n    , enrollment_start_date\n    , enrollment_end_date\n    , payer\n    , payer_type\n    , plan\n    , subscriber_relation\n    , original_reason_entitlement_code\n    , dual_status_code\n    , medicare_status_code\n    , group_id\n    , group_name\n    , first_name\n    , last_name\n    , social_security_number\n    , address\n    , city\n    , state\n    , zip_code\n    , phone\n    , data_source\n    , file_name\n    , file_date\n    , ingest_datetime\nfrom tuva.input_layer.eligibility\n) select distinct\n    elig.person_id\n  , elig.person_id || coalesce(elig.data_source,'') || coalesce(elig.payer,'') || coalesce(elig.plan,'') || coalesce(cast(elig.enrollment_start_date as TEXT),'') || coalesce(cast(elig.enrollment_end_date as TEXT),'') as person_id_key\n  , cal_dob.full_date as normalized_birth_date\n  , cal_death.full_date as normalized_death_date\n  , cal_enroll_start.full_date as normalized_enrollment_start_date\n  , cal_enroll_end.full_date as normalized_enrollment_end_date\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom __dbt__cte__normalized_input__stg_eligibility elig\nleft join tuva.reference_data.calendar cal_dob\n    on elig.birth_date = cal_dob.full_date\nleft join tuva.reference_data.calendar cal_death\n    on elig.death_date = cal_death.full_date\nleft join tuva.reference_data.calendar cal_enroll_start\n    on elig.enrollment_start_date = cal_enroll_start.full_date\nleft join tuva.reference_data.calendar cal_enroll_end\n    on elig.enrollment_end_date = cal_enroll_end.full_date", "relation_name": "tuva.claims_preprocessing._int_normalized_input_eligibility_dates_normalize"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.641966Z", "completed_at": "2025-02-25T21:26:17.651376Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.651681Z", "completed_at": "2025-02-25T21:26:17.651688Z"}], "thread_id": "Thread-3", "execution_time": 0.01055908203125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__medical_claim_date_checks", "compiled": true, "compiled_code": "\n\nwith medical_claim as (\n    select m.claim_id,\n           max(case when claim_start_date is null then 1 else 0 end) as missing_claim_start_date,\n           max(case when claim_end_date is null then 1 else 0 end) as missing_claim_end_date,\n           max(case when claim_line_start_date is null then 1 else 0 end) as missing_claim_line_start_date,\n           max(case when claim_line_end_date is null then 1 else 0 end) as missing_claim_line_end_date,\n           max(case when admission_date is null and d.claim_id is not null then 1 else 0 end) as missing_admission_date,\n           max(case when discharge_date is null and d.claim_id is not null then 1 else 0 end) as missing_discharge_date,\n           max(case when paid_date is null then 1 else 0 end) as missing_paid_date,\n           count(distinct case when d.claim_id is not null then claim_start_date else null end) as claim_start_count,\n           count(distinct case when d.claim_id is not null then claim_end_date else null end) as claim_end_count,\n           count(distinct case when d.claim_id is not null then admission_date else null end) as admission_date_count,\n           count(distinct case when d.claim_id is not null then discharge_date else null end) as discharge_date_count\n    from tuva.input_layer.medical_claim m\n    left join tuva.data_quality.data_quality__inpatient_dq_stage d on m.claim_id = d.claim_id\n    group by m.claim_id\n)\n\n,final as (\nselect 'missing claim_start_date' as data_quality_check,\n       sum(missing_claim_start_date) as result_count\nfrom medical_claim\n\nunion all\n\nselect 'missing claim_end_date' as data_quality_check,\n       sum(missing_claim_end_date) as result_count\nfrom medical_claim\n\nunion all\n\nselect 'missing claim_line_start_date' as data_quality_check,\n       sum(missing_claim_line_start_date) as result_count\nfrom medical_claim\n\nunion all\n\nselect 'missing claim_line_end_date' as data_quality_check,\n       sum(missing_claim_line_end_date) as result_count\nfrom medical_claim\n\nunion all\n\nselect 'missing admission_date' as data_quality_check,\n       sum(missing_admission_date) as result_count\nfrom medical_claim\n\nunion all\n\nselect 'missing discharge_date' as data_quality_check,\n       sum(missing_discharge_date) as result_count\nfrom medical_claim\n\nunion all\n\nselect 'missing medical_claim paid_date' as data_quality_check,\n       sum(missing_paid_date) as result_count\nfrom medical_claim\n\nunion all\n\nselect 'claim start multiple' as data_quality_check,\n       count(distinct claim_id) as result_count\nfrom medical_claim\nwhere claim_start_count > 1\n\nunion all\n\nselect 'claim end multiple' as data_quality_check,\n       count(distinct claim_id) as result_count\nfrom medical_claim\nwhere claim_end_count > 1\n\nunion all\n\nselect 'admission date multiple' as data_quality_check,\n       count(distinct claim_id) as result_count\nfrom medical_claim\nwhere admission_date_count > 1\n\nunion all\n\nselect 'discharge date multiple' as data_quality_check,\n       count(distinct claim_id) as result_count\nfrom medical_claim\nwhere discharge_date_count > 1\n)\n\nselect *\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom final", "relation_name": "tuva.data_quality.medical_claim_date_checks"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.647023Z", "completed_at": "2025-02-25T21:26:17.652449Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.652922Z", "completed_at": "2025-02-25T21:26:17.652926Z"}], "thread_id": "Thread-2", "execution_time": 0.006478071212768555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__medical_claim_inst_header_fields", "compiled": true, "compiled_code": "\n\nwith inst_header as (\n  select\n      m.claim_id\n    , max(case when m.claim_type = 'institutional' and btc.bill_type_code is null and m.bill_type_code is not null then 1 else 0 end) as invalid_bill_type_code\n    , max(case when m.claim_type = 'institutional' and dd.discharge_disposition_code is null and m.discharge_disposition_code is not null then 1 else 0 end) as invalid_discharge_disposition_code\n    , max(case when d.claim_id is not null and (ms.ms_drg_code is null and apr.apr_drg_code is null) and m.drg_code is not null then 1 else 0 end) as invalid_drg_code\n    , max(case when m.claim_type = 'institutional' and m.bill_type_code is null then 1 else 0 end) as missing_bill_type_code\n    , max(case when m.claim_type = 'institutional' and m.discharge_disposition_code is null then 1 else 0 end) as missing_discharge_disposition_code\n    , max(case when d.claim_id is not null and m.drg_code is null then 1 else 0 end) as missing_drg_code\n    , count(distinct case when m.claim_type = 'institutional' then m.bill_type_code else null end) as bill_type_code_count\n    , count(distinct case when m.claim_type = 'institutional' then m.discharge_disposition_code else null end) as discharge_disposition_code_count\n    , count(distinct case when d.claim_id is not null then m.drg_code else null end) as drg_code_count\n  from tuva.input_layer.medical_claim as m\n  left join tuva.data_quality.data_quality__inpatient_dq_stage as d\n    on m.claim_id = d.claim_id\n  left join tuva.terminology.bill_type as btc\n    on m.bill_type_code = btc.bill_type_code\n  left join tuva.terminology.ms_drg as ms\n    on m.drg_code = ms.ms_drg_code\n    and m.drg_code_type = 'ms-drg'\n  left join tuva.terminology.apr_drg as apr\n    on m.drg_code = apr.apr_drg_code\n    and m.drg_code_type = 'apr-drg'\n  left join tuva.terminology.discharge_disposition as dd\n    on m.discharge_disposition_code = dd.discharge_disposition_code\n  group by m.claim_id\n)\n\n, final as (\n  select\n      'invalid bill_type_code' as data_quality_check\n    , sum(invalid_bill_type_code) as result_count\n  from inst_header\n\n  union all\n\n  select\n      'invalid drg_code' as data_quality_check\n    , sum(invalid_drg_code) as result_count\n  from inst_header\n\n  union all\n\n  select\n      'invalid discharge_disposition_code' as data_quality_check\n    , sum(invalid_discharge_disposition_code) as result_count\n  from inst_header\n\n  union all\n\n  select\n      'missing bill_type_code' as data_quality_check\n    , sum(missing_bill_type_code) as result_count\n  from inst_header\n\n  union all\n\n  select\n      'missing drg_code' as data_quality_check\n    , sum(missing_drg_code) as result_count\n  from inst_header\n\n  union all\n\n  select\n      'missing discharge_disposition_code' as data_quality_check\n    , sum(missing_discharge_disposition_code) as result_count\n  from inst_header\n\n  union all\n\n  select\n      'bill_type_code multiple' as data_quality_check\n    , count(distinct claim_id) as result_count\n  from inst_header\n  where bill_type_code_count > 1\n\n  union all\n\n  select\n      'drg_code multiple' as data_quality_check\n    , count(distinct claim_id) as result_count\n  from inst_header\n  where drg_code_count > 1\n\n  union all\n\n  select\n      'discharge_disposition_code multiple' as data_quality_check\n    , count(distinct claim_id) as result_count\n  from inst_header\n  where discharge_disposition_code_count > 1\n)\n\nselect\n    *\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom final", "relation_name": "tuva.data_quality.medical_claim_inst_header_fields"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.653809Z", "completed_at": "2025-02-25T21:26:17.696933Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.719546Z", "completed_at": "2025-02-25T21:26:17.719554Z"}], "thread_id": "Thread-3", "execution_time": 0.06696510314941406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__institutional_admission_date", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte__data_quality__stg_institutional_inpatient as (\n\n\n\n    SELECT *\n    FROM tuva.input_layer.medical_claim\n    WHERE claim_type = 'institutional'\n    AND \n  substr(bill_type_code, 1, 2)\n = '11'\n), base as (\nselect *\nfrom __dbt__cte__data_quality__stg_institutional_inpatient\n)\n, tuva_last_run as(\n\n    select cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) as tuva_last_run\n\n)\n,unique_field as (\n    select distinct claim_id\n        ,cast(admission_date as TEXT) as field\n        ,data_source\n    from base\n),\nclaim_grain as (\n    select claim_id\n        ,data_source\n        ,count(*) as frequency\n    from unique_field\n    group by claim_id\n        ,data_source\n),\nclaim_agg as (\nselect\n    claim_id,\n    data_source,\n    \n    listagg(\n        coalesce(field, 'null'),\n        ', '\n        )\n        within group (order by field desc) as field_aggregated\nfrom\n    unique_field\ngroup by\n    claim_id,\n    data_source\n)\nselect distinct -- to bring to claim_id grain\n    m.data_source\n    ,coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'MEDICAL_CLAIM' AS table_name\n    ,'Claim ID' AS drill_down_key\n    ,coalesce(m.claim_id, 'NULL') AS drill_down_value\n    ,'institutional' AS claim_type\n    ,'ADMISSION_DATE' AS field_name\n    ,case\n        when cg.frequency > 1 then 'multiple'\n        when m.admission_date > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'invalid'\n        when m.admission_date < \n\n    dateadd(\n        year,\n        -10,\n        cte.tuva_last_run\n        )\n\n then 'invalid'\n        when m.admission_date is null then 'null'\n        else 'valid'\n    end as bucket_name\n    ,case\n        when cg.frequency > 1 then 'multiple'\n        when m.admission_date > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'future'\n        when m.admission_date < \n\n    dateadd(\n        year,\n        -10,\n        cte.tuva_last_run\n        )\n\n then 'too old'\n        else null\n    end as invalid_reason\n    ,cast(substring(agg.field_aggregated, 1, 255) as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom base m\nleft join claim_grain cg on m.claim_id = cg.claim_id and m.data_source = cg.data_source\nleft join claim_agg agg on m.claim_id = agg.claim_id and m.data_source = agg.data_source\ncross join tuva_last_run cte", "relation_name": "tuva.data_quality.institutional_admission_date"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.678752Z", "completed_at": "2025-02-25T21:26:17.720810Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.721820Z", "completed_at": "2025-02-25T21:26:17.721825Z"}], "thread_id": "Thread-2", "execution_time": 0.04881095886230469, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__institutional_admit_source_code", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte__data_quality__stg_institutional_inpatient as (\n\n\n\n    SELECT *\n    FROM tuva.input_layer.medical_claim\n    WHERE claim_type = 'institutional'\n    AND \n  substr(bill_type_code, 1, 2)\n = '11'\n), base as (\nselect *\nfrom __dbt__cte__data_quality__stg_institutional_inpatient\n),\n\nunique_field as (\n    select distinct claim_id\n        , base.admit_source_code || '|' || coalesce(term.admit_source_description, '') as field\n        , data_source\n    from base\n    left join tuva.terminology.admit_source as term on base.admit_source_code = term.admit_source_code\n),\n\nclaim_grain as (\n    select claim_id\n        , data_source\n        , count(*) as frequency\n    from unique_field\n    group by claim_id\n        , data_source\n),\n\nclaim_agg as (\nselect\n      claim_id\n    , data_source\n    , \n    listagg(\n        coalesce(field, 'null'),\n        ', '\n        )\n        within group (order by field desc) as field_aggregated\nfrom\n    unique_field\ngroup by\n      claim_id\n    , data_source\n)\n\nselect distinct -- to bring to claim_id grain\n      m.data_source\n    , coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'MEDICAL_CLAIM' AS table_name\n    , 'Claim ID' AS drill_down_key\n    , coalesce(m.claim_id, 'NULL') AS drill_down_value\n    , 'institutional' AS claim_type\n    , 'ADMIT_SOURCE_CODE' AS field_name\n    , case when cg.frequency > 1                then 'multiple'\n          when term.admit_source_code is not null then 'valid'\n          when m.admit_source_code is not null    then 'invalid'\n                                               else 'null' end as bucket_name\n    , case\n        when m.admit_source_code is not null\n            and term.admit_source_code is null\n            and cg. frequency = 1\n            then 'Admit source code does not join to Terminology Admit Source table'\n        else null\n    end as invalid_reason\n    , cast(\n  substr(agg.field_aggregated, 1, 255)\n as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom base m\nleft join claim_grain cg on m.claim_id = cg.claim_id and m.data_source = cg.data_source\nleft join tuva.terminology.admit_source as term on m.admit_source_code = term.admit_source_code\nleft join claim_agg agg on m.claim_id = agg.claim_id and m.data_source = agg.data_source", "relation_name": "tuva.data_quality.institutional_admit_source_code"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.723919Z", "completed_at": "2025-02-25T21:26:17.763524Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.763949Z", "completed_at": "2025-02-25T21:26:17.763957Z"}], "thread_id": "Thread-3", "execution_time": 0.0426328182220459, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__institutional_admit_type_code", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte__data_quality__stg_institutional_inpatient as (\n\n\n\n    SELECT *\n    FROM tuva.input_layer.medical_claim\n    WHERE claim_type = 'institutional'\n    AND \n  substr(bill_type_code, 1, 2)\n = '11'\n), base as (\nselect *\nfrom __dbt__cte__data_quality__stg_institutional_inpatient\n),\n\nunique_field as (\n    select distinct claim_id\n        , base.admit_type_code || '|' || coalesce(term.admit_type_description, '') as field\n        , data_source\n    from base\n    left join tuva.terminology.admit_type as term on base.admit_type_code = term.admit_type_code\n),\n\nclaim_grain as (\n    select claim_id\n        , data_source\n        , count(*) as frequency\n    from unique_field\n    group by claim_id\n        , data_source\n),\n\nclaim_agg as (\nselect\n      claim_id\n    , data_source\n    , \n    listagg(\n        coalesce(field, 'null'),\n        ', '\n        )\n        within group (order by field desc) as field_aggregated\nfrom\n    unique_field\ngroup by\n      claim_id\n    , data_source\n\t)\n\nselect distinct -- to bring to claim_id grain\n      m.data_source\n    , coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'MEDICAL_CLAIM' AS table_name\n    , 'Member ID' AS drill_down_key\n    , coalesce(m.claim_id, 'NULL') AS drill_down_value\n    , 'institutional' AS claim_type\n    , 'ADMIT_TYPE_CODE' AS field_name\n    , case when cg.frequency > 1                then 'multiple'\n          when term.admit_type_code is not null then 'valid'\n          when m.admit_type_code is not null    then 'invalid'\n                                               else 'null' end as bucket_name\n    , case\n        when m.admit_type_code is not null\n            and term.admit_type_code is null\n            and cg.frequency = 1\n            then 'Admit Type Code does not join to Terminology Admit Type table'\n        else null\n    end as invalid_reason\n    , cast(\n  substr(agg.field_aggregated, 1, 255)\n as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom base m\nleft join claim_grain cg on m.claim_id = cg.claim_id and m.data_source = cg.data_source\nleft join tuva.terminology.admit_type as term on m.admit_type_code = term.admit_type_code\nleft join claim_agg agg on m.claim_id = agg.claim_id and m.data_source = agg.data_source", "relation_name": "tuva.data_quality.institutional_admit_type_code"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.742714Z", "completed_at": "2025-02-25T21:26:17.765153Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.777245Z", "completed_at": "2025-02-25T21:26:17.777253Z"}], "thread_id": "Thread-2", "execution_time": 0.03581714630126953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__institutional_discharge_date", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte__data_quality__stg_institutional_inpatient as (\n\n\n\n    SELECT *\n    FROM tuva.input_layer.medical_claim\n    WHERE claim_type = 'institutional'\n    AND \n  substr(bill_type_code, 1, 2)\n = '11'\n), base as (\nselect *\nfrom __dbt__cte__data_quality__stg_institutional_inpatient\n)\n, tuva_last_run as(\n    select cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) as tuva_last_run\n)\n,unique_field as (\n    select distinct claim_id\n        ,cast(discharge_date as TEXT) as field\n        ,data_source\n    from base\n),\nclaim_grain as (\n    select claim_id\n        ,data_source\n        ,count(*) as frequency\n    from unique_field\n    group by claim_id\n        ,data_source\n),\nclaim_agg as (\nselect\n    claim_id,\n    data_source,\n    \n    listagg(\n        coalesce(field, 'null'),\n        ', '\n        )\n        within group (order by field desc) as field_aggregated\nfrom\n    unique_field\ngroup by\n    claim_id,\n    data_source\n)\nselect distinct -- to bring to claim_id grain\n    m.data_source\n    ,coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'MEDICAL_CLAIM' AS table_name\n    ,'Claim ID' AS drill_down_key\n    ,coalesce(m.claim_id, 'NULL') AS drill_down_value\n    ,'institutional' AS claim_type\n    ,'DISCHARGE_DATE' AS field_name\n    ,case\n        when cg.frequency > 1 then 'multiple'\n        when m.discharge_date > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'invalid'\n        when m.discharge_date < \n\n    dateadd(\n        year,\n        -10,\n        cte.tuva_last_run\n        )\n\n then 'invalid'\n        when m.discharge_date < m.admission_date then 'invalid'\n        when m.discharge_date is null then 'null'\n        else 'valid'\n    end as bucket_name\n    ,case\n        when cg.frequency > 1 then 'multiple'\n        when m.discharge_date > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'future'\n        when m.discharge_date < \n\n    dateadd(\n        year,\n        -10,\n        cte.tuva_last_run\n        )\n\n then 'too old'\n        when m.discharge_date < m.admission_date then 'discharge date before admission date'\n        else null\n    end as invalid_reason\n    ,cast(\n  substr(agg.field_aggregated, 1, 255)\n as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom base m\nleft join claim_grain cg on m.claim_id = cg.claim_id and m.data_source = cg.data_source\nleft join claim_agg agg on m.claim_id = agg.claim_id and m.data_source = agg.data_source\ncross join tuva_last_run cte", "relation_name": "tuva.data_quality.institutional_discharge_date"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.765346Z", "completed_at": "2025-02-25T21:26:17.802609Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.802928Z", "completed_at": "2025-02-25T21:26:17.802938Z"}], "thread_id": "Thread-3", "execution_time": 0.03836417198181152, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__institutional_drg_code", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte__data_quality__stg_institutional_inpatient as (\n\n\n\n    SELECT *\n    FROM tuva.input_layer.medical_claim\n    WHERE claim_type = 'institutional'\n    AND \n  substr(bill_type_code, 1, 2)\n = '11'\n), base as (\nselect *\nfrom __dbt__cte__data_quality__stg_institutional_inpatient\n),\n\nunique_field as (\n    select distinct claim_id\n        , base.drg_code || '|' || coalesce(ms.ms_drg_description, apr.apr_drg_description, '') as field\n        , data_source\n    from base\n    left join tuva.terminology.ms_drg as ms on base.drg_code = ms.ms_drg_code and base.drg_code_type = 'ms-drg'\n    left join tuva.terminology.apr_drg as apr on base.drg_code = apr.apr_drg_code and base.drg_code_type = 'apr-drg'\n),\n\nclaim_grain as (\n    select claim_id\n        , data_source\n        , count(*) as frequency\n    from unique_field\n    group by claim_id\n        , data_source\n),\n\nclaim_agg as (\nselect\n      claim_id\n    , data_source\n    , \n    listagg(\n        coalesce(field, 'null'),\n        ', '\n        )\n        within group (order by field desc) as field_aggregated\nfrom\n    unique_field\ngroup by\n      claim_id\n    , data_source\n\n)\n\nselect distinct -- to bring to claim_id grain\n      m.data_source\n    , coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'MEDICAL_CLAIM' AS table_name\n    , 'Claim ID' AS drill_down_key\n    , coalesce(m.claim_id, 'NULL') AS drill_down_value\n    , 'institutional' AS claim_type\n    , 'DRG_CODE' AS field_name\n    , case when cg.frequency > 1                then 'multiple'\n          when coalesce(ms.ms_drg_code, apr.apr_drg_code) is not null then 'valid'\n          when m.drg_code is not null    then 'invalid'\n                                               else 'null' end as bucket_name\n    , case\n        when cg.frequency = 1\n            and m.drg_code is not null\n            and coalesce(ms.ms_drg_code, apr.apr_drg_code) is null\n            then 'DRG code does not join to Terminology DRG table'\n        else null\n    end as invalid_reason\n    , cast(\n  substr(agg.field_aggregated, 1, 255)\n as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom base m\nleft join claim_grain cg on m.claim_id = cg.claim_id and m.data_source = cg.data_source\nleft join tuva.terminology.ms_drg as ms on m.drg_code = ms.ms_drg_code and m.drg_code_type = 'ms-drg'\nleft join tuva.terminology.apr_drg as apr on m.drg_code = apr.apr_drg_code and m.drg_code_type = 'apr-drg'\nleft join claim_agg agg on m.claim_id = agg.claim_id and m.data_source = agg.data_source", "relation_name": "tuva.data_quality.institutional_drg_code"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.784245Z", "completed_at": "2025-02-25T21:26:17.803991Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.804415Z", "completed_at": "2025-02-25T21:26:17.804419Z"}], "thread_id": "Thread-2", "execution_time": 0.020952701568603516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__institutional_procedure_code_1", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte__data_quality__stg_institutional_inpatient as (\n\n\n\n    SELECT *\n    FROM tuva.input_layer.medical_claim\n    WHERE claim_type = 'institutional'\n    AND \n  substr(bill_type_code, 1, 2)\n = '11'\n), base as (\nselect *\nfrom __dbt__cte__data_quality__stg_institutional_inpatient\n),\n\nunique_field as (\n    select distinct claim_id\n        , procedure_code_1 || '|' || coalesce(term.description, '') as field\n        , data_source\n    from base\n    left join tuva.terminology.icd_10_pcs as term on base.procedure_code_1 = term.icd_10_pcs\n),\n\nclaim_grain as (\n    select claim_id\n        , data_source\n        , count(*) as frequency\n    from unique_field\n    group by claim_id\n        , data_source\n),\n\nclaim_agg as (\nselect\n      claim_id\n    , data_source\n    , \n    listagg(\n        coalesce(field, 'null'),\n        ', '\n        )\n        within group (order by field desc) as field_aggregated\nfrom\n    unique_field\ngroup by\n      claim_id\n    , data_source\n\t)\n\nselect distinct -- to bring to claim_id grain\n      m.data_source\n    , coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'MEDICAL_CLAIM' AS table_name\n    , 'Claim ID' AS drill_down_key\n    , coalesce(m.claim_id, 'NULL') AS drill_down_value\n    , 'institutional' AS claim_type\n    , 'PROCEDURE_CODE_1' AS field_name\n    , case when cg.frequency > 1                then 'multiple'\n          when term.icd_10_pcs is not null      then 'valid'\n          when m.procedure_code_1 is not null  then 'invalid'\n                                               else 'null' end as bucket_name\n    , case\n        when cg.frequency = 1\n            and m.procedure_code_1 is not null\n            and term.icd_10_pcs is null\n            then 'procedure code does not join to terminology procedure code table'\n        else null\n    end as invalid_reason\n    , cast(\n  substr(agg.field_aggregated, 1, 255)\n as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom base m\nleft join claim_grain cg on m.claim_id = cg.claim_id and m.data_source = cg.data_source\nleft join tuva.terminology.icd_10_pcs as term on m.procedure_code_1 = term.icd_10_pcs\nleft join claim_agg agg on m.claim_id = agg.claim_id and m.data_source = agg.data_source", "relation_name": "tuva.data_quality.institutional_procedure_code_1"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.804792Z", "completed_at": "2025-02-25T21:26:17.837262Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.837506Z", "completed_at": "2025-02-25T21:26:17.837512Z"}], "thread_id": "Thread-3", "execution_time": 0.033843994140625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__institutional_procedure_code_2", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte__data_quality__stg_institutional_inpatient as (\n\n\n\n    SELECT *\n    FROM tuva.input_layer.medical_claim\n    WHERE claim_type = 'institutional'\n    AND \n  substr(bill_type_code, 1, 2)\n = '11'\n), base as (\nselect *\nfrom __dbt__cte__data_quality__stg_institutional_inpatient\n),\n\nunique_field as (\n    select distinct claim_id\n        , procedure_code_2 || '|' || coalesce(term.description, '') as field\n        , data_source\n    from base\n    left join tuva.terminology.icd_10_pcs as term on base.procedure_code_1 = term.icd_10_pcs\n),\n\nclaim_grain as (\n    select claim_id\n        , data_source\n        , count(*) as frequency\n    from unique_field\n    group by claim_id\n        , data_source\n),\n\nclaim_agg as (\nselect\n      claim_id\n    , data_source\n    , \n    listagg(\n        coalesce(field, 'null'),\n        ', '\n        )\n        within group (order by field desc) as field_aggregated\nfrom\n    unique_field\ngroup by\n      claim_id\n    , data_source\n\t)\n\nselect distinct -- to bring to claim_id grain\n      m.data_source\n    , coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'MEDICAL_CLAIM' AS table_name\n    , 'Claim ID' AS drill_down_key\n    , coalesce(m.claim_id, 'NULL') AS drill_down_value\n    , 'institutional' AS claim_type\n    , 'PROCEDURE_CODE_2' AS field_name\n    , case when cg.frequency > 1                then 'multiple'\n          when term.icd_10_pcs is not null      then 'valid'\n          when m.procedure_code_2 is not null  then 'invalid'\n                                               else 'null' end as bucket_name\n    , case\n        when cg.frequency = 1\n            and m.procedure_code_2 is not null\n            and term.icd_10_pcs is null\n            then 'Procedure Code does not join to Terminology Procedure Code Table'\n        else null\n    end as invalid_reason\n    , cast(\n  substr(agg.field_aggregated, 1, 255)\n as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom base m\nleft join claim_grain cg on m.claim_id = cg.claim_id and m.data_source = cg.data_source\nleft join tuva.terminology.icd_10_pcs as term on m.procedure_code_2 = term.icd_10_pcs\nleft join claim_agg agg on m.claim_id = agg.claim_id and m.data_source = agg.data_source", "relation_name": "tuva.data_quality.institutional_procedure_code_2"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.821273Z", "completed_at": "2025-02-25T21:26:17.844713Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.860236Z", "completed_at": "2025-02-25T21:26:17.860244Z"}], "thread_id": "Thread-2", "execution_time": 0.03958296775817871, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__institutional_procedure_code_3", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte__data_quality__stg_institutional_inpatient as (\n\n\n\n    SELECT *\n    FROM tuva.input_layer.medical_claim\n    WHERE claim_type = 'institutional'\n    AND \n  substr(bill_type_code, 1, 2)\n = '11'\n), base as (\nselect *\nfrom __dbt__cte__data_quality__stg_institutional_inpatient\n),\n\nunique_field as (\n    select distinct claim_id\n        , procedure_code_3 || '|' || coalesce(term.description, '') as field\n        , data_source\n    from base\n    left join tuva.terminology.icd_10_pcs as term on base.procedure_code_3 = term.icd_10_pcs\n),\n\nclaim_grain as (\n    select claim_id\n        , data_source\n        , count(*) as frequency\n    from unique_field\n    group by claim_id\n        , data_source\n),\n\nclaim_agg as (\nselect\n      claim_id\n    , data_source\n    , \n    listagg(\n        coalesce(field, 'null'),\n        ', '\n        )\n        within group (order by field desc) as field_aggregated\nfrom\n    unique_field\ngroup by\n      claim_id\n    , data_source\n)\n\nselect distinct -- to bring to claim_id grain\n      m.data_source\n    , coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    , 'MEDICAL_CLAIM' AS table_name\n    , 'Claim ID' AS drill_down_key\n    , coalesce(m.claim_id, 'NULL') AS drill_down_value\n    , 'institutional' AS claim_type\n    , 'PROCEDURE_CODE_3' AS field_name\n    , case when cg.frequency > 1                then 'multiple'\n          when term.icd_10_pcs is not null      then 'valid'\n          when m.procedure_code_3 is not null  then 'invalid'\n                                               else 'null' end as bucket_name\n    , case\n        when cg.frequency = 1\n            and m.procedure_code_3 is not null\n            and term.icd_10_pcs is null\n            then 'Procedure Code does not join to Terminology Procedure Code Table'\n        else null\n    end as invalid_reason\n    , cast(\n  substr(agg.field_aggregated, 1, 255)\n as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom base m\nleft join claim_grain cg on m.claim_id = cg.claim_id and m.data_source = cg.data_source\nleft join tuva.terminology.icd_10_pcs as term on m.procedure_code_3 = term.icd_10_pcs\nleft join claim_agg agg on m.claim_id = agg.claim_id and m.data_source = agg.data_source", "relation_name": "tuva.data_quality.institutional_procedure_code_3"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.838748Z", "completed_at": "2025-02-25T21:26:17.885086Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.885357Z", "completed_at": "2025-02-25T21:26:17.885364Z"}], "thread_id": "Thread-3", "execution_time": 0.04733014106750488, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__institutional_procedure_date_1", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte__data_quality__stg_institutional_inpatient as (\n\n\n\n    SELECT *\n    FROM tuva.input_layer.medical_claim\n    WHERE claim_type = 'institutional'\n    AND \n  substr(bill_type_code, 1, 2)\n = '11'\n), base as (\nselect *\nfrom __dbt__cte__data_quality__stg_institutional_inpatient\n)\n, tuva_last_run as(\n    select cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) as tuva_last_run\n)\n, unique_field as (\n    select distinct claim_id\n        ,cast(procedure_date_1 as TEXT)  as field\n        ,data_source\n    from base\n\n),\nclaim_grain as (\n    select claim_id\n        ,data_source\n        ,count(*) as frequency\n    from unique_field\n    group by claim_id\n        ,data_source\n),\nclaim_agg as (\nselect\n    claim_id,\n    data_source,\n    \n    listagg(\n        coalesce(field, 'null'),\n        ', '\n        )\n        within group (order by field desc) as field_aggregated\nfrom\n    unique_field\ngroup by\n    claim_id,\n    data_source\n\t)\nselect distinct -- to bring to claim_id grain\n    m.data_source\n    ,coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'MEDICAL_CLAIM' AS table_name\n    ,'Claim ID' AS drill_down_key\n    ,coalesce(m.claim_id, 'NULL') AS drill_down_value\n    ,'institutional' AS claim_type\n    ,'PROCEDURE_DATE_1' AS field_name\n    ,case\n        when cg.frequency > 1 then 'multiple'\n        when m.procedure_date_1 > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'invalid'\n        when m.procedure_date_1 < \n\n    dateadd(\n        year,\n        -10,\n        cte.tuva_last_run\n        )\n\n then 'invalid'\n        when not (m.procedure_date_1 between m.claim_start_date and m.claim_end_date) then 'invalid'\n        when m.procedure_date_1 is null then 'null'\n        else 'valid'\n    end as bucket_name\n    ,case\n        when cg.frequency > 1 then 'multiple'\n        when m.procedure_date_1 > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'future'\n        when m.procedure_date_1 < \n\n    dateadd(\n        year,\n        -10,\n        cte.tuva_last_run\n        )\n\n then 'too old'\n        when not (m.procedure_date_1 between m.claim_start_date and m.claim_end_date) then 'procedure date not between claim start and end dates'\n        else null\n        end as invalid_reason\n    ,cast(\n  substr(agg.field_aggregated, 1, 255)\n as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom base m\nleft join claim_grain cg on m.claim_id = cg.claim_id and m.data_source = cg.data_source\nleft join claim_agg agg on m.claim_id = agg.claim_id and m.data_source = agg.data_source\ncross join tuva_last_run cte", "relation_name": "tuva.data_quality.institutional_procedure_date_1"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.861513Z", "completed_at": "2025-02-25T21:26:17.892366Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.905247Z", "completed_at": "2025-02-25T21:26:17.905255Z"}], "thread_id": "Thread-2", "execution_time": 0.04428601264953613, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__institutional_procedure_date_2", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte__data_quality__stg_institutional_inpatient as (\n\n\n\n    SELECT *\n    FROM tuva.input_layer.medical_claim\n    WHERE claim_type = 'institutional'\n    AND \n  substr(bill_type_code, 1, 2)\n = '11'\n), base as (\nselect *\nfrom __dbt__cte__data_quality__stg_institutional_inpatient\n)\n, tuva_last_run as(\n\n    select cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) as tuva_last_run\n\n)\n,unique_field as (\n    select distinct claim_id\n        ,cast(procedure_date_2 as TEXT)  as field\n        ,data_source\n    from base\n\n),\nclaim_grain as (\n    select claim_id\n        ,data_source\n        ,count(*) as frequency\n    from unique_field\n    group by claim_id\n        ,data_source\n),\nclaim_agg as (\nselect\n    claim_id,\n    data_source,\n    \n    listagg(\n        coalesce(field, 'null'),\n        ', '\n        )\n        within group (order by field desc) as field_aggregated\nfrom\n    unique_field\ngroup by\n    claim_id,\n    data_source\n\t)\nselect distinct -- to bring to claim_id grain\n    m.data_source\n    ,coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'MEDICAL_CLAIM' AS table_name\n    ,'Claim ID' AS drill_down_key\n    ,coalesce(m.claim_id, 'NULL') AS drill_down_value\n    ,'institutional' AS claim_type\n    ,'PROCEDURE_DATE_2' AS field_name\n    ,case\n        when cg.frequency > 1 then 'multiple'\n        when m.procedure_date_2 > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'invalid'\n        when m.procedure_date_2 < \n\n    dateadd(\n        year,\n        -10,\n        cte.tuva_last_run\n        )\n\n then 'invalid'\n        when not (m.procedure_date_2 between m.claim_start_date and m.claim_end_date) then 'invalid'\n        when m.procedure_date_2 is null then 'null'\n        else 'valid'\n    end as bucket_name\n    ,case\n        when cg.frequency > 1 then 'multiple'\n        when m.procedure_date_2 > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'future'\n        when m.procedure_date_2 < \n\n    dateadd(\n        year,\n        -10,\n        cte.tuva_last_run\n        )\n\n then 'too old'\n        when not (m.procedure_date_2 between m.claim_start_date and m.claim_end_date) then 'procedure date not between claim start and end dates'\n        when m.procedure_date_2 is null then null\n        else 'valid'\n    end as invalid_reason\n    ,cast(\n  substr(agg.field_aggregated, 1, 255)\n as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom base m\nleft join claim_grain cg on m.claim_id = cg.claim_id and m.data_source = cg.data_source\nleft join claim_agg agg on m.claim_id = agg.claim_id and m.data_source = agg.data_source\ncross join tuva_last_run cte", "relation_name": "tuva.data_quality.institutional_procedure_date_2"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.886484Z", "completed_at": "2025-02-25T21:26:17.919983Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.920228Z", "completed_at": "2025-02-25T21:26:17.920234Z"}], "thread_id": "Thread-3", "execution_time": 0.03426194190979004, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__institutional_procedure_date_3", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte__data_quality__stg_institutional_inpatient as (\n\n\n\n    SELECT *\n    FROM tuva.input_layer.medical_claim\n    WHERE claim_type = 'institutional'\n    AND \n  substr(bill_type_code, 1, 2)\n = '11'\n), base as (\nselect *\nfrom __dbt__cte__data_quality__stg_institutional_inpatient\n)\n, tuva_last_run as(\n\n    select cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) as tuva_last_run\n\n)\n\n,unique_field as (\n    select distinct claim_id\n        ,cast(procedure_date_3 as TEXT)  as field\n        ,data_source\n    from base\n\n),\nclaim_grain as (\n    select claim_id\n        ,data_source\n        ,count(*) as frequency\n    from unique_field\n    group by claim_id\n        ,data_source\n),\nclaim_agg as (\nselect\n    claim_id,\n    data_source,\n    \n    listagg(\n        coalesce(field, 'null'),\n        ', '\n        )\n        within group (order by field desc) as field_aggregated\nfrom\n    unique_field\ngroup by\n    claim_id,\n    data_source\n\t)\nselect distinct -- to bring to claim_id grain\n    m.data_source\n    ,coalesce(cast(m.claim_start_date as TEXT),cast('1900-01-01' as TEXT)) as source_date\n    ,'MEDICAL_CLAIM' AS table_name\n    ,'Claim ID' AS drill_down_key\n    ,coalesce(m.claim_id, 'NULL') AS drill_down_value\n    ,'institutional' AS claim_type\n    ,'PROCEDURE_DATE_3' AS field_name\n    ,case\n        when cg.frequency > 1 then 'multiple'\n        when m.procedure_date_3 > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'invalid'\n        when m.procedure_date_3 < \n\n    dateadd(\n        year,\n        -10,\n        cte.tuva_last_run\n        )\n\n then 'invalid'\n        when not (m.procedure_date_3 between m.claim_start_date and m.claim_end_date) then 'invalid'\n        when m.procedure_date_3 is null then 'null'\n        else 'valid'\n    end as bucket_name\n    ,case\n        when cg.frequency > 1 then 'multiple'\n        when m.procedure_date_3 > cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) then 'future'\n        when m.procedure_date_3 < \n\n    dateadd(\n        year,\n        -10,\n        cte.tuva_last_run\n        )\n\n then 'too old'\n        when not (m.procedure_date_3 between m.claim_start_date and m.claim_end_date) then 'procedure date not between claim start and end dates'\n        else null\n        end as invalid_reason\n    ,cast(\n  substr(agg.field_aggregated, 1, 255)\n as TEXT) as field_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom base m\nleft join claim_grain cg on m.claim_id = cg.claim_id and m.data_source = cg.data_source\nleft join claim_agg agg on m.claim_id = agg.claim_id and m.data_source = agg.data_source\ncross join tuva_last_run cte", "relation_name": "tuva.data_quality.institutional_procedure_date_3"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.909281Z", "completed_at": "2025-02-25T21:26:17.934186Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.934428Z", "completed_at": "2025-02-25T21:26:17.934435Z"}], "thread_id": "Thread-2", "execution_time": 0.025681018829345703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.normalized_input__int_admit_source_voting", "compiled": true, "compiled_code": "\n\n\n\nwith  __dbt__cte__normalized_input__stg_medical_claim as (\n\n\nselect\n      claim_id\n    , claim_line_number\n    , claim_type\n    , person_id\n    , member_id\n    , payer\n    , plan\n    , claim_start_date\n    , claim_end_date\n    , claim_line_start_date\n    , claim_line_end_date\n    , admission_date\n    , discharge_date\n    , admit_source_code\n    , admit_type_code\n    , discharge_disposition_code\n    , place_of_service_code\n    , bill_type_code\n    , drg_code_type\n    , drg_code\n    , revenue_center_code\n    , service_unit_quantity\n    , hcpcs_code\n    , hcpcs_modifier_1\n    , hcpcs_modifier_2\n    , hcpcs_modifier_3\n    , hcpcs_modifier_4\n    , hcpcs_modifier_5\n    , rendering_npi\n    , rendering_tin\n    , billing_npi\n    , billing_tin\n    , facility_npi\n    , paid_date\n    , paid_amount\n    , allowed_amount\n    , charge_amount\n    , coinsurance_amount\n    , copayment_amount\n    , deductible_amount\n    , total_cost_amount\n    , diagnosis_code_type\n    , diagnosis_code_1\n    , diagnosis_code_2\n    , diagnosis_code_3\n    , diagnosis_code_4\n    , diagnosis_code_5\n    , diagnosis_code_6\n    , diagnosis_code_7\n    , diagnosis_code_8\n    , diagnosis_code_9\n    , diagnosis_code_10\n    , diagnosis_code_11\n    , diagnosis_code_12\n    , diagnosis_code_13\n    , diagnosis_code_14\n    , diagnosis_code_15\n    , diagnosis_code_16\n    , diagnosis_code_17\n    , diagnosis_code_18\n    , diagnosis_code_19\n    , diagnosis_code_20\n    , diagnosis_code_21\n    , diagnosis_code_22\n    , diagnosis_code_23\n    , diagnosis_code_24\n    , diagnosis_code_25\n    , diagnosis_poa_1\n    , diagnosis_poa_2\n    , diagnosis_poa_3\n    , diagnosis_poa_4\n    , diagnosis_poa_5\n    , diagnosis_poa_6\n    , diagnosis_poa_7\n    , diagnosis_poa_8\n    , diagnosis_poa_9\n    , diagnosis_poa_10\n    , diagnosis_poa_11\n    , diagnosis_poa_12\n    , diagnosis_poa_13\n    , diagnosis_poa_14\n    , diagnosis_poa_15\n    , diagnosis_poa_16\n    , diagnosis_poa_17\n    , diagnosis_poa_18\n    , diagnosis_poa_19\n    , diagnosis_poa_20\n    , diagnosis_poa_21\n    , diagnosis_poa_22\n    , diagnosis_poa_23\n    , diagnosis_poa_24\n    , diagnosis_poa_25\n    , procedure_code_type\n    , procedure_code_1\n    , procedure_code_2\n    , procedure_code_3\n    , procedure_code_4\n    , procedure_code_5\n    , procedure_code_6\n    , procedure_code_7\n    , procedure_code_8\n    , procedure_code_9\n    , procedure_code_10\n    , procedure_code_11\n    , procedure_code_12\n    , procedure_code_13\n    , procedure_code_14\n    , procedure_code_15\n    , procedure_code_16\n    , procedure_code_17\n    , procedure_code_18\n    , procedure_code_19\n    , procedure_code_20\n    , procedure_code_21\n    , procedure_code_22\n    , procedure_code_23\n    , procedure_code_24\n    , procedure_code_25\n    , procedure_date_1\n    , procedure_date_2\n    , procedure_date_3\n    , procedure_date_4\n    , procedure_date_5\n    , procedure_date_6\n    , procedure_date_7\n    , procedure_date_8\n    , procedure_date_9\n    , procedure_date_10\n    , procedure_date_11\n    , procedure_date_12\n    , procedure_date_13\n    , procedure_date_14\n    , procedure_date_15\n    , procedure_date_16\n    , procedure_date_17\n    , procedure_date_18\n    , procedure_date_19\n    , procedure_date_20\n    , procedure_date_21\n    , procedure_date_22\n    , procedure_date_23\n    , procedure_date_24\n    , procedure_date_25\n    , in_network_flag\n    , data_source\n    , file_name\n    , file_date\n    , ingest_datetime\nfrom tuva.input_layer.medical_claim\n), normalize_cte as(\n    select \n        med.claim_id\n        , med.data_source\n        , admit.admit_source_code\n\n        , admit.admit_source_description\n    from __dbt__cte__normalized_input__stg_medical_claim med\n    inner join tuva.terminology.admit_source admit\n        on med.admit_source_code = admit.admit_source_code\n    where claim_type = 'institutional'\n)\n, distinct_counts as(\n    select \n        claim_id\n        , data_source\n        , admit_source_code\n        , admit_source_description\n        , count(*) as admit_source_occurrence_count\n    from normalize_cte\n    where admit_source_code is not null\n    group by \n        claim_id\n        , data_source\n        , admit_source_code\n        , admit_source_description\n)\n\n, occurence_comparison as(\n    select\n        claim_id\n        , data_source\n        , 'admit_source_code' as column_name\n        , admit_source_code as normalized_code\n        , admit_source_description as normalized_description\n        , admit_source_occurrence_count as occurrence_count\n        , coalesce(lead(admit_source_occurrence_count) \n            over (partition by claim_id, data_source order by admit_source_occurrence_count desc),0) as next_occurrence_count\n        , row_number() over (partition by claim_id, data_source order by admit_source_occurrence_count desc) as occurrence_row_count\n    from distinct_counts dist\n)\n\nselect\n    claim_id\n    , data_source\n    , column_name\n    , normalized_code\n    , normalized_description\n    , occurrence_count\n    , next_occurrence_count\n    , occurrence_row_count\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom occurence_comparison", "relation_name": "tuva.claims_preprocessing._int_normalized_input_admit_source_voting"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.921293Z", "completed_at": "2025-02-25T21:26:17.934829Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.935305Z", "completed_at": "2025-02-25T21:26:17.935308Z"}], "thread_id": "Thread-3", "execution_time": 0.014490842819213867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.normalized_input__int_admit_type_voting", "compiled": true, "compiled_code": "\n\n\nwith  __dbt__cte__normalized_input__stg_medical_claim as (\n\n\nselect\n      claim_id\n    , claim_line_number\n    , claim_type\n    , person_id\n    , member_id\n    , payer\n    , plan\n    , claim_start_date\n    , claim_end_date\n    , claim_line_start_date\n    , claim_line_end_date\n    , admission_date\n    , discharge_date\n    , admit_source_code\n    , admit_type_code\n    , discharge_disposition_code\n    , place_of_service_code\n    , bill_type_code\n    , drg_code_type\n    , drg_code\n    , revenue_center_code\n    , service_unit_quantity\n    , hcpcs_code\n    , hcpcs_modifier_1\n    , hcpcs_modifier_2\n    , hcpcs_modifier_3\n    , hcpcs_modifier_4\n    , hcpcs_modifier_5\n    , rendering_npi\n    , rendering_tin\n    , billing_npi\n    , billing_tin\n    , facility_npi\n    , paid_date\n    , paid_amount\n    , allowed_amount\n    , charge_amount\n    , coinsurance_amount\n    , copayment_amount\n    , deductible_amount\n    , total_cost_amount\n    , diagnosis_code_type\n    , diagnosis_code_1\n    , diagnosis_code_2\n    , diagnosis_code_3\n    , diagnosis_code_4\n    , diagnosis_code_5\n    , diagnosis_code_6\n    , diagnosis_code_7\n    , diagnosis_code_8\n    , diagnosis_code_9\n    , diagnosis_code_10\n    , diagnosis_code_11\n    , diagnosis_code_12\n    , diagnosis_code_13\n    , diagnosis_code_14\n    , diagnosis_code_15\n    , diagnosis_code_16\n    , diagnosis_code_17\n    , diagnosis_code_18\n    , diagnosis_code_19\n    , diagnosis_code_20\n    , diagnosis_code_21\n    , diagnosis_code_22\n    , diagnosis_code_23\n    , diagnosis_code_24\n    , diagnosis_code_25\n    , diagnosis_poa_1\n    , diagnosis_poa_2\n    , diagnosis_poa_3\n    , diagnosis_poa_4\n    , diagnosis_poa_5\n    , diagnosis_poa_6\n    , diagnosis_poa_7\n    , diagnosis_poa_8\n    , diagnosis_poa_9\n    , diagnosis_poa_10\n    , diagnosis_poa_11\n    , diagnosis_poa_12\n    , diagnosis_poa_13\n    , diagnosis_poa_14\n    , diagnosis_poa_15\n    , diagnosis_poa_16\n    , diagnosis_poa_17\n    , diagnosis_poa_18\n    , diagnosis_poa_19\n    , diagnosis_poa_20\n    , diagnosis_poa_21\n    , diagnosis_poa_22\n    , diagnosis_poa_23\n    , diagnosis_poa_24\n    , diagnosis_poa_25\n    , procedure_code_type\n    , procedure_code_1\n    , procedure_code_2\n    , procedure_code_3\n    , procedure_code_4\n    , procedure_code_5\n    , procedure_code_6\n    , procedure_code_7\n    , procedure_code_8\n    , procedure_code_9\n    , procedure_code_10\n    , procedure_code_11\n    , procedure_code_12\n    , procedure_code_13\n    , procedure_code_14\n    , procedure_code_15\n    , procedure_code_16\n    , procedure_code_17\n    , procedure_code_18\n    , procedure_code_19\n    , procedure_code_20\n    , procedure_code_21\n    , procedure_code_22\n    , procedure_code_23\n    , procedure_code_24\n    , procedure_code_25\n    , procedure_date_1\n    , procedure_date_2\n    , procedure_date_3\n    , procedure_date_4\n    , procedure_date_5\n    , procedure_date_6\n    , procedure_date_7\n    , procedure_date_8\n    , procedure_date_9\n    , procedure_date_10\n    , procedure_date_11\n    , procedure_date_12\n    , procedure_date_13\n    , procedure_date_14\n    , procedure_date_15\n    , procedure_date_16\n    , procedure_date_17\n    , procedure_date_18\n    , procedure_date_19\n    , procedure_date_20\n    , procedure_date_21\n    , procedure_date_22\n    , procedure_date_23\n    , procedure_date_24\n    , procedure_date_25\n    , in_network_flag\n    , data_source\n    , file_name\n    , file_date\n    , ingest_datetime\nfrom tuva.input_layer.medical_claim\n), normalize_cte as(\n    select \n        med.claim_id\n        , med.data_source\n        , admit.admit_type_code\n        , admit.admit_type_description\n    from __dbt__cte__normalized_input__stg_medical_claim med\n    inner join tuva.terminology.admit_type admit\n        on med.admit_type_code = admit.admit_type_code\n    where claim_type = 'institutional'\n)\n, distinct_counts as(\n    select \n        claim_id\n        , data_source\n        , admit_type_code\n        , admit_type_description\n        , count(*) as admit_type_occurrence_count\n    from normalize_cte\n\n    where admit_type_code is not null\n    group by \n        claim_id\n        , data_source\n        , admit_type_code\n        , admit_type_description\n)\n\n, occurence_comparison as(\n    select\n        claim_id\n        , data_source\n        , 'admit_type_code' as column_name\n        , admit_type_code as normalized_code\n        , admit_type_description as normalized_description\n        , admit_type_occurrence_count as occurrence_count\n        , coalesce(lead(admit_type_occurrence_count) \n            over (partition by claim_id, data_source order by admit_type_occurrence_count desc),0) as next_occurrence_count\n        , row_number() over (partition by claim_id, data_source order by admit_type_occurrence_count desc) as occurrence_row_count\n    from distinct_counts dist\n)\n\nselect\n    claim_id\n    , data_source\n    , column_name\n    , normalized_code\n    , normalized_description\n    , occurrence_count\n    , next_occurrence_count\n    , occurrence_row_count\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom occurence_comparison", "relation_name": "tuva.claims_preprocessing._int_normalized_input_admit_type_normalize_voting"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:16.937024Z", "completed_at": "2025-02-25T21:26:17.721059Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:17.722266Z", "completed_at": "2025-02-25T21:26:17.722270Z"}], "thread_id": "Thread-1", "execution_time": 1.0245330333709717, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__dx_and_px", "compiled": true, "compiled_code": "\n\nwith unpivot_diagnosis as(\n        select\n        claim_id,\n        diagnosis_code_type,\n\n      cast('DRG_CODE_TYPE' as TEXT) as diagnosis_column,\n      cast(  \n           DRG_CODE_TYPE\n             \n           as TEXT) as diagnosis_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        diagnosis_code_type,\n\n      cast('DIAGNOSIS_CODE_1' as TEXT) as diagnosis_column,\n      cast(  \n           DIAGNOSIS_CODE_1\n             \n           as TEXT) as diagnosis_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        diagnosis_code_type,\n\n      cast('DIAGNOSIS_CODE_2' as TEXT) as diagnosis_column,\n      cast(  \n           DIAGNOSIS_CODE_2\n             \n           as TEXT) as diagnosis_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        diagnosis_code_type,\n\n      cast('DIAGNOSIS_CODE_3' as TEXT) as diagnosis_column,\n      cast(  \n           DIAGNOSIS_CODE_3\n             \n           as TEXT) as diagnosis_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        diagnosis_code_type,\n\n      cast('DIAGNOSIS_CODE_4' as TEXT) as diagnosis_column,\n      cast(  \n           DIAGNOSIS_CODE_4\n             \n           as TEXT) as diagnosis_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        diagnosis_code_type,\n\n      cast('DIAGNOSIS_CODE_5' as TEXT) as diagnosis_column,\n      cast(  \n           DIAGNOSIS_CODE_5\n             \n           as TEXT) as diagnosis_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        diagnosis_code_type,\n\n      cast('DIAGNOSIS_CODE_6' as TEXT) as diagnosis_column,\n      cast(  \n           DIAGNOSIS_CODE_6\n             \n           as TEXT) as diagnosis_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        diagnosis_code_type,\n\n      cast('DIAGNOSIS_CODE_7' as TEXT) as diagnosis_column,\n      cast(  \n           DIAGNOSIS_CODE_7\n             \n           as TEXT) as diagnosis_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        diagnosis_code_type,\n\n      cast('DIAGNOSIS_CODE_8' as TEXT) as diagnosis_column,\n      cast(  \n           DIAGNOSIS_CODE_8\n             \n           as TEXT) as diagnosis_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        diagnosis_code_type,\n\n      cast('DIAGNOSIS_CODE_9' as TEXT) as diagnosis_column,\n      cast(  \n           DIAGNOSIS_CODE_9\n             \n           as TEXT) as diagnosis_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        diagnosis_code_type,\n\n      cast('DIAGNOSIS_CODE_10' as TEXT) as diagnosis_column,\n      cast(  \n           DIAGNOSIS_CODE_10\n             \n           as TEXT) as diagnosis_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        diagnosis_code_type,\n\n      cast('DIAGNOSIS_CODE_11' as TEXT) as diagnosis_column,\n      cast(  \n           DIAGNOSIS_CODE_11\n             \n           as TEXT) as diagnosis_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        diagnosis_code_type,\n\n      cast('DIAGNOSIS_CODE_12' as TEXT) as diagnosis_column,\n      cast(  \n           DIAGNOSIS_CODE_12\n             \n           as TEXT) as diagnosis_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        diagnosis_code_type,\n\n      cast('DIAGNOSIS_CODE_13' as TEXT) as diagnosis_column,\n      cast(  \n           DIAGNOSIS_CODE_13\n             \n           as TEXT) as diagnosis_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        diagnosis_code_type,\n\n      cast('DIAGNOSIS_CODE_14' as TEXT) as diagnosis_column,\n      cast(  \n           DIAGNOSIS_CODE_14\n             \n           as TEXT) as diagnosis_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        diagnosis_code_type,\n\n      cast('DIAGNOSIS_CODE_15' as TEXT) as diagnosis_column,\n      cast(  \n           DIAGNOSIS_CODE_15\n             \n           as TEXT) as diagnosis_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        diagnosis_code_type,\n\n      cast('DIAGNOSIS_CODE_16' as TEXT) as diagnosis_column,\n      cast(  \n           DIAGNOSIS_CODE_16\n             \n           as TEXT) as diagnosis_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        diagnosis_code_type,\n\n      cast('DIAGNOSIS_CODE_17' as TEXT) as diagnosis_column,\n      cast(  \n           DIAGNOSIS_CODE_17\n             \n           as TEXT) as diagnosis_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        diagnosis_code_type,\n\n      cast('DIAGNOSIS_CODE_18' as TEXT) as diagnosis_column,\n      cast(  \n           DIAGNOSIS_CODE_18\n             \n           as TEXT) as diagnosis_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        diagnosis_code_type,\n\n      cast('DIAGNOSIS_CODE_19' as TEXT) as diagnosis_column,\n      cast(  \n           DIAGNOSIS_CODE_19\n             \n           as TEXT) as diagnosis_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        diagnosis_code_type,\n\n      cast('DIAGNOSIS_CODE_20' as TEXT) as diagnosis_column,\n      cast(  \n           DIAGNOSIS_CODE_20\n             \n           as TEXT) as diagnosis_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        diagnosis_code_type,\n\n      cast('DIAGNOSIS_CODE_21' as TEXT) as diagnosis_column,\n      cast(  \n           DIAGNOSIS_CODE_21\n             \n           as TEXT) as diagnosis_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        diagnosis_code_type,\n\n      cast('DIAGNOSIS_CODE_22' as TEXT) as diagnosis_column,\n      cast(  \n           DIAGNOSIS_CODE_22\n             \n           as TEXT) as diagnosis_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        diagnosis_code_type,\n\n      cast('DIAGNOSIS_CODE_23' as TEXT) as diagnosis_column,\n      cast(  \n           DIAGNOSIS_CODE_23\n             \n           as TEXT) as diagnosis_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        diagnosis_code_type,\n\n      cast('DIAGNOSIS_CODE_24' as TEXT) as diagnosis_column,\n      cast(  \n           DIAGNOSIS_CODE_24\n             \n           as TEXT) as diagnosis_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        diagnosis_code_type,\n\n      cast('DIAGNOSIS_CODE_25' as TEXT) as diagnosis_column,\n      cast(  \n           DIAGNOSIS_CODE_25\n             \n           as TEXT) as diagnosis_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        diagnosis_code_type,\n\n      cast('FILE_DATE' as TEXT) as diagnosis_column,\n      cast(  \n           FILE_DATE\n             \n           as TEXT) as diagnosis_code\n\n    from tuva.input_layer.medical_claim\n\n    \n)\n, unpivot_procedure as(\n        select\n        claim_id,\n        procedure_code_type,\n\n      cast('DRG_CODE_TYPE' as TEXT) as procedure_column,\n      cast(  \n           DRG_CODE_TYPE\n             \n           as TEXT) as procedure_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        procedure_code_type,\n\n      cast('PROCEDURE_CODE_1' as TEXT) as procedure_column,\n      cast(  \n           PROCEDURE_CODE_1\n             \n           as TEXT) as procedure_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        procedure_code_type,\n\n      cast('PROCEDURE_CODE_2' as TEXT) as procedure_column,\n      cast(  \n           PROCEDURE_CODE_2\n             \n           as TEXT) as procedure_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        procedure_code_type,\n\n      cast('PROCEDURE_CODE_3' as TEXT) as procedure_column,\n      cast(  \n           PROCEDURE_CODE_3\n             \n           as TEXT) as procedure_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        procedure_code_type,\n\n      cast('PROCEDURE_CODE_4' as TEXT) as procedure_column,\n      cast(  \n           PROCEDURE_CODE_4\n             \n           as TEXT) as procedure_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        procedure_code_type,\n\n      cast('PROCEDURE_CODE_5' as TEXT) as procedure_column,\n      cast(  \n           PROCEDURE_CODE_5\n             \n           as TEXT) as procedure_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        procedure_code_type,\n\n      cast('PROCEDURE_CODE_6' as TEXT) as procedure_column,\n      cast(  \n           PROCEDURE_CODE_6\n             \n           as TEXT) as procedure_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        procedure_code_type,\n\n      cast('PROCEDURE_CODE_7' as TEXT) as procedure_column,\n      cast(  \n           PROCEDURE_CODE_7\n             \n           as TEXT) as procedure_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        procedure_code_type,\n\n      cast('PROCEDURE_CODE_8' as TEXT) as procedure_column,\n      cast(  \n           PROCEDURE_CODE_8\n             \n           as TEXT) as procedure_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        procedure_code_type,\n\n      cast('PROCEDURE_CODE_9' as TEXT) as procedure_column,\n      cast(  \n           PROCEDURE_CODE_9\n             \n           as TEXT) as procedure_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        procedure_code_type,\n\n      cast('PROCEDURE_CODE_10' as TEXT) as procedure_column,\n      cast(  \n           PROCEDURE_CODE_10\n             \n           as TEXT) as procedure_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        procedure_code_type,\n\n      cast('PROCEDURE_CODE_11' as TEXT) as procedure_column,\n      cast(  \n           PROCEDURE_CODE_11\n             \n           as TEXT) as procedure_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        procedure_code_type,\n\n      cast('PROCEDURE_CODE_12' as TEXT) as procedure_column,\n      cast(  \n           PROCEDURE_CODE_12\n             \n           as TEXT) as procedure_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        procedure_code_type,\n\n      cast('PROCEDURE_CODE_13' as TEXT) as procedure_column,\n      cast(  \n           PROCEDURE_CODE_13\n             \n           as TEXT) as procedure_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        procedure_code_type,\n\n      cast('PROCEDURE_CODE_14' as TEXT) as procedure_column,\n      cast(  \n           PROCEDURE_CODE_14\n             \n           as TEXT) as procedure_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        procedure_code_type,\n\n      cast('PROCEDURE_CODE_15' as TEXT) as procedure_column,\n      cast(  \n           PROCEDURE_CODE_15\n             \n           as TEXT) as procedure_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        procedure_code_type,\n\n      cast('PROCEDURE_CODE_16' as TEXT) as procedure_column,\n      cast(  \n           PROCEDURE_CODE_16\n             \n           as TEXT) as procedure_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        procedure_code_type,\n\n      cast('PROCEDURE_CODE_17' as TEXT) as procedure_column,\n      cast(  \n           PROCEDURE_CODE_17\n             \n           as TEXT) as procedure_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        procedure_code_type,\n\n      cast('PROCEDURE_CODE_18' as TEXT) as procedure_column,\n      cast(  \n           PROCEDURE_CODE_18\n             \n           as TEXT) as procedure_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        procedure_code_type,\n\n      cast('PROCEDURE_CODE_19' as TEXT) as procedure_column,\n      cast(  \n           PROCEDURE_CODE_19\n             \n           as TEXT) as procedure_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        procedure_code_type,\n\n      cast('PROCEDURE_CODE_20' as TEXT) as procedure_column,\n      cast(  \n           PROCEDURE_CODE_20\n             \n           as TEXT) as procedure_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        procedure_code_type,\n\n      cast('PROCEDURE_CODE_21' as TEXT) as procedure_column,\n      cast(  \n           PROCEDURE_CODE_21\n             \n           as TEXT) as procedure_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        procedure_code_type,\n\n      cast('PROCEDURE_CODE_22' as TEXT) as procedure_column,\n      cast(  \n           PROCEDURE_CODE_22\n             \n           as TEXT) as procedure_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        procedure_code_type,\n\n      cast('PROCEDURE_CODE_23' as TEXT) as procedure_column,\n      cast(  \n           PROCEDURE_CODE_23\n             \n           as TEXT) as procedure_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        procedure_code_type,\n\n      cast('PROCEDURE_CODE_24' as TEXT) as procedure_column,\n      cast(  \n           PROCEDURE_CODE_24\n             \n           as TEXT) as procedure_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        procedure_code_type,\n\n      cast('PROCEDURE_CODE_25' as TEXT) as procedure_column,\n      cast(  \n           PROCEDURE_CODE_25\n             \n           as TEXT) as procedure_code\n\n    from tuva.input_layer.medical_claim\n\n    union all\n    select\n        claim_id,\n        procedure_code_type,\n\n      cast('FILE_DATE' as TEXT) as procedure_column,\n      cast(  \n           FILE_DATE\n             \n           as TEXT) as procedure_code\n\n    from tuva.input_layer.medical_claim\n\n    \n\n\n)\n\n, total_claims as(\n    select\n        cast(count(distinct claim_id) as integer ) as total_claims\n    from tuva.input_layer.medical_claim\n)\n\n, claims_with_primary_dx as(\n    select\n        count(diagnosis_code_1) as distinct_claims_with_primary\n    from tuva.input_layer.medical_claim\n)\n\n, secondary_dx_prep_cte as (    \n    select\n        tc.total_claims\n        , cast(count(distinct claim_id) as integer) as secondary_dx_claim_count\n    from unpivot_diagnosis\n    cross join total_claims tc\n    where diagnosis_column <> 'DIAGNOSIS_CODE_1'\n    and\n    cast(diagnosis_code as TEXT )   is not null\n    group by total_claims\n    ) \n\n, claims_with_secondary_dx as (\n    select\n    total_claims\n    , cast(secondary_dx_claim_count as integer ) as secondary_dx_claim_count\n    , (cast(secondary_dx_claim_count as integer ) / cast(total_claims as integer )) * 100 as result_count\n    , cast('Percent of claims with secondary diagnosis' as TEXT) as data_quality_check\n    from\n    secondary_dx_prep_cte\n\n)\n, missing_primary_dx as (\n    select\n     cast('missing primary diagnosis' as TEXT) as data_quality_check\n        , cast(count(distinct claim_id) as integer ) as result_count\n    from tuva.input_layer.medical_claim m\n    where diagnosis_code_1 is null\n)\n, invalid_primary_dx as(\n    select\n        data_quality_check\n        , count(distinct claim_id) as result_count\n    from (\n    select\n        cast('invalid primary diagnosis' as TEXT) as data_quality_check\n        , claim_id\n        , diagnosis_code_type\n        , diagnosis_column\n        , diagnosis_code\n        , icd_10_cm\n        , icd_9_cm\n        , case\n            when icd10.icd_10_cm is null and icd9.icd_9_cm is null\n                then 1\n            else 0\n        end as invalid_diagnosis\n    from unpivot_diagnosis dx\n    left join tuva.terminology.icd_10_cm icd10\n        on dx.diagnosis_code = icd10.icd_10_cm\n    left join tuva.terminology.icd_9_cm icd9\n        on dx.diagnosis_code = icd9.icd_9_cm\n    where diagnosis_column = 'DIAGNOSIS_CODE_1'\n    and diagnosis_code is not null\n    )x\n   where invalid_diagnosis = 1\n    group by\n        data_quality_check\n)\n, multiple_primary_dx as(\n\n    select\n        cast('multiple primary diagnosis' as TEXT) as data_quality_check\n        , cast(count(*) as integer ) as result_count\n    from\n        (\n            select\n                claim_id\n                , row_number() over (partition by claim_id order by claim_id) as row_nbr\n            from unpivot_diagnosis\n             where diagnosis_column = 'DIAGNOSIS_CODE_1'\n            group by\n                claim_id\n            )x\n    where row_nbr > 1\n\n)\n, invalid_secondary_dx as(\n    select\n        data_quality_check\n        , count(*) as result_count\n    from (\n    select\n        cast('invalid secondary diagnosis' as TEXT) as data_quality_check\n        , claim_id\n        , case\n            when icd10.icd_10_cm is null and icd9.icd_9_cm is null\n                then 1\n            else 0\n        end as invalid_diagnosis\n    from unpivot_diagnosis dx\n    left join tuva.terminology.icd_10_cm icd10\n        on dx.diagnosis_code = icd10.icd_10_cm\n    left join tuva.terminology.icd_9_cm icd9\n    on dx.diagnosis_code = icd9.icd_9_cm\n    where diagnosis_column <> 'DIAGNOSIS_CODE_1'\n    and diagnosis_code is not null\n    )x\n    where invalid_diagnosis = 1\n    group by\n        data_quality_check\n)\n\n, invalid_procedure as(\n    select\n        data_quality_check\n        , count(*) as result_count\n    from (\n    select\n         cast('invalid procedure' as TEXT) as data_quality_check\n        , claim_id\n        , case\n            when icd10.icd_10_pcs is null and icd9.icd_9_pcs is null\n                then 1\n            else 0\n        end as invalid_procedure\n    from unpivot_procedure px\n    left join tuva.terminology.icd_10_pcs icd10\n        on px.procedure_code = icd10.icd_10_pcs\n    left join tuva.terminology.icd_9_pcs icd9\n    on px.procedure_code = icd9.icd_9_pcs\n    where px.procedure_code is not null\n    )x\n    where invalid_procedure = 1\n    group by\n        data_quality_check\n)\n\n, final as (\n    select cast(data_quality_check as TEXT ) as data_quality_check\n    , cast( result_count as integer) as result_count\n    from missing_primary_dx\n\n    union all\n\n    select cast(data_quality_check as TEXT ) as data_quality_check\n    , cast( result_count as integer) as result_count\n    from invalid_primary_dx\n\n    union all\n\n    select cast(data_quality_check as TEXT ) as data_quality_check\n    , cast( result_count as integer) as result_count\n    from multiple_primary_dx\n\n    union all\n\n    select cast(data_quality_check as TEXT ) as data_quality_check\n    , cast( result_count as integer) as result_count\n    from invalid_secondary_dx\n\n    union all\n\n    select cast(data_quality_check as TEXT ) as data_quality_check\n    , cast( result_count as integer) as result_count\n    from claims_with_secondary_dx\n\n    union all\n\n    select cast(data_quality_check as TEXT ) as data_quality_check\n    , cast( result_count as integer) as result_count\n    from invalid_procedure\n)\n\nselect\n    *\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom final", "relation_name": "tuva.data_quality.dx_and_px"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.937074Z", "completed_at": "2025-02-25T21:26:17.979375Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.003402Z", "completed_at": "2025-02-25T21:26:18.003408Z"}], "thread_id": "Thread-2", "execution_time": 0.06765413284301758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.normalized_input__int_bill_type_voting", "compiled": true, "compiled_code": "\n\n\nwith  __dbt__cte__normalized_input__stg_medical_claim as (\n\n\nselect\n      claim_id\n    , claim_line_number\n    , claim_type\n    , person_id\n    , member_id\n    , payer\n    , plan\n    , claim_start_date\n    , claim_end_date\n    , claim_line_start_date\n    , claim_line_end_date\n    , admission_date\n    , discharge_date\n    , admit_source_code\n    , admit_type_code\n    , discharge_disposition_code\n    , place_of_service_code\n    , bill_type_code\n    , drg_code_type\n    , drg_code\n    , revenue_center_code\n    , service_unit_quantity\n    , hcpcs_code\n    , hcpcs_modifier_1\n    , hcpcs_modifier_2\n    , hcpcs_modifier_3\n    , hcpcs_modifier_4\n    , hcpcs_modifier_5\n    , rendering_npi\n    , rendering_tin\n    , billing_npi\n    , billing_tin\n    , facility_npi\n    , paid_date\n    , paid_amount\n    , allowed_amount\n    , charge_amount\n    , coinsurance_amount\n    , copayment_amount\n    , deductible_amount\n    , total_cost_amount\n    , diagnosis_code_type\n    , diagnosis_code_1\n    , diagnosis_code_2\n    , diagnosis_code_3\n    , diagnosis_code_4\n    , diagnosis_code_5\n    , diagnosis_code_6\n    , diagnosis_code_7\n    , diagnosis_code_8\n    , diagnosis_code_9\n    , diagnosis_code_10\n    , diagnosis_code_11\n    , diagnosis_code_12\n    , diagnosis_code_13\n    , diagnosis_code_14\n    , diagnosis_code_15\n    , diagnosis_code_16\n    , diagnosis_code_17\n    , diagnosis_code_18\n    , diagnosis_code_19\n    , diagnosis_code_20\n    , diagnosis_code_21\n    , diagnosis_code_22\n    , diagnosis_code_23\n    , diagnosis_code_24\n    , diagnosis_code_25\n    , diagnosis_poa_1\n    , diagnosis_poa_2\n    , diagnosis_poa_3\n    , diagnosis_poa_4\n    , diagnosis_poa_5\n    , diagnosis_poa_6\n    , diagnosis_poa_7\n    , diagnosis_poa_8\n    , diagnosis_poa_9\n    , diagnosis_poa_10\n    , diagnosis_poa_11\n    , diagnosis_poa_12\n    , diagnosis_poa_13\n    , diagnosis_poa_14\n    , diagnosis_poa_15\n    , diagnosis_poa_16\n    , diagnosis_poa_17\n    , diagnosis_poa_18\n    , diagnosis_poa_19\n    , diagnosis_poa_20\n    , diagnosis_poa_21\n    , diagnosis_poa_22\n    , diagnosis_poa_23\n    , diagnosis_poa_24\n    , diagnosis_poa_25\n    , procedure_code_type\n    , procedure_code_1\n    , procedure_code_2\n    , procedure_code_3\n    , procedure_code_4\n    , procedure_code_5\n    , procedure_code_6\n    , procedure_code_7\n    , procedure_code_8\n    , procedure_code_9\n    , procedure_code_10\n    , procedure_code_11\n    , procedure_code_12\n    , procedure_code_13\n    , procedure_code_14\n    , procedure_code_15\n    , procedure_code_16\n    , procedure_code_17\n    , procedure_code_18\n    , procedure_code_19\n    , procedure_code_20\n    , procedure_code_21\n    , procedure_code_22\n    , procedure_code_23\n    , procedure_code_24\n    , procedure_code_25\n    , procedure_date_1\n    , procedure_date_2\n    , procedure_date_3\n    , procedure_date_4\n    , procedure_date_5\n    , procedure_date_6\n    , procedure_date_7\n    , procedure_date_8\n    , procedure_date_9\n    , procedure_date_10\n    , procedure_date_11\n    , procedure_date_12\n    , procedure_date_13\n    , procedure_date_14\n    , procedure_date_15\n    , procedure_date_16\n    , procedure_date_17\n    , procedure_date_18\n    , procedure_date_19\n    , procedure_date_20\n    , procedure_date_21\n    , procedure_date_22\n    , procedure_date_23\n    , procedure_date_24\n    , procedure_date_25\n    , in_network_flag\n    , data_source\n    , file_name\n    , file_date\n    , ingest_datetime\nfrom tuva.input_layer.medical_claim\n), normalize_cte as(\n    select \n        med.claim_id\n        , med.data_source\n        , bill.bill_type_code\n        , bill.bill_type_description\n    from __dbt__cte__normalized_input__stg_medical_claim med\n    inner join tuva.terminology.bill_type bill\n        on ltrim(med.bill_type_code, '0') = bill.bill_type_code\n    where claim_type = 'institutional'\n)\n, distinct_counts as(\n    select \n        claim_id\n        , data_source\n        , bill_type_code\n        , bill_type_description\n        , count(*) as bill_type_occurrence_count\n    from normalize_cte\n    where bill_type_code is not null\n    group by \n        claim_id\n        , data_source\n        , bill_type_code\n        , bill_type_description\n)\n\n, occurence_comparison as(\n    select\n        claim_id\n        , data_source\n        , 'bill_type_code' as column_name\n        , bill_type_code as normalized_code\n        , bill_type_description as normalized_description\n        , bill_type_occurrence_count as occurrence_count\n        , row_number() over (partition by claim_id, data_source order by bill_type_occurrence_count desc, bill_type_code asc) as occurrence_row_count\n    from distinct_counts dist\n)\n\nselect\n    claim_id\n    , data_source\n    , column_name\n    , normalized_code\n    , normalized_description\n    , occurrence_count\n    , occurrence_row_count\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom occurence_comparison", "relation_name": "tuva.claims_preprocessing._int_normalized_input_bill_type_voting"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.991651Z", "completed_at": "2025-02-25T21:26:18.018259Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.018486Z", "completed_at": "2025-02-25T21:26:18.018492Z"}], "thread_id": "Thread-1", "execution_time": 0.04529619216918945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.normalized_input__int_discharge_disposition_voting", "compiled": true, "compiled_code": "\n\n\nwith  __dbt__cte__normalized_input__stg_medical_claim as (\n\n\nselect\n      claim_id\n    , claim_line_number\n    , claim_type\n    , person_id\n    , member_id\n    , payer\n    , plan\n    , claim_start_date\n    , claim_end_date\n    , claim_line_start_date\n    , claim_line_end_date\n    , admission_date\n    , discharge_date\n    , admit_source_code\n    , admit_type_code\n    , discharge_disposition_code\n    , place_of_service_code\n    , bill_type_code\n    , drg_code_type\n    , drg_code\n    , revenue_center_code\n    , service_unit_quantity\n    , hcpcs_code\n    , hcpcs_modifier_1\n    , hcpcs_modifier_2\n    , hcpcs_modifier_3\n    , hcpcs_modifier_4\n    , hcpcs_modifier_5\n    , rendering_npi\n    , rendering_tin\n    , billing_npi\n    , billing_tin\n    , facility_npi\n    , paid_date\n    , paid_amount\n    , allowed_amount\n    , charge_amount\n    , coinsurance_amount\n    , copayment_amount\n    , deductible_amount\n    , total_cost_amount\n    , diagnosis_code_type\n    , diagnosis_code_1\n    , diagnosis_code_2\n    , diagnosis_code_3\n    , diagnosis_code_4\n    , diagnosis_code_5\n    , diagnosis_code_6\n    , diagnosis_code_7\n    , diagnosis_code_8\n    , diagnosis_code_9\n    , diagnosis_code_10\n    , diagnosis_code_11\n    , diagnosis_code_12\n    , diagnosis_code_13\n    , diagnosis_code_14\n    , diagnosis_code_15\n    , diagnosis_code_16\n    , diagnosis_code_17\n    , diagnosis_code_18\n    , diagnosis_code_19\n    , diagnosis_code_20\n    , diagnosis_code_21\n    , diagnosis_code_22\n    , diagnosis_code_23\n    , diagnosis_code_24\n    , diagnosis_code_25\n    , diagnosis_poa_1\n    , diagnosis_poa_2\n    , diagnosis_poa_3\n    , diagnosis_poa_4\n    , diagnosis_poa_5\n    , diagnosis_poa_6\n    , diagnosis_poa_7\n    , diagnosis_poa_8\n    , diagnosis_poa_9\n    , diagnosis_poa_10\n    , diagnosis_poa_11\n    , diagnosis_poa_12\n    , diagnosis_poa_13\n    , diagnosis_poa_14\n    , diagnosis_poa_15\n    , diagnosis_poa_16\n    , diagnosis_poa_17\n    , diagnosis_poa_18\n    , diagnosis_poa_19\n    , diagnosis_poa_20\n    , diagnosis_poa_21\n    , diagnosis_poa_22\n    , diagnosis_poa_23\n    , diagnosis_poa_24\n    , diagnosis_poa_25\n    , procedure_code_type\n    , procedure_code_1\n    , procedure_code_2\n    , procedure_code_3\n    , procedure_code_4\n    , procedure_code_5\n    , procedure_code_6\n    , procedure_code_7\n    , procedure_code_8\n    , procedure_code_9\n    , procedure_code_10\n    , procedure_code_11\n    , procedure_code_12\n    , procedure_code_13\n    , procedure_code_14\n    , procedure_code_15\n    , procedure_code_16\n    , procedure_code_17\n    , procedure_code_18\n    , procedure_code_19\n    , procedure_code_20\n    , procedure_code_21\n    , procedure_code_22\n    , procedure_code_23\n    , procedure_code_24\n    , procedure_code_25\n    , procedure_date_1\n    , procedure_date_2\n    , procedure_date_3\n    , procedure_date_4\n    , procedure_date_5\n    , procedure_date_6\n    , procedure_date_7\n    , procedure_date_8\n    , procedure_date_9\n    , procedure_date_10\n    , procedure_date_11\n    , procedure_date_12\n    , procedure_date_13\n    , procedure_date_14\n    , procedure_date_15\n    , procedure_date_16\n    , procedure_date_17\n    , procedure_date_18\n    , procedure_date_19\n    , procedure_date_20\n    , procedure_date_21\n    , procedure_date_22\n    , procedure_date_23\n    , procedure_date_24\n    , procedure_date_25\n    , in_network_flag\n    , data_source\n    , file_name\n    , file_date\n    , ingest_datetime\nfrom tuva.input_layer.medical_claim\n), normalize_cte as(\n    select \n        med.claim_id\n        , med.data_source\n        , disch.discharge_disposition_code\n        , disch.discharge_disposition_description\n    from __dbt__cte__normalized_input__stg_medical_claim med\n    inner join tuva.terminology.discharge_disposition disch\n        on med.discharge_disposition_code = disch.discharge_disposition_code\n    where claim_type = 'institutional'\n)\n, distinct_counts as(\n    select \n        claim_id\n        , data_source\n        , discharge_disposition_code\n        , discharge_disposition_description\n        , count(*) as discharge_disposition_occurrence_count\n    from normalize_cte\n    where discharge_disposition_code is not null\n    group by \n        claim_id\n        , data_source\n        , discharge_disposition_code\n        , discharge_disposition_description\n)\n\n, occurence_comparison as(\n    select\n        claim_id\n        , data_source\n        , 'discharge_disposition_code' as column_name\n        , discharge_disposition_code as normalized_code\n        , discharge_disposition_description as normalized_description\n        , discharge_disposition_occurrence_count as occurrence_count\n        , coalesce(lead(discharge_disposition_occurrence_count) \n            over (partition by claim_id, data_source order by discharge_disposition_occurrence_count desc),0) as next_occurrence_count\n        , row_number() over (partition by claim_id, data_source order by discharge_disposition_occurrence_count desc) as occurrence_row_count\n    from distinct_counts dist\n)\n\nselect\n    claim_id\n    , data_source\n    , column_name\n    , normalized_code\n    , normalized_description\n    , occurrence_count\n    , next_occurrence_count\n    , occurrence_row_count\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom occurence_comparison", "relation_name": "tuva.claims_preprocessing._int_normalized_input_discharge_disposition_voting"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:17.948367Z", "completed_at": "2025-02-25T21:26:18.025823Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.027855Z", "completed_at": "2025-02-25T21:26:18.027860Z"}], "thread_id": "Thread-3", "execution_time": 0.09109091758728027, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.normalized_input__int_diagnosis_code_normalize", "compiled": true, "compiled_code": "\n\n\nwith  __dbt__cte__normalized_input__stg_medical_claim as (\n\n\nselect\n      claim_id\n    , claim_line_number\n    , claim_type\n    , person_id\n    , member_id\n    , payer\n    , plan\n    , claim_start_date\n    , claim_end_date\n    , claim_line_start_date\n    , claim_line_end_date\n    , admission_date\n    , discharge_date\n    , admit_source_code\n    , admit_type_code\n    , discharge_disposition_code\n    , place_of_service_code\n    , bill_type_code\n    , drg_code_type\n    , drg_code\n    , revenue_center_code\n    , service_unit_quantity\n    , hcpcs_code\n    , hcpcs_modifier_1\n    , hcpcs_modifier_2\n    , hcpcs_modifier_3\n    , hcpcs_modifier_4\n    , hcpcs_modifier_5\n    , rendering_npi\n    , rendering_tin\n    , billing_npi\n    , billing_tin\n    , facility_npi\n    , paid_date\n    , paid_amount\n    , allowed_amount\n    , charge_amount\n    , coinsurance_amount\n    , copayment_amount\n    , deductible_amount\n    , total_cost_amount\n    , diagnosis_code_type\n    , diagnosis_code_1\n    , diagnosis_code_2\n    , diagnosis_code_3\n    , diagnosis_code_4\n    , diagnosis_code_5\n    , diagnosis_code_6\n    , diagnosis_code_7\n    , diagnosis_code_8\n    , diagnosis_code_9\n    , diagnosis_code_10\n    , diagnosis_code_11\n    , diagnosis_code_12\n    , diagnosis_code_13\n    , diagnosis_code_14\n    , diagnosis_code_15\n    , diagnosis_code_16\n    , diagnosis_code_17\n    , diagnosis_code_18\n    , diagnosis_code_19\n    , diagnosis_code_20\n    , diagnosis_code_21\n    , diagnosis_code_22\n    , diagnosis_code_23\n    , diagnosis_code_24\n    , diagnosis_code_25\n    , diagnosis_poa_1\n    , diagnosis_poa_2\n    , diagnosis_poa_3\n    , diagnosis_poa_4\n    , diagnosis_poa_5\n    , diagnosis_poa_6\n    , diagnosis_poa_7\n    , diagnosis_poa_8\n    , diagnosis_poa_9\n    , diagnosis_poa_10\n    , diagnosis_poa_11\n    , diagnosis_poa_12\n    , diagnosis_poa_13\n    , diagnosis_poa_14\n    , diagnosis_poa_15\n    , diagnosis_poa_16\n    , diagnosis_poa_17\n    , diagnosis_poa_18\n    , diagnosis_poa_19\n    , diagnosis_poa_20\n    , diagnosis_poa_21\n    , diagnosis_poa_22\n    , diagnosis_poa_23\n    , diagnosis_poa_24\n    , diagnosis_poa_25\n    , procedure_code_type\n    , procedure_code_1\n    , procedure_code_2\n    , procedure_code_3\n    , procedure_code_4\n    , procedure_code_5\n    , procedure_code_6\n    , procedure_code_7\n    , procedure_code_8\n    , procedure_code_9\n    , procedure_code_10\n    , procedure_code_11\n    , procedure_code_12\n    , procedure_code_13\n    , procedure_code_14\n    , procedure_code_15\n    , procedure_code_16\n    , procedure_code_17\n    , procedure_code_18\n    , procedure_code_19\n    , procedure_code_20\n    , procedure_code_21\n    , procedure_code_22\n    , procedure_code_23\n    , procedure_code_24\n    , procedure_code_25\n    , procedure_date_1\n    , procedure_date_2\n    , procedure_date_3\n    , procedure_date_4\n    , procedure_date_5\n    , procedure_date_6\n    , procedure_date_7\n    , procedure_date_8\n    , procedure_date_9\n    , procedure_date_10\n    , procedure_date_11\n    , procedure_date_12\n    , procedure_date_13\n    , procedure_date_14\n    , procedure_date_15\n    , procedure_date_16\n    , procedure_date_17\n    , procedure_date_18\n    , procedure_date_19\n    , procedure_date_20\n    , procedure_date_21\n    , procedure_date_22\n    , procedure_date_23\n    , procedure_date_24\n    , procedure_date_25\n    , in_network_flag\n    , data_source\n    , file_name\n    , file_date\n    , ingest_datetime\nfrom tuva.input_layer.medical_claim\n), pivot_diagnosis as(\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , diagnosis_code_type\n        , 'diagnosis_code_1'  as diagnosis_column\n        ,  diagnosis_code_1  as diagnosis_code\n    from __dbt__cte__normalized_input__stg_medical_claim \n\twhere diagnosis_code_1 is not null\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , diagnosis_code_type\n        , 'diagnosis_code_2'  as diagnosis_column\n        ,  diagnosis_code_2  as diagnosis_code\n    from __dbt__cte__normalized_input__stg_medical_claim \n\twhere diagnosis_code_2 is not null\n\t\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , diagnosis_code_type\n        , 'diagnosis_code_3'  as diagnosis_column\n        ,  diagnosis_code_3  as diagnosis_code\n    from __dbt__cte__normalized_input__stg_medical_claim \n\twhere diagnosis_code_3 is not null\t\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , diagnosis_code_type\n        , 'diagnosis_code_4'  as diagnosis_column\n        ,  diagnosis_code_4  as diagnosis_code\n    from __dbt__cte__normalized_input__stg_medical_claim \n\twhere diagnosis_code_4 is not null\t\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , diagnosis_code_type\n        , 'diagnosis_code_5'  as diagnosis_column\n        ,  diagnosis_code_5  as diagnosis_code\n    from __dbt__cte__normalized_input__stg_medical_claim \n\twhere diagnosis_code_5 is not null\t\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , diagnosis_code_type\n        , 'diagnosis_code_6'  as diagnosis_column\n        ,  diagnosis_code_6  as diagnosis_code\n    from __dbt__cte__normalized_input__stg_medical_claim \n\twhere diagnosis_code_6 is not null\t\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , diagnosis_code_type\n        , 'diagnosis_code_7'  as diagnosis_column\n        ,  diagnosis_code_7  as diagnosis_code\n    from __dbt__cte__normalized_input__stg_medical_claim \n\twhere diagnosis_code_7 is not null\t\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , diagnosis_code_type\n        , 'diagnosis_code_8'  as diagnosis_column\n        ,  diagnosis_code_8  as diagnosis_code\n    from __dbt__cte__normalized_input__stg_medical_claim \n\twhere diagnosis_code_8 is not null\t\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , diagnosis_code_type\n        , 'diagnosis_code_9'  as diagnosis_column\n        ,  diagnosis_code_9  as diagnosis_code\n    from __dbt__cte__normalized_input__stg_medical_claim \n\twhere diagnosis_code_9 is not null\t\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , diagnosis_code_type\n        , 'diagnosis_code_10'  as diagnosis_column\n        ,  diagnosis_code_10  as diagnosis_code\n    from __dbt__cte__normalized_input__stg_medical_claim \n\twhere diagnosis_code_10 is not null\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , diagnosis_code_type\n        , 'diagnosis_code_11'  as diagnosis_column\n        ,  diagnosis_code_11  as diagnosis_code\n    from __dbt__cte__normalized_input__stg_medical_claim \n\twhere diagnosis_code_11 is not null\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , diagnosis_code_type\n        , 'diagnosis_code_12'  as diagnosis_column\n        ,  diagnosis_code_12  as diagnosis_code\n    from __dbt__cte__normalized_input__stg_medical_claim \n\twhere diagnosis_code_12 is not null\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , diagnosis_code_type\n        , 'diagnosis_code_13'  as diagnosis_column\n        ,  diagnosis_code_13  as diagnosis_code\n    from __dbt__cte__normalized_input__stg_medical_claim \n\twhere diagnosis_code_13 is not null\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , diagnosis_code_type\n        , 'diagnosis_code_14'  as diagnosis_column\n        ,  diagnosis_code_14  as diagnosis_code\n    from __dbt__cte__normalized_input__stg_medical_claim \n\twhere diagnosis_code_14 is not null\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , diagnosis_code_type\n        , 'diagnosis_code_15'  as diagnosis_column\n        ,  diagnosis_code_15  as diagnosis_code\n    from __dbt__cte__normalized_input__stg_medical_claim \n\twhere diagnosis_code_15 is not null\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , diagnosis_code_type\n        , 'diagnosis_code_16'  as diagnosis_column\n        ,  diagnosis_code_16  as diagnosis_code\n    from __dbt__cte__normalized_input__stg_medical_claim \n\twhere diagnosis_code_16 is not null\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , diagnosis_code_type\n        , 'diagnosis_code_17'  as diagnosis_column\n        ,  diagnosis_code_17  as diagnosis_code\n    from __dbt__cte__normalized_input__stg_medical_claim \n\twhere diagnosis_code_17 is not null\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , diagnosis_code_type\n        , 'diagnosis_code_18'  as diagnosis_column\n        ,  diagnosis_code_18  as diagnosis_code\n    from __dbt__cte__normalized_input__stg_medical_claim \n\twhere diagnosis_code_18 is not null\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , diagnosis_code_type\n        , 'diagnosis_code_19'  as diagnosis_column\n        ,  diagnosis_code_19  as diagnosis_code\n    from __dbt__cte__normalized_input__stg_medical_claim \n\twhere diagnosis_code_19 is not null\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , diagnosis_code_type\n        , 'diagnosis_code_20'  as diagnosis_column\n        ,  diagnosis_code_20  as diagnosis_code\n    from __dbt__cte__normalized_input__stg_medical_claim \n\twhere diagnosis_code_20 is not null\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , diagnosis_code_type\n        , 'diagnosis_code_21'  as diagnosis_column\n        ,  diagnosis_code_21  as diagnosis_code\n    from __dbt__cte__normalized_input__stg_medical_claim \n\twhere diagnosis_code_21 is not null\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , diagnosis_code_type\n        , 'diagnosis_code_22'  as diagnosis_column\n        ,  diagnosis_code_22  as diagnosis_code\n    from __dbt__cte__normalized_input__stg_medical_claim \n\twhere diagnosis_code_22 is not null\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , diagnosis_code_type\n        , 'diagnosis_code_23'  as diagnosis_column\n        ,  diagnosis_code_23  as diagnosis_code\n    from __dbt__cte__normalized_input__stg_medical_claim \n\twhere diagnosis_code_23 is not null\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , diagnosis_code_type\n        , 'diagnosis_code_24'  as diagnosis_column\n        ,  diagnosis_code_24  as diagnosis_code\n    from __dbt__cte__normalized_input__stg_medical_claim \n\twhere diagnosis_code_24 is not null\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , diagnosis_code_type\n        , 'diagnosis_code_25'  as diagnosis_column\n        ,  diagnosis_code_25  as diagnosis_code\n    from __dbt__cte__normalized_input__stg_medical_claim \n\twhere diagnosis_code_25 is not null)\n\nselect\n    claim_id\n    , data_source\n    , diagnosis_code_type\n    , diagnosis_column\n    , coalesce(icd_9.icd_9_cm,icd_10.icd_10_cm) as normalized_diagnosis_code\n    , count(*) as diagnosis_code_occurrence_count\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom pivot_diagnosis piv\nleft join tuva.terminology.icd_10_cm icd_10\n    on replace(piv.diagnosis_code,'.','') = icd_10.icd_10_cm\n    and piv.diagnosis_code_type = 'icd-10-cm'\nleft join tuva.terminology.icd_9_cm icd_9\n    on replace(piv.diagnosis_code,'.','') = icd_9.icd_9_cm\n    and piv.diagnosis_code_type = 'icd-9-cm'\nwhere claim_type <> 'undetermined'\ngroup by \n    claim_id\n    , data_source\n    , diagnosis_code_type\n    , diagnosis_column\n    , coalesce(icd_9.icd_9_cm,icd_10.icd_10_cm)", "relation_name": "tuva.claims_preprocessing._int_normalized_input_diagnosis_code_normalize"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.004612Z", "completed_at": "2025-02-25T21:26:18.028267Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.028818Z", "completed_at": "2025-02-25T21:26:18.028822Z"}], "thread_id": "Thread-2", "execution_time": 0.024701833724975586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.normalized_input__int_drg_voting", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte__normalized_input__stg_medical_claim as (\n\n\nselect\n      claim_id\n    , claim_line_number\n    , claim_type\n    , person_id\n    , member_id\n    , payer\n    , plan\n    , claim_start_date\n    , claim_end_date\n    , claim_line_start_date\n    , claim_line_end_date\n    , admission_date\n    , discharge_date\n    , admit_source_code\n    , admit_type_code\n    , discharge_disposition_code\n    , place_of_service_code\n    , bill_type_code\n    , drg_code_type\n    , drg_code\n    , revenue_center_code\n    , service_unit_quantity\n    , hcpcs_code\n    , hcpcs_modifier_1\n    , hcpcs_modifier_2\n    , hcpcs_modifier_3\n    , hcpcs_modifier_4\n    , hcpcs_modifier_5\n    , rendering_npi\n    , rendering_tin\n    , billing_npi\n    , billing_tin\n    , facility_npi\n    , paid_date\n    , paid_amount\n    , allowed_amount\n    , charge_amount\n    , coinsurance_amount\n    , copayment_amount\n    , deductible_amount\n    , total_cost_amount\n    , diagnosis_code_type\n    , diagnosis_code_1\n    , diagnosis_code_2\n    , diagnosis_code_3\n    , diagnosis_code_4\n    , diagnosis_code_5\n    , diagnosis_code_6\n    , diagnosis_code_7\n    , diagnosis_code_8\n    , diagnosis_code_9\n    , diagnosis_code_10\n    , diagnosis_code_11\n    , diagnosis_code_12\n    , diagnosis_code_13\n    , diagnosis_code_14\n    , diagnosis_code_15\n    , diagnosis_code_16\n    , diagnosis_code_17\n    , diagnosis_code_18\n    , diagnosis_code_19\n    , diagnosis_code_20\n    , diagnosis_code_21\n    , diagnosis_code_22\n    , diagnosis_code_23\n    , diagnosis_code_24\n    , diagnosis_code_25\n    , diagnosis_poa_1\n    , diagnosis_poa_2\n    , diagnosis_poa_3\n    , diagnosis_poa_4\n    , diagnosis_poa_5\n    , diagnosis_poa_6\n    , diagnosis_poa_7\n    , diagnosis_poa_8\n    , diagnosis_poa_9\n    , diagnosis_poa_10\n    , diagnosis_poa_11\n    , diagnosis_poa_12\n    , diagnosis_poa_13\n    , diagnosis_poa_14\n    , diagnosis_poa_15\n    , diagnosis_poa_16\n    , diagnosis_poa_17\n    , diagnosis_poa_18\n    , diagnosis_poa_19\n    , diagnosis_poa_20\n    , diagnosis_poa_21\n    , diagnosis_poa_22\n    , diagnosis_poa_23\n    , diagnosis_poa_24\n    , diagnosis_poa_25\n    , procedure_code_type\n    , procedure_code_1\n    , procedure_code_2\n    , procedure_code_3\n    , procedure_code_4\n    , procedure_code_5\n    , procedure_code_6\n    , procedure_code_7\n    , procedure_code_8\n    , procedure_code_9\n    , procedure_code_10\n    , procedure_code_11\n    , procedure_code_12\n    , procedure_code_13\n    , procedure_code_14\n    , procedure_code_15\n    , procedure_code_16\n    , procedure_code_17\n    , procedure_code_18\n    , procedure_code_19\n    , procedure_code_20\n    , procedure_code_21\n    , procedure_code_22\n    , procedure_code_23\n    , procedure_code_24\n    , procedure_code_25\n    , procedure_date_1\n    , procedure_date_2\n    , procedure_date_3\n    , procedure_date_4\n    , procedure_date_5\n    , procedure_date_6\n    , procedure_date_7\n    , procedure_date_8\n    , procedure_date_9\n    , procedure_date_10\n    , procedure_date_11\n    , procedure_date_12\n    , procedure_date_13\n    , procedure_date_14\n    , procedure_date_15\n    , procedure_date_16\n    , procedure_date_17\n    , procedure_date_18\n    , procedure_date_19\n    , procedure_date_20\n    , procedure_date_21\n    , procedure_date_22\n    , procedure_date_23\n    , procedure_date_24\n    , procedure_date_25\n    , in_network_flag\n    , data_source\n    , file_name\n    , file_date\n    , ingest_datetime\nfrom tuva.input_layer.medical_claim\n), normalize_cte as(\n    select \n        med.claim_id\n        , med.data_source\n        , med.drg_code_type\n        , coalesce(msdrg.ms_drg_code, aprdrg.apr_drg_code) as drg_code\n        , coalesce(msdrg.ms_drg_description, aprdrg.apr_drg_description) as drg_description\n    from __dbt__cte__normalized_input__stg_medical_claim med\n    left join tuva.terminology.ms_drg msdrg\n        on med.drg_code_type = 'ms-drg'\n        and med.drg_code = msdrg.ms_drg_code\n    left join tuva.terminology.apr_drg aprdrg\n        on med.drg_code_type = 'apr-drg'\n        and med.drg_code = aprdrg.apr_drg_code\n    where claim_type = 'institutional'\n)\n, distinct_counts as(\n    select \n        claim_id\n        , data_source\n        , drg_code\n        , drg_description\n        , count(*) as drg_occurrence_count\n    from normalize_cte\n    where drg_code is not null\n    group by \n        claim_id\n        , data_source\n        , drg_code\n        , drg_description\n)\n\n, occurence_comparison as(\n    select\n        claim_id\n        , data_source\n        , 'drg_code' as column_name\n        , drg_code as normalized_code\n        , drg_description as normalized_description\n        , drg_occurrence_count as occurrence_count\n        , coalesce(lead(drg_occurrence_count) \n            over (partition by claim_id, data_source order by drg_occurrence_count desc),0) as next_occurrence_count\n        , row_number() over (partition by claim_id, data_source order by drg_occurrence_count desc) as occurrence_row_count\n    from distinct_counts dist\n)\n\nselect\n    claim_id\n    , data_source\n    , column_name\n    , normalized_code\n    , normalized_description\n    , occurrence_count\n    , next_occurrence_count\n    , occurrence_row_count\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom occurence_comparison", "relation_name": "tuva.claims_preprocessing._int_normalized_input_drg_voting"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.019545Z", "completed_at": "2025-02-25T21:26:18.029573Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.030239Z", "completed_at": "2025-02-25T21:26:18.030242Z"}], "thread_id": "Thread-1", "execution_time": 0.011162996292114258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.normalized_input__int_medical_claim_date_normalize", "compiled": true, "compiled_code": "\n\n\nwith __dbt__cte__normalized_input__stg_medical_claim as (\n\n\nselect\n      claim_id\n    , claim_line_number\n    , claim_type\n    , person_id\n    , member_id\n    , payer\n    , plan\n    , claim_start_date\n    , claim_end_date\n    , claim_line_start_date\n    , claim_line_end_date\n    , admission_date\n    , discharge_date\n    , admit_source_code\n    , admit_type_code\n    , discharge_disposition_code\n    , place_of_service_code\n    , bill_type_code\n    , drg_code_type\n    , drg_code\n    , revenue_center_code\n    , service_unit_quantity\n    , hcpcs_code\n    , hcpcs_modifier_1\n    , hcpcs_modifier_2\n    , hcpcs_modifier_3\n    , hcpcs_modifier_4\n    , hcpcs_modifier_5\n    , rendering_npi\n    , rendering_tin\n    , billing_npi\n    , billing_tin\n    , facility_npi\n    , paid_date\n    , paid_amount\n    , allowed_amount\n    , charge_amount\n    , coinsurance_amount\n    , copayment_amount\n    , deductible_amount\n    , total_cost_amount\n    , diagnosis_code_type\n    , diagnosis_code_1\n    , diagnosis_code_2\n    , diagnosis_code_3\n    , diagnosis_code_4\n    , diagnosis_code_5\n    , diagnosis_code_6\n    , diagnosis_code_7\n    , diagnosis_code_8\n    , diagnosis_code_9\n    , diagnosis_code_10\n    , diagnosis_code_11\n    , diagnosis_code_12\n    , diagnosis_code_13\n    , diagnosis_code_14\n    , diagnosis_code_15\n    , diagnosis_code_16\n    , diagnosis_code_17\n    , diagnosis_code_18\n    , diagnosis_code_19\n    , diagnosis_code_20\n    , diagnosis_code_21\n    , diagnosis_code_22\n    , diagnosis_code_23\n    , diagnosis_code_24\n    , diagnosis_code_25\n    , diagnosis_poa_1\n    , diagnosis_poa_2\n    , diagnosis_poa_3\n    , diagnosis_poa_4\n    , diagnosis_poa_5\n    , diagnosis_poa_6\n    , diagnosis_poa_7\n    , diagnosis_poa_8\n    , diagnosis_poa_9\n    , diagnosis_poa_10\n    , diagnosis_poa_11\n    , diagnosis_poa_12\n    , diagnosis_poa_13\n    , diagnosis_poa_14\n    , diagnosis_poa_15\n    , diagnosis_poa_16\n    , diagnosis_poa_17\n    , diagnosis_poa_18\n    , diagnosis_poa_19\n    , diagnosis_poa_20\n    , diagnosis_poa_21\n    , diagnosis_poa_22\n    , diagnosis_poa_23\n    , diagnosis_poa_24\n    , diagnosis_poa_25\n    , procedure_code_type\n    , procedure_code_1\n    , procedure_code_2\n    , procedure_code_3\n    , procedure_code_4\n    , procedure_code_5\n    , procedure_code_6\n    , procedure_code_7\n    , procedure_code_8\n    , procedure_code_9\n    , procedure_code_10\n    , procedure_code_11\n    , procedure_code_12\n    , procedure_code_13\n    , procedure_code_14\n    , procedure_code_15\n    , procedure_code_16\n    , procedure_code_17\n    , procedure_code_18\n    , procedure_code_19\n    , procedure_code_20\n    , procedure_code_21\n    , procedure_code_22\n    , procedure_code_23\n    , procedure_code_24\n    , procedure_code_25\n    , procedure_date_1\n    , procedure_date_2\n    , procedure_date_3\n    , procedure_date_4\n    , procedure_date_5\n    , procedure_date_6\n    , procedure_date_7\n    , procedure_date_8\n    , procedure_date_9\n    , procedure_date_10\n    , procedure_date_11\n    , procedure_date_12\n    , procedure_date_13\n    , procedure_date_14\n    , procedure_date_15\n    , procedure_date_16\n    , procedure_date_17\n    , procedure_date_18\n    , procedure_date_19\n    , procedure_date_20\n    , procedure_date_21\n    , procedure_date_22\n    , procedure_date_23\n    , procedure_date_24\n    , procedure_date_25\n    , in_network_flag\n    , data_source\n    , file_name\n    , file_date\n    , ingest_datetime\nfrom tuva.input_layer.medical_claim\n) select distinct\n  med.claim_id\n  , med.claim_line_number\n  , med.claim_type\n  , med.data_source\n  , cal_claim_start.full_date as normalized_claim_start_date\n  , cal_claim_end.full_date as normalized_claim_end_date\n  , cal_claim_line_start.full_date as normalized_claim_line_start_date\n  , cal_claim_line_end.full_date as normalized_claim_line_end_date\n  , cal_admission.full_date as normalized_admission_date\n  , cal_discharge.full_date as normalized_discharge_date\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom __dbt__cte__normalized_input__stg_medical_claim med\nleft join tuva.reference_data.calendar cal_claim_start\n    on med.claim_start_date = cal_claim_start.full_date\nleft join tuva.reference_data.calendar cal_claim_end\n    on med.claim_end_date = cal_claim_end.full_date\nleft join tuva.reference_data.calendar cal_claim_line_start\n    on med.claim_line_start_date = cal_claim_line_start.full_date\nleft join tuva.reference_data.calendar cal_claim_line_end\n    on med.claim_line_end_date = cal_claim_line_end.full_date\nleft join tuva.reference_data.calendar cal_admission\n    on med.admission_date = cal_admission.full_date\nleft join tuva.reference_data.calendar cal_discharge\n    on med.discharge_date = cal_discharge.full_date", "relation_name": "tuva.claims_preprocessing._int_normalized_input_medical_claim_date_normalize"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.030830Z", "completed_at": "2025-02-25T21:26:18.049061Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.061677Z", "completed_at": "2025-02-25T21:26:18.061685Z"}], "thread_id": "Thread-3", "execution_time": 0.03253006935119629, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.normalized_input__int_medical_npi_normalize", "compiled": true, "compiled_code": "\n\nwith __dbt__cte__normalized_input__stg_medical_claim as (\n\n\nselect\n      claim_id\n    , claim_line_number\n    , claim_type\n    , person_id\n    , member_id\n    , payer\n    , plan\n    , claim_start_date\n    , claim_end_date\n    , claim_line_start_date\n    , claim_line_end_date\n    , admission_date\n    , discharge_date\n    , admit_source_code\n    , admit_type_code\n    , discharge_disposition_code\n    , place_of_service_code\n    , bill_type_code\n    , drg_code_type\n    , drg_code\n    , revenue_center_code\n    , service_unit_quantity\n    , hcpcs_code\n    , hcpcs_modifier_1\n    , hcpcs_modifier_2\n    , hcpcs_modifier_3\n    , hcpcs_modifier_4\n    , hcpcs_modifier_5\n    , rendering_npi\n    , rendering_tin\n    , billing_npi\n    , billing_tin\n    , facility_npi\n    , paid_date\n    , paid_amount\n    , allowed_amount\n    , charge_amount\n    , coinsurance_amount\n    , copayment_amount\n    , deductible_amount\n    , total_cost_amount\n    , diagnosis_code_type\n    , diagnosis_code_1\n    , diagnosis_code_2\n    , diagnosis_code_3\n    , diagnosis_code_4\n    , diagnosis_code_5\n    , diagnosis_code_6\n    , diagnosis_code_7\n    , diagnosis_code_8\n    , diagnosis_code_9\n    , diagnosis_code_10\n    , diagnosis_code_11\n    , diagnosis_code_12\n    , diagnosis_code_13\n    , diagnosis_code_14\n    , diagnosis_code_15\n    , diagnosis_code_16\n    , diagnosis_code_17\n    , diagnosis_code_18\n    , diagnosis_code_19\n    , diagnosis_code_20\n    , diagnosis_code_21\n    , diagnosis_code_22\n    , diagnosis_code_23\n    , diagnosis_code_24\n    , diagnosis_code_25\n    , diagnosis_poa_1\n    , diagnosis_poa_2\n    , diagnosis_poa_3\n    , diagnosis_poa_4\n    , diagnosis_poa_5\n    , diagnosis_poa_6\n    , diagnosis_poa_7\n    , diagnosis_poa_8\n    , diagnosis_poa_9\n    , diagnosis_poa_10\n    , diagnosis_poa_11\n    , diagnosis_poa_12\n    , diagnosis_poa_13\n    , diagnosis_poa_14\n    , diagnosis_poa_15\n    , diagnosis_poa_16\n    , diagnosis_poa_17\n    , diagnosis_poa_18\n    , diagnosis_poa_19\n    , diagnosis_poa_20\n    , diagnosis_poa_21\n    , diagnosis_poa_22\n    , diagnosis_poa_23\n    , diagnosis_poa_24\n    , diagnosis_poa_25\n    , procedure_code_type\n    , procedure_code_1\n    , procedure_code_2\n    , procedure_code_3\n    , procedure_code_4\n    , procedure_code_5\n    , procedure_code_6\n    , procedure_code_7\n    , procedure_code_8\n    , procedure_code_9\n    , procedure_code_10\n    , procedure_code_11\n    , procedure_code_12\n    , procedure_code_13\n    , procedure_code_14\n    , procedure_code_15\n    , procedure_code_16\n    , procedure_code_17\n    , procedure_code_18\n    , procedure_code_19\n    , procedure_code_20\n    , procedure_code_21\n    , procedure_code_22\n    , procedure_code_23\n    , procedure_code_24\n    , procedure_code_25\n    , procedure_date_1\n    , procedure_date_2\n    , procedure_date_3\n    , procedure_date_4\n    , procedure_date_5\n    , procedure_date_6\n    , procedure_date_7\n    , procedure_date_8\n    , procedure_date_9\n    , procedure_date_10\n    , procedure_date_11\n    , procedure_date_12\n    , procedure_date_13\n    , procedure_date_14\n    , procedure_date_15\n    , procedure_date_16\n    , procedure_date_17\n    , procedure_date_18\n    , procedure_date_19\n    , procedure_date_20\n    , procedure_date_21\n    , procedure_date_22\n    , procedure_date_23\n    , procedure_date_24\n    , procedure_date_25\n    , in_network_flag\n    , data_source\n    , file_name\n    , file_date\n    , ingest_datetime\nfrom tuva.input_layer.medical_claim\n) select distinct\n    med.claim_id\n  , med.claim_line_number\n  , med.claim_type\n  , med.data_source\n  , rend_prov.npi as normalized_rendering_npi\n  , case \n      when rend_prov.entity_type_code = '1' then \n        cast(rend_prov.provider_last_name || ', ' || rend_prov.provider_first_name as TEXT)\n      else \n        cast(rend_prov.provider_organization_name as TEXT)\n    end as normalized_rendering_name\n  , bill_prov.npi as normalized_billing_npi\n  , case \n      when bill_prov.entity_type_code = '1' then\n        cast(bill_prov.provider_last_name || ', ' || bill_prov.provider_first_name as TEXT)\n      else \n        cast(bill_prov.provider_organization_name as TEXT)\n    end as normalized_billing_name\n  , fac_prov.npi as normalized_facility_npi\n  , case \n      when fac_prov.entity_type_code = '1' then\n        cast(fac_prov.provider_last_name || ', ' || fac_prov.provider_first_name as TEXT)\n      else \n        cast(fac_prov.provider_organization_name as TEXT)\n    end as normalized_facility_name\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom __dbt__cte__normalized_input__stg_medical_claim as med\nleft join tuva.terminology.provider as rend_prov\n  on med.rendering_npi = rend_prov.npi\nleft join tuva.terminology.provider as bill_prov\n  on med.billing_npi = bill_prov.npi\nleft join tuva.terminology.provider as fac_prov\n  on med.facility_npi = fac_prov.npi\n  and fac_prov.entity_type_description = 'Organization'\n  and med.claim_type = 'institutional'", "relation_name": "tuva.claims_preprocessing._int_normalized_input_medical_npi_normalize"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.043426Z", "completed_at": "2025-02-25T21:26:18.086862Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.093427Z", "completed_at": "2025-02-25T21:26:18.093434Z"}], "thread_id": "Thread-2", "execution_time": 0.06292462348937988, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.normalized_input__int_place_of_service_normalize", "compiled": true, "compiled_code": "\n\n\nwith __dbt__cte__normalized_input__stg_medical_claim as (\n\n\nselect\n      claim_id\n    , claim_line_number\n    , claim_type\n    , person_id\n    , member_id\n    , payer\n    , plan\n    , claim_start_date\n    , claim_end_date\n    , claim_line_start_date\n    , claim_line_end_date\n    , admission_date\n    , discharge_date\n    , admit_source_code\n    , admit_type_code\n    , discharge_disposition_code\n    , place_of_service_code\n    , bill_type_code\n    , drg_code_type\n    , drg_code\n    , revenue_center_code\n    , service_unit_quantity\n    , hcpcs_code\n    , hcpcs_modifier_1\n    , hcpcs_modifier_2\n    , hcpcs_modifier_3\n    , hcpcs_modifier_4\n    , hcpcs_modifier_5\n    , rendering_npi\n    , rendering_tin\n    , billing_npi\n    , billing_tin\n    , facility_npi\n    , paid_date\n    , paid_amount\n    , allowed_amount\n    , charge_amount\n    , coinsurance_amount\n    , copayment_amount\n    , deductible_amount\n    , total_cost_amount\n    , diagnosis_code_type\n    , diagnosis_code_1\n    , diagnosis_code_2\n    , diagnosis_code_3\n    , diagnosis_code_4\n    , diagnosis_code_5\n    , diagnosis_code_6\n    , diagnosis_code_7\n    , diagnosis_code_8\n    , diagnosis_code_9\n    , diagnosis_code_10\n    , diagnosis_code_11\n    , diagnosis_code_12\n    , diagnosis_code_13\n    , diagnosis_code_14\n    , diagnosis_code_15\n    , diagnosis_code_16\n    , diagnosis_code_17\n    , diagnosis_code_18\n    , diagnosis_code_19\n    , diagnosis_code_20\n    , diagnosis_code_21\n    , diagnosis_code_22\n    , diagnosis_code_23\n    , diagnosis_code_24\n    , diagnosis_code_25\n    , diagnosis_poa_1\n    , diagnosis_poa_2\n    , diagnosis_poa_3\n    , diagnosis_poa_4\n    , diagnosis_poa_5\n    , diagnosis_poa_6\n    , diagnosis_poa_7\n    , diagnosis_poa_8\n    , diagnosis_poa_9\n    , diagnosis_poa_10\n    , diagnosis_poa_11\n    , diagnosis_poa_12\n    , diagnosis_poa_13\n    , diagnosis_poa_14\n    , diagnosis_poa_15\n    , diagnosis_poa_16\n    , diagnosis_poa_17\n    , diagnosis_poa_18\n    , diagnosis_poa_19\n    , diagnosis_poa_20\n    , diagnosis_poa_21\n    , diagnosis_poa_22\n    , diagnosis_poa_23\n    , diagnosis_poa_24\n    , diagnosis_poa_25\n    , procedure_code_type\n    , procedure_code_1\n    , procedure_code_2\n    , procedure_code_3\n    , procedure_code_4\n    , procedure_code_5\n    , procedure_code_6\n    , procedure_code_7\n    , procedure_code_8\n    , procedure_code_9\n    , procedure_code_10\n    , procedure_code_11\n    , procedure_code_12\n    , procedure_code_13\n    , procedure_code_14\n    , procedure_code_15\n    , procedure_code_16\n    , procedure_code_17\n    , procedure_code_18\n    , procedure_code_19\n    , procedure_code_20\n    , procedure_code_21\n    , procedure_code_22\n    , procedure_code_23\n    , procedure_code_24\n    , procedure_code_25\n    , procedure_date_1\n    , procedure_date_2\n    , procedure_date_3\n    , procedure_date_4\n    , procedure_date_5\n    , procedure_date_6\n    , procedure_date_7\n    , procedure_date_8\n    , procedure_date_9\n    , procedure_date_10\n    , procedure_date_11\n    , procedure_date_12\n    , procedure_date_13\n    , procedure_date_14\n    , procedure_date_15\n    , procedure_date_16\n    , procedure_date_17\n    , procedure_date_18\n    , procedure_date_19\n    , procedure_date_20\n    , procedure_date_21\n    , procedure_date_22\n    , procedure_date_23\n    , procedure_date_24\n    , procedure_date_25\n    , in_network_flag\n    , data_source\n    , file_name\n    , file_date\n    , ingest_datetime\nfrom tuva.input_layer.medical_claim\n) select\n    claim_id\n    , claim_line_number\n    , data_source\n    , pos.place_of_service_code as normalized_code\n    , pos.place_of_service_description as normalized_description\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom __dbt__cte__normalized_input__stg_medical_claim med\nleft join tuva.terminology.place_of_service pos\n    \n        on lpad(med.place_of_service_code, 2, '0') = pos.place_of_service_code\n    \nwhere claim_type = 'professional'", "relation_name": "tuva.claims_preprocessing._int_normalized_input_place_of_service_normalize"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.049282Z", "completed_at": "2025-02-25T21:26:18.146218Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.146548Z", "completed_at": "2025-02-25T21:26:18.146554Z"}], "thread_id": "Thread-1", "execution_time": 0.10350728034973145, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.normalized_input__int_present_on_admit_normalize", "compiled": true, "compiled_code": "\n\n\nwith  __dbt__cte__normalized_input__stg_medical_claim as (\n\n\nselect\n      claim_id\n    , claim_line_number\n    , claim_type\n    , person_id\n    , member_id\n    , payer\n    , plan\n    , claim_start_date\n    , claim_end_date\n    , claim_line_start_date\n    , claim_line_end_date\n    , admission_date\n    , discharge_date\n    , admit_source_code\n    , admit_type_code\n    , discharge_disposition_code\n    , place_of_service_code\n    , bill_type_code\n    , drg_code_type\n    , drg_code\n    , revenue_center_code\n    , service_unit_quantity\n    , hcpcs_code\n    , hcpcs_modifier_1\n    , hcpcs_modifier_2\n    , hcpcs_modifier_3\n    , hcpcs_modifier_4\n    , hcpcs_modifier_5\n    , rendering_npi\n    , rendering_tin\n    , billing_npi\n    , billing_tin\n    , facility_npi\n    , paid_date\n    , paid_amount\n    , allowed_amount\n    , charge_amount\n    , coinsurance_amount\n    , copayment_amount\n    , deductible_amount\n    , total_cost_amount\n    , diagnosis_code_type\n    , diagnosis_code_1\n    , diagnosis_code_2\n    , diagnosis_code_3\n    , diagnosis_code_4\n    , diagnosis_code_5\n    , diagnosis_code_6\n    , diagnosis_code_7\n    , diagnosis_code_8\n    , diagnosis_code_9\n    , diagnosis_code_10\n    , diagnosis_code_11\n    , diagnosis_code_12\n    , diagnosis_code_13\n    , diagnosis_code_14\n    , diagnosis_code_15\n    , diagnosis_code_16\n    , diagnosis_code_17\n    , diagnosis_code_18\n    , diagnosis_code_19\n    , diagnosis_code_20\n    , diagnosis_code_21\n    , diagnosis_code_22\n    , diagnosis_code_23\n    , diagnosis_code_24\n    , diagnosis_code_25\n    , diagnosis_poa_1\n    , diagnosis_poa_2\n    , diagnosis_poa_3\n    , diagnosis_poa_4\n    , diagnosis_poa_5\n    , diagnosis_poa_6\n    , diagnosis_poa_7\n    , diagnosis_poa_8\n    , diagnosis_poa_9\n    , diagnosis_poa_10\n    , diagnosis_poa_11\n    , diagnosis_poa_12\n    , diagnosis_poa_13\n    , diagnosis_poa_14\n    , diagnosis_poa_15\n    , diagnosis_poa_16\n    , diagnosis_poa_17\n    , diagnosis_poa_18\n    , diagnosis_poa_19\n    , diagnosis_poa_20\n    , diagnosis_poa_21\n    , diagnosis_poa_22\n    , diagnosis_poa_23\n    , diagnosis_poa_24\n    , diagnosis_poa_25\n    , procedure_code_type\n    , procedure_code_1\n    , procedure_code_2\n    , procedure_code_3\n    , procedure_code_4\n    , procedure_code_5\n    , procedure_code_6\n    , procedure_code_7\n    , procedure_code_8\n    , procedure_code_9\n    , procedure_code_10\n    , procedure_code_11\n    , procedure_code_12\n    , procedure_code_13\n    , procedure_code_14\n    , procedure_code_15\n    , procedure_code_16\n    , procedure_code_17\n    , procedure_code_18\n    , procedure_code_19\n    , procedure_code_20\n    , procedure_code_21\n    , procedure_code_22\n    , procedure_code_23\n    , procedure_code_24\n    , procedure_code_25\n    , procedure_date_1\n    , procedure_date_2\n    , procedure_date_3\n    , procedure_date_4\n    , procedure_date_5\n    , procedure_date_6\n    , procedure_date_7\n    , procedure_date_8\n    , procedure_date_9\n    , procedure_date_10\n    , procedure_date_11\n    , procedure_date_12\n    , procedure_date_13\n    , procedure_date_14\n    , procedure_date_15\n    , procedure_date_16\n    , procedure_date_17\n    , procedure_date_18\n    , procedure_date_19\n    , procedure_date_20\n    , procedure_date_21\n    , procedure_date_22\n    , procedure_date_23\n    , procedure_date_24\n    , procedure_date_25\n    , in_network_flag\n    , data_source\n    , file_name\n    , file_date\n    , ingest_datetime\nfrom tuva.input_layer.medical_claim\n), pivot_poa as(\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'diagnosis_poa_1'  as diagnosis_column\n        ,  diagnosis_poa_1  as present_on_admit_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'diagnosis_poa_2'  as diagnosis_column\n        ,  diagnosis_poa_2  as present_on_admit_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'diagnosis_poa_3'  as diagnosis_column\n        ,  diagnosis_poa_3  as present_on_admit_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'diagnosis_poa_4'  as diagnosis_column\n        ,  diagnosis_poa_4  as present_on_admit_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'diagnosis_poa_5'  as diagnosis_column\n        ,  diagnosis_poa_5  as present_on_admit_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'diagnosis_poa_6'  as diagnosis_column\n        ,  diagnosis_poa_6  as present_on_admit_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'diagnosis_poa_7'  as diagnosis_column\n        ,  diagnosis_poa_7  as present_on_admit_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'diagnosis_poa_8'  as diagnosis_column\n        ,  diagnosis_poa_8  as present_on_admit_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'diagnosis_poa_9'  as diagnosis_column\n        ,  diagnosis_poa_9  as present_on_admit_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'diagnosis_poa_10'  as diagnosis_column\n        ,  diagnosis_poa_10  as present_on_admit_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'diagnosis_poa_11'  as diagnosis_column\n        ,  diagnosis_poa_11  as present_on_admit_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'diagnosis_poa_12'  as diagnosis_column\n        ,  diagnosis_poa_12  as present_on_admit_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'diagnosis_poa_13'  as diagnosis_column\n        ,  diagnosis_poa_13  as present_on_admit_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'diagnosis_poa_14'  as diagnosis_column\n        ,  diagnosis_poa_14  as present_on_admit_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'diagnosis_poa_15'  as diagnosis_column\n        ,  diagnosis_poa_15  as present_on_admit_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'diagnosis_poa_16'  as diagnosis_column\n        ,  diagnosis_poa_16  as present_on_admit_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'diagnosis_poa_17'  as diagnosis_column\n        ,  diagnosis_poa_17  as present_on_admit_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'diagnosis_poa_18'  as diagnosis_column\n        ,  diagnosis_poa_18  as present_on_admit_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'diagnosis_poa_19'  as diagnosis_column\n        ,  diagnosis_poa_19  as present_on_admit_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'diagnosis_poa_20'  as diagnosis_column\n        ,  diagnosis_poa_20  as present_on_admit_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'diagnosis_poa_21'  as diagnosis_column\n        ,  diagnosis_poa_21  as present_on_admit_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'diagnosis_poa_22'  as diagnosis_column\n        ,  diagnosis_poa_22  as present_on_admit_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'diagnosis_poa_23'  as diagnosis_column\n        ,  diagnosis_poa_24  as present_on_admit_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'diagnosis_poa_24'  as diagnosis_column\n        ,  diagnosis_poa_24  as present_on_admit_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'diagnosis_poa_25'  as diagnosis_column\n        ,  diagnosis_poa_25  as present_on_admit_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n)\n\nselect\n    claim_id\n    , data_source\n    , diagnosis_column\n    , poa.present_on_admit_code as normalized_present_on_admit_code\n    , count(*) as present_on_admit_occurrence_count\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom pivot_poa piv\nleft join tuva.terminology.present_on_admission poa\n    on replace(piv.present_on_admit_code,'.','') = poa.present_on_admit_code\nwhere claim_type = 'institutional'\ngroup by \n    claim_id\n    , data_source\n    , diagnosis_column\n    , poa.present_on_admit_code", "relation_name": "tuva.claims_preprocessing._int_normalized_input_present_on_admit_normalize"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.062762Z", "completed_at": "2025-02-25T21:26:18.152743Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.155338Z", "completed_at": "2025-02-25T21:26:18.155344Z"}], "thread_id": "Thread-3", "execution_time": 0.09306812286376953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.normalized_input__int_procedure_code_normalize", "compiled": true, "compiled_code": "\n\n\nwith  __dbt__cte__normalized_input__stg_medical_claim as (\n\n\nselect\n      claim_id\n    , claim_line_number\n    , claim_type\n    , person_id\n    , member_id\n    , payer\n    , plan\n    , claim_start_date\n    , claim_end_date\n    , claim_line_start_date\n    , claim_line_end_date\n    , admission_date\n    , discharge_date\n    , admit_source_code\n    , admit_type_code\n    , discharge_disposition_code\n    , place_of_service_code\n    , bill_type_code\n    , drg_code_type\n    , drg_code\n    , revenue_center_code\n    , service_unit_quantity\n    , hcpcs_code\n    , hcpcs_modifier_1\n    , hcpcs_modifier_2\n    , hcpcs_modifier_3\n    , hcpcs_modifier_4\n    , hcpcs_modifier_5\n    , rendering_npi\n    , rendering_tin\n    , billing_npi\n    , billing_tin\n    , facility_npi\n    , paid_date\n    , paid_amount\n    , allowed_amount\n    , charge_amount\n    , coinsurance_amount\n    , copayment_amount\n    , deductible_amount\n    , total_cost_amount\n    , diagnosis_code_type\n    , diagnosis_code_1\n    , diagnosis_code_2\n    , diagnosis_code_3\n    , diagnosis_code_4\n    , diagnosis_code_5\n    , diagnosis_code_6\n    , diagnosis_code_7\n    , diagnosis_code_8\n    , diagnosis_code_9\n    , diagnosis_code_10\n    , diagnosis_code_11\n    , diagnosis_code_12\n    , diagnosis_code_13\n    , diagnosis_code_14\n    , diagnosis_code_15\n    , diagnosis_code_16\n    , diagnosis_code_17\n    , diagnosis_code_18\n    , diagnosis_code_19\n    , diagnosis_code_20\n    , diagnosis_code_21\n    , diagnosis_code_22\n    , diagnosis_code_23\n    , diagnosis_code_24\n    , diagnosis_code_25\n    , diagnosis_poa_1\n    , diagnosis_poa_2\n    , diagnosis_poa_3\n    , diagnosis_poa_4\n    , diagnosis_poa_5\n    , diagnosis_poa_6\n    , diagnosis_poa_7\n    , diagnosis_poa_8\n    , diagnosis_poa_9\n    , diagnosis_poa_10\n    , diagnosis_poa_11\n    , diagnosis_poa_12\n    , diagnosis_poa_13\n    , diagnosis_poa_14\n    , diagnosis_poa_15\n    , diagnosis_poa_16\n    , diagnosis_poa_17\n    , diagnosis_poa_18\n    , diagnosis_poa_19\n    , diagnosis_poa_20\n    , diagnosis_poa_21\n    , diagnosis_poa_22\n    , diagnosis_poa_23\n    , diagnosis_poa_24\n    , diagnosis_poa_25\n    , procedure_code_type\n    , procedure_code_1\n    , procedure_code_2\n    , procedure_code_3\n    , procedure_code_4\n    , procedure_code_5\n    , procedure_code_6\n    , procedure_code_7\n    , procedure_code_8\n    , procedure_code_9\n    , procedure_code_10\n    , procedure_code_11\n    , procedure_code_12\n    , procedure_code_13\n    , procedure_code_14\n    , procedure_code_15\n    , procedure_code_16\n    , procedure_code_17\n    , procedure_code_18\n    , procedure_code_19\n    , procedure_code_20\n    , procedure_code_21\n    , procedure_code_22\n    , procedure_code_23\n    , procedure_code_24\n    , procedure_code_25\n    , procedure_date_1\n    , procedure_date_2\n    , procedure_date_3\n    , procedure_date_4\n    , procedure_date_5\n    , procedure_date_6\n    , procedure_date_7\n    , procedure_date_8\n    , procedure_date_9\n    , procedure_date_10\n    , procedure_date_11\n    , procedure_date_12\n    , procedure_date_13\n    , procedure_date_14\n    , procedure_date_15\n    , procedure_date_16\n    , procedure_date_17\n    , procedure_date_18\n    , procedure_date_19\n    , procedure_date_20\n    , procedure_date_21\n    , procedure_date_22\n    , procedure_date_23\n    , procedure_date_24\n    , procedure_date_25\n    , in_network_flag\n    , data_source\n    , file_name\n    , file_date\n    , ingest_datetime\nfrom tuva.input_layer.medical_claim\n), pivot_procedure as(\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , procedure_code_type\n        , 'procedure_code_1'  as procedure_column\n        ,  procedure_code_1  as procedure_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , procedure_code_type\n        , 'procedure_code_2'  as procedure_column\n        ,  procedure_code_2  as procedure_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , procedure_code_type\n        , 'procedure_code_3'  as procedure_column\n        ,  procedure_code_3  as procedure_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , procedure_code_type\n        , 'procedure_code_4'  as procedure_column\n        ,  procedure_code_4  as procedure_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , procedure_code_type\n        , 'procedure_code_5'  as procedure_column\n        ,  procedure_code_5  as procedure_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , procedure_code_type\n        , 'procedure_code_6'  as procedure_column\n        ,  procedure_code_6  as procedure_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , procedure_code_type\n        , 'procedure_code_7'  as procedure_column\n        ,  procedure_code_7  as procedure_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , procedure_code_type\n        , 'procedure_code_8'  as procedure_column\n        ,  procedure_code_8  as procedure_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , procedure_code_type\n        , 'procedure_code_9'  as procedure_column\n        ,  procedure_code_9  as procedure_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , procedure_code_type\n        , 'procedure_code_10'  as procedure_column\n        ,  procedure_code_10  as procedure_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , procedure_code_type\n        , 'procedure_code_11'  as procedure_column\n        ,  procedure_code_11  as procedure_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , procedure_code_type\n        , 'procedure_code_12'  as procedure_column\n        ,  procedure_code_12  as procedure_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , procedure_code_type\n        , 'procedure_code_13'  as procedure_column\n        ,  procedure_code_13  as procedure_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , procedure_code_type\n        , 'procedure_code_14'  as procedure_column\n        ,  procedure_code_14  as procedure_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , procedure_code_type\n        , 'procedure_code_15'  as procedure_column\n        ,  procedure_code_15  as procedure_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , procedure_code_type\n        , 'procedure_code_16'  as procedure_column\n        ,  procedure_code_16  as procedure_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , procedure_code_type\n        , 'procedure_code_17'  as procedure_column\n        ,  procedure_code_17  as procedure_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , procedure_code_type\n        , 'procedure_code_18'  as procedure_column\n        ,  procedure_code_18  as procedure_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , procedure_code_type\n        , 'procedure_code_19'  as procedure_column\n        ,  procedure_code_19  as procedure_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , procedure_code_type\n        , 'procedure_code_20'  as procedure_column\n        ,  procedure_code_20  as procedure_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , procedure_code_type\n        , 'procedure_code_21'  as procedure_column\n        ,  procedure_code_21  as procedure_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , procedure_code_type\n        , 'procedure_code_22'  as procedure_column\n        ,  procedure_code_22  as procedure_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , procedure_code_type\n        , 'procedure_code_23'  as procedure_column\n        ,  procedure_code_23  as procedure_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , procedure_code_type\n        , 'procedure_code_24'  as procedure_column\n        ,  procedure_code_24  as procedure_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , procedure_code_type\n        , 'procedure_code_25'  as procedure_column\n        ,  procedure_code_25  as procedure_code\n    from __dbt__cte__normalized_input__stg_medical_claim\n)\n\nselect\n    claim_id\n    , data_source\n    , procedure_code_type\n    , procedure_column\n    , coalesce(icd_9.icd_9_pcs,icd_10.icd_10_pcs) as normalized_procedure_code\n    , count(*) as procedure_code_occurrence_count\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom pivot_procedure piv\nleft join tuva.terminology.icd_10_pcs icd_10\n    on replace(piv.procedure_code,'.','') = icd_10.icd_10_pcs\n    and piv.procedure_code_type = 'icd-10-pcs'\nleft join tuva.terminology.icd_9_pcs icd_9\n    on replace(piv.procedure_code,'.','') = icd_9.icd_9_pcs\n    and piv.procedure_code_type = 'icd-9-pcs'\nwhere claim_type = 'institutional'\ngroup by \n    claim_id\n    , data_source\n    , procedure_code_type\n    , procedure_column\n    , coalesce(icd_9.icd_9_pcs,icd_10.icd_10_pcs)", "relation_name": "tuva.claims_preprocessing._int_normalized_input_procedure_code_normalize"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.121463Z", "completed_at": "2025-02-25T21:26:18.167658Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.168602Z", "completed_at": "2025-02-25T21:26:18.168608Z"}], "thread_id": "Thread-2", "execution_time": 0.06200075149536133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.normalized_input__int_procedure_date_normalize", "compiled": true, "compiled_code": "\n\n\nwith  __dbt__cte__normalized_input__stg_medical_claim as (\n\n\nselect\n      claim_id\n    , claim_line_number\n    , claim_type\n    , person_id\n    , member_id\n    , payer\n    , plan\n    , claim_start_date\n    , claim_end_date\n    , claim_line_start_date\n    , claim_line_end_date\n    , admission_date\n    , discharge_date\n    , admit_source_code\n    , admit_type_code\n    , discharge_disposition_code\n    , place_of_service_code\n    , bill_type_code\n    , drg_code_type\n    , drg_code\n    , revenue_center_code\n    , service_unit_quantity\n    , hcpcs_code\n    , hcpcs_modifier_1\n    , hcpcs_modifier_2\n    , hcpcs_modifier_3\n    , hcpcs_modifier_4\n    , hcpcs_modifier_5\n    , rendering_npi\n    , rendering_tin\n    , billing_npi\n    , billing_tin\n    , facility_npi\n    , paid_date\n    , paid_amount\n    , allowed_amount\n    , charge_amount\n    , coinsurance_amount\n    , copayment_amount\n    , deductible_amount\n    , total_cost_amount\n    , diagnosis_code_type\n    , diagnosis_code_1\n    , diagnosis_code_2\n    , diagnosis_code_3\n    , diagnosis_code_4\n    , diagnosis_code_5\n    , diagnosis_code_6\n    , diagnosis_code_7\n    , diagnosis_code_8\n    , diagnosis_code_9\n    , diagnosis_code_10\n    , diagnosis_code_11\n    , diagnosis_code_12\n    , diagnosis_code_13\n    , diagnosis_code_14\n    , diagnosis_code_15\n    , diagnosis_code_16\n    , diagnosis_code_17\n    , diagnosis_code_18\n    , diagnosis_code_19\n    , diagnosis_code_20\n    , diagnosis_code_21\n    , diagnosis_code_22\n    , diagnosis_code_23\n    , diagnosis_code_24\n    , diagnosis_code_25\n    , diagnosis_poa_1\n    , diagnosis_poa_2\n    , diagnosis_poa_3\n    , diagnosis_poa_4\n    , diagnosis_poa_5\n    , diagnosis_poa_6\n    , diagnosis_poa_7\n    , diagnosis_poa_8\n    , diagnosis_poa_9\n    , diagnosis_poa_10\n    , diagnosis_poa_11\n    , diagnosis_poa_12\n    , diagnosis_poa_13\n    , diagnosis_poa_14\n    , diagnosis_poa_15\n    , diagnosis_poa_16\n    , diagnosis_poa_17\n    , diagnosis_poa_18\n    , diagnosis_poa_19\n    , diagnosis_poa_20\n    , diagnosis_poa_21\n    , diagnosis_poa_22\n    , diagnosis_poa_23\n    , diagnosis_poa_24\n    , diagnosis_poa_25\n    , procedure_code_type\n    , procedure_code_1\n    , procedure_code_2\n    , procedure_code_3\n    , procedure_code_4\n    , procedure_code_5\n    , procedure_code_6\n    , procedure_code_7\n    , procedure_code_8\n    , procedure_code_9\n    , procedure_code_10\n    , procedure_code_11\n    , procedure_code_12\n    , procedure_code_13\n    , procedure_code_14\n    , procedure_code_15\n    , procedure_code_16\n    , procedure_code_17\n    , procedure_code_18\n    , procedure_code_19\n    , procedure_code_20\n    , procedure_code_21\n    , procedure_code_22\n    , procedure_code_23\n    , procedure_code_24\n    , procedure_code_25\n    , procedure_date_1\n    , procedure_date_2\n    , procedure_date_3\n    , procedure_date_4\n    , procedure_date_5\n    , procedure_date_6\n    , procedure_date_7\n    , procedure_date_8\n    , procedure_date_9\n    , procedure_date_10\n    , procedure_date_11\n    , procedure_date_12\n    , procedure_date_13\n    , procedure_date_14\n    , procedure_date_15\n    , procedure_date_16\n    , procedure_date_17\n    , procedure_date_18\n    , procedure_date_19\n    , procedure_date_20\n    , procedure_date_21\n    , procedure_date_22\n    , procedure_date_23\n    , procedure_date_24\n    , procedure_date_25\n    , in_network_flag\n    , data_source\n    , file_name\n    , file_date\n    , ingest_datetime\nfrom tuva.input_layer.medical_claim\n), pivot_procedure as(\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'procedure_date_1'  as procedure_column\n        ,  procedure_date_1  as procedure_date\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'procedure_date_2'  as procedure_column\n        ,  procedure_date_2  as procedure_date\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'procedure_date_3'  as procedure_column\n        ,  procedure_date_3  as procedure_date\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'procedure_date_4'  as procedure_column\n        ,  procedure_date_4  as procedure_date\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'procedure_date_5'  as procedure_column\n        ,  procedure_date_5  as procedure_date\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'procedure_date_6'  as procedure_column\n        ,  procedure_date_6  as procedure_date\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'procedure_date_7'  as procedure_column\n        ,  procedure_date_7  as procedure_date\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'procedure_date_8'  as procedure_column\n        ,  procedure_date_8  as procedure_date\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'procedure_date_9'  as procedure_column\n        ,  procedure_date_9  as procedure_date\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'procedure_date_10'  as procedure_column\n        ,  procedure_date_10  as procedure_date\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'procedure_date_11'  as procedure_column\n        ,  procedure_date_11  as procedure_date\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'procedure_date_12'  as procedure_column\n        ,  procedure_date_12  as procedure_date\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'procedure_date_13'  as procedure_column\n        ,  procedure_date_13  as procedure_date\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'procedure_date_14'  as procedure_column\n        ,  procedure_date_14  as procedure_date\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'procedure_date_15'  as procedure_column\n        ,  procedure_date_15  as procedure_date\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'procedure_date_16'  as procedure_column\n        ,  procedure_date_16  as procedure_date\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'procedure_date_17'  as procedure_column\n        ,  procedure_date_17  as procedure_date\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'procedure_date_18'  as procedure_column\n        ,  procedure_date_18  as procedure_date\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'procedure_date_19'  as procedure_column\n        ,  procedure_date_19  as procedure_date\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'procedure_date_20'  as procedure_column\n        ,  procedure_date_20  as procedure_date\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'procedure_date_21'  as procedure_column\n        ,  procedure_date_21  as procedure_date\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'procedure_date_22'  as procedure_column\n        ,  procedure_date_22  as procedure_date\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'procedure_date_23'  as procedure_column\n        ,  procedure_date_23  as procedure_date\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'procedure_date_24'  as procedure_column\n        ,  procedure_date_24  as procedure_date\n    from __dbt__cte__normalized_input__stg_medical_claim\n\n    union all\n\n    select\n        claim_id\n        , claim_type\n        , data_source\n        , 'procedure_date_25'  as procedure_column\n        ,  procedure_date_25  as procedure_date\n    from __dbt__cte__normalized_input__stg_medical_claim\n)\n\nselect\n    claim_id\n    , data_source\n    , procedure_column\n    , cal.full_date as procedure_date\n    , count(*) as procedure_date_occurrence_count\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom pivot_procedure piv\nleft join tuva.reference_data.calendar cal\n    on piv.procedure_date = cal.full_date\nwhere claim_type = 'institutional'\ngroup by \n    claim_id\n    , data_source\n    , procedure_column\n    , cal.full_date", "relation_name": "tuva.claims_preprocessing._int_normalized_input_procedure_date_normalize"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.161083Z", "completed_at": "2025-02-25T21:26:18.169424Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.187043Z", "completed_at": "2025-02-25T21:26:18.187056Z"}], "thread_id": "Thread-1", "execution_time": 0.0341649055480957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.normalized_input__int_revenue_center_normalize", "compiled": true, "compiled_code": "\n\n\nwith __dbt__cte__normalized_input__stg_medical_claim as (\n\n\nselect\n      claim_id\n    , claim_line_number\n    , claim_type\n    , person_id\n    , member_id\n    , payer\n    , plan\n    , claim_start_date\n    , claim_end_date\n    , claim_line_start_date\n    , claim_line_end_date\n    , admission_date\n    , discharge_date\n    , admit_source_code\n    , admit_type_code\n    , discharge_disposition_code\n    , place_of_service_code\n    , bill_type_code\n    , drg_code_type\n    , drg_code\n    , revenue_center_code\n    , service_unit_quantity\n    , hcpcs_code\n    , hcpcs_modifier_1\n    , hcpcs_modifier_2\n    , hcpcs_modifier_3\n    , hcpcs_modifier_4\n    , hcpcs_modifier_5\n    , rendering_npi\n    , rendering_tin\n    , billing_npi\n    , billing_tin\n    , facility_npi\n    , paid_date\n    , paid_amount\n    , allowed_amount\n    , charge_amount\n    , coinsurance_amount\n    , copayment_amount\n    , deductible_amount\n    , total_cost_amount\n    , diagnosis_code_type\n    , diagnosis_code_1\n    , diagnosis_code_2\n    , diagnosis_code_3\n    , diagnosis_code_4\n    , diagnosis_code_5\n    , diagnosis_code_6\n    , diagnosis_code_7\n    , diagnosis_code_8\n    , diagnosis_code_9\n    , diagnosis_code_10\n    , diagnosis_code_11\n    , diagnosis_code_12\n    , diagnosis_code_13\n    , diagnosis_code_14\n    , diagnosis_code_15\n    , diagnosis_code_16\n    , diagnosis_code_17\n    , diagnosis_code_18\n    , diagnosis_code_19\n    , diagnosis_code_20\n    , diagnosis_code_21\n    , diagnosis_code_22\n    , diagnosis_code_23\n    , diagnosis_code_24\n    , diagnosis_code_25\n    , diagnosis_poa_1\n    , diagnosis_poa_2\n    , diagnosis_poa_3\n    , diagnosis_poa_4\n    , diagnosis_poa_5\n    , diagnosis_poa_6\n    , diagnosis_poa_7\n    , diagnosis_poa_8\n    , diagnosis_poa_9\n    , diagnosis_poa_10\n    , diagnosis_poa_11\n    , diagnosis_poa_12\n    , diagnosis_poa_13\n    , diagnosis_poa_14\n    , diagnosis_poa_15\n    , diagnosis_poa_16\n    , diagnosis_poa_17\n    , diagnosis_poa_18\n    , diagnosis_poa_19\n    , diagnosis_poa_20\n    , diagnosis_poa_21\n    , diagnosis_poa_22\n    , diagnosis_poa_23\n    , diagnosis_poa_24\n    , diagnosis_poa_25\n    , procedure_code_type\n    , procedure_code_1\n    , procedure_code_2\n    , procedure_code_3\n    , procedure_code_4\n    , procedure_code_5\n    , procedure_code_6\n    , procedure_code_7\n    , procedure_code_8\n    , procedure_code_9\n    , procedure_code_10\n    , procedure_code_11\n    , procedure_code_12\n    , procedure_code_13\n    , procedure_code_14\n    , procedure_code_15\n    , procedure_code_16\n    , procedure_code_17\n    , procedure_code_18\n    , procedure_code_19\n    , procedure_code_20\n    , procedure_code_21\n    , procedure_code_22\n    , procedure_code_23\n    , procedure_code_24\n    , procedure_code_25\n    , procedure_date_1\n    , procedure_date_2\n    , procedure_date_3\n    , procedure_date_4\n    , procedure_date_5\n    , procedure_date_6\n    , procedure_date_7\n    , procedure_date_8\n    , procedure_date_9\n    , procedure_date_10\n    , procedure_date_11\n    , procedure_date_12\n    , procedure_date_13\n    , procedure_date_14\n    , procedure_date_15\n    , procedure_date_16\n    , procedure_date_17\n    , procedure_date_18\n    , procedure_date_19\n    , procedure_date_20\n    , procedure_date_21\n    , procedure_date_22\n    , procedure_date_23\n    , procedure_date_24\n    , procedure_date_25\n    , in_network_flag\n    , data_source\n    , file_name\n    , file_date\n    , ingest_datetime\nfrom tuva.input_layer.medical_claim\n) select\n    claim_id\n    , claim_line_number\n    , data_source\n    , rev.revenue_center_code as normalized_code\n    , rev.revenue_center_description as normalized_description\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom __dbt__cte__normalized_input__stg_medical_claim med\nleft join tuva.terminology.revenue_center rev\n    \n        on lpad(med.revenue_center_code, 4, '0') = rev.revenue_center_code\n    \nwhere claim_type = 'institutional'", "relation_name": "tuva.claims_preprocessing._int_normalized_input_revenue_center_normalize"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.169962Z", "completed_at": "2025-02-25T21:26:18.212605Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.235897Z", "completed_at": "2025-02-25T21:26:18.235906Z"}], "thread_id": "Thread-3", "execution_time": 0.06776595115661621, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.normalized_input__int_undetermined_claim_type", "compiled": true, "compiled_code": "\n\n\nwith __dbt__cte__normalized_input__stg_medical_claim as (\n\n\nselect\n      claim_id\n    , claim_line_number\n    , claim_type\n    , person_id\n    , member_id\n    , payer\n    , plan\n    , claim_start_date\n    , claim_end_date\n    , claim_line_start_date\n    , claim_line_end_date\n    , admission_date\n    , discharge_date\n    , admit_source_code\n    , admit_type_code\n    , discharge_disposition_code\n    , place_of_service_code\n    , bill_type_code\n    , drg_code_type\n    , drg_code\n    , revenue_center_code\n    , service_unit_quantity\n    , hcpcs_code\n    , hcpcs_modifier_1\n    , hcpcs_modifier_2\n    , hcpcs_modifier_3\n    , hcpcs_modifier_4\n    , hcpcs_modifier_5\n    , rendering_npi\n    , rendering_tin\n    , billing_npi\n    , billing_tin\n    , facility_npi\n    , paid_date\n    , paid_amount\n    , allowed_amount\n    , charge_amount\n    , coinsurance_amount\n    , copayment_amount\n    , deductible_amount\n    , total_cost_amount\n    , diagnosis_code_type\n    , diagnosis_code_1\n    , diagnosis_code_2\n    , diagnosis_code_3\n    , diagnosis_code_4\n    , diagnosis_code_5\n    , diagnosis_code_6\n    , diagnosis_code_7\n    , diagnosis_code_8\n    , diagnosis_code_9\n    , diagnosis_code_10\n    , diagnosis_code_11\n    , diagnosis_code_12\n    , diagnosis_code_13\n    , diagnosis_code_14\n    , diagnosis_code_15\n    , diagnosis_code_16\n    , diagnosis_code_17\n    , diagnosis_code_18\n    , diagnosis_code_19\n    , diagnosis_code_20\n    , diagnosis_code_21\n    , diagnosis_code_22\n    , diagnosis_code_23\n    , diagnosis_code_24\n    , diagnosis_code_25\n    , diagnosis_poa_1\n    , diagnosis_poa_2\n    , diagnosis_poa_3\n    , diagnosis_poa_4\n    , diagnosis_poa_5\n    , diagnosis_poa_6\n    , diagnosis_poa_7\n    , diagnosis_poa_8\n    , diagnosis_poa_9\n    , diagnosis_poa_10\n    , diagnosis_poa_11\n    , diagnosis_poa_12\n    , diagnosis_poa_13\n    , diagnosis_poa_14\n    , diagnosis_poa_15\n    , diagnosis_poa_16\n    , diagnosis_poa_17\n    , diagnosis_poa_18\n    , diagnosis_poa_19\n    , diagnosis_poa_20\n    , diagnosis_poa_21\n    , diagnosis_poa_22\n    , diagnosis_poa_23\n    , diagnosis_poa_24\n    , diagnosis_poa_25\n    , procedure_code_type\n    , procedure_code_1\n    , procedure_code_2\n    , procedure_code_3\n    , procedure_code_4\n    , procedure_code_5\n    , procedure_code_6\n    , procedure_code_7\n    , procedure_code_8\n    , procedure_code_9\n    , procedure_code_10\n    , procedure_code_11\n    , procedure_code_12\n    , procedure_code_13\n    , procedure_code_14\n    , procedure_code_15\n    , procedure_code_16\n    , procedure_code_17\n    , procedure_code_18\n    , procedure_code_19\n    , procedure_code_20\n    , procedure_code_21\n    , procedure_code_22\n    , procedure_code_23\n    , procedure_code_24\n    , procedure_code_25\n    , procedure_date_1\n    , procedure_date_2\n    , procedure_date_3\n    , procedure_date_4\n    , procedure_date_5\n    , procedure_date_6\n    , procedure_date_7\n    , procedure_date_8\n    , procedure_date_9\n    , procedure_date_10\n    , procedure_date_11\n    , procedure_date_12\n    , procedure_date_13\n    , procedure_date_14\n    , procedure_date_15\n    , procedure_date_16\n    , procedure_date_17\n    , procedure_date_18\n    , procedure_date_19\n    , procedure_date_20\n    , procedure_date_21\n    , procedure_date_22\n    , procedure_date_23\n    , procedure_date_24\n    , procedure_date_25\n    , in_network_flag\n    , data_source\n    , file_name\n    , file_date\n    , ingest_datetime\nfrom tuva.input_layer.medical_claim\n) select\n    claim_id\n    , claim_line_number\n    , claim_type\n    , person_id\n    , member_id\n    , payer\n    , plan\n    , claim_start_date\n    , claim_end_date\n    , claim_line_start_date\n    , claim_line_end_date\n    , admission_date\n    , discharge_date\n    , ad_src.admit_source_code\n    , ad_src.admit_source_description\n    , ad_type.admit_type_code\n    , ad_type.admit_type_description\n    , dis.discharge_disposition_code\n    , dis.discharge_disposition_description\n    , pos.place_of_service_code\n    , pos.place_of_service_description\n    , tob.bill_type_code\n    , tob.bill_type_description\n    , med.drg_code_type\n    , coalesce(msdrg.ms_drg_code, aprdrg.apr_drg_code) as drg_code\n    , coalesce(msdrg.ms_drg_description, aprdrg.apr_drg_description) as drg_description\n    , rev.revenue_center_code\n    , rev.revenue_center_description\n    , service_unit_quantity\n    , hcpcs_code\n    , hcpcs_modifier_1\n    , hcpcs_modifier_2\n    , hcpcs_modifier_3\n    , hcpcs_modifier_4\n    , hcpcs_modifier_5\n    , rendering_npi\n    , rendnpi.npi as rendering_name\n    , billing_npi\n    , billnpi.npi as billing_name\n    , facility_npi\n    , facnpi.npi as facility_name\n    , paid_date\n    , paid_amount\n    , allowed_amount\n    , charge_amount\n    , coinsurance_amount\n    , copayment_amount\n    , deductible_amount\n    , total_cost_amount\n    , diagnosis_code_type\n    , diagnosis_code_1\n    , diagnosis_code_2\n    , diagnosis_code_3\n    , diagnosis_code_4\n    , diagnosis_code_5\n    , diagnosis_code_6\n    , diagnosis_code_7\n    , diagnosis_code_8\n    , diagnosis_code_9\n    , diagnosis_code_10\n    , diagnosis_code_11\n    , diagnosis_code_12\n    , diagnosis_code_13\n    , diagnosis_code_14\n    , diagnosis_code_15\n    , diagnosis_code_16\n    , diagnosis_code_17\n    , diagnosis_code_18\n    , diagnosis_code_19\n    , diagnosis_code_20\n    , diagnosis_code_21\n    , diagnosis_code_22\n    , diagnosis_code_23\n    , diagnosis_code_24\n    , diagnosis_code_25\n    , diagnosis_poa_1\n    , diagnosis_poa_2\n    , diagnosis_poa_3\n    , diagnosis_poa_4\n    , diagnosis_poa_5\n    , diagnosis_poa_6\n    , diagnosis_poa_7\n    , diagnosis_poa_8\n    , diagnosis_poa_9\n    , diagnosis_poa_10\n    , diagnosis_poa_11\n    , diagnosis_poa_12\n    , diagnosis_poa_13\n    , diagnosis_poa_14\n    , diagnosis_poa_15\n    , diagnosis_poa_16\n    , diagnosis_poa_17\n    , diagnosis_poa_18\n    , diagnosis_poa_19\n    , diagnosis_poa_20\n    , diagnosis_poa_21\n    , diagnosis_poa_22\n    , diagnosis_poa_23\n    , diagnosis_poa_24\n    , diagnosis_poa_25\n    , procedure_code_type\n    , procedure_code_1\n    , procedure_code_2\n    , procedure_code_3\n    , procedure_code_4\n    , procedure_code_5\n    , procedure_code_6\n    , procedure_code_7\n    , procedure_code_8\n    , procedure_code_9\n    , procedure_code_10\n    , procedure_code_11\n    , procedure_code_12\n    , procedure_code_13\n    , procedure_code_14\n    , procedure_code_15\n    , procedure_code_16\n    , procedure_code_17\n    , procedure_code_18\n    , procedure_code_19\n    , procedure_code_20\n    , procedure_code_21\n    , procedure_code_22\n    , procedure_code_23\n    , procedure_code_24\n    , procedure_code_25\n    , procedure_date_1\n    , procedure_date_2\n    , procedure_date_3\n    , procedure_date_4\n    , procedure_date_5\n    , procedure_date_6\n    , procedure_date_7\n    , procedure_date_8\n    , procedure_date_9\n    , procedure_date_10\n    , procedure_date_11\n    , procedure_date_12\n    , procedure_date_13\n    , procedure_date_14\n    , procedure_date_15\n    , procedure_date_16\n    , procedure_date_17\n    , procedure_date_18\n    , procedure_date_19\n    , procedure_date_20\n    , procedure_date_21\n    , procedure_date_22\n    , procedure_date_23\n    , procedure_date_24\n    , procedure_date_25\n    , data_source\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom __dbt__cte__normalized_input__stg_medical_claim med\nleft join tuva.terminology.admit_source ad_src\n    on med.admit_source_code = ad_src.admit_source_code\nleft join tuva.terminology.admit_type ad_type\n    on med.admit_type_code = ad_type.admit_type_code\nleft join tuva.terminology.discharge_disposition dis\n    on med.discharge_disposition_code = dis.discharge_disposition_code\nleft join tuva.terminology.place_of_service pos\n    on med.place_of_service_code = pos.place_of_service_code\nleft join tuva.terminology.bill_type tob\n    on med.bill_type_code = tob.bill_type_code\nleft join tuva.terminology.ms_drg msdrg\n    on med.drg_code_type = 'ms-drg'\n    and med.drg_code = msdrg.ms_drg_code\nleft join tuva.terminology.apr_drg aprdrg\n    on med.drg_code_type = 'apr-drg'\n    and med.drg_code = aprdrg.apr_drg_code\nleft join tuva.terminology.revenue_center rev\n    on med.revenue_center_code = rev.revenue_center_code\nleft join tuva.terminology.provider rendnpi\n    on med.rendering_npi = rendnpi.npi\nleft join tuva.terminology.provider billnpi\n    on med.billing_npi = billnpi.npi\nleft join tuva.terminology.provider facnpi\n    on med.facility_npi = facnpi.npi\nwhere claim_type in ('undetermined')", "relation_name": "tuva.claims_preprocessing._int_normalized_input_undetermined_claim_type"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.212867Z", "completed_at": "2025-02-25T21:26:18.252195Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.271387Z", "completed_at": "2025-02-25T21:26:18.271401Z"}], "thread_id": "Thread-2", "execution_time": 0.07717299461364746, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.normalized_input__pharmacy_claim", "compiled": true, "compiled_code": "\n\n\nwith __dbt__cte__normalized_input__stg_pharmacy_claim as (\n\n\n\nselect\n      claim_id\n    , claim_line_number\n    , person_id\n    , member_id\n    , payer\n    , plan\n    , prescribing_provider_npi\n    , dispensing_provider_npi\n    , dispensing_date\n    , ndc_code\n    , quantity\n    , days_supply\n    , refills\n    , paid_date\n    , paid_amount\n    , allowed_amount\n    , charge_amount\n    , coinsurance_amount\n    , copayment_amount\n    , deductible_amount\n    , in_network_flag\n    , data_source\n    , file_name\n    , file_date\n    , ingest_datetime\nfrom tuva.input_layer.pharmacy_claim\n) select\n      cast(claim_id as TEXT ) as claim_id\n    , cast(claim_line_number as int ) as claim_line_number\n    , cast(person_id as TEXT ) as person_id\n    , cast(member_id as TEXT ) as member_id\n    , cast(payer as TEXT ) as payer\n    , cast(plan as TEXT ) as plan\n    , cast(prescribing_provider_npi as TEXT ) as prescribing_provider_id\n    , cast(coalesce(pres.provider_last_name || ', ' || pres.provider_first_name, pres.provider_organization_name) as TEXT ) as prescribing_provider_name\n    , cast(dispensing_provider_npi as TEXT ) as dispensing_provider_id\n    , cast(coalesce(disp.provider_last_name || ', ' || disp.provider_first_name, disp.provider_organization_name) as TEXT ) as dispensing_provider_name    , cast(dispensing_date as date ) as dispensing_date\n    , cast(ndc_code as TEXT ) as ndc_code\n    , cast(ndc.fda_description as TEXT ) as ndc_description\n    , cast(quantity as int ) as quantity\n    , cast(days_supply as int ) as days_supply\n    , cast(refills as int ) as refills\n    , cast(paid_date as date ) as paid_date\n    , cast(paid_amount as numeric(28,6) ) as paid_amount\n    , cast(allowed_amount as numeric(28,6) ) as allowed_amount\n    , cast(charge_amount as numeric(28,6) ) as charge_amount\n    , cast(coinsurance_amount as numeric(28,6) ) as coinsurance_amount\n    , cast(copayment_amount as numeric(28,6) ) as copayment_amount\n    , cast(deductible_amount as numeric(28,6) ) as deductible_amount\n    , cast(in_network_flag as int ) as in_network_flag\n    , cast(data_source as TEXT ) as data_source\n    , cast('2025-02-25 21:25:59.177756+00:00' as TEXT ) as tuva_last_run\nfrom __dbt__cte__normalized_input__stg_pharmacy_claim pharm\nleft join tuva.terminology.provider pres\n      on pharm.prescribing_provider_npi = pres.npi\nleft join tuva.terminology.provider disp\n      on pharm.dispensing_provider_npi = disp.npi\nleft join tuva.terminology.ndc ndc\n      on pharm.ndc_code = ndc.ndc", "relation_name": "tuva.claims_preprocessing.normalized_input_pharmacy_claim"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.236401Z", "completed_at": "2025-02-25T21:26:18.252509Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.274264Z", "completed_at": "2025-02-25T21:26:18.274269Z"}], "thread_id": "Thread-1", "execution_time": 0.06218123435974121, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__data_quality_clinical_for_pbi", "compiled": true, "compiled_code": "\n\nWITH Ranked_Examples as (\n       SELECT\n              summary_sk,\n              data_source,\n              table_name,\n              field_name,\n              bucket_name,\n              invalid_reason,\n              drill_down_key,\n              drill_down_value as drill_down_value,\n              field_value as field_value,\n              count(drill_down_value) as frequency,\n              row_number() over (partition by summary_sk, bucket_name, field_value order by field_value) as rn\n              , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\n       FROM tuva.data_quality.data_quality_clinical_detail\n       where bucket_name not in ('valid', 'null')\n       group by\n              data_source,\n              field_name,\n              table_name,\n              bucket_name,\n              field_value,\n              drill_down_key,\n              drill_down_value,\n              invalid_reason,\n              summary_sk\n\n),\n\npk_examples as (\n       SELECT\n              detail.summary_sk,\n              detail.data_source,\n              detail.table_name,\n              detail.field_name,\n              detail.bucket_name,\n              detail.invalid_reason,\n              detail.drill_down_key,\n              detail.drill_down_value as drill_down_value,\n              detail.field_value as field_value,\n              count(detail.drill_down_value) as frequency,\n              row_number() over (partition by detail.summary_sk order by detail.summary_sk) as rn\n              , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\n       from tuva.data_quality.data_quality_clinical_detail as detail\n              left join tuva.data_quality._value_set_crosswalk_field_info as field_info on detail.table_name = field_info.input_layer_table_name\n                     and detail.field_name = field_info.field_name\n       where detail.bucket_name = 'valid'\n              and field_info.unique_values_expected_flag = 1\n       GROUP BY\n              detail.data_source,\n              detail.field_name,\n              detail.table_name,\n              detail.bucket_name,\n              detail.field_value,\n              detail.drill_down_key,\n              detail.drill_down_value,\n              detail.invalid_reason,\n              detail.summary_sk\n\n)\n--- Null Values\n\nSELECT\n       summary_sk,\n       data_source,\n       table_name,\n       field_name,\n       bucket_name,\n       invalid_reason,\n       drill_down_key,\n       max(drill_down_value) as drill_down_value,\n       null as field_value,\n       count(drill_down_value) as frequency\n       , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.data_quality.data_quality_clinical_detail\nwhere bucket_name = 'null'\ngroup by\n       data_source,\n       field_name,\n       table_name,\n       bucket_name,\n       invalid_reason,\n       drill_down_key,\n       summary_sk\n\nunion all\n\n--- Valid Values except PKs\n\nSELECT\n       detail.summary_sk,\n       detail.data_source,\n       detail.table_name,\n       detail.field_name,\n       detail.bucket_name,\n       detail.invalid_reason,\n       detail.drill_down_key,\n       max(detail.drill_down_value) as drill_down_value,\n       detail.field_value as field_value,\n       count(detail.drill_down_value) as frequency\n       , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.data_quality.data_quality_clinical_detail as detail\nleft join tuva.data_quality._value_set_crosswalk_field_info as field_info on detail.table_name = field_info.input_layer_table_name\n       and detail.field_name = field_info.field_name\nWHERE\n       detail.bucket_name = 'valid'\n       and field_info.unique_values_expected_flag = 0 --- need to handle pks differently since every value is supposed to be unique\ngroup by\n       detail.data_source,\n       detail.field_name,\n       detail.table_name,\n       detail.bucket_name,\n       detail.field_value,\n       detail.invalid_reason,\n       detail.drill_down_key,\n       detail.summary_sk\n\nunion all\n\n-- 5 Examples of each invalid example\n\nSELECT\n       summary_sk,\n       data_source,\n       table_name,\n       field_name,\n       bucket_name,\n       invalid_reason,\n       drill_down_key,\n       drill_down_value as drill_down_value,\n       field_value as field_value,\n       frequency\n       , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nFROM Ranked_Examples\nWHERE rn <= 5\n\nunion all\n\n--- Aggregating all other invalid examples into single row\n\nSELECT\n       summary_sk,\n       data_source,\n       table_name,\n       field_name,\n       bucket_name,\n       invalid_reason,\n       drill_down_key,\n       'all others' as drill_down_value,\n       field_value as field_value,\n       sum(frequency) as frequency\n       , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nFROM Ranked_Examples\nWHERE rn > 5 --- Aggregating all other rows\nGROUP BY\n    summary_sk,\n    data_source,\n    table_name,\n    field_name,\n    bucket_name,\n    invalid_reason,\n    drill_down_key,\n    field_value\n\nunion all\n\n--- 5 Examples of valid primary key values\n\nSELECT\n       summary_sk,\n       data_source,\n       table_name,\n       field_name,\n       bucket_name,\n       invalid_reason,\n       drill_down_key,\n       drill_down_value as drill_down_value,\n       field_value as field_value,\n       frequency\n       , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nFROM pk_examples\nWHERE rn <= 5\n\nunion all\n\n--- Aggegating all other valid primary key value examples\n\nSELECT\n       summary_sk,\n       data_source,\n       table_name,\n       field_name,\n       bucket_name,\n       invalid_reason,\n       drill_down_key,\n       'All Others' as drill_down_value,\n       'All Others' as field_value,\n       sum(frequency) as frequency\n       , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nFROM pk_examples\nWHERE rn > 5 --- Aggregating all other rows\nGROUP BY\n    summary_sk,\n    data_source,\n    table_name,\n    field_name,\n    bucket_name,\n    invalid_reason,\n    drill_down_key,\n    field_value", "relation_name": "tuva.data_quality.data_quality_clinical_for_pbi"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.247042Z", "completed_at": "2025-02-25T21:26:18.276253Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.276962Z", "completed_at": "2025-02-25T21:26:18.276967Z"}], "thread_id": "Thread-3", "execution_time": 0.030692100524902344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.hcc_suspecting__int_prep_egfr_labs", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte___stg_lab_result as (\n\n\nselect\n      lab_result_id\n    , person_id\n    , lower(coalesce(normalized_code_type,source_code_type)) as code_type\n    , coalesce(normalized_code,source_code) as code\n    , status\n    , result\n    , result_date\n    , data_source\nfrom tuva.core.lab_result\n\n\n), lab_result as (\n\n    select\n          person_id\n        , data_source\n        , code_type\n        , code\n        , status\n        , result\n        , result_date\n    from __dbt__cte___stg_lab_result\n\n)\n\n, seed_egfr_codes as (\n\n    select\n          concept_name\n        , code\n        , code_system\n    from tuva.hcc_suspecting._value_set_clinical_concepts\n    where lower(concept_name) = 'estimated glomerular filtration rate'\n\n)\n\n, egfr_labs as (\n\n    select distinct\n          lab_result.person_id\n        , lab_result.data_source\n        , lab_result.code_type\n        , lab_result.code\n        , lab_result.result_date\n        , lab_result.result\n    from lab_result\n        inner join seed_egfr_codes\n        on lab_result.code = seed_egfr_codes.code\n        and lab_result.code_type = seed_egfr_codes.code_system\n    where lab_result.result is not null\n    and lower(lab_result.status) not in ('cancelled', 'entered-in-error')\n\n)\n\n, numeric_egfr_labs as (\n\n    select\n          person_id\n        , data_source\n        , code_type\n        , code\n        , result_date\n        , cast(result as numeric(28,6)) as result\n    from egfr_labs\n   \n        where regexp_like(result, '^[+-]?([0-9]*[.])?[0-9]+$')\n    \n\n)\n\n, clean_non_numeric_egfr_labs as (\n\n    select\n          person_id\n        , data_source\n        , code_type\n        , code\n        , result_date\n        , result\n        , cast(case\n            when lower(result) like '%unsatisfactory specimen%' then null\n            when result like '%>%' then null\n            when result like '%<%' then null\n            when result like '%@%' then trim(replace(result,'@',''))\n            when result like '%mL/min/1.73m2%' then trim(replace(result,'mL/min/1.73m2',''))\n            else null\n          end as numeric(28,6)) as clean_result\n    from egfr_labs\n    \n        where regexp_like(result, '^[+-]?([0-9]*[.])?[0-9]+$') = False\n    \n\n)\n\n, unioned_labs as (\n\n    select\n          person_id\n        , data_source\n        , code_type\n        , code\n        , result_date\n        , result\n    from numeric_egfr_labs\n\n    union all\n\n    select\n          person_id\n        , data_source\n        , code_type\n        , code\n        , result_date\n        , clean_result as result\n    from clean_non_numeric_egfr_labs\n    where clean_result is not null\n\n)\n\n, add_data_types as (\n\n    select\n          cast(person_id as TEXT) as person_id\n        , cast(data_source as TEXT) as data_source\n        , cast(code_type as TEXT) as code_type\n        , cast(code as TEXT) as code\n        , cast(result_date as date) as result_date\n        , cast(result as numeric(28,6)) as result\n    from unioned_labs\n\n)\n\nselect\n      person_id\n    , data_source\n    , code_type\n    , code\n    , result_date\n    , result\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.hcc_suspecting._int_prep_egfr_labs"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.281287Z", "completed_at": "2025-02-25T21:26:18.308427Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.308694Z", "completed_at": "2025-02-25T21:26:18.308702Z"}], "thread_id": "Thread-1", "execution_time": 0.03282499313354492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.not_null_quality_measures__stg_core__observation_person_id.96069e762b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nwith __dbt__cte___stg_observation as (\n\n\nselect\n      person_id\n    , encounter_id\n    , observation_date\n    , result\n    , source_code_type\n    , source_code\n    , normalized_code_type\n    , normalized_code\n    , normalized_description\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.observation\n\n\n) select person_id\nfrom __dbt__cte___stg_observation\nwhere person_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.277360Z", "completed_at": "2025-02-25T21:26:18.309199Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.309807Z", "completed_at": "2025-02-25T21:26:18.309812Z"}], "thread_id": "Thread-2", "execution_time": 0.03429698944091797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.not_null_quality_measures__stg_core__medication_person_id.c251b1b4af", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nwith __dbt__cte___stg_medication as (\n\n\nselect\n      person_id\n    , encounter_id\n    , prescribing_date  \n    , dispensing_date\n    , source_code_type\n    , source_code\n    , ndc_code\n    , rxnorm_code\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.medication\n\n\n) select person_id\nfrom __dbt__cte___stg_medication\nwhere person_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.286022Z", "completed_at": "2025-02-25T21:26:18.310491Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.311161Z", "completed_at": "2025-02-25T21:26:18.311164Z"}], "thread_id": "Thread-3", "execution_time": 0.025723695755004883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.normalized_input__eligibility", "compiled": true, "compiled_code": "\n\n\nwith __dbt__cte__normalized_input__stg_eligibility as (\n\n\n\nselect\n      person_id\n    , person_id || coalesce(data_source,'') || coalesce(payer,'') || coalesce(plan,'') || coalesce(cast(enrollment_start_date as TEXT),'') || coalesce(cast(enrollment_end_date as TEXT),'') as person_id_key\n    , member_id\n    , subscriber_id\n    , gender\n    , race\n    , birth_date\n    , death_date\n    , death_flag\n    , enrollment_start_date\n    , enrollment_end_date\n    , payer\n    , payer_type\n    , plan\n    , subscriber_relation\n    , original_reason_entitlement_code\n    , dual_status_code\n    , medicare_status_code\n    , group_id\n    , group_name\n    , first_name\n    , last_name\n    , social_security_number\n    , address\n    , city\n    , state\n    , zip_code\n    , phone\n    , data_source\n    , file_name\n    , file_date\n    , ingest_datetime\nfrom tuva.input_layer.eligibility\n) select\n    cast(elig.person_id as TEXT ) as person_id\n    , cast(elig.member_id as TEXT ) as member_id\n    , cast(elig.subscriber_id as TEXT ) as subscriber_id\n    , cast(elig.gender as TEXT ) as gender\n    , cast(elig.race as TEXT ) as race\n    , cast(date_norm.normalized_birth_date as date ) as birth_date\n    , cast(date_norm.normalized_death_date as date ) as death_date\n    , cast(elig.death_flag as int ) as death_flag\n    , cast(date_norm.normalized_enrollment_start_date as date ) as enrollment_start_date\n    , cast(date_norm.normalized_enrollment_end_date as date ) as enrollment_end_date\n    , cast(elig.payer as TEXT ) as payer\n    , cast(elig.payer_type as TEXT ) as payer_type\n    , cast(elig.plan as TEXT ) as plan\n    , cast(elig.original_reason_entitlement_code as TEXT ) as original_reason_entitlement_code\n    , cast(elig.dual_status_code as TEXT ) as dual_status_code\n    , cast(elig.medicare_status_code as TEXT ) as medicare_status_code\n    , cast(elig.group_id as TEXT ) as group_id\n    , cast(elig.group_name as TEXT ) as group_name\n    , cast(elig.first_name as TEXT ) as first_name\n    , cast(elig.last_name as TEXT ) as last_name\n    , cast(elig.social_security_number as TEXT ) as social_security_number\n    , cast(elig.subscriber_relation as TEXT ) as subscriber_relation\n    , cast(elig.address as TEXT ) as address\n    , cast(elig.city as TEXT ) as city\n    , cast(elig.state as TEXT ) as state\n    , cast(elig.zip_code as TEXT ) as zip_code\n    , cast(elig.phone as TEXT ) as phone\n    , cast(elig.data_source as TEXT ) as data_source\n    , cast('2025-02-25 21:25:59.177756+00:00'  as TEXT ) as tuva_last_run\nfrom __dbt__cte__normalized_input__stg_eligibility elig\nleft join tuva.claims_preprocessing._int_normalized_input_eligibility_dates_normalize date_norm\n    on elig.person_id_key = date_norm.person_id_key", "relation_name": "tuva.claims_preprocessing.normalized_input_eligibility"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.388359Z", "completed_at": "2025-02-25T21:26:18.456087Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.456549Z", "completed_at": "2025-02-25T21:26:18.456557Z"}], "thread_id": "Thread-3", "execution_time": 0.1378459930419922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.normalized_input__int_admit_source_final", "compiled": true, "compiled_code": "\n\n\nselect\n    claim_id\n    , data_source\n    , column_name\n    , normalized_code\n    , normalized_description\n    , occurrence_count\n    , next_occurrence_count\n    , occurrence_row_count\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing._int_normalized_input_admit_source_voting\nwhere (occurrence_row_count = 1\n        and occurrence_count > next_occurrence_count)", "relation_name": "tuva.claims_preprocessing._int_normalized_input_admit_source_final"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.457628Z", "completed_at": "2025-02-25T21:26:18.495674Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.501600Z", "completed_at": "2025-02-25T21:26:18.501608Z"}], "thread_id": "Thread-3", "execution_time": 0.044473886489868164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.normalized_input__int_admit_type_final", "compiled": true, "compiled_code": "\n\n\nselect\n    claim_id\n    , data_source\n    , column_name\n    , normalized_code\n    , normalized_description\n    , occurrence_count\n    , next_occurrence_count\n    , occurrence_row_count\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing._int_normalized_input_admit_type_normalize_voting\nwhere (occurrence_row_count = 1\n        and occurrence_count > next_occurrence_count)", "relation_name": "tuva.claims_preprocessing._int_normalized_input_admit_type_final"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.319043Z", "completed_at": "2025-02-25T21:26:18.510305Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.510550Z", "completed_at": "2025-02-25T21:26:18.510555Z"}], "thread_id": "Thread-2", "execution_time": 0.19910502433776855, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__data_quality_claims_detail", "compiled": true, "compiled_code": "\n\nWITH unioned_data as (\nSELECT\n    cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.claim_allowed_amount\n\nunion all\n\nSELECT\n    cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.claim_charge_amount\n\nunion all\n\nSELECT\n    cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.claim_claim_id\n\nunion all\n\nSELECT\n    cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.claim_claim_line_end_date\n\nunion all\n\nSELECT\n    cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.claim_claim_line_number\n\nunion all\n\nSELECT\n    cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.claim_claim_line_start_date\n\nunion all\n\nSELECT\n    cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.claim_claim_type\n\nunion all\n\nSELECT\n    cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.claim_coninsurance_amount\n\nunion all\n\nSELECT\n    cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.claim_copayment_amount\n\nunion all\n\nSELECT\n    cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.claim_data_source\n\nunion all\n\nSELECT\n    cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.claim_deductible_amount\n\nunion all\n\nSELECT\n    cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.claim_diagnosis_code_type\n\nunion all\n\nSELECT\n    cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.claim_hcpcs_code\n\nunion all\n\nSELECT\n    cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.claim_member_id\n\nunion all\n\nSELECT\n    cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.claim_paid_amount\n\nunion all\n\nSELECT\n    cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.claim_paid_date\n\nunion all\n\nSELECT\n    cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.claim_person_id\n\nunion all\n\nSELECT\n    cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.claim_payer\n\nunion all\n\nSELECT\n    cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.claim_plan\n\nunion all\n\nSELECT\n    cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.claim_total_cost_amount\n\nunion all\n\nSELECT\n    cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.eligibility_address\n\nunion all\n\nSELECT\n    cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.eligibility_birth_date\n\nunion all\n\nSELECT\n    cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.eligibility_city\n\nunion all\n\nSELECT\n    cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.eligibility_data_source\n\nunion all\n\nSELECT\n    cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.eligibility_death_date\n\nunion all\n\nSELECT\n    cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.eligibility_death_flag\n\nunion all\n\nSELECT\n    cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.eligibility_dual_status_code\n\nunion all\n\nSELECT\n    cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.eligibility_end_date\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.eligibility_first_name\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.eligibility_gender\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.eligibility_last_name\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.eligibility_medicare_status_code\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.eligibility_member_id\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.eligibility_original_reason_entitlement_code\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.eligibility_person_id\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.eligibility_payer_type\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.eligibility_payer\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.eligibility_phone\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.eligibility_plan\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.eligibility_race\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.eligibility_start_date\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.eligibility_state\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.eligibility_zip_code\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.institutional_drg_code\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.institutional_admission_date\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.institutional_admit_source_code\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.institutional_admit_type_code\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.institutional_bill_type_code\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.institutional_billing_npi\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.institutional_claim_end_date\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.institutional_claim_start_date\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.institutional_diagnosis_code_1\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.institutional_diagnosis_code_2\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.institutional_diagnosis_code_3\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.institutional_discharge_date\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.institutional_discharge_disposition_code\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.institutional_facility_npi\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.institutional_present_on_admission_1\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.institutional_present_on_admission_2\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.institutional_present_on_admission_3\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.institutional_procedure_code_1\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.institutional_procedure_code_2\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.institutional_procedure_code_3\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.institutional_procedure_date_1\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.institutional_procedure_date_2\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.institutional_procedure_date_3\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.institutional_rendering_npi\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.institutional_revenue_center_code\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.institutional_service_unit_quantity\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.pharmacy_allowed_amount\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.pharmacy_claim_id\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.pharmacy_claim_line_number\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.pharmacy_coinsurance_amount\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.pharmacy_copayment_amount\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.pharmacy_data_source\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.pharmacy_days_supply\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.pharmacy_deductible_amount\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.pharmacy_dispensing_date\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.pharmacy_dispensing_provider_npi\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.pharmacy_member_id\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.pharmacy_ndc_code\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.pharmacy_paid_amount\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.pharmacy_paid_date\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.pharmacy_person_id\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.pharmacy_payer\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.pharmacy_plan\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.pharmacy_prescribing_provider_npi\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.pharmacy_quantity\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.pharmacy_refills\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.professional_billing_npi\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.professional_facility_npi\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.professional_place_of_service_code\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.professional_rendering_npi\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.professional_claim_end_date\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.professional_claim_start_date\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.professional_diagnosis_code_1\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.professional_diagnosis_code_2\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.data_quality.professional_diagnosis_code_3\n\nunion all\n\nSELECT     cast(data_source as TEXT) as data_source\n\t, cast(source_date as TEXT) as source_date\n\t, cast(table_name as TEXT) as table_name\n\t, cast(drill_down_key as TEXT) as drill_down_key\n\t, cast(drill_down_value as TEXT) as drill_down_value\n\t, cast(claim_type as TEXT) as claim_type\n\t, cast(field_name as TEXT) as field_name\n\t, cast(bucket_name as TEXT) as bucket_name\n\t, cast(invalid_reason as TEXT) as invalid_reason\n\t, cast(field_value as TEXT) as field_value\n\t, cast(tuva_last_run as TEXT) as tuva_last_run\n\tFROM tuva.dbt_sarah.data_quality__claim_drg_code_type\n\n)\n\n\nselect\n    cast(data_source as TEXT) as data_source\n  , cast(source_date as TEXT) as source_date\n  , cast(table_name as TEXT) as table_name\n  , cast(drill_down_key as TEXT) as drill_down_key\n  , cast(drill_down_value as TEXT) as drill_down_value\n  , cast(claim_type as TEXT) as claim_type\n  , cast(field_name as TEXT) as field_name\n  , cast(bucket_name as TEXT) as bucket_name\n  , cast(invalid_reason as TEXT) as invalid_reason\n  , cast(field_value as TEXT) as field_value\n  , cast(tuva_last_run as TEXT) as tuva_last_run\n  , dense_rank() over (\n        order by data_source\n               , table_name\n               , claim_type\n               , field_name\n    ) as summary_sk\nfrom unioned_data", "relation_name": "tuva.data_quality.data_quality_claims_detail"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.506806Z", "completed_at": "2025-02-25T21:26:18.511209Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.511711Z", "completed_at": "2025-02-25T21:26:18.511714Z"}], "thread_id": "Thread-3", "execution_time": 0.005381107330322266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.normalized_input__int_bill_type_final", "compiled": true, "compiled_code": "\n\n\nselect\n    claim_id\n    , data_source\n    , column_name\n    , normalized_code\n    , normalized_description\n    , occurrence_count\n    , occurrence_row_count\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing._int_normalized_input_bill_type_voting\nwhere occurrence_row_count = 1", "relation_name": "tuva.claims_preprocessing._int_normalized_input_bill_type_final"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.512502Z", "completed_at": "2025-02-25T21:26:18.519957Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.520177Z", "completed_at": "2025-02-25T21:26:18.520181Z"}], "thread_id": "Thread-2", "execution_time": 0.00880289077758789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.normalized_input__int_discharge_disposition_final", "compiled": true, "compiled_code": "\n\n\nselect\n    claim_id\n    , data_source\n    , column_name\n    , normalized_code\n    , normalized_description\n    , occurrence_count\n    , next_occurrence_count\n    , occurrence_row_count\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing._int_normalized_input_discharge_disposition_voting\nwhere (occurrence_row_count = 1\n        and occurrence_count > next_occurrence_count)", "relation_name": "tuva.claims_preprocessing._int_normalized_input_discharge_disposition_final"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.516102Z", "completed_at": "2025-02-25T21:26:18.520747Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.521202Z", "completed_at": "2025-02-25T21:26:18.521205Z"}], "thread_id": "Thread-3", "execution_time": 0.005660295486450195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.normalized_input__int_diagnosis_code_voting", "compiled": true, "compiled_code": "\n\nwith distinct_count as(\n    select\n        claim_id\n        , data_source\n        , diagnosis_column\n        , count(*) as distinct_count\n        , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\n    from tuva.claims_preprocessing._int_normalized_input_diagnosis_code_normalize\n    group by\n        claim_id\n        , data_source\n        , diagnosis_column\n)\n\nselect \n    norm.claim_id\n    , norm.data_source\n    , norm.diagnosis_column as column_name\n    , norm.normalized_diagnosis_code as normalized_code\n    , norm.diagnosis_code_occurrence_count as occurrence_count\n    , coalesce(lead(diagnosis_code_occurrence_count) \n        over (partition by norm.claim_id, norm.data_source, norm.diagnosis_column order by diagnosis_code_occurrence_count desc),0) as next_occurrence_count\n    , row_number() over (partition by norm.claim_id, norm.data_source, norm.diagnosis_column order by diagnosis_code_occurrence_count desc) as occurrence_row_count\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing._int_normalized_input_diagnosis_code_normalize norm\ninner join distinct_count dist\n    on norm.claim_id = dist.claim_id\n    and norm.data_source = dist.data_source\n    and norm.diagnosis_column = dist.diagnosis_column", "relation_name": "tuva.claims_preprocessing._int_normalized_input_diagnosis_code_voting"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.521997Z", "completed_at": "2025-02-25T21:26:18.530054Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.530280Z", "completed_at": "2025-02-25T21:26:18.530285Z"}], "thread_id": "Thread-2", "execution_time": 0.009373188018798828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.normalized_input__int_drg_final", "compiled": true, "compiled_code": "\n\n\nselect\n    claim_id\n    , data_source\n    , column_name\n    , normalized_code\n    , normalized_description\n    , occurrence_count\n    , next_occurrence_count\n    , occurrence_row_count\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing._int_normalized_input_drg_voting\nwhere (occurrence_row_count = 1\n        and occurrence_count > next_occurrence_count)", "relation_name": "tuva.claims_preprocessing._int_normalized_input_drg_final"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.525556Z", "completed_at": "2025-02-25T21:26:18.530923Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.531387Z", "completed_at": "2025-02-25T21:26:18.531390Z"}], "thread_id": "Thread-3", "execution_time": 0.006361246109008789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.normalized_input__int_medical_date_aggregation", "compiled": true, "compiled_code": "\n\n\nselect\n    claim_id\n    , data_source\n    , min(normalized_claim_start_date) as minimum_claim_start_date\n    , max(normalized_claim_end_date) as maximum_claim_end_date\n    , min(normalized_admission_date) as minimum_admission_date\n    , max(normalized_discharge_date) as maximum_discharge_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing._int_normalized_input_medical_claim_date_normalize\nwhere claim_type = 'institutional'\ngroup by\n    claim_id\n    , data_source\n\nunion all\n\nselect\n    claim_id\n    , data_source\n    , min(normalized_claim_start_date) as minimum_claim_start_date\n    , max(normalized_claim_end_date) as maximum_claim_end_date\n    , null as minimum_admission_date\n    , null as maximum_discharge_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing._int_normalized_input_medical_claim_date_normalize\nwhere claim_type = 'professional'\ngroup by\n    claim_id\n    , data_source", "relation_name": "tuva.claims_preprocessing._int_normalized_input_medical_date_aggregation"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.532468Z", "completed_at": "2025-02-25T21:26:18.540849Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.541085Z", "completed_at": "2025-02-25T21:26:18.541090Z"}], "thread_id": "Thread-2", "execution_time": 0.01001882553100586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.normalized_input__int_present_on_admit_voting", "compiled": true, "compiled_code": "\n\nwith distinct_count as(\n    select\n        claim_id\n        , data_source\n        , diagnosis_column\n        , count(*) as distinct_count\n        , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\n    from tuva.claims_preprocessing._int_normalized_input_present_on_admit_normalize\n    group by\n        claim_id\n        , data_source\n        , diagnosis_column\n)\n\nselect \n    norm.claim_id\n    , norm.data_source\n    , norm.diagnosis_column as column_name\n    , norm.normalized_present_on_admit_code as normalized_code\n    , norm.present_on_admit_occurrence_count as occurrence_count\n    , coalesce(lead(present_on_admit_occurrence_count) \n        over (partition by norm.claim_id, norm.data_source, norm.diagnosis_column order by present_on_admit_occurrence_count desc),0) as next_occurrence_count\n    , row_number() over (partition by norm.claim_id, norm.data_source, norm.diagnosis_column order by present_on_admit_occurrence_count desc) as occurrence_row_count\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing._int_normalized_input_present_on_admit_normalize norm\ninner join distinct_count dist\n    on norm.claim_id = dist.claim_id\n    and norm.data_source = dist.data_source\n    and norm.diagnosis_column = dist.diagnosis_column", "relation_name": "tuva.claims_preprocessing._int_normalized_input_present_on_admit_voting"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.536945Z", "completed_at": "2025-02-25T21:26:18.541462Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.541948Z", "completed_at": "2025-02-25T21:26:18.541952Z"}], "thread_id": "Thread-3", "execution_time": 0.005579710006713867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.normalized_input__int_procedure_code_voting", "compiled": true, "compiled_code": "\n\nwith distinct_count as(\n    select\n        claim_id\n        , data_source\n        , procedure_column\n        , count(*) as distinct_count\n        , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\n    from tuva.claims_preprocessing._int_normalized_input_procedure_code_normalize\n    group by\n        claim_id\n        , data_source\n        , procedure_column\n)\n\nselect \n    norm.claim_id\n    , norm.data_source\n    , norm.procedure_column as column_name\n    , norm.normalized_procedure_code as normalized_code\n    , norm.procedure_code_occurrence_count as occurrence_count\n    , coalesce(lead(procedure_code_occurrence_count) \n        over (partition by norm.claim_id, norm.data_source, norm.procedure_column order by procedure_code_occurrence_count desc),0) as next_occurrence_count\n    , row_number() over (partition by norm.claim_id, norm.data_source, norm.procedure_column order by procedure_code_occurrence_count desc) as occurrence_row_count\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing._int_normalized_input_procedure_code_normalize norm\ninner join distinct_count dist\n    on norm.claim_id = dist.claim_id\n    and norm.data_source = dist.data_source\n    and norm.procedure_column = dist.procedure_column", "relation_name": "tuva.claims_preprocessing._int_normalized_input_procedure_code_voting"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.543380Z", "completed_at": "2025-02-25T21:26:18.555422Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.555705Z", "completed_at": "2025-02-25T21:26:18.555710Z"}], "thread_id": "Thread-2", "execution_time": 0.013382911682128906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.normalized_input__int_procedure_date_voting", "compiled": true, "compiled_code": "\n\nwith distinct_count as(\n    select\n        claim_id\n        , data_source\n        , procedure_column\n        , count(*) as distinct_count\n        , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\n    from tuva.claims_preprocessing._int_normalized_input_procedure_date_normalize\n    group by\n        claim_id\n        , data_source\n        , procedure_column\n)\n\nselect \n    norm.claim_id\n    , norm.data_source\n    , norm.procedure_column as column_name\n    , norm.procedure_date as normalized_code\n    , norm.procedure_date_occurrence_count as occurrence_count\n    , coalesce(lead(procedure_date_occurrence_count) \n        over (partition by norm.claim_id, norm.data_source, norm.procedure_column order by procedure_date_occurrence_count desc),0) as next_occurrence_count\n    , row_number() over (partition by norm.claim_id, norm.data_source, norm.procedure_column order by procedure_date_occurrence_count desc) as occurrence_row_count\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing._int_normalized_input_procedure_date_normalize norm\ninner join distinct_count dist\n    on norm.claim_id = dist.claim_id\n    and norm.data_source = dist.data_source\n    and norm.procedure_column = dist.procedure_column", "relation_name": "tuva.claims_preprocessing._int_normalized_input_procedure_date_voting"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.547544Z", "completed_at": "2025-02-25T21:26:18.556607Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.557031Z", "completed_at": "2025-02-25T21:26:18.557034Z"}], "thread_id": "Thread-3", "execution_time": 0.013931989669799805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.core__person_id_crosswalk", "compiled": true, "compiled_code": "\n\nselect distinct\n      cast(person_id as TEXT) as person_id\n    , cast(null as TEXT) as patient_id\n    , cast(member_id as TEXT) as member_id\n    , cast(payer as TEXT) as payer\n    , cast(plan as TEXT) as plan\n    , cast(data_source as TEXT) as data_source\nfrom tuva.claims_preprocessing.normalized_input_eligibility\nunion all\nselect distinct\n      cast(person_id as TEXT) as person_id\n    , cast(patient_id as TEXT) as patient_id\n    , cast(null as TEXT) as member_id\n    , cast(null as TEXT) as payer\n    , cast(null as TEXT) as plan\n    , cast(data_source as TEXT) as data_source\nfrom tuva.input_layer.patient\n\n", "relation_name": "tuva.core.person_id_crosswalk"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.557374Z", "completed_at": "2025-02-25T21:26:18.570833Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.574926Z", "completed_at": "2025-02-25T21:26:18.574933Z"}], "thread_id": "Thread-2", "execution_time": 0.018664836883544922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.core__stg_claims_eligibility", "compiled": true, "compiled_code": "\n\n-- *************************************************\n-- This dbt model creates the eligibility table in core.\n-- *************************************************\n\n\n\n\nselect\n       person_id || '-' || member_id || '-' || enrollment_start_date || '-' || enrollment_end_date || '-' || payer || '-' || plan || '-' || data_source as eligibility_id\n       , cast(person_id as TEXT ) as person_id\n       , cast(member_id as TEXT ) as member_id\n       , cast(subscriber_id as TEXT ) as subscriber_id\n       , cast(birth_date as date) as birth_date\n       , cast(death_date as date) as death_date\n       , cast(enrollment_start_date as date ) as enrollment_start_date\n       , cast(enrollment_end_date as date ) as enrollment_end_date\n       , cast(payer as TEXT ) as payer\n       , cast(payer_type as TEXT ) as payer_type\n       , plan\n       , cast(original_reason_entitlement_code as TEXT ) as original_reason_entitlement_code\n       , cast(dual_status_code as TEXT ) as dual_status_code\n       , cast(medicare_status_code as TEXT ) as medicare_status_code\n       , cast(subscriber_relation as TEXT ) as subscriber_relation\n        , cast(group_id as TEXT ) as group_id\n        , cast(group_name as TEXT ) as group_name\n       , cast(data_source as TEXT ) as data_source\n       , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.normalized_input_eligibility", "relation_name": "tuva.core._stg_claims_eligibility"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.564820Z", "completed_at": "2025-02-25T21:26:18.576266Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.582250Z", "completed_at": "2025-02-25T21:26:18.582258Z"}], "thread_id": "Thread-3", "execution_time": 0.01800990104675293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.core__stg_claims_patient", "compiled": true, "compiled_code": "\n\nwith patient_stage as(\n    select\n        person_id\n        ,first_name\n        ,last_name\n        ,gender\n        ,race\n        ,birth_date\n        ,death_date\n        ,death_flag\n        ,social_security_number\n        ,address\n        ,city\n        ,state\n        ,zip_code\n        ,phone\n        ,data_source\n        ,row_number() over (\n\t        partition by person_id\n\t        order by case when enrollment_end_date is null\n                then cast ('2050-01-01' as date)\n                else enrollment_end_date end DESC)\n            as row_sequence\n        , cast('2025-02-25 21:25:59.177756+00:00' as timestamp) as tuva_last_run_datetime\n        , cast(substring('2025-02-25 21:25:59.177756+00:00',1,10) as date) as tuva_last_run_date\n    from tuva.claims_preprocessing.normalized_input_eligibility\n)\n\nselect\n    cast(person_id as TEXT) as person_id\n    , cast(first_name as TEXT) as first_name\n    , cast(last_name as TEXT) as last_name\n    , cast(gender as TEXT) as sex\n    , cast(race as TEXT) as race\n    , cast(birth_date as date) as birth_date\n    , cast(death_date as date) as death_date\n    , cast(death_flag as int) as death_flag\n    , cast(social_security_number as TEXT) as social_security_number\n    , cast(address as TEXT) as address\n    , cast(city as TEXT) as city\n    , cast(state as TEXT) as state\n    , cast(zip_code as TEXT) as zip_code\n    , cast(null as TEXT) as county\n    , cast(null as float) as latitude \n    , cast(null as float) as longitude\n    , cast(phone as TEXT) as phone\n    , cast(data_source as TEXT) as data_source\n    , cast(floor(datediff(\n        hour,\n        birth_date,\n        tuva_last_run_date\n        ) / 8760.0) as integer ) as age\n    , cast(\n        CASE\n            WHEN cast(floor(datediff(\n        hour,\n        birth_date,\n        tuva_last_run_date\n        ) / 8760.0) as integer ) < 10 THEN '0-9'\n            WHEN cast(floor(datediff(\n        hour,\n        birth_date,\n        tuva_last_run_date\n        ) / 8760.0) as integer ) < 20 THEN '10-19'\n            WHEN cast(floor(datediff(\n        hour,\n        birth_date,\n        tuva_last_run_date\n        ) / 8760.0) as integer ) < 30 THEN '20-29'\n            WHEN cast(floor(datediff(\n        hour,\n        birth_date,\n        tuva_last_run_date\n        ) / 8760.0) as integer ) < 40 THEN '30-39'\n            WHEN cast(floor(datediff(\n        hour,\n        birth_date,\n        tuva_last_run_date\n        ) / 8760.0) as integer ) < 50 THEN '40-49'\n            WHEN cast(floor(datediff(\n        hour,\n        birth_date,\n        tuva_last_run_date\n        ) / 8760.0) as integer ) < 60 THEN '50-59'\n            WHEN cast(floor(datediff(\n        hour,\n        birth_date,\n        tuva_last_run_date\n        ) / 8760.0) as integer ) < 70 THEN '60-69'\n            WHEN cast(floor(datediff(\n        hour,\n        birth_date,\n        tuva_last_run_date\n        ) / 8760.0) as integer ) < 80 THEN '70-79'\n            WHEN cast(floor(datediff(\n        hour,\n        birth_date,\n        tuva_last_run_date\n        ) / 8760.0) as integer ) < 90 THEN '80-89'\n            ELSE '90+'\n        END as TEXT\n    ) AS age_group\n    , tuva_last_run_datetime as tuva_last_run\nfrom patient_stage\nwhere row_sequence = 1", "relation_name": "tuva.core._stg_claims_patient"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.576460Z", "completed_at": "2025-02-25T21:26:18.588819Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.589104Z", "completed_at": "2025-02-25T21:26:18.589110Z"}], "thread_id": "Thread-2", "execution_time": 0.013448953628540039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__data_quality_claims_for_pbi", "compiled": true, "compiled_code": "\n\nWITH ranked_examples as (\n       select\n       summary_sk,\n       data_source,\n       table_name,\n       claim_type,\n       field_name,\n       bucket_name,\n       invalid_reason,\n       drill_down_key,\n       drill_down_value as drill_down_value, --all claims\n       field_value as field_value,\n       count(drill_down_value) as frequency,\n       row_number() over (partition by summary_sk, bucket_name, field_value order by field_value) as rn\n       , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nFROM tuva.data_quality.data_quality_claims_detail\nWHERE bucket_name not in ('valid', 'null')\nGROUP BY\n       data_source,\n       field_name,\n       table_name,\n       claim_type,\n       bucket_name,\n       field_value,\n       drill_down_key,\n       drill_down_value,\n       invalid_reason,\n       summary_sk\n)\nSELECT\n       summary_sk,\n       data_source,\n       table_name,\n       claim_type,\n       field_name,\n       bucket_name,\n       invalid_reason,\n       drill_down_key,\n       max(drill_down_value) as drill_down_value, --1 sample claim\n       null as field_value,\n       count(drill_down_value) as frequency\n       , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nFROM tuva.data_quality.data_quality_claims_detail\nWHERE bucket_name = 'null'\nGROUP BY\n       data_source,\n       field_name,\n       table_name,\n       claim_type,\n       bucket_name,\n       invalid_reason,\n       drill_down_key,\n       summary_sk\n\nunion all\nSELECT\n       summary_sk,\n       data_source,\n       table_name,\n       claim_type,\n       field_name,\n       bucket_name,\n       invalid_reason,\n       drill_down_key,\n       max(drill_down_value) as drill_down_value, --1 sample claim\n       field_value as field_value,\n       count(drill_down_value) as frequency\n       , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nFROM tuva.data_quality.data_quality_claims_detail\nWHERE bucket_name = 'valid'\nGROUP BY\n       data_source,\n       field_name,\n       table_name,\n       claim_type,\n       bucket_name,\n       field_value,\n       invalid_reason,\n       drill_down_key,\n       summary_sk\n\nunion all\nSELECT\n       summary_sk,\n       data_source,\n       table_name,\n       claim_type,\n       field_name,\n       bucket_name,\n       invalid_reason,\n       drill_down_key,\n       drill_down_value as drill_down_value,\n       field_value as field_value,\n       frequency\n       , '2025-02-25 21:25:59.177756+00:00'\nFROM ranked_examples\nWHERE rn <= 5 -- 5 Example claims per unique SK / field value\nunion all\nSELECT\n       summary_sk,\n       data_source,\n       table_name,\n       claim_type,\n       field_name,\n       bucket_name,\n       invalid_reason,\n       drill_down_key,\n       'All Others' as drill_down_value,\n       field_value as field_value,\n       sum(frequency) as frequency\n       , '2025-02-25 21:25:59.177756+00:00'\nFROM ranked_examples\nWHERE rn > 5 -- Aggregating all other rows\nGROUP BY\n    summary_sk,\n    data_source,\n    table_name,\n    claim_type,\n    field_name,\n    bucket_name,\n    invalid_reason,\n    drill_down_key,\n    field_value", "relation_name": "tuva.data_quality.data_quality_claims_for_pbi"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.583519Z", "completed_at": "2025-02-25T21:26:18.589768Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.590294Z", "completed_at": "2025-02-25T21:26:18.590298Z"}], "thread_id": "Thread-3", "execution_time": 0.0073549747467041016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__data_quality_detail", "compiled": true, "compiled_code": "\n\nSELECT\n    data_source,\n\tsource_date,\n\ttable_name,\n\tdrill_down_key,\n\tdrill_down_value,\n\tclaim_type,\n\tfield_name,\n\tbucket_name,\n\tinvalid_reason,\n\tfield_value,\n\tsummary_sk,\n\t'2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nFROM tuva.data_quality.data_quality_claims_detail\n\nunion all\n\nSELECT\n    data_source,\n\tsource_date,\n\ttable_name,\n\tdrill_down_key,\n\tdrill_down_value,\n\t'CLINICAL' AS claim_type,\n\tfield_name,\n\tbucket_name,\n\tinvalid_reason,\n\tfield_value,\n\tsummary_sk,\n\t'2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nFROM tuva.data_quality.data_quality_clinical_detail\n\n", "relation_name": "tuva.data_quality.data_quality_detail"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.591140Z", "completed_at": "2025-02-25T21:26:18.600226Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.600486Z", "completed_at": "2025-02-25T21:26:18.600493Z"}], "thread_id": "Thread-2", "execution_time": 0.01056814193725586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.normalized_input__int_diagnosis_code_final", "compiled": true, "compiled_code": "\n\n\nselect\n    claim_id\n    , data_source\n    , max(case when lower(column_name) = 'diagnosis_code_1' then normalized_code else null end) as diagnosis_code_1\n    , max(case when lower(column_name) = 'diagnosis_code_2' then normalized_code else null end) as diagnosis_code_2\n    , max(case when lower(column_name) = 'diagnosis_code_3' then normalized_code else null end) as diagnosis_code_3\n    , max(case when lower(column_name) = 'diagnosis_code_4' then normalized_code else null end) as diagnosis_code_4\n    , max(case when lower(column_name) = 'diagnosis_code_5' then normalized_code else null end) as diagnosis_code_5\n    , max(case when lower(column_name) = 'diagnosis_code_6' then normalized_code else null end) as diagnosis_code_6\n    , max(case when lower(column_name) = 'diagnosis_code_7' then normalized_code else null end) as diagnosis_code_7\n    , max(case when lower(column_name) = 'diagnosis_code_8' then normalized_code else null end) as diagnosis_code_8\n    , max(case when lower(column_name) = 'diagnosis_code_9' then normalized_code else null end) as diagnosis_code_9\n    , max(case when lower(column_name) = 'diagnosis_code_10' then normalized_code else null end) as diagnosis_code_10\n    , max(case when lower(column_name) = 'diagnosis_code_11' then normalized_code else null end) as diagnosis_code_11\n    , max(case when lower(column_name) = 'diagnosis_code_12' then normalized_code else null end) as diagnosis_code_12\n    , max(case when lower(column_name) = 'diagnosis_code_13' then normalized_code else null end) as diagnosis_code_13\n    , max(case when lower(column_name) = 'diagnosis_code_14' then normalized_code else null end) as diagnosis_code_14\n    , max(case when lower(column_name) = 'diagnosis_code_15' then normalized_code else null end) as diagnosis_code_15\n    , max(case when lower(column_name) = 'diagnosis_code_16' then normalized_code else null end) as diagnosis_code_16\n    , max(case when lower(column_name) = 'diagnosis_code_17' then normalized_code else null end) as diagnosis_code_17\n    , max(case when lower(column_name) = 'diagnosis_code_18' then normalized_code else null end) as diagnosis_code_18\n    , max(case when lower(column_name) = 'diagnosis_code_19' then normalized_code else null end) as diagnosis_code_19\n    , max(case when lower(column_name) = 'diagnosis_code_20' then normalized_code else null end) as diagnosis_code_20\n    , max(case when lower(column_name) = 'diagnosis_code_21' then normalized_code else null end) as diagnosis_code_21\n    , max(case when lower(column_name) = 'diagnosis_code_22' then normalized_code else null end) as diagnosis_code_22\n    , max(case when lower(column_name) = 'diagnosis_code_23' then normalized_code else null end) as diagnosis_code_23\n    , max(case when lower(column_name) = 'diagnosis_code_24' then normalized_code else null end) as diagnosis_code_24\n    , max(case when lower(column_name) = 'diagnosis_code_25' then normalized_code else null end) as diagnosis_code_25\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing._int_normalized_input_diagnosis_code_voting\nwhere (occurrence_row_count = 1\n        and occurrence_count > next_occurrence_count)\ngroup by\n    claim_id\n    , data_source", "relation_name": "tuva.claims_preprocessing._int_normalized_input_diagnosis_code_final"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.596253Z", "completed_at": "2025-02-25T21:26:18.601541Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.601989Z", "completed_at": "2025-02-25T21:26:18.601993Z"}], "thread_id": "Thread-3", "execution_time": 0.006357908248901367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.normalized_input__int_present_on_admit_final", "compiled": true, "compiled_code": "\n\nselect\n    claim_id\n    , data_source\n    , max(case when column_name = 'DIAGNOSIS_POA_1' then normalized_code else null end) as diagnosis_poa_1\n    , max(case when column_name = 'DIAGNOSIS_POA_2' then normalized_code else null end) as diagnosis_poa_2\n    , max(case when column_name = 'DIAGNOSIS_POA_3' then normalized_code else null end) as diagnosis_poa_3\n    , max(case when column_name = 'DIAGNOSIS_POA_4' then normalized_code else null end) as diagnosis_poa_4\n    , max(case when column_name = 'DIAGNOSIS_POA_5' then normalized_code else null end) as diagnosis_poa_5\n    , max(case when column_name = 'DIAGNOSIS_POA_6' then normalized_code else null end) as diagnosis_poa_6\n    , max(case when column_name = 'DIAGNOSIS_POA_7' then normalized_code else null end) as diagnosis_poa_7\n    , max(case when column_name = 'DIAGNOSIS_POA_8' then normalized_code else null end) as diagnosis_poa_8\n    , max(case when column_name = 'DIAGNOSIS_POA_9' then normalized_code else null end) as diagnosis_poa_9\n    , max(case when column_name = 'DIAGNOSIS_POA_10' then normalized_code else null end) as diagnosis_poa_10\n    , max(case when column_name = 'DIAGNOSIS_POA_11' then normalized_code else null end) as diagnosis_poa_11\n    , max(case when column_name = 'DIAGNOSIS_POA_12' then normalized_code else null end) as diagnosis_poa_12\n    , max(case when column_name = 'DIAGNOSIS_POA_13' then normalized_code else null end) as diagnosis_poa_13\n    , max(case when column_name = 'DIAGNOSIS_POA_14' then normalized_code else null end) as diagnosis_poa_14\n    , max(case when column_name = 'DIAGNOSIS_POA_15' then normalized_code else null end) as diagnosis_poa_15\n    , max(case when column_name = 'DIAGNOSIS_POA_16' then normalized_code else null end) as diagnosis_poa_16\n    , max(case when column_name = 'DIAGNOSIS_POA_17' then normalized_code else null end) as diagnosis_poa_17\n    , max(case when column_name = 'DIAGNOSIS_POA_18' then normalized_code else null end) as diagnosis_poa_18\n    , max(case when column_name = 'DIAGNOSIS_POA_19' then normalized_code else null end) as diagnosis_poa_19\n    , max(case when column_name = 'DIAGNOSIS_POA_20' then normalized_code else null end) as diagnosis_poa_20\n    , max(case when column_name = 'DIAGNOSIS_POA_21' then normalized_code else null end) as diagnosis_poa_21\n    , max(case when column_name = 'DIAGNOSIS_POA_22' then normalized_code else null end) as diagnosis_poa_22\n    , max(case when column_name = 'DIAGNOSIS_POA_23' then normalized_code else null end) as diagnosis_poa_23\n    , max(case when column_name = 'DIAGNOSIS_POA_24' then normalized_code else null end) as diagnosis_poa_24\n    , max(case when column_name = 'DIAGNOSIS_POA_25' then normalized_code else null end) as diagnosis_poa_25\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing._int_normalized_input_present_on_admit_voting\nwhere (occurrence_row_count = 1\n        and occurrence_count > next_occurrence_count)\ngroup by\n    claim_id\n    , data_source", "relation_name": "tuva.claims_preprocessing._int_normalized_input_present_on_admit_final"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.602410Z", "completed_at": "2025-02-25T21:26:18.609455Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.613250Z", "completed_at": "2025-02-25T21:26:18.613258Z"}], "thread_id": "Thread-2", "execution_time": 0.012089014053344727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.normalized_input__int_procedure_code_final", "compiled": true, "compiled_code": "\n\nselect\n    claim_id\n    , data_source\n    , max(case when lower(column_name) = 'procedure_code_1' then normalized_code else null end) as procedure_code_1\n    , max(case when lower(column_name) = 'procedure_code_2' then normalized_code else null end) as procedure_code_2\n    , max(case when lower(column_name) = 'procedure_code_3' then normalized_code else null end) as procedure_code_3\n    , max(case when lower(column_name) = 'procedure_code_4' then normalized_code else null end) as procedure_code_4\n    , max(case when lower(column_name) = 'procedure_code_5' then normalized_code else null end) as procedure_code_5\n    , max(case when lower(column_name) = 'procedure_code_6' then normalized_code else null end) as procedure_code_6\n    , max(case when lower(column_name) = 'procedure_code_7' then normalized_code else null end) as procedure_code_7\n    , max(case when lower(column_name) = 'procedure_code_8' then normalized_code else null end) as procedure_code_8\n    , max(case when lower(column_name) = 'procedure_code_9' then normalized_code else null end) as procedure_code_9\n    , max(case when lower(column_name) = 'procedure_code_10' then normalized_code else null end) as procedure_code_10\n    , max(case when lower(column_name) = 'procedure_code_11' then normalized_code else null end) as procedure_code_11\n    , max(case when lower(column_name) = 'procedure_code_12' then normalized_code else null end) as procedure_code_12\n    , max(case when lower(column_name) = 'procedure_code_13' then normalized_code else null end) as procedure_code_13\n    , max(case when lower(column_name) = 'procedure_code_14' then normalized_code else null end) as procedure_code_14\n    , max(case when lower(column_name) = 'procedure_code_15' then normalized_code else null end) as procedure_code_15\n    , max(case when lower(column_name) = 'procedure_code_16' then normalized_code else null end) as procedure_code_16\n    , max(case when lower(column_name) = 'procedure_code_17' then normalized_code else null end) as procedure_code_17\n    , max(case when lower(column_name) = 'procedure_code_18' then normalized_code else null end) as procedure_code_18\n    , max(case when lower(column_name) = 'procedure_code_19' then normalized_code else null end) as procedure_code_19\n    , max(case when lower(column_name) = 'procedure_code_20' then normalized_code else null end) as procedure_code_20\n    , max(case when lower(column_name) = 'procedure_code_21' then normalized_code else null end) as procedure_code_21\n    , max(case when lower(column_name) = 'procedure_code_22' then normalized_code else null end) as procedure_code_22\n    , max(case when lower(column_name) = 'procedure_code_23' then normalized_code else null end) as procedure_code_23\n    , max(case when lower(column_name) = 'procedure_code_24' then normalized_code else null end) as procedure_code_24\n    , max(case when lower(column_name) = 'procedure_code_25' then normalized_code else null end) as procedure_code_25\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing._int_normalized_input_procedure_code_voting\nwhere (occurrence_row_count = 1\n        and occurrence_count > next_occurrence_count)\ngroup by\n    claim_id\n    , data_source", "relation_name": "tuva.claims_preprocessing._int_normalized_input_procedure_code_final"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.614467Z", "completed_at": "2025-02-25T21:26:18.625541Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.625895Z", "completed_at": "2025-02-25T21:26:18.625904Z"}], "thread_id": "Thread-3", "execution_time": 0.018500089645385742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.normalized_input__int_procedure_date_final", "compiled": true, "compiled_code": "\n\nselect\n    claim_id\n    , data_source\n    , max(case when lower(column_name) = 'procedure_date_1' then normalized_code else null end) as procedure_date_1\n    , max(case when lower(column_name) = 'procedure_date_2' then normalized_code else null end) as procedure_date_2\n    , max(case when lower(column_name) = 'procedure_date_3' then normalized_code else null end) as procedure_date_3\n    , max(case when lower(column_name) = 'procedure_date_4' then normalized_code else null end) as procedure_date_4\n    , max(case when lower(column_name) = 'procedure_date_5' then normalized_code else null end) as procedure_date_5\n    , max(case when lower(column_name) = 'procedure_date_6' then normalized_code else null end) as procedure_date_6\n    , max(case when lower(column_name) = 'procedure_date_7' then normalized_code else null end) as procedure_date_7\n    , max(case when lower(column_name) = 'procedure_date_8' then normalized_code else null end) as procedure_date_8\n    , max(case when lower(column_name) = 'procedure_date_9' then normalized_code else null end) as procedure_date_9\n    , max(case when lower(column_name) = 'procedure_date_10' then normalized_code else null end) as procedure_date_10\n    , max(case when lower(column_name) = 'procedure_date_11' then normalized_code else null end) as procedure_date_11\n    , max(case when lower(column_name) = 'procedure_date_12' then normalized_code else null end) as procedure_date_12\n    , max(case when lower(column_name) = 'procedure_date_13' then normalized_code else null end) as procedure_date_13\n    , max(case when lower(column_name) = 'procedure_date_14' then normalized_code else null end) as procedure_date_14\n    , max(case when lower(column_name) = 'procedure_date_15' then normalized_code else null end) as procedure_date_15\n    , max(case when lower(column_name) = 'procedure_date_16' then normalized_code else null end) as procedure_date_16\n    , max(case when lower(column_name) = 'procedure_date_17' then normalized_code else null end) as procedure_date_17\n    , max(case when lower(column_name) = 'procedure_date_18' then normalized_code else null end) as procedure_date_18\n    , max(case when lower(column_name) = 'procedure_date_19' then normalized_code else null end) as procedure_date_19\n    , max(case when lower(column_name) = 'procedure_date_20' then normalized_code else null end) as procedure_date_20\n    , max(case when lower(column_name) = 'procedure_date_21' then normalized_code else null end) as procedure_date_21\n    , max(case when lower(column_name) = 'procedure_date_22' then normalized_code else null end) as procedure_date_22\n    , max(case when lower(column_name) = 'procedure_date_23' then normalized_code else null end) as procedure_date_23\n    , max(case when lower(column_name) = 'procedure_date_24' then normalized_code else null end) as procedure_date_24\n    , max(case when lower(column_name) = 'procedure_date_25' then normalized_code else null end) as procedure_date_25\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing._int_normalized_input_procedure_date_voting\nwhere (occurrence_row_count = 1\n        and occurrence_count > next_occurrence_count)\ngroup by\n    claim_id\n    , data_source", "relation_name": "tuva.claims_preprocessing._int_normalized_input_procedure_date_final"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.627070Z", "completed_at": "2025-02-25T21:26:18.630305Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.630787Z", "completed_at": "2025-02-25T21:26:18.630792Z"}], "thread_id": "Thread-3", "execution_time": 0.0042231082916259766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.core__eligibility", "compiled": true, "compiled_code": "\n\nselect * from tuva.core._stg_claims_eligibility", "relation_name": "tuva.core.eligibility"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.621053Z", "completed_at": "2025-02-25T21:26:18.630528Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.631280Z", "completed_at": "2025-02-25T21:26:18.631285Z"}], "thread_id": "Thread-2", "execution_time": 0.011483192443847656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.dbt_utils_unique_combination_of_columns_core__person_id_crosswalk_person_id__patient_id__member_id__payer___quote_column_plan___data_source.83bbec69b8", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        person_id, patient_id, member_id, payer, plan, data_source\n    from tuva.core.person_id_crosswalk\n    group by person_id, patient_id, member_id, payer, plan, data_source\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.634328Z", "completed_at": "2025-02-25T21:26:18.644997Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.645237Z", "completed_at": "2025-02-25T21:26:18.645243Z"}], "thread_id": "Thread-3", "execution_time": 0.012999773025512695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.core__patient", "compiled": true, "compiled_code": "\n\nselect * from tuva.core._stg_claims_patient\nunion all\nselect * from tuva.core._stg_clinical_patient\n\n", "relation_name": "tuva.core.patient"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.639107Z", "completed_at": "2025-02-25T21:26:18.650199Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.650443Z", "completed_at": "2025-02-25T21:26:18.650448Z"}], "thread_id": "Thread-2", "execution_time": 0.016849040985107422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__data_quality_for_pbi", "compiled": true, "compiled_code": "\n\nSELECT\n    data_source,\n    field_name,\n    table_name,\n    claim_type,\n    bucket_name,\n    field_value,\n    drill_down_key,\n    drill_down_value,\n    invalid_reason,\n    summary_sk,\n    frequency,\n\t'2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nFROM tuva.data_quality.data_quality_claims_for_pbi\n\nunion all\n\nSELECT\n    data_source,\n    field_name,\n    table_name,\n    'CLINICAL' AS claim_type,\n    bucket_name,\n    field_value,\n    drill_down_key,\n    drill_down_value,\n    invalid_reason,\n    summary_sk,\n    frequency,\n\t'2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nFROM tuva.data_quality.data_quality_clinical_for_pbi\n\n", "relation_name": "tuva.data_quality.data_quality_for_pbi"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.646300Z", "completed_at": "2025-02-25T21:26:18.651425Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.651810Z", "completed_at": "2025-02-25T21:26:18.651813Z"}], "thread_id": "Thread-3", "execution_time": 0.005986213684082031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__crosswalk_field_to_mart_sk", "compiled": true, "compiled_code": "\n\n\n\nwith results as (\n\n    select distinct\n        table_name as input_layer_table_name\n      , claim_type\n      , field_name\n      , cast(NULL as TEXT) AS mart_name\n    from tuva.data_quality.data_quality_detail\n\n    union all\n\n    select\n        input_layer_table_name\n      , claim_type\n      , field_name\n      , mart_name\n    from tuva.data_quality._value_set_crosswalk_field_to_mart\n\n)\n\n, final as (\n\n    select\n        input_layer_table_name\n      , claim_type\n      , field_name\n      , mart_name\n      , DENSE_RANK () OVER (ORDER BY input_layer_table_name, claim_type, field_name) as table_claim_type_field_sk\n\t, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\n    from results\n    group by\n        input_layer_table_name\n      , claim_type\n      , field_name\n      , mart_name\n\n)\n\nselect * from final", "relation_name": "tuva.data_quality.crosswalk_field_to_mart_sk"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.652154Z", "completed_at": "2025-02-25T21:26:18.668299Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.675761Z", "completed_at": "2025-02-25T21:26:18.675772Z"}], "thread_id": "Thread-2", "execution_time": 0.02471017837524414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__quality_trend", "compiled": true, "compiled_code": "\n\n\nwith cte as (\nselect try_cast( d.source_date as date ) as source_date_type\n    ,summary_sk\n    ,SUM(CASE WHEN bucket_name = 'valid' THEN 1 ELSE 0 END) as valid_num\n    ,SUM(CASE WHEN bucket_name <> 'null' THEN 1 ELSE 0 END) as fill_num\n    ,COUNT(drill_down_value) as denom\nfrom tuva.data_quality.data_quality_detail d\ngroup by\n    try_cast( d.source_date as date )\n    ,summary_sk\n\n)\n\nselect\n      c.first_day_of_month\n    , summary_sk\n    , sum(valid_num) as valid_num\n    , sum(fill_num) as fill_num\n    , sum(denom)  as denom\nfrom cte\nleft join tuva.reference_data.calendar c on cte.source_date_type = c.full_date\ngroup by\n      c.first_day_of_month\n    , summary_sk", "relation_name": "tuva.data_quality.quality_trend"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.744619Z", "completed_at": "2025-02-25T21:26:18.797524Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.804103Z", "completed_at": "2025-02-25T21:26:18.804110Z"}], "thread_id": "Thread-2", "execution_time": 0.060004234313964844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.core__member_months", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte__financial_pmpm__stg_provider_attribution as (\n\n\nselect\n      cast(person_id as TEXT ) as person_id\n    , cast(year_month as TEXT ) as year_month\n    , cast(payer as TEXT ) as payer\n    , plan\n    , cast(data_source as TEXT ) as data_source\n    , cast(payer_attributed_provider as TEXT ) as payer_attributed_provider\n    , cast(payer_attributed_provider_practice as TEXT ) as payer_attributed_provider_practice\n    , cast(payer_attributed_provider_organization as TEXT ) as payer_attributed_provider_organization\n    , cast(payer_attributed_provider_lob as TEXT ) as payer_attributed_provider_lob\n    , cast(custom_attributed_provider as TEXT ) as custom_attributed_provider\n    , cast(custom_attributed_provider_practice as TEXT ) as custom_attributed_provider_practice\n    , cast(custom_attributed_provider_organization as TEXT ) as custom_attributed_provider_organization\n    , cast(custom_attributed_provider_lob as TEXT ) as custom_attributed_provider_lob\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.input_layer.provider_attribution\n\n\n), month_start_and_end_dates as (\n  select\n    year || \n\n    case when 2 = 0\n        then ''\n    else\n        right(\n            '0' || month,\n            2\n        )\n    end as year_month\n    , min(full_date) as month_start_date\n    , max(full_date) as month_end_date\n  from tuva.reference_data.calendar\n  group by year, month, year_month\n),\n\n\nfinal_before_attribution_fields as (\nselect distinct\n    a.person_id\n  , a.member_id\n  , year_month\n  , a.payer\n  , a.plan\n  , data_source\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.eligibility a\ninner join month_start_and_end_dates b\n  on a.enrollment_start_date <= b.month_end_date\n  and a.enrollment_end_date >= b.month_start_date\n),\n\nadd_attribution_fields as (\nselect\n    a.person_id\n  , a.member_id\n  , a.year_month\n  , a.payer\n  , a.plan\n  , a.data_source\n  , a.tuva_last_run\n  \n  , b.payer_attributed_provider\n  , b.payer_attributed_provider_practice\n  , b.payer_attributed_provider_organization\n  , b.payer_attributed_provider_lob\n  , b.custom_attributed_provider\n  , b.custom_attributed_provider_practice\n  , b.custom_attributed_provider_organization\n  , b.custom_attributed_provider_lob\n\nfrom final_before_attribution_fields a\nleft join __dbt__cte__financial_pmpm__stg_provider_attribution b\non a.person_id = b.person_id\nand a.year_month = b.year_month\nand a.payer = b.payer\nand a.plan = b.plan\nand a.data_source = b.data_source\n),\n\nfinal_with_sk as (\nselect \n    dense_rank() over (\n      order by \n        person_id\n      , year_month\n      , payer\n      , plan\n      , data_source\n  ) as member_month_key\n  , person_id\n  , member_id\n  , year_month\n  , payer\n  , plan\n  , data_source\n  , tuva_last_run\n  , payer_attributed_provider\n  , payer_attributed_provider_practice\n  , payer_attributed_provider_organization\n  , payer_attributed_provider_lob\n  , custom_attributed_provider\n  , custom_attributed_provider_practice\n  , custom_attributed_provider_organization\n  , custom_attributed_provider_lob\nfrom add_attribution_fields\n)\n\nselect * from final_with_sk", "relation_name": "tuva.core.member_months"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.656438Z", "completed_at": "2025-02-25T21:26:18.872016Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.872479Z", "completed_at": "2025-02-25T21:26:18.872486Z"}], "thread_id": "Thread-3", "execution_time": 0.21665406227111816, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.normalized_input__medical_claim", "compiled": true, "compiled_code": "\n\n\nwith __dbt__cte__normalized_input__stg_medical_claim as (\n\n\nselect\n      claim_id\n    , claim_line_number\n    , claim_type\n    , person_id\n    , member_id\n    , payer\n    , plan\n    , claim_start_date\n    , claim_end_date\n    , claim_line_start_date\n    , claim_line_end_date\n    , admission_date\n    , discharge_date\n    , admit_source_code\n    , admit_type_code\n    , discharge_disposition_code\n    , place_of_service_code\n    , bill_type_code\n    , drg_code_type\n    , drg_code\n    , revenue_center_code\n    , service_unit_quantity\n    , hcpcs_code\n    , hcpcs_modifier_1\n    , hcpcs_modifier_2\n    , hcpcs_modifier_3\n    , hcpcs_modifier_4\n    , hcpcs_modifier_5\n    , rendering_npi\n    , rendering_tin\n    , billing_npi\n    , billing_tin\n    , facility_npi\n    , paid_date\n    , paid_amount\n    , allowed_amount\n    , charge_amount\n    , coinsurance_amount\n    , copayment_amount\n    , deductible_amount\n    , total_cost_amount\n    , diagnosis_code_type\n    , diagnosis_code_1\n    , diagnosis_code_2\n    , diagnosis_code_3\n    , diagnosis_code_4\n    , diagnosis_code_5\n    , diagnosis_code_6\n    , diagnosis_code_7\n    , diagnosis_code_8\n    , diagnosis_code_9\n    , diagnosis_code_10\n    , diagnosis_code_11\n    , diagnosis_code_12\n    , diagnosis_code_13\n    , diagnosis_code_14\n    , diagnosis_code_15\n    , diagnosis_code_16\n    , diagnosis_code_17\n    , diagnosis_code_18\n    , diagnosis_code_19\n    , diagnosis_code_20\n    , diagnosis_code_21\n    , diagnosis_code_22\n    , diagnosis_code_23\n    , diagnosis_code_24\n    , diagnosis_code_25\n    , diagnosis_poa_1\n    , diagnosis_poa_2\n    , diagnosis_poa_3\n    , diagnosis_poa_4\n    , diagnosis_poa_5\n    , diagnosis_poa_6\n    , diagnosis_poa_7\n    , diagnosis_poa_8\n    , diagnosis_poa_9\n    , diagnosis_poa_10\n    , diagnosis_poa_11\n    , diagnosis_poa_12\n    , diagnosis_poa_13\n    , diagnosis_poa_14\n    , diagnosis_poa_15\n    , diagnosis_poa_16\n    , diagnosis_poa_17\n    , diagnosis_poa_18\n    , diagnosis_poa_19\n    , diagnosis_poa_20\n    , diagnosis_poa_21\n    , diagnosis_poa_22\n    , diagnosis_poa_23\n    , diagnosis_poa_24\n    , diagnosis_poa_25\n    , procedure_code_type\n    , procedure_code_1\n    , procedure_code_2\n    , procedure_code_3\n    , procedure_code_4\n    , procedure_code_5\n    , procedure_code_6\n    , procedure_code_7\n    , procedure_code_8\n    , procedure_code_9\n    , procedure_code_10\n    , procedure_code_11\n    , procedure_code_12\n    , procedure_code_13\n    , procedure_code_14\n    , procedure_code_15\n    , procedure_code_16\n    , procedure_code_17\n    , procedure_code_18\n    , procedure_code_19\n    , procedure_code_20\n    , procedure_code_21\n    , procedure_code_22\n    , procedure_code_23\n    , procedure_code_24\n    , procedure_code_25\n    , procedure_date_1\n    , procedure_date_2\n    , procedure_date_3\n    , procedure_date_4\n    , procedure_date_5\n    , procedure_date_6\n    , procedure_date_7\n    , procedure_date_8\n    , procedure_date_9\n    , procedure_date_10\n    , procedure_date_11\n    , procedure_date_12\n    , procedure_date_13\n    , procedure_date_14\n    , procedure_date_15\n    , procedure_date_16\n    , procedure_date_17\n    , procedure_date_18\n    , procedure_date_19\n    , procedure_date_20\n    , procedure_date_21\n    , procedure_date_22\n    , procedure_date_23\n    , procedure_date_24\n    , procedure_date_25\n    , in_network_flag\n    , data_source\n    , file_name\n    , file_date\n    , ingest_datetime\nfrom tuva.input_layer.medical_claim\n) select\n\tcast(med.claim_id as TEXT ) as claim_id\n\t, cast(med.claim_line_number as int ) as claim_line_number\n\t, cast(med.claim_type as TEXT ) as claim_type\n\t, cast(med.person_id as TEXT ) as person_id\n\t, cast(med.member_id as TEXT ) as member_id\n\t, cast(med.payer as TEXT ) as payer\n    , cast(med.plan as TEXT ) as plan\n\t, cast(coalesce(dates.minimum_claim_start_date, undetermined.claim_start_date) as date ) as claim_start_date\n\t, cast(coalesce(dates.maximum_claim_end_date, undetermined.claim_start_date) as date ) as claim_end_date\n\t, cast(coalesce(claim_line_dates.normalized_claim_line_start_date, undetermined.claim_line_start_date) as date ) as claim_line_start_date\n\t, cast(coalesce(claim_line_dates.normalized_claim_line_end_date, undetermined.claim_line_end_date) as date ) as claim_line_end_date\n\t, cast(coalesce(dates.minimum_admission_date, undetermined.admission_date) as date ) as admission_date\n\t, cast(coalesce(dates.maximum_discharge_date, undetermined.discharge_date) as date ) as discharge_date\n\t, cast(coalesce(ad_source.normalized_code, undetermined.admit_source_code) as TEXT ) as admit_source_code\n    , cast(coalesce(ad_source.normalized_description, undetermined.admit_source_description) as TEXT ) as admit_source_description\n\t, cast(coalesce(ad_type.normalized_code, undetermined.admit_type_code) as TEXT ) as admit_type_code\n    , cast(coalesce(ad_type.normalized_description, undetermined.admit_type_description) as TEXT ) as admit_type_description\n\t, cast(coalesce(disch_disp.normalized_code, undetermined.discharge_disposition_code) as TEXT ) as discharge_disposition_code\n    , cast(coalesce(disch_disp.normalized_description, undetermined.discharge_disposition_description) as TEXT ) as discharge_disposition_description\n\t, cast(coalesce(pos.normalized_code, undetermined.place_of_service_code) as TEXT ) as place_of_service_code\n    , cast(coalesce(pos.normalized_description, undetermined.place_of_service_description) as TEXT ) as place_of_service_description\n\t, cast(coalesce(bill.normalized_code, undetermined.bill_type_code) as TEXT ) as bill_type_code\n    , cast(coalesce(bill.normalized_description, undetermined.bill_type_description) as TEXT ) as bill_type_description\n\t, cast(med.drg_code_type as TEXT ) as drg_code_type\n\t, cast(coalesce(drg.normalized_code, undetermined.drg_code) as TEXT ) as drg_code\n    , cast(coalesce(drg.normalized_description, undetermined.drg_description) as TEXT ) as drg_description\n\t, cast(coalesce(rev.normalized_code, undetermined.revenue_center_code) as TEXT ) as revenue_center_code\n    , cast(coalesce(rev.normalized_description, undetermined.revenue_center_description) as TEXT ) as revenue_center_description\n\t, cast(med.service_unit_quantity as numeric(28,6) ) as service_unit_quantity\n\t, cast(med.hcpcs_code as TEXT ) as hcpcs_code\n\t, cast(med.hcpcs_modifier_1 as TEXT ) as hcpcs_modifier_1\n\t, cast(med.hcpcs_modifier_2 as TEXT ) as hcpcs_modifier_2\n\t, cast(med.hcpcs_modifier_3 as TEXT ) as hcpcs_modifier_3\n\t, cast(med.hcpcs_modifier_4 as TEXT ) as hcpcs_modifier_4\n\t, cast(med.hcpcs_modifier_5 as TEXT ) as hcpcs_modifier_5\n\t, cast(coalesce(med_npi.normalized_rendering_npi, undetermined.rendering_npi) as TEXT ) as rendering_id\n    , cast(med.rendering_tin as TEXT ) as rendering_tin\n    , cast(coalesce(med_npi.normalized_rendering_name, undetermined.rendering_name) as TEXT ) as rendering_name\n\t, cast(coalesce(med_npi.normalized_billing_npi, undetermined.billing_npi) as TEXT ) as billing_id\n    , cast(med.billing_tin as TEXT ) as billing_tin\n    , cast(coalesce(med_npi.normalized_billing_name, undetermined.billing_name) as TEXT ) as billing_name\n\t, cast(coalesce(med_npi.normalized_facility_npi, undetermined.facility_npi) as TEXT ) as facility_id\n\t, cast(coalesce(med_npi.normalized_facility_name, undetermined.facility_name) as TEXT ) as facility_name\n    , cast(med.paid_date as date ) as paid_date\n\t, cast(med.paid_amount as numeric(28,6) ) as paid_amount\n\t, cast(med.allowed_amount as numeric(28,6) ) as allowed_amount\n\t, cast(med.charge_amount as numeric(28,6) ) as charge_amount\n\t, cast(med.coinsurance_amount as numeric(28,6) ) as coinsurance_amount\n\t, cast(med.copayment_amount as numeric(28,6) ) as copayment_amount\n\t, cast(med.deductible_amount as numeric(28,6) ) as deductible_amount\n\t, cast(med.total_cost_amount as numeric(28,6) ) as total_cost_amount\n\t, cast(med.diagnosis_code_type as TEXT ) as diagnosis_code_type\n\t, cast(coalesce(dx_code.diagnosis_code_1, undetermined.diagnosis_code_1) as TEXT ) as diagnosis_code_1\n\t, cast(coalesce(dx_code.diagnosis_code_2, undetermined.diagnosis_code_2) as TEXT ) as diagnosis_code_2\n\t, cast(coalesce(dx_code.diagnosis_code_3, undetermined.diagnosis_code_3) as TEXT ) as diagnosis_code_3\n\t, cast(coalesce(dx_code.diagnosis_code_4, undetermined.diagnosis_code_4) as TEXT ) as diagnosis_code_4\n\t, cast(coalesce(dx_code.diagnosis_code_5, undetermined.diagnosis_code_5) as TEXT ) as diagnosis_code_5\n\t, cast(coalesce(dx_code.diagnosis_code_6, undetermined.diagnosis_code_6) as TEXT ) as diagnosis_code_6\n\t, cast(coalesce(dx_code.diagnosis_code_7, undetermined.diagnosis_code_7) as TEXT ) as diagnosis_code_7\n\t, cast(coalesce(dx_code.diagnosis_code_8, undetermined.diagnosis_code_8) as TEXT ) as diagnosis_code_8\n\t, cast(coalesce(dx_code.diagnosis_code_9, undetermined.diagnosis_code_9) as TEXT ) as diagnosis_code_9\n\t, cast(coalesce(dx_code.diagnosis_code_10, undetermined.diagnosis_code_10) as TEXT ) as diagnosis_code_10\n\t, cast(coalesce(dx_code.diagnosis_code_11, undetermined.diagnosis_code_11) as TEXT ) as diagnosis_code_11\n\t, cast(coalesce(dx_code.diagnosis_code_12, undetermined.diagnosis_code_12) as TEXT ) as diagnosis_code_12\n\t, cast(coalesce(dx_code.diagnosis_code_13, undetermined.diagnosis_code_13) as TEXT ) as diagnosis_code_13\n\t, cast(coalesce(dx_code.diagnosis_code_14, undetermined.diagnosis_code_14) as TEXT ) as diagnosis_code_14\n\t, cast(coalesce(dx_code.diagnosis_code_15, undetermined.diagnosis_code_15) as TEXT ) as diagnosis_code_15\n\t, cast(coalesce(dx_code.diagnosis_code_16, undetermined.diagnosis_code_16) as TEXT ) as diagnosis_code_16\n\t, cast(coalesce(dx_code.diagnosis_code_17, undetermined.diagnosis_code_17) as TEXT ) as diagnosis_code_17\n\t, cast(coalesce(dx_code.diagnosis_code_18, undetermined.diagnosis_code_18) as TEXT ) as diagnosis_code_18\n\t, cast(coalesce(dx_code.diagnosis_code_19, undetermined.diagnosis_code_19) as TEXT ) as diagnosis_code_19\n\t, cast(coalesce(dx_code.diagnosis_code_20, undetermined.diagnosis_code_20) as TEXT ) as diagnosis_code_20\n\t, cast(coalesce(dx_code.diagnosis_code_21, undetermined.diagnosis_code_21) as TEXT ) as diagnosis_code_21\n\t, cast(coalesce(dx_code.diagnosis_code_22, undetermined.diagnosis_code_22) as TEXT ) as diagnosis_code_22\n\t, cast(coalesce(dx_code.diagnosis_code_23, undetermined.diagnosis_code_23) as TEXT ) as diagnosis_code_23\n\t, cast(coalesce(dx_code.diagnosis_code_24, undetermined.diagnosis_code_24) as TEXT ) as diagnosis_code_24\n\t, cast(coalesce(dx_code.diagnosis_code_25, undetermined.diagnosis_code_25) as TEXT ) as diagnosis_code_25\n\t, cast(coalesce(poa.diagnosis_poa_1, undetermined.diagnosis_poa_1) as TEXT ) as diagnosis_poa_1\n\t, cast(coalesce(poa.diagnosis_poa_2, undetermined.diagnosis_poa_2) as TEXT ) as diagnosis_poa_2\n\t, cast(coalesce(poa.diagnosis_poa_3, undetermined.diagnosis_poa_3) as TEXT ) as diagnosis_poa_3\n\t, cast(coalesce(poa.diagnosis_poa_4, undetermined.diagnosis_poa_4) as TEXT ) as diagnosis_poa_4\n\t, cast(coalesce(poa.diagnosis_poa_5, undetermined.diagnosis_poa_5) as TEXT ) as diagnosis_poa_5\n\t, cast(coalesce(poa.diagnosis_poa_6, undetermined.diagnosis_poa_6) as TEXT ) as diagnosis_poa_6\n\t, cast(coalesce(poa.diagnosis_poa_7, undetermined.diagnosis_poa_7) as TEXT ) as diagnosis_poa_7\n\t, cast(coalesce(poa.diagnosis_poa_8, undetermined.diagnosis_poa_8) as TEXT ) as diagnosis_poa_8\n\t, cast(coalesce(poa.diagnosis_poa_9, undetermined.diagnosis_poa_9) as TEXT ) as diagnosis_poa_9\n\t, cast(coalesce(poa.diagnosis_poa_10, undetermined.diagnosis_poa_10) as TEXT ) as diagnosis_poa_10\n\t, cast(coalesce(poa.diagnosis_poa_11, undetermined.diagnosis_poa_11) as TEXT ) as diagnosis_poa_11\n\t, cast(coalesce(poa.diagnosis_poa_12, undetermined.diagnosis_poa_12) as TEXT ) as diagnosis_poa_12\n\t, cast(coalesce(poa.diagnosis_poa_13, undetermined.diagnosis_poa_13) as TEXT ) as diagnosis_poa_13\n\t, cast(coalesce(poa.diagnosis_poa_14, undetermined.diagnosis_poa_14) as TEXT ) as diagnosis_poa_14\n\t, cast(coalesce(poa.diagnosis_poa_15, undetermined.diagnosis_poa_15) as TEXT ) as diagnosis_poa_15\n\t, cast(coalesce(poa.diagnosis_poa_16, undetermined.diagnosis_poa_16) as TEXT ) as diagnosis_poa_16\n\t, cast(coalesce(poa.diagnosis_poa_17, undetermined.diagnosis_poa_17) as TEXT ) as diagnosis_poa_17\n\t, cast(coalesce(poa.diagnosis_poa_18, undetermined.diagnosis_poa_18) as TEXT ) as diagnosis_poa_18\n\t, cast(coalesce(poa.diagnosis_poa_19, undetermined.diagnosis_poa_19) as TEXT ) as diagnosis_poa_19\n\t, cast(coalesce(poa.diagnosis_poa_20, undetermined.diagnosis_poa_20) as TEXT ) as diagnosis_poa_20\n\t, cast(coalesce(poa.diagnosis_poa_21, undetermined.diagnosis_poa_21) as TEXT ) as diagnosis_poa_21\n\t, cast(coalesce(poa.diagnosis_poa_22, undetermined.diagnosis_poa_22) as TEXT ) as diagnosis_poa_22\n\t, cast(coalesce(poa.diagnosis_poa_23, undetermined.diagnosis_poa_23) as TEXT ) as diagnosis_poa_23\n\t, cast(coalesce(poa.diagnosis_poa_24, undetermined.diagnosis_poa_24) as TEXT ) as diagnosis_poa_24\n\t, cast(coalesce(poa.diagnosis_poa_25, undetermined.diagnosis_poa_25) as TEXT ) as diagnosis_poa_25\n\t, cast(med.procedure_code_type as TEXT ) as procedure_code_type\n\t, cast(coalesce(px_code.procedure_code_1, undetermined.procedure_code_1) as TEXT ) as procedure_code_1\n\t, cast(coalesce(px_code.procedure_code_2, undetermined.procedure_code_2) as TEXT ) as procedure_code_2\n\t, cast(coalesce(px_code.procedure_code_3, undetermined.procedure_code_3) as TEXT ) as procedure_code_3\n\t, cast(coalesce(px_code.procedure_code_4, undetermined.procedure_code_4) as TEXT ) as procedure_code_4\n\t, cast(coalesce(px_code.procedure_code_5, undetermined.procedure_code_5) as TEXT ) as procedure_code_5\n\t, cast(coalesce(px_code.procedure_code_6, undetermined.procedure_code_6) as TEXT ) as procedure_code_6\n\t, cast(coalesce(px_code.procedure_code_7, undetermined.procedure_code_7) as TEXT ) as procedure_code_7\n\t, cast(coalesce(px_code.procedure_code_8, undetermined.procedure_code_8) as TEXT ) as procedure_code_8\n\t, cast(coalesce(px_code.procedure_code_9, undetermined.procedure_code_9) as TEXT ) as procedure_code_9\n\t, cast(coalesce(px_code.procedure_code_10, undetermined.procedure_code_10) as TEXT ) as procedure_code_10\n\t, cast(coalesce(px_code.procedure_code_11, undetermined.procedure_code_11) as TEXT ) as procedure_code_11\n\t, cast(coalesce(px_code.procedure_code_12, undetermined.procedure_code_12) as TEXT ) as procedure_code_12\n\t, cast(coalesce(px_code.procedure_code_13, undetermined.procedure_code_13) as TEXT ) as procedure_code_13\n\t, cast(coalesce(px_code.procedure_code_14, undetermined.procedure_code_14) as TEXT ) as procedure_code_14\n\t, cast(coalesce(px_code.procedure_code_15, undetermined.procedure_code_15) as TEXT ) as procedure_code_15\n\t, cast(coalesce(px_code.procedure_code_16, undetermined.procedure_code_16) as TEXT ) as procedure_code_16\n\t, cast(coalesce(px_code.procedure_code_17, undetermined.procedure_code_17) as TEXT ) as procedure_code_17\n\t, cast(coalesce(px_code.procedure_code_18, undetermined.procedure_code_18) as TEXT ) as procedure_code_18\n\t, cast(coalesce(px_code.procedure_code_19, undetermined.procedure_code_19) as TEXT ) as procedure_code_19\n\t, cast(coalesce(px_code.procedure_code_20, undetermined.procedure_code_20) as TEXT ) as procedure_code_20\n\t, cast(coalesce(px_code.procedure_code_21, undetermined.procedure_code_21) as TEXT ) as procedure_code_21\n\t, cast(coalesce(px_code.procedure_code_22, undetermined.procedure_code_22) as TEXT ) as procedure_code_22\n\t, cast(coalesce(px_code.procedure_code_23, undetermined.procedure_code_23) as TEXT ) as procedure_code_23\n\t, cast(coalesce(px_code.procedure_code_24, undetermined.procedure_code_24) as TEXT ) as procedure_code_24\n\t, cast(coalesce(px_code.procedure_code_25, undetermined.procedure_code_25) as TEXT ) as procedure_code_25\n\t, cast(coalesce(px_date.procedure_date_1, undetermined.procedure_date_1) as date ) as procedure_date_1\n\t, cast(coalesce(px_date.procedure_date_2, undetermined.procedure_date_2) as date ) as procedure_date_2\n\t, cast(coalesce(px_date.procedure_date_3, undetermined.procedure_date_3) as date ) as procedure_date_3\n\t, cast(coalesce(px_date.procedure_date_4, undetermined.procedure_date_4) as date ) as procedure_date_4\n\t, cast(coalesce(px_date.procedure_date_5, undetermined.procedure_date_5) as date ) as procedure_date_5\n\t, cast(coalesce(px_date.procedure_date_6, undetermined.procedure_date_6) as date ) as procedure_date_6\n\t, cast(coalesce(px_date.procedure_date_7, undetermined.procedure_date_7) as date ) as procedure_date_7\n\t, cast(coalesce(px_date.procedure_date_8, undetermined.procedure_date_8) as date ) as procedure_date_8\n\t, cast(coalesce(px_date.procedure_date_9, undetermined.procedure_date_9) as date ) as procedure_date_9\n\t, cast(coalesce(px_date.procedure_date_10, undetermined.procedure_date_10) as date ) as procedure_date_10\n\t, cast(coalesce(px_date.procedure_date_11, undetermined.procedure_date_11) as date ) as procedure_date_11\n\t, cast(coalesce(px_date.procedure_date_12, undetermined.procedure_date_12) as date ) as procedure_date_12\n\t, cast(coalesce(px_date.procedure_date_13, undetermined.procedure_date_13) as date ) as procedure_date_13\n\t, cast(coalesce(px_date.procedure_date_14, undetermined.procedure_date_14) as date ) as procedure_date_14\n\t, cast(coalesce(px_date.procedure_date_15, undetermined.procedure_date_15) as date ) as procedure_date_15\n\t, cast(coalesce(px_date.procedure_date_16, undetermined.procedure_date_16) as date ) as procedure_date_16\n\t, cast(coalesce(px_date.procedure_date_17, undetermined.procedure_date_17) as date ) as procedure_date_17\n\t, cast(coalesce(px_date.procedure_date_18, undetermined.procedure_date_18) as date ) as procedure_date_18\n\t, cast(coalesce(px_date.procedure_date_19, undetermined.procedure_date_19) as date ) as procedure_date_19\n\t, cast(coalesce(px_date.procedure_date_20, undetermined.procedure_date_20) as date ) as procedure_date_20\n\t, cast(coalesce(px_date.procedure_date_21, undetermined.procedure_date_21) as date ) as procedure_date_21\n\t, cast(coalesce(px_date.procedure_date_22, undetermined.procedure_date_22) as date ) as procedure_date_22\n\t, cast(coalesce(px_date.procedure_date_23, undetermined.procedure_date_23) as date ) as procedure_date_23\n\t, cast(coalesce(px_date.procedure_date_24, undetermined.procedure_date_24) as date ) as procedure_date_24\n\t, cast(coalesce(px_date.procedure_date_25, undetermined.procedure_date_25) as date ) as procedure_date_25\n\t, cast(med.data_source as TEXT ) as data_source\n    , cast(med.in_network_flag as int ) as in_network_flag\n    , cast('2025-02-25 21:25:59.177756+00:00' as TEXT ) as tuva_last_run\nfrom __dbt__cte__normalized_input__stg_medical_claim med\nleft join tuva.claims_preprocessing._int_normalized_input_admit_source_final ad_source\n    on med.claim_id = ad_source.claim_id\n    and med.data_source = ad_source.data_source\nleft join tuva.claims_preprocessing._int_normalized_input_admit_type_final ad_type\n    on med.claim_id = ad_type.claim_id\n    and med.data_source = ad_type.data_source\nleft join tuva.claims_preprocessing._int_normalized_input_bill_type_final bill\n    on med.claim_id = bill.claim_id\n    and med.data_source = bill.data_source\nleft join tuva.claims_preprocessing._int_normalized_input_medical_claim_date_normalize claim_line_dates\n    on med.claim_id = claim_line_dates.claim_id\n    and med.claim_line_number = claim_line_dates.claim_line_number\n    and med.data_source = claim_line_dates.data_source\nleft join tuva.claims_preprocessing._int_normalized_input_medical_date_aggregation dates\n    on med.claim_id = dates.claim_id\n    and med.data_source = dates.data_source\nleft join tuva.claims_preprocessing._int_normalized_input_medical_npi_normalize med_npi\n    on med.claim_id = med_npi.claim_id\n    and med.claim_line_number = med_npi.claim_line_number\n    and med.data_source = med_npi.data_source\nleft join tuva.claims_preprocessing._int_normalized_input_discharge_disposition_final disch_disp\n    on med.claim_id = disch_disp.claim_id\n    and med.data_source = disch_disp.data_source\nleft join tuva.claims_preprocessing._int_normalized_input_drg_final drg\n\ton med.claim_id = drg.claim_id\n    and med.data_source = drg.data_source\nleft join tuva.claims_preprocessing._int_normalized_input_place_of_service_normalize pos\n    on med.claim_id = pos.claim_id\n    and med.claim_line_number = pos.claim_line_number\n    and med.data_source = pos.data_source\nleft join tuva.claims_preprocessing._int_normalized_input_diagnosis_code_final dx_code\n    on med.claim_id = dx_code.claim_id\n    and med.data_source = dx_code.data_source\nleft join tuva.claims_preprocessing._int_normalized_input_present_on_admit_final poa\n    on med.claim_id = poa.claim_id\n    and med.data_source = poa.data_source\nleft join tuva.claims_preprocessing._int_normalized_input_procedure_code_final px_code\n    on med.claim_id = px_code.claim_id\n    and med.data_source = px_code.data_source\nleft join tuva.claims_preprocessing._int_normalized_input_procedure_date_final px_date\n    on med.claim_id = px_date.claim_id\n    and med.data_source = px_date.data_source\nleft join tuva.claims_preprocessing._int_normalized_input_revenue_center_normalize rev\n    on med.claim_id = rev.claim_id\n    and med.claim_line_number = rev.claim_line_number\n    and med.data_source = rev.data_source\nleft join tuva.claims_preprocessing._int_normalized_input_undetermined_claim_type undetermined\n    on med.claim_id = undetermined.claim_id\n    and med.claim_line_number = undetermined.claim_line_number\n    and med.data_source = undetermined.data_source", "relation_name": "tuva.claims_preprocessing.normalized_input_medical_claim"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.868540Z", "completed_at": "2025-02-25T21:26:18.874148Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.877434Z", "completed_at": "2025-02-25T21:26:18.877441Z"}], "thread_id": "Thread-2", "execution_time": 0.009798049926757812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.not_null_core__eligibility_person_id.c107049663", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect person_id\nfrom tuva.core.eligibility\nwhere person_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.874357Z", "completed_at": "2025-02-25T21:26:18.882573Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.882839Z", "completed_at": "2025-02-25T21:26:18.882846Z"}], "thread_id": "Thread-3", "execution_time": 0.009279966354370117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.unique_core__eligibility_eligibility_id.f0f050366a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    eligibility_id as unique_field,\n    count(*) as n_records\n\nfrom tuva.core.eligibility\nwhere eligibility_id is not null\ngroup by eligibility_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.903844Z", "completed_at": "2025-02-25T21:26:18.912203Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.912489Z", "completed_at": "2025-02-25T21:26:18.912495Z"}], "thread_id": "Thread-3", "execution_time": 0.009517669677734375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.mart_review__patient", "compiled": true, "compiled_code": "\n\nSELECT *,\n    person_id || '|' || data_source as patient_data_source_key\nFROM tuva.core.patient", "relation_name": "tuva.data_quality.mart_review__patient"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.918431Z", "completed_at": "2025-02-25T21:26:18.922535Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.925838Z", "completed_at": "2025-02-25T21:26:18.925845Z"}], "thread_id": "Thread-2", "execution_time": 0.008040189743041992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.not_null_core__patient_person_id.9d11274eb7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect person_id\nfrom tuva.core.patient\nwhere person_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.922758Z", "completed_at": "2025-02-25T21:26:18.930715Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.930973Z", "completed_at": "2025-02-25T21:26:18.930979Z"}], "thread_id": "Thread-3", "execution_time": 0.008989810943603516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.unique_core__patient_person_id.c85be01fdc", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    person_id as unique_field,\n    count(*) as n_records\n\nfrom tuva.core.patient\nwhere person_id is not null\ngroup by person_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.927076Z", "completed_at": "2025-02-25T21:26:18.931937Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:18.932369Z", "completed_at": "2025-02-25T21:26:18.932373Z"}], "thread_id": "Thread-2", "execution_time": 0.005827903747558594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__summary", "compiled": true, "compiled_code": "\n\nWITH CTE AS (\n    SELECT DISTINCT fm.field_name\n    ,fm.input_layer_table_name\n    ,fm.claim_type\n    ,table_claim_type_field_sk\n    FROM tuva.data_quality.crosswalk_field_to_mart_sk fm\n)\n\nSELECT\n    summary_sk,\n    fm.table_claim_type_field_sk,\n    data_source,\n    x.table_name,\n    x.claim_type,\n    x.field_name,\n    sct.red,\n    sct.green,\n    sum(case when bucket_name = 'valid' then 1 else 0 end) as valid_num,\n    sum(case when bucket_name <> 'null' then 1 else 0 end) as fill_num,\n    count(drill_down_value) as denom,\n    '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nFROM\n    tuva.data_quality.data_quality_detail x\nLEFT JOIN CTE fm\n    on x.field_name = fm.field_name\n    and\n    fm.input_layer_table_name = x.table_name\n    and\n    fm.claim_type = x.claim_type\nLEFT JOIN tuva.data_quality._value_set_crosswalk_field_info sct\n    on x.field_name = sct.field_name\n    and\n    sct.input_layer_table_name = x.table_name\n    and\n    sct.claim_type = x.claim_type\nGROUP BY\n    summary_sk,\n    data_source,\n    fm.table_claim_type_field_sk,\n    x.claim_type,\n    x.table_name,\n    x.field_name,\n    sct.red,\n    sct.green", "relation_name": "tuva.data_quality.summary"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.932739Z", "completed_at": "2025-02-25T21:26:19.060698Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.061883Z", "completed_at": "2025-02-25T21:26:19.061915Z"}], "thread_id": "Thread-3", "execution_time": 0.13044214248657227, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ahrq_measures__stg_pqi_member_months", "compiled": true, "compiled_code": "\n\nwith\n\ndate_int as (\n    select distinct\n        replace(year_month,'-','') yyyymm\n      , first_day_of_month\n    from tuva.reference_data.calendar as c\n)\n\nselect \n    data_source\n  , person_id\n  , first_day_of_month\n  , d.yyyymm as year_month\n\nfrom \n    tuva.core.member_months mm\ninner join date_int d on mm.year_month = d.yyyymm", "relation_name": "tuva.ahrq_measures._stg_pqi_member_months"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.937570Z", "completed_at": "2025-02-25T21:26:19.074007Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.078551Z", "completed_at": "2025-02-25T21:26:19.078560Z"}], "thread_id": "Thread-2", "execution_time": 0.1415538787841797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.claims_enrollment__flag_rx_claims_with_enrollment", "compiled": true, "compiled_code": "\n\n\nwith claim_dates as(\n    select\n        claim_id\n        , claim_line_number\n        , person_id\n        , member_id\n        , payer\n        , plan\n        , data_source\n        , date_part('year', paid_date) || \n\n    case when 2 = 0\n        then ''\n    else\n        right(\n            '0' || date_part('month', paid_date),\n            2\n        )\n    end as paid_year_month\n    from tuva.claims_preprocessing.normalized_input_pharmacy_claim\n)\n\nselect distinct\n     claim.claim_id\n    , claim.claim_line_number\n    , claim.person_id\n    , claim.member_id\n    , claim.payer\n    , claim.plan\n    , claim.data_source\n    , mm.member_month_key\n    , claim.paid_year_month\n    , cast('2025-02-25 21:25:59.177756+00:00' as timestamp ) as tuva_last_run\nfrom tuva.core.member_months mm\ninner join claim_dates claim\n    on mm.person_id = claim.person_id\n    and mm.member_id = claim.member_id\n    and mm.payer = claim.payer\n    and mm.plan = claim.plan\n    and mm.year_month = claim.paid_year_month", "relation_name": "tuva.claims_preprocessing.flag_rx_claims_with_enrollment"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.083553Z", "completed_at": "2025-02-25T21:26:19.092078Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.092401Z", "completed_at": "2025-02-25T21:26:19.092409Z"}], "thread_id": "Thread-2", "execution_time": 0.010684967041015625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.mart_review__stg_member_month", "compiled": true, "compiled_code": "\n\nwith cte as\n(\nselect distinct year_month_int\n,full_date\nfrom tuva.reference_data.calendar c\nwhere day = 1\n\n)\n\nselect  mm.*\n,c.year_month_int\n,c.full_date as year_month_date\nFROM tuva.core.member_months mm\nleft join cte c on cast(mm.year_month as int) = c.year_month_int", "relation_name": "tuva.data_quality.mart_review__stg_member_month"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.087637Z", "completed_at": "2025-02-25T21:26:19.093597Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.094085Z", "completed_at": "2025-02-25T21:26:19.094089Z"}], "thread_id": "Thread-3", "execution_time": 0.010913848876953125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.not_null_core__member_months_member_month_key.8869981ed9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect member_month_key\nfrom tuva.core.member_months\nwhere member_month_key is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.094464Z", "completed_at": "2025-02-25T21:26:19.101454Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.101687Z", "completed_at": "2025-02-25T21:26:19.101693Z"}], "thread_id": "Thread-2", "execution_time": 0.008446931838989258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.not_null_core__member_months_person_id.af3d01121f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect person_id\nfrom tuva.core.member_months\nwhere person_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.098401Z", "completed_at": "2025-02-25T21:26:19.102637Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.103092Z", "completed_at": "2025-02-25T21:26:19.103097Z"}], "thread_id": "Thread-3", "execution_time": 0.00523686408996582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.encounters__patient_data_source_id", "compiled": true, "compiled_code": "\n\nwith multiple_sources as (\nselect distinct person_id\n,data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim\n\n\nunion distinct\n\n\nselect distinct person_id\n,data_source\nfrom tuva.claims_preprocessing.normalized_input_eligibility\n)\n\nselect\nperson_id\n,data_source\n,dense_rank() over (order by concat(person_id,data_source)) as patient_data_source_id\nfrom multiple_sources", "relation_name": "tuva.claims_preprocessing.encounters__patient_data_source_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.103489Z", "completed_at": "2025-02-25T21:26:19.112904Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.113144Z", "completed_at": "2025-02-25T21:26:19.113150Z"}], "thread_id": "Thread-2", "execution_time": 0.010830879211425781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__stg_medical_claim", "compiled": true, "compiled_code": "\n\nselect\n  m.claim_id\n  , m.claim_line_number\n  , m.claim_id || '|' || cast(m.claim_line_number as TEXT) as claim_line_id\n  , m.claim_type\n  , coalesce(m.admission_date,m.claim_line_start_date,m.claim_start_date) as start_date\n  , coalesce(m.discharge_date,m.claim_line_end_date,m.claim_end_date) as end_date\n  , m.admission_date\n  , m.discharge_date\n  , m.claim_start_date\n  , m.claim_end_date\n  , m.claim_line_start_date\n  , m.claim_line_end_date\n  , m.bill_type_code\n  , bt.bill_type_description\n  , m.hcpcs_code\n  , c.ccs_category\n  , c.ccs_category_description\n  , m.drg_code_type\n  , m.drg_code\n  , m.drg_description\n  , m.place_of_service_code\n  , pos.place_of_service_description\n  , m.revenue_center_code\n  , r.revenue_center_description\n  , m.diagnosis_code_1\n  , dx.default_ccsr_category_ip\n  , dx.default_ccsr_category_op\n  , dx.default_ccsr_category_description_ip\n  , dx.default_ccsr_category_description_op\n  , p.primary_taxonomy_code\n  , p.primary_specialty_description\n  , rend.primary_specialty_description as rend_primary_specialty_description\n  , n.modality\n  , m.data_source\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.normalized_input_medical_claim m\nleft join tuva.ccsr._value_set_dxccsr_v2023_1_cleaned_map dx on m.diagnosis_code_1 = dx.icd_10_cm_code\nleft join tuva.terminology.provider p on m.facility_id = p.npi\nleft join tuva.terminology.ccs_services_procedures c on m.hcpcs_code = c.hcpcs_code\nleft join tuva.terminology.nitos n on m.hcpcs_code = n.hcpcs_code\nleft join tuva.terminology.revenue_center r on m.revenue_center_code = r.revenue_center_code\nleft join tuva.terminology.place_of_service pos on m.place_of_service_code = pos.place_of_service_code\nleft join tuva.terminology.bill_type bt on m.bill_type_code = bt.bill_type_code\nleft join tuva.terminology.provider rend on m.rendering_id = rend.npi", "relation_name": "tuva.claims_preprocessing.service_category__stg_medical_claim"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.109861Z", "completed_at": "2025-02-25T21:26:19.114316Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.121115Z", "completed_at": "2025-02-25T21:26:19.121122Z"}], "thread_id": "Thread-3", "execution_time": 0.011873960494995117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.dbt_utils_unique_combination_of_columns_normalized_input__medical_claim_claim_id__claim_line_number.6d94c0c08d", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        claim_id, claim_line_number\n    from tuva.claims_preprocessing.normalized_input_medical_claim\n    group by claim_id, claim_line_number\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.114679Z", "completed_at": "2025-02-25T21:26:19.126580Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.126860Z", "completed_at": "2025-02-25T21:26:19.126867Z"}], "thread_id": "Thread-2", "execution_time": 0.013180255889892578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.claims_enrollment__flag_claims_with_enrollment", "compiled": true, "compiled_code": "\n\n\nwith claim_dates as(\n    select\n        claim_id\n        , claim_line_number\n        , person_id\n        , member_id\n        , payer\n        , plan\n        , data_source\n        , coalesce(claim_line_start_date, claim_start_date, admission_date) as inferred_claim_start_date\n        , case\n            when claim_line_start_date is not null then 'claim_line_start_date'\n            when claim_line_start_date is null and claim_start_date is not null then 'claim_start_date'\n            when claim_line_start_date is null and claim_start_date is null and admission_date is not null then 'admission_date'\n        end as inferred_claim_start_column_used\n    from tuva.claims_preprocessing.normalized_input_medical_claim\n)\n\n, claim_year_month as(\n    select\n          claim_id\n        , claim_line_number\n        , person_id\n        , member_id\n        , payer\n        , plan\n        , data_source\n        , inferred_claim_start_date\n        , inferred_claim_start_column_used\n        , date_part('year', inferred_claim_start_date) || \n\n    case when 2 = 0\n        then ''\n    else\n        right(\n            '0' || date_part('month', inferred_claim_start_date),\n            2\n        )\n    end as inferred_claim_start_year_month\nfrom claim_dates\n\n)\n\nselect distinct\n     claim.claim_id\n    , claim.claim_line_number\n    , claim.person_id\n    , claim.member_id\n    , claim.payer\n    , claim.plan\n    , claim.data_source\n    , mm.member_month_key\n    , claim.inferred_claim_start_year_month\n    , claim.inferred_claim_start_column_used\n    , cast('2025-02-25 21:25:59.177756+00:00' as timestamp ) as tuva_last_run\nfrom tuva.core.member_months mm\ninner join claim_year_month claim\n    on mm.person_id = claim.person_id\n    and mm.member_id = claim.member_id\n    and mm.payer = claim.payer\n    and mm.plan = claim.plan\n    and mm.year_month = claim.inferred_claim_start_year_month", "relation_name": "tuva.claims_preprocessing.flag_claims_with_enrollment"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.122445Z", "completed_at": "2025-02-25T21:26:19.128141Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.133124Z", "completed_at": "2025-02-25T21:26:19.133134Z"}], "thread_id": "Thread-3", "execution_time": 0.011324882507324219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ahrq_measures__int_pqi_shared_exclusion_missing_age", "compiled": true, "compiled_code": "\n\nwith __dbt__cte___stg_pqi_patient as (\n\n\nselect \n    data_source\n  , birth_date\n  , person_id\n  , sex\nfrom \n    tuva.core.patient\n) /* Exclude patients with missing age */\nselect \n    data_source\n    , person_id\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom __dbt__cte___stg_pqi_patient\nwhere birth_date is null", "relation_name": "tuva.ahrq_measures._int_pqi_shared_exclusions_missing_age"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.128336Z", "completed_at": "2025-02-25T21:26:19.140250Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.140865Z", "completed_at": "2025-02-25T21:26:19.140874Z"}], "thread_id": "Thread-2", "execution_time": 0.013320207595825195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ahrq_measures__int_pqi_shared_exclusion_missing_gender", "compiled": true, "compiled_code": "\n\nwith __dbt__cte___stg_pqi_patient as (\n\n\nselect \n    data_source\n  , birth_date\n  , person_id\n  , sex\nfrom \n    tuva.core.patient\n) -- Exclude patients with undefined or missing gender\nselect \n    data_source\n  , person_id\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom __dbt__cte___stg_pqi_patient\nwhere \n  sex not in ('male', 'female')", "relation_name": "tuva.ahrq_measures._int_pqi_shared_exclusion_missing_gender"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.135111Z", "completed_at": "2025-02-25T21:26:19.146400Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.146680Z", "completed_at": "2025-02-25T21:26:19.146689Z"}], "thread_id": "Thread-3", "execution_time": 0.012263059616088867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.accepted_values_quality_measures__stg_core__patient_sex__female__male__unknown.e6adc9ce2b", "compiled": true, "compiled_code": "\n    \n    \n\nwith  __dbt__cte___stg_patient as (\n\nselect\n      person_id\n    , sex\n    , birth_date\n    , death_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.patient\n), all_values as (\n\n    select\n        sex as value_field,\n        count(*) as n_records\n\n    from __dbt__cte___stg_patient\n    group by sex\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'female','male','unknown'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.142314Z", "completed_at": "2025-02-25T21:26:19.152309Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.152585Z", "completed_at": "2025-02-25T21:26:19.152593Z"}], "thread_id": "Thread-2", "execution_time": 0.010987997055053711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.not_null_quality_measures__stg_core__patient_birth_date.4b3a2e74e6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nwith __dbt__cte___stg_patient as (\n\nselect\n      person_id\n    , sex\n    , birth_date\n    , death_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.patient\n) select birth_date\nfrom __dbt__cte___stg_patient\nwhere birth_date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.147837Z", "completed_at": "2025-02-25T21:26:19.157131Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.157415Z", "completed_at": "2025-02-25T21:26:19.157421Z"}], "thread_id": "Thread-3", "execution_time": 0.010118961334228516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.not_null_quality_measures__stg_core__patient_person_id.a54573252c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nwith __dbt__cte___stg_patient as (\n\nselect\n      person_id\n    , sex\n    , birth_date\n    , death_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.patient\n) select person_id\nfrom __dbt__cte___stg_patient\nwhere person_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.153725Z", "completed_at": "2025-02-25T21:26:19.164363Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.165850Z", "completed_at": "2025-02-25T21:26:19.165856Z"}], "thread_id": "Thread-2", "execution_time": 0.012645244598388672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.not_null_quality_measures__stg_core__patient_sex.e2f34cab69", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nwith __dbt__cte___stg_patient as (\n\nselect\n      person_id\n    , sex\n    , birth_date\n    , death_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.patient\n) select sex\nfrom __dbt__cte___stg_patient\nwhere sex is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.158555Z", "completed_at": "2025-02-25T21:26:19.167065Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.174580Z", "completed_at": "2025-02-25T21:26:19.174586Z"}], "thread_id": "Thread-3", "execution_time": 0.016562938690185547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ahrq_measures__int_pqi_01_denom", "compiled": true, "compiled_code": "\n\nwith __dbt__cte___stg_pqi_patient as (\n\n\nselect \n    data_source\n  , birth_date\n  , person_id\n  , sex\nfrom \n    tuva.core.patient\n) select distinct\n    cast(substring(e.year_month, 1, 4) as int) AS year_number\n  , e.person_id\n  , e.data_source\n  , datediff(\n        year,\n        p.birth_date,\n        e.first_day_of_month\n        ) as age\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._stg_pqi_member_months as e\ninner join __dbt__cte___stg_pqi_patient as p \n  on e.person_id = p.person_id\n  and p.data_source = e.data_source\nwhere \n  datediff(\n        year,\n        p.birth_date,\n        e.first_day_of_month\n        ) >= 18", "relation_name": "tuva.ahrq_measures._int_pqi_01_denom"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.167287Z", "completed_at": "2025-02-25T21:26:19.175805Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.182706Z", "completed_at": "2025-02-25T21:26:19.182711Z"}], "thread_id": "Thread-2", "execution_time": 0.016150712966918945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ahrq_measures__int_pqi_03_denom", "compiled": true, "compiled_code": "\n\nwith __dbt__cte___stg_pqi_patient as (\n\n\nselect \n    data_source\n  , birth_date\n  , person_id\n  , sex\nfrom \n    tuva.core.patient\n) select distinct\n    cast(substring(e.year_month, 1, 4) as int) AS year_number\n  , e.person_id\n  , e.data_source\n  , datediff(\n        year,\n        p.birth_date,\n        e.first_day_of_month\n        ) as age\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._stg_pqi_member_months as e\ninner join __dbt__cte___stg_pqi_patient as p \n  on e.person_id = p.person_id\n  and p.data_source = e.data_source\nwhere \n  datediff(\n        year,\n        p.birth_date,\n        e.first_day_of_month\n        ) >= 18", "relation_name": "tuva.ahrq_measures._int_pqi_03_denom"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.176003Z", "completed_at": "2025-02-25T21:26:19.183840Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.191689Z", "completed_at": "2025-02-25T21:26:19.191694Z"}], "thread_id": "Thread-3", "execution_time": 0.01639699935913086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ahrq_measures__int_pqi_05_denom", "compiled": true, "compiled_code": "\n\nwith __dbt__cte___stg_pqi_patient as (\n\n\nselect \n    data_source\n  , birth_date\n  , person_id\n  , sex\nfrom \n    tuva.core.patient\n) select distinct\n    cast(substring(e.year_month, 1, 4) as int) AS year_number\n  , e.person_id\n  , e.data_source\n  , datediff(\n        year,\n        p.birth_date,\n        e.first_day_of_month\n        ) as age\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._stg_pqi_member_months as e\ninner join __dbt__cte___stg_pqi_patient as p \n  on e.person_id = p.person_id\n  and p.data_source = e.data_source\nwhere \n  datediff(\n        year,\n        p.birth_date,\n        e.first_day_of_month\n        ) >= 40", "relation_name": "tuva.ahrq_measures._int_pqi_05_denom"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.184021Z", "completed_at": "2025-02-25T21:26:19.192823Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.200185Z", "completed_at": "2025-02-25T21:26:19.200191Z"}], "thread_id": "Thread-2", "execution_time": 0.016846895217895508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ahrq_measures__int_pqi_07_denom", "compiled": true, "compiled_code": "\n\nwith __dbt__cte___stg_pqi_patient as (\n\n\nselect \n    data_source\n  , birth_date\n  , person_id\n  , sex\nfrom \n    tuva.core.patient\n) select distinct\n    cast(substring(e.year_month, 1, 4) as int) AS year_number\n  , e.person_id\n  , e.data_source\n  , datediff(\n        year,\n        p.birth_date,\n        e.first_day_of_month\n        ) as age\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._stg_pqi_member_months as e\ninner join __dbt__cte___stg_pqi_patient as p \n  on e.person_id = p.person_id\n  and p.data_source = e.data_source\nwhere \n  datediff(\n        year,\n        p.birth_date,\n        e.first_day_of_month\n        ) >= 18", "relation_name": "tuva.ahrq_measures._int_pqi_07_denom"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.193015Z", "completed_at": "2025-02-25T21:26:19.204178Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.204792Z", "completed_at": "2025-02-25T21:26:19.204796Z"}], "thread_id": "Thread-3", "execution_time": 0.012445926666259766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ahrq_measures__int_pqi_08_denom", "compiled": true, "compiled_code": "\n\nwith __dbt__cte___stg_pqi_patient as (\n\n\nselect \n    data_source\n  , birth_date\n  , person_id\n  , sex\nfrom \n    tuva.core.patient\n) select distinct\n    cast(substring(e.year_month, 1, 4) as int) AS year_number\n  , e.person_id\n  , e.data_source\n  , datediff(\n        year,\n        p.birth_date,\n        e.first_day_of_month\n        ) as age\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._stg_pqi_member_months as e\ninner join __dbt__cte___stg_pqi_patient as p \n  on e.person_id = p.person_id\n  and p.data_source = e.data_source\nwhere \n  datediff(\n        year,\n        p.birth_date,\n        e.first_day_of_month\n        ) >= 18", "relation_name": "tuva.ahrq_measures._int_pqi_08_denom"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.205212Z", "completed_at": "2025-02-25T21:26:19.218403Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.221214Z", "completed_at": "2025-02-25T21:26:19.221220Z"}], "thread_id": "Thread-2", "execution_time": 0.017336130142211914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ahrq_measures__int_pqi_11_denom", "compiled": true, "compiled_code": "\n\nwith __dbt__cte___stg_pqi_patient as (\n\n\nselect \n    data_source\n  , birth_date\n  , person_id\n  , sex\nfrom \n    tuva.core.patient\n) select distinct\n    cast(substring(e.year_month, 1, 4) as int) AS year_number\n  , e.person_id\n  , e.data_source\n  , datediff(\n        year,\n        p.birth_date,\n        e.first_day_of_month\n        ) as age\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._stg_pqi_member_months as e\ninner join __dbt__cte___stg_pqi_patient as p \n  on e.person_id = p.person_id\n  and p.data_source = e.data_source\nwhere \n  datediff(\n        year,\n        p.birth_date,\n        e.first_day_of_month\n        ) >= 18", "relation_name": "tuva.ahrq_measures._int_pqi_11_denom"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.213139Z", "completed_at": "2025-02-25T21:26:19.228724Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.229472Z", "completed_at": "2025-02-25T21:26:19.229476Z"}], "thread_id": "Thread-3", "execution_time": 0.016942739486694336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ahrq_measures__int_pqi_12_denom", "compiled": true, "compiled_code": "\n\nwith __dbt__cte___stg_pqi_patient as (\n\n\nselect \n    data_source\n  , birth_date\n  , person_id\n  , sex\nfrom \n    tuva.core.patient\n) select distinct\n    cast(substring(e.year_month, 1, 4) as int) AS year_number\n  , e.person_id\n  , e.data_source\n  , datediff(\n        year,\n        p.birth_date,\n        e.first_day_of_month\n        ) as age\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._stg_pqi_member_months as e\ninner join __dbt__cte___stg_pqi_patient as p \n  on e.person_id = p.person_id\n  and p.data_source = e.data_source\nwhere \n  datediff(\n        year,\n        p.birth_date,\n        e.first_day_of_month\n        ) >= 18", "relation_name": "tuva.ahrq_measures._int_pqi_12_denom"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.222423Z", "completed_at": "2025-02-25T21:26:19.230988Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.238926Z", "completed_at": "2025-02-25T21:26:19.238931Z"}], "thread_id": "Thread-2", "execution_time": 0.017023086547851562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ahrq_measures__int_pqi_14_denom", "compiled": true, "compiled_code": "\n\nwith __dbt__cte___stg_pqi_patient as (\n\n\nselect \n    data_source\n  , birth_date\n  , person_id\n  , sex\nfrom \n    tuva.core.patient\n) select distinct\n    cast(substring(e.year_month, 1, 4) as int) AS year_number\n  , e.person_id\n  , e.data_source\n  , datediff(\n        year,\n        p.birth_date,\n        e.first_day_of_month\n        ) as age\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._stg_pqi_member_months as e\ninner join __dbt__cte___stg_pqi_patient as p \n  on e.person_id = p.person_id\n  and p.data_source = e.data_source\nwhere \n  datediff(\n        year,\n        p.birth_date,\n        e.first_day_of_month\n        ) >= 18", "relation_name": "tuva.ahrq_measures._int_pqi_14_denom"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.231205Z", "completed_at": "2025-02-25T21:26:19.240107Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.247260Z", "completed_at": "2025-02-25T21:26:19.247266Z"}], "thread_id": "Thread-3", "execution_time": 0.016887903213500977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ahrq_measures__int_pqi_15_denom", "compiled": true, "compiled_code": "\n\nwith __dbt__cte___stg_pqi_patient as (\n\n\nselect \n    data_source\n  , birth_date\n  , person_id\n  , sex\nfrom \n    tuva.core.patient\n) select distinct\n    cast(substring(e.year_month, 1, 4) as int) AS year_number\n  , e.person_id\n  , e.data_source\n  , datediff(\n        year,\n        p.birth_date,\n        e.first_day_of_month\n        ) as age\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._stg_pqi_member_months as e\ninner join __dbt__cte___stg_pqi_patient as p \n  on e.person_id = p.person_id\n  and p.data_source = e.data_source\nwhere \n  datediff(\n        year,\n        p.birth_date,\n        e.first_day_of_month\n        ) >= 18\n  and\n  datediff(\n        year,\n        p.birth_date,\n        e.first_day_of_month\n        ) <= 39", "relation_name": "tuva.ahrq_measures._int_pqi_15_denom"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.240290Z", "completed_at": "2025-02-25T21:26:19.254281Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.256523Z", "completed_at": "2025-02-25T21:26:19.256527Z"}], "thread_id": "Thread-2", "execution_time": 0.01691126823425293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ahrq_measures__int_pqi_16_denom", "compiled": true, "compiled_code": "\n\nwith __dbt__cte___stg_pqi_patient as (\n\n\nselect \n    data_source\n  , birth_date\n  , person_id\n  , sex\nfrom \n    tuva.core.patient\n) select distinct\n    cast(substring(e.year_month, 1, 4) as int) AS year_number\n  , e.person_id\n  , e.data_source\n  , datediff(\n        year,\n        p.birth_date,\n        e.first_day_of_month\n        ) as age\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._stg_pqi_member_months as e\ninner join __dbt__cte___stg_pqi_patient as p \n  on e.person_id = p.person_id\n  and p.data_source = e.data_source\nwhere \n  datediff(\n        year,\n        p.birth_date,\n        e.first_day_of_month\n        ) >= 18", "relation_name": "tuva.ahrq_measures._int_pqi_16_denom"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.248472Z", "completed_at": "2025-02-25T21:26:19.261546Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.261785Z", "completed_at": "2025-02-25T21:26:19.261790Z"}], "thread_id": "Thread-3", "execution_time": 0.013837099075317383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.core__stg_claims_pharmacy_claim", "compiled": true, "compiled_code": "\n\n-- *************************************************\n-- This dbt model creates the pharmacy_claim\n-- table in core.\n-- *************************************************\n\nselect\n    cast(pharm.claim_id as TEXT) || '-' || cast(pharm.claim_line_number as TEXT) || '-' || cast(pharm.data_source as TEXT) as pharmacy_claim_id\n       , cast(pharm.claim_id as TEXT ) as claim_id\n       , cast(pharm.claim_line_number as integer ) as claim_line_number\n       , cast(pharm.person_id as TEXT ) as person_id\n       , cast(pharm.member_id as TEXT ) as member_id\n       , cast(pharm.payer as TEXT ) as payer\n       , pharm.plan\n       , cast(pharm.prescribing_provider_id as TEXT ) as prescribing_provider_id\n       , cast(pharm.prescribing_provider_name as TEXT ) as prescribing_provider_name\n       , cast(pharm.dispensing_provider_id as TEXT ) as dispensing_provider_id\n       , cast(pharm.dispensing_provider_name as TEXT ) as dispensing_provider_name\n       , cast(pharm.dispensing_date as date ) as dispensing_date\n       , cast(pharm.ndc_code as TEXT ) as ndc_code\n       , cast(pharm.ndc_description as TEXT ) as ndc_description\n       , cast(pharm.quantity as integer ) as quantity\n       , cast(pharm.days_supply as integer ) as days_supply\n       , cast(pharm.refills as integer ) as refills\n       , cast(pharm.paid_date as date ) as paid_date\n       , cast(pharm.paid_amount as numeric(28,6)) as paid_amount\n       , cast(pharm.allowed_amount as numeric(28,6) ) as allowed_amount\n       , cast(pharm.charge_amount as numeric(28,6) ) as charge_amount\n       , cast(pharm.coinsurance_amount as numeric(28,6) ) as coinsurance_amount\n       , cast(pharm.copayment_amount as numeric(28,6) ) as copayment_amount\n       , cast(pharm.deductible_amount as numeric(28,6) ) as deductible_amount\n       , cast(pharm.in_network_flag as int ) as in_network_flag\n       , cast(\n       case\n           when enroll.claim_id is not null then 1\n              else 0\n       end as int) as enrollment_flag\n       , enroll.member_month_key\n       , cast(pharm.data_source as TEXT ) as data_source\n       , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.normalized_input_pharmacy_claim  pharm\nleft join tuva.claims_preprocessing.flag_rx_claims_with_enrollment as enroll\n  on pharm.claim_id = enroll.claim_id\n  and pharm.claim_line_number = enroll.claim_line_number\n  and pharm.person_id = enroll.person_id\n  and pharm.payer = enroll.payer\n  and pharm.plan = enroll.plan\n  and pharm.data_source = enroll.data_source", "relation_name": "tuva.core._stg_claims_pharmacy_claim"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.257689Z", "completed_at": "2025-02-25T21:26:19.268064Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.268472Z", "completed_at": "2025-02-25T21:26:19.268480Z"}], "thread_id": "Thread-2", "execution_time": 0.011294126510620117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.mart_review__enrollment_change", "compiled": true, "compiled_code": "\n\nWITH RankedMonths AS (\n    SELECT\n        person_id,\n        year_month,\n        data_source,\n        lag(year_month_date, 1) over (partition by person_id, data_source order by year_month_date) as prev_year_month,\n        lead(year_month_date, 1) over (partition by person_id, data_source order by year_month_date) as next_year_month,\n        year_month_date\n    FROM tuva.data_quality.mart_review__stg_member_month\n),\nChanges AS (\n SELECT\n    person_id,\n    data_source,\n    year_month_date as change_month,\n    case\n        when prev_year_month is null\n            or \n\n    dateadd(\n        month,\n        -1,\n        year_month_date\n        )\n\n != prev_year_month\n        then 'added'\n    end as change_type\nFROM RankedMonths\nunion all\nSELECT\n    person_id,\n    data_source,\n    \n\n    dateadd(\n        month,\n        1,\n        year_month_date\n        )\n\n as change_month,\n    case\n        when next_year_month is null\n            or \n\n    dateadd(\n        month,\n        1,\n        year_month_date\n        )\n\n != next_year_month\n        then 'removed'\n    end as change_type\nFROM RankedMonths\n\n),\nFinal AS (\n    SELECT\n       person_id || '|' || change_month as membermonthkey,\n        data_source,\n        person_id,\n        change_month,\n        change_type\n    FROM Changes\n    WHERE change_type IS NOT NULL\n),\nResult AS (\n    SELECT\n        data_source,\n        change_month,\n        change_type,\n        count(*) as member_count\n    FROM Final\n    GROUP BY data_source\n    , change_month\n    , change_type\n)\n\n\nSELECT * , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nFROM Result", "relation_name": "tuva.data_quality.mart_review__enrollment_change"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.263192Z", "completed_at": "2025-02-25T21:26:19.273192Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.273468Z", "completed_at": "2025-02-25T21:26:19.273474Z"}], "thread_id": "Thread-3", "execution_time": 0.010850906372070312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.encounters__stg_eligibility", "compiled": true, "compiled_code": "\n\nselect\n      e.person_id\n    , e.birth_date\n    , e.gender\n    , e.race\n    , d.patient_data_source_id\n    , row_number() over (partition by d.patient_data_source_id order by e.enrollment_start_date desc) patient_row_num\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.normalized_input_eligibility e\ninner join tuva.claims_preprocessing.encounters__patient_data_source_id d on e.person_id = d.person_id\nand\ne.data_source = d.data_source", "relation_name": "tuva.claims_preprocessing.encounters__stg_eligibility"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.269731Z", "completed_at": "2025-02-25T21:26:19.274669Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.275102Z", "completed_at": "2025-02-25T21:26:19.275106Z"}], "thread_id": "Thread-2", "execution_time": 0.0060040950775146484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__acute_inpatient_professional", "compiled": true, "compiled_code": "\n\nselect distinct\n    claim_id\n  , claim_line_number\n  , claim_line_id\n  , 'inpatient' as service_category_1\n  , 'acute inpatient' as service_category_2\n  , case \n      when hcpcs_code in ('59400', '59409', '59410', '59610', '59612', '59614') then 'l/d - vaginal delivery'\n      when hcpcs_code in ('59510', '59514', '59515', '59618', '59620', '59622') then 'l/d - cesarean delivery'\n      else 'acute inpatient - other'\n    end as service_category_3\n  , '_int_acute_inpatient_professional' as source_model_name\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim\nwhere \n  claim_type = 'professional'\n  and place_of_service_code = '21'", "relation_name": "tuva.claims_preprocessing._int_acute_inpatient_professional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.275494Z", "completed_at": "2025-02-25T21:26:19.283678Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.283924Z", "completed_at": "2025-02-25T21:26:19.283931Z"}], "thread_id": "Thread-3", "execution_time": 0.009582996368408203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__ambulance_professional", "compiled": true, "compiled_code": "\n\nselect distinct\n    claim_id\n  , claim_line_number\n  , claim_line_id\n  , 'ancillary' as service_category_1\n  , 'ambulance' as service_category_2\n  , 'ambulance' as service_category_3\n  , '_int_ambulance_professional' as source_model_name\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim\nwhere \n  claim_type = 'professional'\n  and (\n    hcpcs_code between 'A0425' and 'A0436'\n    or place_of_service_code in ('41', '42')\n  )", "relation_name": "tuva.claims_preprocessing._int_ambulance_professional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.280126Z", "completed_at": "2025-02-25T21:26:19.285105Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.289740Z", "completed_at": "2025-02-25T21:26:19.289747Z"}], "thread_id": "Thread-2", "execution_time": 0.010383129119873047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__home_health_institutional", "compiled": true, "compiled_code": "\n\nselect distinct \n  claim_id\n  , 'outpatient' as service_category_1\n, 'home health' as service_category_2\n, 'home health' as service_category_3\n, '_int_home_health_institutional' as source_model_name\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim\nwhere claim_type = 'institutional'\n  and substring(bill_type_code, 1, 2) in ('31','32','33')", "relation_name": "tuva.claims_preprocessing._int_home_health_institutional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.285289Z", "completed_at": "2025-02-25T21:26:19.295309Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.295635Z", "completed_at": "2025-02-25T21:26:19.295643Z"}], "thread_id": "Thread-3", "execution_time": 0.011059999465942383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__inpatient_psychiatric_professional", "compiled": true, "compiled_code": "\n\nselect distinct \nclaim_id\n, claim_line_number\n, claim_line_id\n, 'inpatient' as service_category_1\n, 'inpatient psychiatric' as service_category_2\n, 'inpatient psychiatric' as service_category_3\n,'_int_inpatient_psychiatric_professional' as source_model_name\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim\nwhere claim_type = 'professional'\n  and place_of_service_code in ('51','55','56')", "relation_name": "tuva.claims_preprocessing._int_inpatient_psychiatric_professional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.291049Z", "completed_at": "2025-02-25T21:26:19.300710Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.300970Z", "completed_at": "2025-02-25T21:26:19.300975Z"}], "thread_id": "Thread-2", "execution_time": 0.010566949844360352, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__inpatient_rehab_professional", "compiled": true, "compiled_code": "\n\nselect distinct\n  claim_id\n, claim_line_number\n, claim_line_id\n, 'inpatient' as service_category_1\n, 'inpatient rehabilitation' as service_category_2\n, 'inpatient rehabilitation' as service_category_3\n,'_int_inpatient_rehab_professional' as source_model_name\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim\nwhere claim_type = 'professional'\n  and place_of_service_code in ('61')", "relation_name": "tuva.claims_preprocessing._int_inpatient_rehab_professional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.296911Z", "completed_at": "2025-02-25T21:26:19.301901Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.302336Z", "completed_at": "2025-02-25T21:26:19.302340Z"}], "thread_id": "Thread-3", "execution_time": 0.006041765213012695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__inpatient_skilled_nursing_institutional", "compiled": true, "compiled_code": "\n\nselect distinct \n  claim_id\n, 'inpatient' as service_category_1\n, 'skilled nursing' as service_category_2\n, 'skilled nursing' as service_category_3\n, '_int_inpatient_skilled_nursing_institutional' as source_model_name\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim\nwhere claim_type = 'institutional'\n  and substring(bill_type_code, 1, 2) in ('21','22')", "relation_name": "tuva.claims_preprocessing._int_inpatient_skilled_nursing_institutional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.302701Z", "completed_at": "2025-02-25T21:26:19.311517Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.311795Z", "completed_at": "2025-02-25T21:26:19.311803Z"}], "thread_id": "Thread-2", "execution_time": 0.01027679443359375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__observation_institutional", "compiled": true, "compiled_code": "\n\nselect distinct \n   med.claim_id\n,  med.claim_line_number\n, 'outpatient' as service_category_1\n, 'observation' as service_category_2\n, 'observation' as service_category_3\n, '_int_observation_institutional' as source_model_name\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim med\nwhere claim_type = 'institutional'\nand (revenue_center_code in ('0762')\nor hcpcs_code in ('G0378','G0379')\n)", "relation_name": "tuva.claims_preprocessing._int_observation_institutional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.307146Z", "completed_at": "2025-02-25T21:26:19.312560Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.313047Z", "completed_at": "2025-02-25T21:26:19.313051Z"}], "thread_id": "Thread-3", "execution_time": 0.0064640045166015625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__outpatient_psychiatric_professional", "compiled": true, "compiled_code": "\n\nselect distinct\n  claim_id\n, claim_line_number\n, claim_line_id\n, 'outpatient' as service_category_1    \n, 'outpatient psychiatric' as service_category_2\n, 'outpatient psychiatric' as service_category_3\n, '_int_outpatient_psychiatric_professional' as source_model_name\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim\nwhere claim_type = 'professional'\n  and place_of_service_code in ('52','53','57','58')", "relation_name": "tuva.claims_preprocessing._int_outpatient_psychiatric_professional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.313968Z", "completed_at": "2025-02-25T21:26:19.324423Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.324678Z", "completed_at": "2025-02-25T21:26:19.324686Z"}], "thread_id": "Thread-2", "execution_time": 0.011995077133178711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__outpatient_rehab_professional", "compiled": true, "compiled_code": "\n\nselect distinct\n  claim_id\n, claim_line_number\n, claim_line_id\n, 'outpatient' as service_category_1    \n, 'outpatient rehabilitation' as service_category_2\n, 'outpatient rehabilitation' as service_category_3\n,'_int_outpatient_rehab_professional' as source_model_name\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim\nwhere claim_type = 'professional'\n  and place_of_service_code in ('62')", "relation_name": "tuva.claims_preprocessing._int_outpatient_rehab_professional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.319212Z", "completed_at": "2025-02-25T21:26:19.325671Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.326115Z", "completed_at": "2025-02-25T21:26:19.326120Z"}], "thread_id": "Thread-3", "execution_time": 0.007508993148803711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__stg_inpatient_institutional", "compiled": true, "compiled_code": "\n\nwith drg_requirement as (\n  select distinct\n      mc.claim_id\n  from tuva.claims_preprocessing.service_category__stg_medical_claim as mc\n  left join tuva.terminology.ms_drg as msdrg\n    on mc.drg_code_type = 'ms-drg'\n    and mc.drg_code = msdrg.ms_drg_code\n  left join tuva.terminology.apr_drg as aprdrg\n    on mc.drg_code_type = 'apr-drg'\n    and mc.drg_code = aprdrg.apr_drg_code\n  where mc.claim_type = 'institutional'\n    and (msdrg.ms_drg_code is not null\n      OR aprdrg.apr_drg_code is not null\n    )\n)\n, bill_type_requirement as (\n  select distinct\n      claim_id\n  from tuva.claims_preprocessing.service_category__stg_medical_claim\n  where claim_type = 'institutional'\n    and substring(bill_type_code, 1, 2) in (\n      '11'  -- hospital inpatient \n    , '12'  -- hospital inpatient \n    , '21'  -- SNF inpatient\n    , '82'  -- inpatient hospice\n    )\n)\n\nselect distinct\n    a.claim_id\n  , 'inpatient' as service_type\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim as a\ninner join bill_type_requirement as d\n  on a.claim_id = d.claim_id\n\n\nunion distinct\n\n\nselect distinct\n    a.claim_id\n  , 'inpatient' as service_type\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim as a\ninner join drg_requirement as c\n  on a.claim_id = c.claim_id", "relation_name": "tuva.claims_preprocessing.service_category__stg_inpatient_institutional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.326492Z", "completed_at": "2025-02-25T21:26:19.337181Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.340060Z", "completed_at": "2025-02-25T21:26:19.340069Z"}], "thread_id": "Thread-2", "execution_time": 0.014735937118530273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__stg_professional", "compiled": true, "compiled_code": "\n\nselect  distinct \n    a.claim_id\n  , a.claim_line_number\n  , a.claim_line_id as claim_line_id\n  , 'professional' as service_type\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim a\nwhere a.claim_type = 'professional'", "relation_name": "tuva.claims_preprocessing.service_category__stg_professional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.331708Z", "completed_at": "2025-02-25T21:26:19.340497Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.341264Z", "completed_at": "2025-02-25T21:26:19.341268Z"}], "thread_id": "Thread-3", "execution_time": 0.010150909423828125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__urgent_care_institutional", "compiled": true, "compiled_code": "\n\nwith multiple_sources as (\nselect distinct \n  a.claim_id\n, 'urgent care' as service_category_2\n, 'urgent care' as service_category_3\n,'_int_urgent_care_institutional' as source_model_name\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim a\nwhere claim_type = 'institutional'\n  and revenue_center_code = '0456'\n  and substring(bill_type_code, 1, 2) in ('13','71','73')\n \nunion all\n\nselect distinct \n  a.claim_id\n, 'urgent care' as service_category_2\n, 'urgent care' as service_category_3\n,'_int_urgent_care_institutional' as source_model_name\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim a\nwhere claim_type = 'institutional'\n  and hcpcs_code in ('S9088','99051','S9083')\n)\n\nselect distinct \nclaim_id\n,'outpatient' as service_category_1    \n,service_category_2\n,service_category_3\n,source_model_name\n,tuva_last_run\nfrom multiple_sources", "relation_name": "tuva.claims_preprocessing._int_urgent_care_institutional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.343571Z", "completed_at": "2025-02-25T21:26:19.358783Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.359011Z", "completed_at": "2025-02-25T21:26:19.359018Z"}], "thread_id": "Thread-2", "execution_time": 0.017056941986083984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__urgent_care_professional", "compiled": true, "compiled_code": "\n\nwith multiple_source as (\nselect distinct\n    claim_id\n    , claim_line_number\n    , claim_line_id\n, 'urgent care' as service_category_2\n, 'urgent care' as service_category_3\n,'_int_urgent_care_professional' as source_model_name\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim\nwhere claim_type = 'professional'\n  and place_of_service_code in ('20')\n\nunion all\n\nselect distinct\n    claim_id\n    , claim_line_number\n    , claim_line_id\n, 'urgent care' as service_category_2\n, 'urgent care' as service_category_3\n,'_int_urgent_care_professional' as source_model_name\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim\nwhere claim_type = 'professional'\nand hcpcs_code in ('S9088','99051','S9083')\n)\n\nselect distinct \nclaim_id\n,claim_line_number\n,claim_line_id\n,'outpatient' as service_category_1    \n,service_category_2\n,service_category_3\n,source_model_name\n,tuva_last_run\nfrom multiple_source", "relation_name": "tuva.claims_preprocessing._int_urgent_care_professional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.349418Z", "completed_at": "2025-02-25T21:26:19.362862Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.363100Z", "completed_at": "2025-02-25T21:26:19.363106Z"}], "thread_id": "Thread-3", "execution_time": 0.01988983154296875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ahrq_measures__pqi_denom_long", "compiled": true, "compiled_code": "\n\nselect\n    d.year_number\n  , d.person_id\n  , d.data_source\n  , '01' as pqi_number\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._int_pqi_01_denom as d\n\nunion all\n\nselect\n    d.year_number\n  , d.person_id\n  , d.data_source\n  , '03' as pqi_number\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._int_pqi_03_denom as d\n\nunion all\n\nselect\n    d.year_number\n  , d.person_id\n  , d.data_source\n  , '05' as pqi_number\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._int_pqi_05_denom as d\n\nunion all\n\nselect\n    d.year_number\n  , d.person_id\n  , d.data_source\n  , '07' as pqi_number\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._int_pqi_07_denom as d\n\nunion all\n\nselect\n    d.year_number\n  , d.person_id\n  , d.data_source\n  , '08' as pqi_number\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._int_pqi_08_denom as d\n\nunion all\n\nselect\n    d.year_number\n  , d.person_id\n  , d.data_source\n  , '11' as pqi_number\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._int_pqi_11_denom as d\n\nunion all\n\nselect\n    d.year_number\n  , d.person_id\n  , d.data_source\n  , '12' as pqi_number\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._int_pqi_12_denom as d\n\nunion all\n\nselect\n    d.year_number\n  , d.person_id\n  , d.data_source\n  , '14' as pqi_number\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._int_pqi_14_denom as d\n\nunion all\n\nselect\n    d.year_number\n  , d.person_id\n  , d.data_source\n  , '15' as pqi_number\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._int_pqi_15_denom as d\n\nunion all\n\nselect\n    d.year_number\n  , d.person_id\n  , d.data_source\n  , '16' as pqi_number\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._int_pqi_16_denom as d", "relation_name": "tuva.ahrq_measures.pqi_denom_long"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.360050Z", "completed_at": "2025-02-25T21:26:19.363739Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.364165Z", "completed_at": "2025-02-25T21:26:19.364168Z"}], "thread_id": "Thread-2", "execution_time": 0.004580974578857422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.core__pharmacy_claim", "compiled": true, "compiled_code": "\n\nselect * from tuva.core._stg_claims_pharmacy_claim", "relation_name": "tuva.core.pharmacy_claim"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.365070Z", "completed_at": "2025-02-25T21:26:19.373017Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.373264Z", "completed_at": "2025-02-25T21:26:19.373271Z"}], "thread_id": "Thread-3", "execution_time": 0.009427309036254883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.encounters__stg_inpatient_institutional", "compiled": true, "compiled_code": "\n\nselect  \n  claim_id\n, service_type\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_inpatient_institutional a", "relation_name": "tuva.claims_preprocessing.encounters__stg_inpatient_institutional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.369206Z", "completed_at": "2025-02-25T21:26:19.373986Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.374419Z", "completed_at": "2025-02-25T21:26:19.374423Z"}], "thread_id": "Thread-2", "execution_time": 0.005839824676513672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__acute_inpatient_institutional_maternity", "compiled": true, "compiled_code": "\n\nselect distinct\n    a.claim_id\n  , 'inpatient' as service_category_1\n  , 'acute inpatient' as service_category_2\n  , case \n      when s.drg_code in ('768', '796', '797', '798', '805', '806', '807') then 'l/d - vaginal delivery'\n      when s.drg_code in ('783', '784', '785', '786', '787', '788') then 'l/d - cesarean delivery'\n      when s.drg_code = '795' then 'l/d - newborn'\n      when s.drg_code in ('789', '790', '791', '792', '793', '794') then 'l/d - newborn nicu'\n      when s.revenue_center_code in ('0173', '0174') then 'l/d - newborn nicu'\n      else 'l/d - other'\n    end as service_category_3\n  , '_int_acute_inpatient_institutional_maternity' as source_model_name\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim as s\ninner join tuva.claims_preprocessing.service_category__stg_inpatient_institutional as a\n  on s.claim_id = a.claim_id\ninner join tuva.terminology.ms_drg as m\n  on s.drg_code = m.ms_drg_code\n  and s.drg_code_type = 'ms-drg'\nwhere \n  m.mdc_code in ('MDC 14', 'MDC 15')", "relation_name": "tuva.claims_preprocessing._int_acute_inpatient_institutional_maternity"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.375255Z", "completed_at": "2025-02-25T21:26:19.381527Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.382678Z", "completed_at": "2025-02-25T21:26:19.382686Z"}], "thread_id": "Thread-3", "execution_time": 0.008594036102294922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__acute_inpatient_institutional_med_surg", "compiled": true, "compiled_code": "\n\nselect distinct\n    a.claim_id\n  , 'inpatient' as service_category_1\n  , 'acute inpatient' as service_category_2\n  , case \n      when coalesce(ms.medical_surgical, apr.medical_surgical) = 'M' then 'medical'\n      when coalesce(ms.medical_surgical, apr.medical_surgical) = 'P' then 'surgical'\n      when coalesce(ms.medical_surgical, apr.medical_surgical) = 'surgical' then 'surgical'\n      else 'acute inpatient - other' \n    end as service_category_3\n  , '_int_acute_inpatient_institutional_med_surg' as source_model_name\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim as s\ninner join tuva.claims_preprocessing.service_category__stg_inpatient_institutional as a\n  on s.claim_id = a.claim_id\nleft join tuva.terminology.ms_drg as ms\n  on s.drg_code = ms.ms_drg_code\n  and s.drg_code_type = 'ms-drg'\nleft join tuva.terminology.apr_drg as apr\n  on s.drg_code = apr.apr_drg_code\n  and s.drg_code_type = 'apr-drg'\nwhere\n  ms.ms_drg_code is not null\n  or apr.apr_drg_code is not null", "relation_name": "tuva.claims_preprocessing._int_acute_inpatient_institutional_med_surg"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.383106Z", "completed_at": "2025-02-25T21:26:19.389316Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.393788Z", "completed_at": "2025-02-25T21:26:19.393797Z"}], "thread_id": "Thread-2", "execution_time": 0.013427972793579102, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__acute_inpatient_institutional_other", "compiled": true, "compiled_code": "\n\n\n--simplified by setting lowest priority instead of explicitly doing all the joins\nselect distinct \n  a.claim_id\n  , 'inpatient' as service_category_1\n, 'acute inpatient' as service_category_2\n, 'acute inpatient - other' as service_category_3\n, '_int_acute_inpatient_institutional_other' as source_model_name\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim s\ninner join tuva.claims_preprocessing.service_category__stg_inpatient_institutional a on s.claim_id = a.claim_id", "relation_name": "tuva.claims_preprocessing._int_acute_inpatient_institutional_other"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.389541Z", "completed_at": "2025-02-25T21:26:19.395758Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.400299Z", "completed_at": "2025-02-25T21:26:19.400309Z"}], "thread_id": "Thread-3", "execution_time": 0.011748790740966797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__inpatient_hospice_institutional", "compiled": true, "compiled_code": "\n\nselect distinct \ns.claim_id\n, 'inpatient' as service_category_1\n, 'inpatient hospice' as service_category_2\n, 'inpatient hospice' as service_category_3\n, '_int_inpatient_hospice_institutional' as source_model_name\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim s\ninner join tuva.claims_preprocessing.service_category__stg_inpatient_institutional a on s.claim_id = a.claim_id\nwhere substring(s.bill_type_code, 1, 2) in ('82')", "relation_name": "tuva.claims_preprocessing._int_inpatient_hospice_institutional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.395965Z", "completed_at": "2025-02-25T21:26:19.401921Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.405842Z", "completed_at": "2025-02-25T21:26:19.405849Z"}], "thread_id": "Thread-2", "execution_time": 0.010754108428955078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__inpatient_psychiatric_institutional", "compiled": true, "compiled_code": "\n\nselect distinct \ns.claim_id\n, 'inpatient' as service_category_1\n, 'inpatient psychiatric' as service_category_2\n, 'inpatient psychiatric' as service_category_3\n, '_int_inpatient_psychiatric_institutional' as source_model_name\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim s\ninner join tuva.claims_preprocessing.service_category__stg_inpatient_institutional i on s.claim_id = i.claim_id\nwhere s.primary_taxonomy_code in ('283Q00000X'\n                                  ,'273R00000X')", "relation_name": "tuva.claims_preprocessing._int_inpatient_psychiatric_institutional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.402214Z", "completed_at": "2025-02-25T21:26:19.411780Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.412048Z", "completed_at": "2025-02-25T21:26:19.412054Z"}], "thread_id": "Thread-3", "execution_time": 0.010804891586303711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__inpatient_rehab_institutional", "compiled": true, "compiled_code": "\n\nselect distinct \n  s.claim_id\n, 'inpatient' as service_category_1\n, 'inpatient rehabilitation' as service_category_2\n, 'inpatient rehabilitation' as service_category_3\n, '_int_inpatient_rehab_institutional' as source_model_name\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim s\ninner join tuva.claims_preprocessing.service_category__stg_inpatient_institutional i on s.claim_id = i.claim_id\nwhere s.primary_taxonomy_code in ('283X00000X'\n                                  ,'273Y00000X'\n                                  )", "relation_name": "tuva.claims_preprocessing._int_inpatient_rehab_institutional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.407180Z", "completed_at": "2025-02-25T21:26:19.412972Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.413357Z", "completed_at": "2025-02-25T21:26:19.413360Z"}], "thread_id": "Thread-2", "execution_time": 0.006784915924072266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__inpatient_substance_use_institutional", "compiled": true, "compiled_code": "\n\nselect distinct\n    a.claim_id\n  , 'inpatient' as service_category_1\n  , 'inpatient substance use' as service_category_2\n  , 'inpatient substance use' as service_category_3\n  , '_int_inpatient_substance_use_institutional' as source_model_name\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim as s\ninner join tuva.claims_preprocessing.service_category__stg_inpatient_institutional as a\n  on s.claim_id = a.claim_id\nwhere \n  s.primary_taxonomy_code in (\n      '324500000X'\n    , '261QR0405X'\n    , '101YA0400X'\n  )\n  or s.default_ccsr_category_description_ip in (\n      'MBD026'\n    , 'SYM008'\n    , 'MBD025'\n    , 'SYM009'\n    , 'MBD034'\n  )", "relation_name": "tuva.claims_preprocessing._int_inpatient_substance_use_institutional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.413710Z", "completed_at": "2025-02-25T21:26:19.421257Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.421514Z", "completed_at": "2025-02-25T21:26:19.421521Z"}], "thread_id": "Thread-3", "execution_time": 0.008863210678100586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__stg_outpatient_institutional", "compiled": true, "compiled_code": "\n\nselect distinct \n  a.claim_id\n, 'outpatient' as service_type\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim a\nleft join tuva.claims_preprocessing.service_category__stg_inpatient_institutional i on a.claim_id = i.claim_id\nwhere i.claim_id is null\nand\na.claim_type = 'institutional'", "relation_name": "tuva.claims_preprocessing.service_category__stg_outpatient_institutional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.418020Z", "completed_at": "2025-02-25T21:26:19.422837Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.426544Z", "completed_at": "2025-02-25T21:26:19.426549Z"}], "thread_id": "Thread-2", "execution_time": 0.0090789794921875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.encounters__stg_professional", "compiled": true, "compiled_code": "\n\nselect distinct \n  claim_id\n, claim_line_number\n, claim_line_id\n, service_type\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_professional a", "relation_name": "tuva.claims_preprocessing.encounters__stg_professional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.423037Z", "completed_at": "2025-02-25T21:26:19.427776Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.431674Z", "completed_at": "2025-02-25T21:26:19.431680Z"}], "thread_id": "Thread-3", "execution_time": 0.009536981582641602, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__ambulatory_surgery_professional", "compiled": true, "compiled_code": "\n\nselect distinct\n    med.claim_id\n    , med.claim_line_number\n    , med.claim_line_id\n    , 'outpatient' as service_category_1\n, 'ambulatory surgery center' as service_category_2\n, 'ambulatory surgery center' as service_category_3\n, '_int_ambulatory_surgery_professional' as source_model_name\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim med\ninner join tuva.claims_preprocessing.service_category__stg_professional prof on med.claim_id = prof.claim_id \nand\nmed.claim_line_number = prof.claim_line_number\nwhere med.place_of_service_code in ('24')", "relation_name": "tuva.claims_preprocessing._int_ambulatory_surgery_professional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.427994Z", "completed_at": "2025-02-25T21:26:19.432915Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.436605Z", "completed_at": "2025-02-25T21:26:19.436611Z"}], "thread_id": "Thread-2", "execution_time": 0.009425163269042969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__dialysis_professional", "compiled": true, "compiled_code": "\n\nselect distinct\n    med.claim_id\n  , med.claim_line_number\n  , med.claim_line_id\n  , 'outpatient' as service_category_1    \n  , 'dialysis' as service_category_2\n  , 'dialysis' as service_category_3\n  , '_int_dialysis_professional' as source_model_name\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim as med\ninner join tuva.claims_preprocessing.service_category__stg_professional as prof\n  on med.claim_id = prof.claim_id\n  and med.claim_line_number = prof.claim_line_number\nwhere \n  med.place_of_service_code in ('65')\n  or med.ccs_category in ('91', '58', '57')", "relation_name": "tuva.claims_preprocessing._int_dialysis_professional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.433126Z", "completed_at": "2025-02-25T21:26:19.442453Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.442706Z", "completed_at": "2025-02-25T21:26:19.442711Z"}], "thread_id": "Thread-3", "execution_time": 0.010324954986572266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__dme_professional", "compiled": true, "compiled_code": "\n\nselect distinct\n      med.claim_id\n    , med.claim_line_number\n    , med.claim_line_id\n, 'ancillary' as service_category_1\n, 'durable medical equipment' as service_category_2\n, 'durable medical equipment' as service_category_3\n, '_int_dme_professional' as source_model_name\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim med\ninner join tuva.claims_preprocessing.service_category__stg_professional prof on med.claim_id = prof.claim_id \nand\nmed.claim_line_number = prof.claim_line_number\nwhere med.ccs_category = '243'", "relation_name": "tuva.claims_preprocessing._int_dme_professional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.437772Z", "completed_at": "2025-02-25T21:26:19.443753Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.444179Z", "completed_at": "2025-02-25T21:26:19.444184Z"}], "thread_id": "Thread-2", "execution_time": 0.006916999816894531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__emergency_department_professional", "compiled": true, "compiled_code": "\n\nselect distinct\n  med.claim_id\n, med.claim_line_number\n, med.claim_line_id\n, 'outpatient' as service_category_1\n, 'emergency department' as service_category_2\n, 'emergency department' as service_category_3\n, '_int_emergency_department_professional' as source_model_name\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim med\ninner join tuva.claims_preprocessing.service_category__stg_professional prof on med.claim_id = prof.claim_id \nand\nmed.claim_line_number = prof.claim_line_number\nwhere place_of_service_code = '23'\nOR\nhcpcs_code in ('99281','99282','99283','99284','99285','G0380','G0381','G0382','G0383','G0384')", "relation_name": "tuva.claims_preprocessing._int_emergency_department_professional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.444541Z", "completed_at": "2025-02-25T21:26:19.452182Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.452423Z", "completed_at": "2025-02-25T21:26:19.452428Z"}], "thread_id": "Thread-3", "execution_time": 0.009005069732666016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__home_health_professional", "compiled": true, "compiled_code": "\n\nselect distinct\nmed.claim_id\n, med.claim_line_number\n, med.claim_line_id\n, 'outpatient' as service_category_1\n, 'home health' as service_category_2\n, 'home health' as service_category_3\n, '_int_home_health_professional' as source_model_name\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim med\ninner join tuva.claims_preprocessing.service_category__stg_professional prof on med.claim_id = prof.claim_id \nand\nmed.claim_line_number = prof.claim_line_number\nwhere med.place_of_service_code in ('12')", "relation_name": "tuva.claims_preprocessing._int_home_health_professional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.448782Z", "completed_at": "2025-02-25T21:26:19.453071Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.453512Z", "completed_at": "2025-02-25T21:26:19.453515Z"}], "thread_id": "Thread-2", "execution_time": 0.005239009857177734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__inpatient_hospice_professional", "compiled": true, "compiled_code": "\n\nselect distinct\nmed.claim_id\n, med.claim_line_number\n, med.claim_line_id\n, 'inpatient' as service_category_1\n, 'inpatient hospice' as service_category_2\n, 'inpatient hospice' as service_category_3\n,'_int_inpatient_hospice_professional' as source_model_name\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim med\ninner join tuva.claims_preprocessing.service_category__stg_professional prof on med.claim_id = prof.claim_id \nand\nmed.claim_line_number = prof.claim_line_number\nwhere place_of_service_code in ('34')", "relation_name": "tuva.claims_preprocessing._int_inpatient_hospice_professional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.454340Z", "completed_at": "2025-02-25T21:26:19.462047Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.462273Z", "completed_at": "2025-02-25T21:26:19.462279Z"}], "thread_id": "Thread-3", "execution_time": 0.009090900421142578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__lab_professional", "compiled": true, "compiled_code": "\n\nselect distinct\n  med.claim_id\n, med.claim_line_number\n, med.claim_line_id\n, 'ancillary' as service_category_1  \n, 'lab' as service_category_2\n, 'lab' as service_category_3\n,'_int_lab_professional' as source_model_name\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim med\ninner join tuva.claims_preprocessing.service_category__stg_professional prof on med.claim_id = prof.claim_id \nand\nmed.claim_line_number = prof.claim_line_number\nwhere place_of_service_code = '81'\nOR\nmed.ccs_category in ('233' -- lab\n,'235' --other lab\n,'234' --pathology\n)", "relation_name": "tuva.claims_preprocessing._int_lab_professional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.458525Z", "completed_at": "2025-02-25T21:26:19.463161Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.463563Z", "completed_at": "2025-02-25T21:26:19.463567Z"}], "thread_id": "Thread-2", "execution_time": 0.005613088607788086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__observation_professional", "compiled": true, "compiled_code": "\n\nselect distinct\n    med.claim_id\n  , med.claim_line_number\n  , med.claim_line_id\n  , 'outpatient' as service_category_1\n  , 'observation' as service_category_2\n  , 'observation' as service_category_3\n  , '_int_observation_professional' as source_model_name\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim as med\ninner join tuva.claims_preprocessing.service_category__stg_professional as prof\n  on med.claim_id = prof.claim_id\n  and med.claim_line_number = prof.claim_line_number\nwhere \n  med.hcpcs_code in ('G0378', 'G0379')", "relation_name": "tuva.claims_preprocessing._int_observation_professional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.463930Z", "completed_at": "2025-02-25T21:26:19.472816Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.473038Z", "completed_at": "2025-02-25T21:26:19.473043Z"}], "thread_id": "Thread-3", "execution_time": 0.010187864303588867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__outpatient_hospice_professional", "compiled": true, "compiled_code": "\n\nselect distinct \n  med.claim_id\n, med.claim_line_number\n, med.claim_line_id\n, 'outpatient' as service_category_1    \n, 'outpatient hospice' as service_category_2\n, 'outpatient hospice' as service_category_3\n, '_int_outpatient_hospice_professional' as source_model_name\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim med\ninner join tuva.claims_preprocessing.service_category__stg_professional prof on med.claim_id = prof.claim_id \nand\nmed.claim_line_number = prof.claim_line_number\nwhere \nmed.hcpcs_code in ('Q5001','Q5002','Q5003','Q5009')", "relation_name": "tuva.claims_preprocessing._int_outpatient_hospice_professional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.469337Z", "completed_at": "2025-02-25T21:26:19.473920Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.474320Z", "completed_at": "2025-02-25T21:26:19.474324Z"}], "thread_id": "Thread-2", "execution_time": 0.0055310726165771484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__outpatient_hospital_or_clinic_professional", "compiled": true, "compiled_code": "\n\nselect distinct\n    med.claim_id\n  , med.claim_line_number\n  , med.claim_line_id\n  , 'outpatient' as service_category_1\n  , 'outpatient hospital or clinic' as service_category_2\n  , 'outpatient hospital or clinic' as service_category_3\n  , '_int_outpatient_hospital_or_clinic_professional' as source_model_name\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim as med\ninner join tuva.claims_preprocessing.service_category__stg_professional as prof\n  on med.claim_id = prof.claim_id\n  and med.claim_line_number = prof.claim_line_number\nwhere \n  med.place_of_service_code in ('15', '17', '19', '22', '49', '50', '60', '71', '72')", "relation_name": "tuva.claims_preprocessing._int_outpatient_hospital_or_clinic_professional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.474684Z", "completed_at": "2025-02-25T21:26:19.482032Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.482244Z", "completed_at": "2025-02-25T21:26:19.482248Z"}], "thread_id": "Thread-3", "execution_time": 0.00861215591430664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__outpatient_physical_therapy_professional", "compiled": true, "compiled_code": "\n\nselect distinct \n  med.claim_id\n, med.claim_line_number\n, med.claim_line_id\n, 'outpatient' as service_category_1    \n, 'outpatient pt/ot/st' as service_category_2\n, 'outpatient pt/ot/st' as service_category_3\n, 'service_category__outpatient_physical_therapy_professional' as source_model_name\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim med\ninner join tuva.claims_preprocessing.service_category__stg_professional prof on med.claim_id = prof.claim_id \nand\nmed.claim_line_number = prof.claim_line_number\nwhere (ccs_category in ('213','212','215')\nOR\nmed.primary_specialty_description IN (\n        'Occupational Health'\n        ,'Occupational Medicine'\n        ,'Occupational Therapist in Private Practice'\n        ,'Occupational Therapy Assistant'\n        ,'Physical Therapist'\n        ,'Physical Therapist in Private Practice'\n        ,'Physical Therapy Assistant'\n        ,'Speech Language Pathologist'\n        ,'Speech-Language Assistant'\n    ))\nAND\nplace_of_service_code <> '11'", "relation_name": "tuva.claims_preprocessing.service_category__outpatient_physical_therapy_professional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.478758Z", "completed_at": "2025-02-25T21:26:19.483295Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.486761Z", "completed_at": "2025-02-25T21:26:19.486766Z"}], "thread_id": "Thread-2", "execution_time": 0.008507013320922852, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__outpatient_radiology_professional", "compiled": true, "compiled_code": "\n\nselect distinct \n  med.claim_id\n, med.claim_line_number\n, med.claim_line_id\n, 'outpatient' as service_category_1    \n, 'outpatient radiology' as service_category_2\n, case when med.modality = 'Nuclear medicine' then 'pet'\n        when med.modality = 'Magnetic resonance' then 'mri'\n        when med.modality = 'Computerized tomography' then 'ct'\n        when med.modality in ('Invasive', 'Ultrasound', 'Computer-aided detection', 'Three-dimensional reconstruction', 'Radiography') then 'general'\n        else 'general' \n        end as service_category_3\n, 'service_category__outpatient_radiology_professional' as source_model_name           \n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim med\ninner join tuva.claims_preprocessing.service_category__stg_professional as prof\n  on med.claim_id = prof.claim_id\n  and med.claim_line_number = prof.claim_line_number\nwhere med.modality is not null\nand\nplace_of_service_code <> '11'", "relation_name": "tuva.claims_preprocessing.service_category__outpatient_radiology_professional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.483488Z", "completed_at": "2025-02-25T21:26:19.487870Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.492611Z", "completed_at": "2025-02-25T21:26:19.492618Z"}], "thread_id": "Thread-3", "execution_time": 0.009821891784667969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__outpatient_substance_use_professional", "compiled": true, "compiled_code": "\n\nselect distinct\n    med.claim_id\n  , med.claim_line_number\n  , med.claim_line_id\n  , 'outpatient' as service_category_1\n  , 'outpatient substance use' as service_category_2\n  , 'outpatient substance use' as service_category_3\n  , 'service_category__outpatient_substance_use_professional' as source_model_name\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim as med\ninner join tuva.claims_preprocessing.service_category__stg_professional as prof\n  on med.claim_id = prof.claim_id\n  and med.claim_line_number = prof.claim_line_number\nwhere \n  med.default_ccsr_category_description_op in (\n      'MBD026'\n    , 'SYM008'\n    , 'MBD025'\n    , 'SYM009'\n    , 'MBD034'\n  )\n  and med.place_of_service_code <> '11'", "relation_name": "tuva.claims_preprocessing.service_category__outpatient_substance_use_professional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.488056Z", "completed_at": "2025-02-25T21:26:19.493790Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.497357Z", "completed_at": "2025-02-25T21:26:19.497362Z"}], "thread_id": "Thread-2", "execution_time": 0.009994029998779297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__outpatient_surgery_professional", "compiled": true, "compiled_code": "\n\nselect distinct \n    med.claim_id\n  , med.claim_line_number\n  , 'outpatient' as service_category_1    \n  , 'outpatient surgery' as service_category_2\n  , 'outpatient surgery' as service_category_3\n  , 'service_category__outpatient_surgery_professional' as source_model_name\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim med\ninner join tuva.claims_preprocessing.service_category__stg_professional prof on med.claim_id = prof.claim_id \nand\nmed.claim_line_number = prof.claim_line_number\nwhere\n(ccs_category between '1' and '176'\nor\nccs_category in ('229','230','231','232','244'))\nand\nplace_of_service_code in ('15','17','19','22','49','50','60','71','72')", "relation_name": "tuva.claims_preprocessing.service_category__outpatient_surgery_professional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.493976Z", "completed_at": "2025-02-25T21:26:19.501595Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.501802Z", "completed_at": "2025-02-25T21:26:19.501806Z"}], "thread_id": "Thread-3", "execution_time": 0.008535146713256836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__pharmacy_professional", "compiled": true, "compiled_code": "\n\nselect distinct \n    med.claim_id\n    , med.claim_line_number\n    , med.claim_line_id\n    , case when place_of_service_code = '11' then 'office-based' else 'outpatient' end as service_category_1\n    , 'pharmacy' as service_category_2\n    , 'pharmacy' as service_category_3\n    ,'service_category__pharmacy_professional' as source_model_name\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim med\ninner join tuva.claims_preprocessing.service_category__stg_professional prof on med.claim_id = prof.claim_id \nand\nmed.claim_line_number = prof.claim_line_number\nwhere\nccs_category = '240' --medications", "relation_name": "tuva.claims_preprocessing.service_category__pharmacy_professional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.498467Z", "completed_at": "2025-02-25T21:26:19.502853Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.506008Z", "completed_at": "2025-02-25T21:26:19.506013Z"}], "thread_id": "Thread-2", "execution_time": 0.008036136627197266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__stg_office_based", "compiled": true, "compiled_code": "\n\nselect distinct \n  a.claim_id\n  , a.claim_line_number\n  , a.claim_line_id\n  , 'office based' as service_type\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim a\ninner join  tuva.claims_preprocessing.service_category__stg_professional p on a.claim_id = p.claim_id \nand\na.claim_line_number = p.claim_line_number\nwhere a.place_of_service_code in ( '11' -- office\n,'02' --telehealth \n,'10' --telehealth\n)", "relation_name": "tuva.claims_preprocessing.service_category__stg_office_based"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.523923Z", "completed_at": "2025-02-25T21:26:19.530997Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.531236Z", "completed_at": "2025-02-25T21:26:19.531243Z"}], "thread_id": "Thread-2", "execution_time": 0.009036064147949219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.mart_review__stg_pharmacy_claim", "compiled": true, "compiled_code": "\n\nselect mc.*,\ncast(c.year_month_int as TEXT) as year_month\nFROM tuva.core.pharmacy_claim  mc\nleft join tuva.reference_data.calendar c on coalesce(mc.paid_date,mc.dispensing_date) = c.full_date", "relation_name": "tuva.data_quality.mart_review__stg_pharmacy_claim"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.542936Z", "completed_at": "2025-02-25T21:26:19.550566Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.550928Z", "completed_at": "2025-02-25T21:26:19.550935Z"}], "thread_id": "Thread-3", "execution_time": 0.009466171264648438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.not_null_core__pharmacy_claim_person_id.27e3c20e38", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect person_id\nfrom tuva.core.pharmacy_claim\nwhere person_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.546582Z", "completed_at": "2025-02-25T21:26:19.551968Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.552435Z", "completed_at": "2025-02-25T21:26:19.552438Z"}], "thread_id": "Thread-2", "execution_time": 0.0064640045166015625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.unique_core__pharmacy_claim_pharmacy_claim_id.a91e86c79c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    pharmacy_claim_id as unique_field,\n    count(*) as n_records\n\nfrom tuva.core.pharmacy_claim\nwhere pharmacy_claim_id is not null\ngroup by pharmacy_claim_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.552808Z", "completed_at": "2025-02-25T21:26:19.560082Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.560314Z", "completed_at": "2025-02-25T21:26:19.560319Z"}], "thread_id": "Thread-3", "execution_time": 0.008656024932861328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.encounters__stg_outpatient_institutional", "compiled": true, "compiled_code": "\n\n\nselect distinct \n  claim_id\n, service_type\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_outpatient_institutional a", "relation_name": "tuva.claims_preprocessing.encounters__stg_outpatient_institutional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.556776Z", "completed_at": "2025-02-25T21:26:19.561426Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.566017Z", "completed_at": "2025-02-25T21:26:19.566023Z"}], "thread_id": "Thread-2", "execution_time": 0.009778738021850586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__ambulance_institutional", "compiled": true, "compiled_code": "\n\nselect distinct\n    med.claim_id\n  , med.claim_line_number\n  , med.claim_line_id\n  , 'ancillary' as service_category_1\n  , 'ambulance' as service_category_2\n  , 'ambulance' as service_category_3\n  , '_int_ambulance_institutional' as source_model_name\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim as med\ninner join tuva.claims_preprocessing.service_category__stg_outpatient_institutional as outpatient\n  on med.claim_id = outpatient.claim_id\nwhere \n  (med.hcpcs_code between 'A0425' and 'A0436')\n  or med.revenue_center_code = '0540'", "relation_name": "tuva.claims_preprocessing._int_ambulance_institutional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.561609Z", "completed_at": "2025-02-25T21:26:19.570576Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.570782Z", "completed_at": "2025-02-25T21:26:19.570786Z"}], "thread_id": "Thread-3", "execution_time": 0.00987696647644043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__ambulatory_surgery_institutional", "compiled": true, "compiled_code": "\n\nwith multiple_sources as (\nselect distinct \n    med.claim_id\n    , 'ambulatory surgery center' as service_category_2\n    , 'ambulatory surgery center' as service_category_3\n    , '_int_ambulatory_surgery_institutional' as source_model_name\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim med\ninner join tuva.claims_preprocessing.service_category__stg_outpatient_institutional outpatient\n    on med.claim_id = outpatient.claim_id\nwhere revenue_center_code in ('0490','0499')\n\nunion all\n\nselect distinct \n    med.claim_id\n    , 'ambulatory surgery center' as service_category_2\n    , 'ambulatory surgery center' as service_category_3\n    , '_int_ambulatory_surgery_institutional' as source_model_name\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim med\ninner join tuva.claims_preprocessing.service_category__stg_outpatient_institutional outpatient\n    on med.claim_id = outpatient.claim_id\nwhere med.primary_taxonomy_code = '261QA1903X'\n)\n\nselect distinct claim_id\n, 'outpatient' as service_category_1\n,service_category_2\n,service_category_3\n,source_model_name\n,tuva_last_run\nfrom multiple_sources", "relation_name": "tuva.claims_preprocessing._int_ambulatory_surgery_institutional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.567174Z", "completed_at": "2025-02-25T21:26:19.571610Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.572018Z", "completed_at": "2025-02-25T21:26:19.572021Z"}], "thread_id": "Thread-2", "execution_time": 0.005348682403564453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__dialysis_institutional", "compiled": true, "compiled_code": "\n\nselect distinct\n    med.claim_id\n  , 'outpatient' as service_category_1\n  , 'dialysis' as service_category_2\n  , 'dialysis' as service_category_3\n  , '_int_dialysis_institutional' as source_model_name\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim as med\ninner join tuva.claims_preprocessing.service_category__stg_outpatient_institutional as outpatient\n  on med.claim_id = outpatient.claim_id\nwhere \n  substring(med.bill_type_code, 1, 2) in ('72')\n  or med.primary_taxonomy_code in (\n      '2472R0900X'\n    , '163WD1100X'\n    , '163WH0500X'\n    , '261QE0700X'\n  )\n  or med.ccs_category in ('91', '58', '57')\n  or substring(med.revenue_center_code, 1, 3) in ('082', '083', '084', '085', '088')", "relation_name": "tuva.claims_preprocessing._int_dialysis_institutional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.572354Z", "completed_at": "2025-02-25T21:26:19.581696Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.581920Z", "completed_at": "2025-02-25T21:26:19.581926Z"}], "thread_id": "Thread-3", "execution_time": 0.010616064071655273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__dme_institutional", "compiled": true, "compiled_code": "\n\nselect distinct\n      med.claim_id\n    , med.claim_line_number\n    , med.claim_line_id\n, 'ancillary' as service_category_1\n, 'durable medical equipment' as service_category_2\n, 'durable medical equipment' as service_category_3\n, 'service_category__dme_institutional' as source_model_name\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim med\ninner join tuva.claims_preprocessing.service_category__stg_outpatient_institutional as outpatient\n  on med.claim_id = outpatient.claim_id\nwhere med.ccs_category = '243'", "relation_name": "tuva.dbt_sarah.service_category__dme_institutional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.577497Z", "completed_at": "2025-02-25T21:26:19.582984Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.586474Z", "completed_at": "2025-02-25T21:26:19.586479Z"}], "thread_id": "Thread-2", "execution_time": 0.009509086608886719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__emergency_department_institutional", "compiled": true, "compiled_code": "\n\nwith multiple_sources as (\nselect distinct \n    med.claim_id\n    , 'emergency department' as service_category_2\n    , 'emergency department' as service_category_3\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\n    , '_int_emergency_department_institutional' as source_model_name\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim med\ninner join tuva.claims_preprocessing.service_category__stg_outpatient_institutional outpatient\n    on med.claim_id = outpatient.claim_id\nwhere revenue_center_code in ('0450','0451','0452','0459','0981')\nOR\nhcpcs_code in ('99281','99282','99283','99284','99285','G0380','G0381','G0382','G0383','G0384')\n  \nunion all\n\n--Adding in inpatient claims for flagging encounters with ED \nselect distinct \n    med.claim_id\n    , 'emergency department' as service_category_2\n    , 'emergency department' as service_category_3\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\n    , '_int_emergency_department_institutional' as source_model_name\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim med\ninner join tuva.claims_preprocessing.service_category__stg_inpatient_institutional inp\n    on med.claim_id = inp.claim_id\nwhere revenue_center_code in ('0450','0451','0452','0459','0981')\n\n)\n\nselect claim_id\n, 'outpatient' as service_category_1\n,service_category_2\n,service_category_3\n,tuva_last_run\n,source_model_name\nfrom multiple_sources", "relation_name": "tuva.claims_preprocessing._int_emergency_department_institutional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.583170Z", "completed_at": "2025-02-25T21:26:19.587579Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.591062Z", "completed_at": "2025-02-25T21:26:19.591066Z"}], "thread_id": "Thread-3", "execution_time": 0.008567094802856445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__lab_institutional", "compiled": true, "compiled_code": "\n\nselect distinct \n  med.claim_id\n, med.claim_line_number\n, 'ancillary' as service_category_1  \n, 'lab' as service_category_2\n, 'lab' as service_category_3\n,'_int_lab_institutional' as source_model_name\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim med\ninner join tuva.claims_preprocessing.service_category__stg_outpatient_institutional outpatient\n    on med.claim_id = outpatient.claim_id\nwhere substring(med.bill_type_code, 1, 2) in ('14')\nOR\nmed.ccs_category in ('233' -- lab\n,'235' --other lab\n,'234' --pathology\n)", "relation_name": "tuva.claims_preprocessing._int_lab_institutional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.587775Z", "completed_at": "2025-02-25T21:26:19.592163Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.596706Z", "completed_at": "2025-02-25T21:26:19.596711Z"}], "thread_id": "Thread-2", "execution_time": 0.009610891342163086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__outpatient_hospice_institutional", "compiled": true, "compiled_code": "\n\nselect distinct\n    med.claim_id\n  , 'outpatient' as service_category_1\n  , 'outpatient hospice' as service_category_2\n  , 'outpatient hospice' as service_category_3\n  , '_int_outpatient_hospice_institutional' as source_model_name\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim as med\ninner join tuva.claims_preprocessing.service_category__stg_outpatient_institutional as outpatient\n  on med.claim_id = outpatient.claim_id\nwhere \n  substring(med.bill_type_code, 1, 2) in ('81')\n  or (\n    med.hcpcs_code in ('Q5001', 'Q5002', 'Q5003', 'Q5009')\n    and substring(med.bill_type_code, 1, 2) not in ('31', '32', '33')\n  )\n  or med.revenue_center_code in ('0651', '0652')", "relation_name": "tuva.claims_preprocessing._int_outpatient_hospice_institutional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.592348Z", "completed_at": "2025-02-25T21:26:19.601148Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.601378Z", "completed_at": "2025-02-25T21:26:19.601382Z"}], "thread_id": "Thread-3", "execution_time": 0.009725093841552734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__outpatient_hospital_or_clinic_institutional", "compiled": true, "compiled_code": "\n\nwith multiple_sources as (\n    select distinct \n        m.claim_id\n      , 'outpatient hospital or clinic' as service_category_2\n      , 'outpatient hospital or clinic' as service_category_3\n      , '_int_outpatient_hospital_or_clinic_institutional' as source_model_name\n      , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\n    from tuva.claims_preprocessing.service_category__stg_medical_claim as m\n    inner join tuva.claims_preprocessing.service_category__stg_outpatient_institutional as o\n      on m.claim_id = o.claim_id\n    where \n      substring(m.bill_type_code, 1, 2) in ('13', '71', '73')\n\n    union all\n\n    select distinct\n        m.claim_id\n      , 'outpatient hospital or clinic' as service_category_2\n      , 'outpatient hospital or clinic' as service_category_3\n      , '_int_outpatient_hospital_or_clinic_institutional' as source_model_name\n      , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\n    from tuva.claims_preprocessing.service_category__stg_medical_claim as m\n    inner join tuva.claims_preprocessing.service_category__stg_outpatient_institutional as o\n      on m.claim_id = o.claim_id\n    where \n      m.ccs_category = '227' -- Consultation, evaluation, and preventative care\n)\n\nselect distinct\n    claim_id\n  , 'outpatient' as service_category_1\n  , service_category_2\n  , service_category_3\n  , source_model_name\n  , tuva_last_run\nfrom multiple_sources", "relation_name": "tuva.claims_preprocessing._int_outpatient_hospital_or_clinic_institutional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.597841Z", "completed_at": "2025-02-25T21:26:19.602210Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.602624Z", "completed_at": "2025-02-25T21:26:19.602627Z"}], "thread_id": "Thread-2", "execution_time": 0.005278110504150391, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__outpatient_physical_therapy_institutional", "compiled": true, "compiled_code": "\n\nselect distinct \n    med.claim_id\n    , med.claim_line_number\n    ,'outpatient' as service_category_1    \n    , 'outpatient pt/ot/st' as service_category_2\n    , 'outpatient pt/ot/st' as service_category_3\n    ,'service_category__outpatient_physical_therapy_institutional' as source_model_name\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim med\ninner join tuva.claims_preprocessing.service_category__stg_outpatient_institutional o on med.claim_id = o.claim_id\nwhere ccs_category in ('213','212','215')", "relation_name": "tuva.claims_preprocessing.service_category__outpatient_physical_therapy_institutional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.602980Z", "completed_at": "2025-02-25T21:26:19.609244Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.612789Z", "completed_at": "2025-02-25T21:26:19.612795Z"}], "thread_id": "Thread-3", "execution_time": 0.010859012603759766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__outpatient_psychiatric_institutional", "compiled": true, "compiled_code": "\nwith multiple_sources as (\n\nselect distinct \n  m.claim_id\n, 'outpatient psychiatric' as service_category_2\n, 'outpatient psychiatric' as service_category_3\n,'_int_outpatient_psychiatric_institutional' as source_model_name\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim m\ninner join tuva.claims_preprocessing.service_category__stg_outpatient_institutional i on m.claim_id = i.claim_id\nwhere substring(m.bill_type_code, 1, 2) in ('52')\n\nunion all\n\nselect distinct \n  m.claim_id\n, 'outpatient psychiatric' as service_category_2\n, 'outpatient psychiatric' as service_category_3\n,'_int_outpatient_psychiatric_institutional' as source_model_name\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim m\ninner join tuva.claims_preprocessing.service_category__stg_outpatient_institutional i on m.claim_id = i.claim_id\nwhere m.primary_taxonomy_code in ('283Q00000X'\n                                  ,'273R00000X')\n)\n\nselect distinct claim_id\n,'outpatient' as service_category_1    \n,service_category_2\n,service_category_3\n,source_model_name\n,tuva_last_run\nfrom multiple_sources", "relation_name": "tuva.claims_preprocessing._int_outpatient_psychiatric_institutional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.609448Z", "completed_at": "2025-02-25T21:26:19.613948Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.617533Z", "completed_at": "2025-02-25T21:26:19.617538Z"}], "thread_id": "Thread-2", "execution_time": 0.008850812911987305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__outpatient_radiology_institutional", "compiled": true, "compiled_code": "\n\nselect distinct \n  med.claim_id\n, med.claim_line_number\n, 'outpatient' as service_category_1    \n, 'outpatient radiology' as service_category_2\n, case when med.modality = 'Nuclear medicine' then 'pet'\n        when med.modality = 'Magnetic resonance' then 'mri'\n        when med.modality = 'Computerized tomography' then 'ct'\n        when med.modality in ('Invasive', 'Ultrasound', 'Computer-aided detection', 'Three-dimensional reconstruction', 'Radiography') then 'general'\n        else 'general' \n        end as service_category_3\n, 'service_category__outpatient_radiology_institutional' as source_model_name           \n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim med\ninner join tuva.claims_preprocessing.service_category__stg_outpatient_institutional o on med.claim_id = o.claim_id\nwhere med.modality is not null", "relation_name": "tuva.claims_preprocessing.service_category__outpatient_radiology_institutional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.614131Z", "completed_at": "2025-02-25T21:26:19.618654Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.622183Z", "completed_at": "2025-02-25T21:26:19.622188Z"}], "thread_id": "Thread-3", "execution_time": 0.008738994598388672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__outpatient_rehab_institutional", "compiled": true, "compiled_code": "\n\nwith multiple_sources as (\n    select distinct \n        m.claim_id\n      , 'outpatient rehabilitation' as service_category_2\n      , 'outpatient rehabilitation' as service_category_3\n      , 'service_category__outpatient_rehab_institutional' as source_model_name\n      , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\n    from tuva.claims_preprocessing.service_category__stg_medical_claim as m\n    inner join tuva.claims_preprocessing.service_category__stg_outpatient_institutional as i\n      on m.claim_id = i.claim_id\n    where \n      m.primary_taxonomy_code in (\n          '283X00000X'\n        , '273Y00000X'\n        , '261QR0400X'\n        , '315D00000X'\n        , '261QR0401X'\n        , '208100000X'\n        , '225400000X'\n        , '324500000X'\n        , '2278P1005X'\n        , '261QR0405X'\n        , '2081S0010X'\n        , '261QR0404X'\n      )\n)\n\nselect distinct\n    claim_id\n  , 'outpatient' as service_category_1\n  , service_category_2\n  , service_category_3\n  , source_model_name\n  , tuva_last_run\nfrom multiple_sources", "relation_name": "tuva.claims_preprocessing.service_category__outpatient_rehab_institutional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.618858Z", "completed_at": "2025-02-25T21:26:19.623286Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.626723Z", "completed_at": "2025-02-25T21:26:19.626728Z"}], "thread_id": "Thread-2", "execution_time": 0.008551836013793945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__outpatient_substance_use_institutional", "compiled": true, "compiled_code": "\n\nselect distinct\n    med.claim_id\n  , 'outpatient' as service_category_1\n  , 'outpatient substance use' as service_category_2\n  , 'outpatient substance use' as service_category_3\n  , 'service_category__outpatient_substance_use_institutional' as source_model_name\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim as med\ninner join tuva.claims_preprocessing.service_category__stg_outpatient_institutional as o\n  on med.claim_id = o.claim_id\nwhere \n  med.default_ccsr_category_description_op in (\n      'MBD026'\n    , 'SYM008'\n    , 'MBD025'\n    , 'SYM009'\n    , 'MBD034'\n  )\n  or med.primary_taxonomy_code in (\n      '324500000X'\n    , '261QR0405X'\n    , '101YA0400X'\n  )", "relation_name": "tuva.claims_preprocessing.service_category__outpatient_substance_use_institutional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.623467Z", "completed_at": "2025-02-25T21:26:19.627818Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.633618Z", "completed_at": "2025-02-25T21:26:19.633626Z"}], "thread_id": "Thread-3", "execution_time": 0.010846138000488281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__outpatient_surgery_institutional", "compiled": true, "compiled_code": "\n\nselect distinct \n    med.claim_id --claim level\n  , 'outpatient' as service_category_1    \n  , 'outpatient surgery' as service_category_2\n  , 'outpatient surgery' as service_category_3\n  , 'service_category__outpatient_surgery_institutional' as source_model_name\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim med\ninner join tuva.claims_preprocessing.service_category__stg_outpatient_institutional o on med.claim_id = o.claim_id\nwhere\nccs_category between '1' and '176'\nor\nccs_category in ('229','230','231','232','244')", "relation_name": "tuva.claims_preprocessing.service_category__outpatient_surgery_institutional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.628009Z", "completed_at": "2025-02-25T21:26:19.638356Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.638894Z", "completed_at": "2025-02-25T21:26:19.638901Z"}], "thread_id": "Thread-2", "execution_time": 0.011591911315917969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__pharmacy_institutional", "compiled": true, "compiled_code": "\n\nwith multiple_sources as (\n    select distinct \n        med.claim_id\n      , med.claim_line_number\n      , 'outpatient' as service_category_1\n      , 'pharmacy' as service_category_2\n      , 'pharmacy' as service_category_3\n      , 'service_category__pharmacy_institutional' as source_model_name\n      , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\n    from tuva.claims_preprocessing.service_category__stg_medical_claim as med\n    inner join tuva.claims_preprocessing.service_category__stg_outpatient_institutional as outpatient\n      on med.claim_id = outpatient.claim_id\n    where \n      (substring(med.revenue_center_code, 1, 3) in ('025', '026', '063', '089') -- pharmacy and iv therapy\n      or med.revenue_center_code = '0547'\n      or med.ccs_category = '240') -- medications\n\n    union all\n\n    select distinct \n        med.claim_id\n      , med.claim_line_number\n      , 'inpatient' as service_category_1\n      , 'pharmacy' as service_category_2\n      , 'pharmacy' as service_category_3\n      , 'service_category__pharmacy_institutional' as source_model_name\n      , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\n    from tuva.claims_preprocessing.service_category__stg_medical_claim as med\n    inner join tuva.claims_preprocessing.service_category__stg_inpatient_institutional as outpatient\n      on med.claim_id = outpatient.claim_id\n    where \n      (substring(med.revenue_center_code, 1, 3) in ('025', '026', '063', '089') -- pharmacy and iv therapy\n      or med.revenue_center_code = '0547')\n)\n\nselect \n    claim_id\n  , claim_line_number\n  , service_category_1\n  , service_category_2\n  , service_category_3\n  , source_model_name\n  , tuva_last_run\nfrom multiple_sources", "relation_name": "tuva.claims_preprocessing.service_category__pharmacy_institutional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.634883Z", "completed_at": "2025-02-25T21:26:19.640149Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.644517Z", "completed_at": "2025-02-25T21:26:19.644524Z"}], "thread_id": "Thread-3", "execution_time": 0.010158061981201172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__inpatient_skilled_nursing_professional", "compiled": true, "compiled_code": "\n\nselect distinct\n  a.claim_id\n, a.claim_line_number\n, a.claim_line_id\n, 'inpatient' as service_category_1\n, 'skilled nursing' as service_category_2\n, 'skilled nursing' as service_category_3\n, '_int_inpatient_skilled_nursing_professional' as source_model_name\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim a\nleft join tuva.claims_preprocessing._int_dme_professional b\n  on a.claim_id = b.claim_id\n  and a.claim_line_number = b.claim_line_number\nwhere claim_type = 'professional'\n  and place_of_service_code in ('31','32')\n  and (b.claim_id is null and b.claim_line_number is null)", "relation_name": "tuva.claims_preprocessing._int_inpatient_skilled_nursing_professional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.640351Z", "completed_at": "2025-02-25T21:26:19.648127Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.648617Z", "completed_at": "2025-02-25T21:26:19.648621Z"}], "thread_id": "Thread-2", "execution_time": 0.009070158004760742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__office_based_physical_therapy_professional", "compiled": true, "compiled_code": "\n\nselect distinct \n    med.claim_id\n    , med.claim_line_number\n    , med.claim_line_id\n    , 'office-based' as service_category_1    \n    , 'office-based pt/ot/st' as service_category_2\n    , 'office-based pt/ot/st' as service_category_3\n    ,'service_category__office_based_physical_therapy_professional' as source_model_name\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim med\ninner join tuva.claims_preprocessing.service_category__stg_office_based prof on med.claim_id = prof.claim_id \nand\nmed.claim_line_number = prof.claim_line_number\nwhere (\nccs_category in ('213','212','215')\nOR\n med.rend_primary_specialty_description IN (\n        'Occupational Health'\n        ,'Occupational Medicine'\n        ,'Occupational Therapist in Private Practice'\n        ,'Occupational Therapy Assistant'\n        ,'Physical Therapist'\n        ,'Physical Therapist in Private Practice'\n        ,'Physical Therapy Assistant'\n        ,'Speech Language Pathologist'\n        ,'Speech-Language Assistant'\n    ))\nand place_of_service_code = '11'", "relation_name": "tuva.claims_preprocessing.service_category__office_based_physical_therapy_professional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.649665Z", "completed_at": "2025-02-25T21:26:19.659128Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.659351Z", "completed_at": "2025-02-25T21:26:19.659357Z"}], "thread_id": "Thread-3", "execution_time": 0.011105060577392578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__office_based_radiology", "compiled": true, "compiled_code": "\n\nselect distinct \n    med.claim_id\n    , med.claim_line_number\n    , med.claim_line_id\n    , 'office-based' as service_category_1    \n    , 'office-based radiology' as service_category_2\n    , case when med.modality = 'Nuclear medicine' then 'pet'\n           when med.modality = 'Magnetic resonance' then 'mri'\n           when med.modality = 'Computerized tomography' then 'ct'\n           when med.modality in ('Invasive', 'Ultrasound', 'Computer-aided detection', 'Three-dimensional reconstruction', 'Radiography') then 'general'\n           else 'general' \n           end as service_category_3\n    ,'service_category__office_based_radiology' as source_model_name\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim med\ninner join tuva.claims_preprocessing.service_category__stg_office_based o on med.claim_id = o.claim_id\nand\nmed.claim_line_number = o.claim_line_number\nwhere \nmed.modality is not null\nand\nmed.place_of_service_code = '11'", "relation_name": "tuva.claims_preprocessing.service_category__office_based_radiology"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.653907Z", "completed_at": "2025-02-25T21:26:19.664066Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.665155Z", "completed_at": "2025-02-25T21:26:19.665161Z"}], "thread_id": "Thread-2", "execution_time": 0.012121915817260742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__office_based_surgery_professional", "compiled": true, "compiled_code": "\n\n\nwith numeric_hcpcs as (\n    select *\n    from tuva.claims_preprocessing.service_category__stg_medical_claim as med\n    \n        where \n    \n        try_cast(hcpcs_code as int)\n     is not null\n    \n)\n\n\n    select distinct \n        med.claim_id\n      , med.claim_line_number\n      , med.claim_line_id\n      ,'office-based' as service_category_1    \n      , 'office-based surgery' as service_category_2\n      , 'office-based surgery' as service_category_3\n      , 'service_category__office_based_surgery_professional' as source_model_name\n      , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\n    from numeric_hcpcs as med\n    inner join tuva.claims_preprocessing.service_category__stg_office_based as prof\n      on med.claim_id = prof.claim_id\n      and med.claim_line_number = prof.claim_line_number\n    where \n      (hcpcs_code between '10021' and '69999')", "relation_name": "tuva.claims_preprocessing.service_category__office_based_surgery_professional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.660584Z", "completed_at": "2025-02-25T21:26:19.666516Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.667203Z", "completed_at": "2025-02-25T21:26:19.667207Z"}], "thread_id": "Thread-3", "execution_time": 0.007255077362060547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__office_based_visit_professional", "compiled": true, "compiled_code": "\n\nselect distinct\n    med.claim_id\n  , med.claim_line_number\n  , med.claim_line_id\n  , 'office-based' as service_category_1\n  , case \n      when med.place_of_service_code = '11' then 'office-based visit'\n      when med.place_of_service_code in ('02', '10') then 'telehealth visit'\n    end as service_category_2\n  , case \n      when med.place_of_service_code = '11' then 'office-based visit'\n      when med.place_of_service_code in ('02', '10') then 'telehealth visit'\n    end as service_category_3\n  , '_int_office_based_visit_professional' as source_model_name\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.service_category__stg_medical_claim as med\ninner join tuva.claims_preprocessing.service_category__stg_office_based as prof\n  on med.claim_id = prof.claim_id\n  and med.claim_line_number = prof.claim_line_number\nwhere \n  (med.place_of_service_code = '11' and med.ccs_category = '227') -- consultation eval and preventative care\n  or med.place_of_service_code in ('02', '10') -- telehealth", "relation_name": "tuva.claims_preprocessing._int_office_based_visit_professional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.669072Z", "completed_at": "2025-02-25T21:26:19.698727Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.699110Z", "completed_at": "2025-02-25T21:26:19.699118Z"}], "thread_id": "Thread-2", "execution_time": 0.0316619873046875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.hcc_suspecting__int_all_medications", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte___stg_medication as (\n\nselect\n      person_id\n    , dispensing_date\n    , source_code\n    , source_code_type\n    , ndc_code\n    , rxnorm_code\n    , data_source\nfrom tuva.core.medication\n\n\n),  __dbt__cte___stg_pharmacy_claim as (\n\nselect\n      person_id\n    , dispensing_date\n    , ndc_code\n    , paid_date\n    , data_source\nfrom tuva.core.pharmacy_claim\n\n\n), medications as (\n\n    select\n          person_id\n        , dispensing_date\n        , source_code\n        , source_code_type\n        , ndc_code\n        , rxnorm_code\n        , data_source\n    from __dbt__cte___stg_medication\n\n)\n\n, pharmacy_claims as (\n\n    select\n          person_id\n        , coalesce(dispensing_date, paid_date) as dispensing_date\n        , ndc_code as drug_code\n        , 'ndc' as code_system\n        , data_source\n    from __dbt__cte___stg_pharmacy_claim\n\n)\n\n, ndc_medications as (\n\n    select\n          person_id\n        , dispensing_date\n        , ndc_code as drug_code\n        , 'ndc' as code_system\n        , data_source\n    from medications\n    where ndc_code is not null\n\n    union all\n\n    select\n          person_id\n        , dispensing_date\n        , source_code as drug_code\n        , 'ndc' as code_system\n        , data_source\n    from medications\n    where lower(source_code_type) = 'ndc'\n\n)\n\n, rxnorm_medications as (\n\n    select\n          person_id\n        , dispensing_date\n        , rxnorm_code as drug_code\n        , 'rxnorm' as code_system\n        , data_source\n    from medications\n    where rxnorm_code is not null\n\n    union all\n\n    select\n          person_id\n        , dispensing_date\n        , source_code as drug_code\n        , 'rxnorm' as code_system\n        , data_source\n    from medications\n    where lower(source_code_type) = 'rxnorm'\n\n)\n\n, unioned as (\n\n    select * from pharmacy_claims\n    union all\n    select * from ndc_medications\n    union all\n    select * from rxnorm_medications\n\n)\n\n, add_data_types as (\n\n    select\n          cast(person_id as TEXT) as person_id\n        , cast(dispensing_date as date) as dispensing_date\n        , cast(drug_code as TEXT) as drug_code\n        , cast(code_system as TEXT) as code_system\n        , cast(data_source as TEXT) as data_source\n    from unioned\n\n)\n\nselect\n      person_id\n    , dispensing_date\n    , drug_code\n    , code_system\n    , data_source\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.hcc_suspecting._int_all_medications"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.686855Z", "completed_at": "2025-02-25T21:26:19.700523Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.718563Z", "completed_at": "2025-02-25T21:26:19.718577Z"}], "thread_id": "Thread-3", "execution_time": 0.05014300346374512, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.pharmacy__int_claims_current_cost", "compiled": true, "compiled_code": "\nwith __dbt__cte__stg_pharmacy_claim as (\n\n\nselect \n    p.ndc_code\n  , n.fda_description as ndc_description\n  , p.data_source\n  , n.rxcui\n  , p.paid_amount\n  , p.allowed_amount\n  , p.claim_id\n  , p.claim_line_number\n  , p.person_id\n  , p.member_id\n  , p.prescribing_provider_id\n  , p.dispensing_provider_id\n  , p.dispensing_date\n  , p.quantity\n  , p.days_supply\n  , p.refills\n  , p.paid_date\nfrom tuva.core.pharmacy_claim as p\nleft join tuva.terminology.ndc as n \n  on p.ndc_code = n.ndc\n) /* All claims, current cost*/\n\nselect \n    p.ndc_code\n  , p.ndc_description\n  , p.data_source\n  , p.rxcui\n  , r.brand_vs_generic\n  , case \n      when ga.brand_with_generic_available is not null \n        then 'brand_with_generic_available' \n      else null \n    end as generic_available\n  , sum(paid_amount) as paid_amount\n  , count(distinct claim_id) as claim_count\n  , sum(paid_amount) / count(distinct claim_id) as cost_per_claim\n  , sum(quantity) as total_units\n  , case \n      when sum(quantity) > 0 \n      and  sum(paid_amount) > 0 \n      then sum(paid_amount) / sum(quantity) \n      else null \n    end as cost_per_unit\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom __dbt__cte__stg_pharmacy_claim as p\nleft join tuva.terminology.rxnorm_brand_generic as r \n  on p.rxcui = r.product_rxcui\nleft join tuva.pharmacy._int_brand_with_generic_available as ga \n  on p.rxcui = ga.brand_with_generic_available\nwhere p.ndc_code is not null\ngroup by \n    case \n      when ga.brand_with_generic_available is not null \n        then 'brand_with_generic_available' \n      else null \n    end\n  , r.brand_vs_generic\n  , p.ndc_code\n  , p.rxcui\n  , p.ndc_description\n  , p.data_source", "relation_name": "tuva.pharmacy._int_claims_current_cost"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.700763Z", "completed_at": "2025-02-25T21:26:19.763320Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.768974Z", "completed_at": "2025-02-25T21:26:19.768987Z"}], "thread_id": "Thread-2", "execution_time": 0.0690770149230957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.quality_measures__int_adh_diabetes_denominator", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte___stg_pharmacy_claim as (\n\n\nselect\n      person_id\n    , dispensing_date\n    , ndc_code\n    , days_supply\n    , paid_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.pharmacy_claim\n\n\n),  __dbt__cte___stg_patient as (\n\nselect\n      person_id\n    , sex\n    , birth_date\n    , death_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.patient\n), diabetics_codes as (\n\n    select\n          code\n        , code_system\n    from tuva.quality_measures._value_set_codes\n    where lower(concept_name) in (\n          'pqa diabetes medications'\n        )\n\n)\n\n, rx_diabetes as (\n\n    select\n        person_id\n      , dispensing_date\n      , ndc_code\n      , days_supply\n    from __dbt__cte___stg_pharmacy_claim as pharmacy_claims\n    inner join diabetics_codes\n        on pharmacy_claims.ndc_code = diabetics_codes.code\n            and lower(diabetics_codes.code_system) = 'ndc'\n\n)\n\n, rx_diabetes_in_measurement_period as (\n\n    select\n          person_id\n        , dispensing_date\n        , ndc_code\n        , days_supply\n        , performance_period_end -- to use in latter cte for days in treatment period calculation\n    from rx_diabetes\n    inner join tuva.quality_measures._int_adh_diabetes__performance_period pp\n        on dispensing_date between pp.performance_period_begin and pp.performance_period_end\n\n)\n\n/* \n    These patients need to pass two checks\n    - First medication fill date should be at least 91 days before the end of measurement period\n    - Should have at least two distinct Date of Service (FillDate) for rx\n*/\n\n, rx_fill_order as (\n\n    select\n          person_id\n        , dispensing_date\n        , performance_period_end\n        , dense_rank() over (\n            partition by \n                  person_id\n                , performance_period_end\n            order by dispensing_date\n        ) as dr\n    from rx_diabetes_in_measurement_period\n\n)\n\n, rx_first_fill as (\n\n    select\n          person_id\n        , dispensing_date\n        , performance_period_end\n    from rx_fill_order\n    where dr = 1\n          \n)\n\n, timely_fill_check as (\n\n    select\n          person_id\n        , ( 1 + datediff(\n        day,\n        dispensing_date,\n        performance_period_end\n        ) )\n            as days_in_treatment_period\n        /*  \n            Performance Period end minus dispensing date results in \n            second_date non-inclusive difference, so to include both of these days\n            1 day is added\n        */\n    from rx_first_fill\n\n)\n\n, first_check_passed_patients as (\n\n    select\n          person_id\n        , days_in_treatment_period\n    from timely_fill_check\n    where days_in_treatment_period > 90\n\n)\n\n, second_check_passed_patients as (\n\n    select\n          person_id\n    from rx_fill_order\n    where dr = 2\n\n)\n\n, qualifying_patients as (\n\n    select\n          first_check_passed_patients.person_id\n        , first_check_passed_patients.days_in_treatment_period\n    from first_check_passed_patients\n    inner join second_check_passed_patients\n        on first_check_passed_patients.person_id = second_check_passed_patients.person_id \n\n)\n\n, qualifying_patients_with_age as (\n    \n    select\n          patients.person_id\n        , floor(datediff(\n        hour,\n        birth_date,\n        pp.performance_period_begin\n        ) / 8760.0) as age\n        , days_in_treatment_period\n        , performance_period_begin\n        , performance_period_end\n        , measure_id\n        , measure_name\n        , measure_version\n    from __dbt__cte___stg_patient patients\n    inner join qualifying_patients\n        on patients.person_id = qualifying_patients.person_id\n    cross join tuva.quality_measures._int_adh_diabetes__performance_period pp\n    where patients.death_date is null\n\n)\n/*\n    Extracting related fields like dispensing_date, ndc_code and days_supply of qualified patients\n    to avoid redundant computations in numerator model\n*/\n\n, qualifying_patients_all_claim_info as (\n\n    select\n          qualifying_patients_with_age.person_id\n        , qualifying_patients_with_age.age\n        , rx_diabetes_in_measurement_period.dispensing_date\n        , rx_diabetes_in_measurement_period.ndc_code\n        , rx_diabetes_in_measurement_period.days_supply\n        , qualifying_patients_with_age.days_in_treatment_period\n        , qualifying_patients_with_age.performance_period_begin\n        , qualifying_patients_with_age.performance_period_end\n        , qualifying_patients_with_age.measure_id\n        , qualifying_patients_with_age.measure_name\n        , qualifying_patients_with_age.measure_version\n    from qualifying_patients_with_age\n    inner join rx_diabetes_in_measurement_period\n        on qualifying_patients_with_age.person_id = rx_diabetes_in_measurement_period.person_id\n\n)\n\n, denominator as (\n\n    select\n          person_id\n        , age\n        , dispensing_date\n        , ndc_code\n        , days_supply\n        , days_in_treatment_period\n        , performance_period_begin\n        , performance_period_end\n        , measure_id\n        , measure_name\n        , measure_version\n        , 1 as denominator_flag\n    from qualifying_patients_all_claim_info\n    where age >= 18\n\n)\n\n, add_data_types as (\n\n    select\n          cast(person_id as TEXT) as person_id\n        , cast(age as integer) as age\n        , cast(dispensing_date as date) as dispensing_date\n        , cast(ndc_code as TEXT) as ndc_code\n        , cast(days_supply as integer) as days_supply\n        , cast(days_in_treatment_period as integer) as days_in_treatment_period\n        , cast(performance_period_begin as date) as performance_period_begin\n        , cast(performance_period_end as date) as performance_period_end\n        , cast(measure_id as TEXT) as measure_id\n        , cast(measure_name as TEXT) as measure_name\n        , cast(measure_version as TEXT) as measure_version\n        , cast(denominator_flag as integer) as denominator_flag\n    from denominator\n\n)\n\nselect\n      person_id\n    , age\n    , dispensing_date\n    , ndc_code\n    , days_supply\n    , days_in_treatment_period\n    , performance_period_begin\n    , performance_period_end\n    , measure_id\n    , measure_name\n    , measure_version\n    , denominator_flag\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.quality_measures._int_adh_diabetes_denominator"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.738962Z", "completed_at": "2025-02-25T21:26:19.781891Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.788033Z", "completed_at": "2025-02-25T21:26:19.788045Z"}], "thread_id": "Thread-3", "execution_time": 0.0558779239654541, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.quality_measures__int_adh_statins_denominator", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte___stg_pharmacy_claim as (\n\n\nselect\n      person_id\n    , dispensing_date\n    , ndc_code\n    , days_supply\n    , paid_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.pharmacy_claim\n\n\n),  __dbt__cte___stg_patient as (\n\nselect\n      person_id\n    , sex\n    , birth_date\n    , death_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.patient\n), performance_period as (\n\n    select\n          measure_id\n        , measure_name\n        , measure_version\n        , performance_period_end\n        , performance_period_begin\n    from tuva.quality_measures._int_adh_statins__performance_period\n\n)\n\n, visit_codes as (\n\n    select\n          code\n        , code_system\n    from tuva.quality_measures._value_set_codes\n    where lower(concept_name) = 'pqa statin medications'\n\n)\n\n, pharmacy_claim  as (\n\n    select \n          person_id\n        , dispensing_date\n        , ndc_code\n        , days_supply\n    from __dbt__cte___stg_pharmacy_claim\n\n)\n\n, patient_with_claim as (\n\n    select\n          pharmacy_claim.person_id\n        , dispensing_date\n        , days_supply\n        , ndc_code\n    from pharmacy_claim \n    inner join visit_codes\n        on pharmacy_claim.ndc_code = visit_codes.code\n    \n)\n\n, patient_within_performance_period as (\n\n    select\n          person_id\n        , dispensing_date\n        , days_supply\n        , ndc_code\n        , performance_period_begin\n        , performance_period_end\n    from patient_with_claim as claim_patient\n    inner join performance_period as pp\n        on claim_patient.dispensing_date between pp.performance_period_begin and pp.performance_period_end\n\n)\n\n/* \n    These patients need to pass two checks\n    - First medication fill date should be at least 91 days before the end of measurement period\n    - Should have at least two distinct Date of Service (FillDate) for rx\n*/\n\n, patient_with_rank as (\n\n    select\n          person_id\n        , dispensing_date\n        , days_supply\n        , ndc_code\n        , dense_rank() over (partition by person_id order by dispensing_date) as dense_rank\n    from patient_within_performance_period\n\n)\n\n, patient_with_first_dispensing_date as (\n\n    select\n          person_id\n        , dispensing_date as first_dispensing_date\n    from patient_with_rank\n    where dense_rank = 1\n\n)\n\n\n/*\ntreatment period days is abbreviated as tpd\n*/\n\n, patient_with_tpd as (\n\n    select\n          patients1.person_id\n        , patients1.dispensing_date\n        , patients2.first_dispensing_date\n        , patients1.days_supply\n        , datediff(\n        day,\n        first_dispensing_date,\n        performance_period_end\n        ) as tpd\n    from patient_within_performance_period as patients1\n    inner join patient_with_first_dispensing_date as patients2\n        on patients1.person_id = patients2.person_id\n\n)\n\n, first_check_patient as (\n\n    select\n          person_id\n        , dispensing_date\n        , first_dispensing_date\n        , days_supply\n    from patient_with_tpd\n    where tpd > 89\n    \n)\n\n, second_check_patient as (\n\n    select\n          person_id\n        , ndc_code\n    from patient_with_rank\n    where dense_rank = 2\n\n)\n\n, both_check_patient as (\n\n    select\n          valid_patients1.person_id\n        , valid_patients1.dispensing_date\n        , valid_patients1.first_dispensing_date\n        , valid_patients1.days_supply\n        , valid_patients2.ndc_code\n    from first_check_patient as valid_patients1\n    inner join second_check_patient as valid_patients2\n        on valid_patients1.person_id = valid_patients2.person_id\n     \n)\n\n, patient_with_age as (\n\n    select\n          valid_patients1.person_id\n        , floor(datediff(\n        hour,\n        birth_date,\n        pp.performance_period_begin\n        ) / 8760.0) as age\n        , dispensing_date\n        , first_dispensing_date\n        , days_supply\n        , ndc_code\n        , pp.performance_period_begin\n        , pp.performance_period_end\n        , pp.measure_id\n        , pp.measure_name\n        , pp.measure_version\n    from __dbt__cte___stg_patient as patient\n    inner join both_check_patient as valid_patients1\n        on patient.person_id = valid_patients1.person_id\n    cross join performance_period as pp\n    where patient.death_date is null\n\n)\n\n, qualifying_patients as (\n\n    select\n          person_id\n        , dispensing_date\n        , first_dispensing_date\n        , days_supply\n        , ndc_code\n        , performance_period_begin\n        , performance_period_end\n        , measure_id\n        , measure_name\n        , measure_version\n        , 1 as denominator_flag\n    from patient_with_age \n    where age > 17\n\n)\n\n, add_data_types as (\n\n    select\n          cast(person_id as TEXT) as person_id\n        , cast(dispensing_date as date) as dispensing_date\n        , cast(first_dispensing_date as date) as first_dispensing_date\n        , cast(days_supply as integer) as days_supply\n        , cast(ndc_code as TEXT) as ndc_code\n        , cast(performance_period_begin as date) as performance_period_begin\n        , cast(performance_period_end as date) as performance_period_end\n        , cast(measure_id as TEXT) as measure_id\n        , cast(measure_name as TEXT) as measure_name\n        , cast(measure_version as TEXT) as measure_version\n        , cast(denominator_flag as integer) as denominator_flag\n    from qualifying_patients\n\n)\n\nselect \n      person_id\n    , dispensing_date\n    , first_dispensing_date\n    , days_supply\n    , ndc_code\n    , performance_period_begin\n    , performance_period_end\n    , measure_id\n    , measure_name\n    , measure_version\n    , denominator_flag\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.quality_measures._int_adh_statins_denominator"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.775614Z", "completed_at": "2025-02-25T21:26:19.836509Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.837016Z", "completed_at": "2025-02-25T21:26:19.837022Z"}], "thread_id": "Thread-2", "execution_time": 0.062151193618774414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.quality_measures__int_adhras_denominator", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte___stg_pharmacy_claim as (\n\n\nselect\n      person_id\n    , dispensing_date\n    , ndc_code\n    , days_supply\n    , paid_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.pharmacy_claim\n\n\n),  __dbt__cte___stg_patient as (\n\nselect\n      person_id\n    , sex\n    , birth_date\n    , death_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.patient\n), performance_period as (\n\n    select\n          measure_id\n        , measure_name\n        , measure_version\n        , performance_period_end\n        , performance_period_begin\n    from tuva.quality_measures._int_adhras__performance_period\n\n)\n\n, visit_codes as (\n\n    select\n          code\n        , code_system\n    from tuva.quality_measures._value_set_codes\n    where lower(concept_name) = 'pqa rasa medications'\n\n)\n\n, pharmacy_claim  as (\n\n    select \n          person_id\n        , dispensing_date\n        , ndc_code\n        , days_supply\n    from __dbt__cte___stg_pharmacy_claim\n\n)\n\n, patient_with_claim as (\n\n    select\n          pharmacy_claim.person_id\n        , dispensing_date\n        , days_supply\n        , ndc_code\n    from pharmacy_claim \n    inner join visit_codes\n        on pharmacy_claim.ndc_code = visit_codes.code\n    \n)\n\n, patient_within_performance_period as (\n\n    select\n          person_id\n        , dispensing_date\n        , days_supply\n        , ndc_code\n        , performance_period_begin\n        , performance_period_end\n    from patient_with_claim as claim_patient\n    inner join performance_period as pp\n        on claim_patient.dispensing_date between pp.performance_period_begin and pp.performance_period_end\n\n)\n\n/* \n    These patients need to pass two checks\n    - First medication fill date should be at least 91 days before the end of measurement period\n    - Should have at least two distinct Date of Service (FillDate) for rx\n*/\n\n, patient_with_rank as (\n\n    select\n          person_id\n        , dispensing_date\n        , days_supply\n        , ndc_code\n        , dense_rank() over (partition by person_id order by dispensing_date) as dense_rank\n    from patient_within_performance_period\n\n)\n\n, patient_with_first_dispensing_date as (\n\n    select\n          person_id\n        , dispensing_date as first_dispensing_date\n    from patient_with_rank\n    where dense_rank = 1\n\n)\n\n/*\ntreatment period days is abbreviated as tpd\n*/\n\n, patient_with_tpd as (\n\n    select\n          patients1.person_id\n        , patients1.dispensing_date\n        , patients2.first_dispensing_date\n        , patients1.days_supply\n        , datediff(\n        day,\n        first_dispensing_date,\n        performance_period_end\n        ) as tpd\n    from patient_within_performance_period as patients1\n    inner join patient_with_first_dispensing_date as patients2\n        on patients1.person_id = patients2.person_id\n\n)\n\n, first_check_patient as (\n\n    select\n          person_id\n        , dispensing_date\n        , first_dispensing_date\n        , days_supply\n    from patient_with_tpd\n    where tpd > 89\n    \n)\n\n, second_check_patient as (\n\n    select\n          person_id\n        , ndc_code\n    from patient_with_rank\n    where dense_rank = 2\n\n)\n\n, both_check_patient as (\n\n    select\n          valid_patients1.person_id\n        , valid_patients1.dispensing_date\n        , valid_patients1.first_dispensing_date\n        , valid_patients1.days_supply\n        , valid_patients2.ndc_code\n    from first_check_patient as valid_patients1\n    inner join second_check_patient as valid_patients2\n        on valid_patients1.person_id = valid_patients2.person_id\n     \n)\n\n, patient_with_age as (\n\n    select\n          valid_patients1.person_id\n        , floor(datediff(\n        hour,\n        birth_date,\n        pp.performance_period_begin\n        ) / 8760.0) as age\n        , dispensing_date\n        , first_dispensing_date\n        , days_supply\n        , ndc_code\n        , pp.performance_period_begin\n        , pp.performance_period_end\n        , pp.measure_id\n        , pp.measure_name\n        , pp.measure_version\n    from __dbt__cte___stg_patient as patient\n    inner join both_check_patient as valid_patients1\n        on patient.person_id = valid_patients1.person_id\n    cross join performance_period as pp\n    where patient.death_date is null\n\n)\n\n, qualifying_patients as (\n\n    select\n          person_id\n        , dispensing_date\n        , first_dispensing_date\n        , days_supply\n        , ndc_code\n        , performance_period_begin\n        , performance_period_end\n        , measure_id\n        , measure_name\n        , measure_version\n        , 1 as denominator_flag\n    from patient_with_age \n    where age > 17\n\n)\n\n, add_data_types as (\n\n    select\n          cast(person_id as TEXT) as person_id\n        , cast(dispensing_date as date) as dispensing_date\n        , cast(first_dispensing_date as date) as first_dispensing_date\n        , cast(days_supply as integer) as days_supply\n        , cast(ndc_code as TEXT) as ndc_code\n        , cast(performance_period_begin as date) as performance_period_begin\n        , cast(performance_period_end as date) as performance_period_end\n        , cast(measure_id as TEXT) as measure_id\n        , cast(measure_name as TEXT) as measure_name\n        , cast(measure_version as TEXT) as measure_version\n        , cast(denominator_flag as integer) as denominator_flag\n    from qualifying_patients\n\n)\n\nselect \n      person_id\n    , dispensing_date\n    , first_dispensing_date\n    , days_supply\n    , ndc_code\n    , performance_period_begin\n    , performance_period_end\n    , measure_id\n    , measure_name\n    , measure_version\n    , denominator_flag\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.quality_measures._int_adhras_denominator"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.813658Z", "completed_at": "2025-02-25T21:26:19.836810Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:19.837498Z", "completed_at": "2025-02-25T21:26:19.837502Z"}], "thread_id": "Thread-3", "execution_time": 0.03029489517211914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.quality_measures__int_supd_denominator", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte___stg_pharmacy_claim as (\n\n\nselect\n      person_id\n    , dispensing_date\n    , ndc_code\n    , days_supply\n    , paid_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.pharmacy_claim\n\n\n),  __dbt__cte___stg_patient as (\n\nselect\n      person_id\n    , sex\n    , birth_date\n    , death_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.patient\n), diabetics_codes as (\n\n    select\n          code\n        , code_system\n    from tuva.quality_measures._value_set_codes\n    where lower(concept_name) in (\n          'pqa antidiabetics medications'\n        )\n\n)\n\n, rx_diabetes as (\n\n    select\n        person_id\n      , dispensing_date\n      , ndc_code\n    from __dbt__cte___stg_pharmacy_claim as pharmacy_claims\n    inner join diabetics_codes\n        on pharmacy_claims.ndc_code = diabetics_codes.code\n            and lower(diabetics_codes.code_system) = 'ndc'\n\n)\n\n, rx_diabetes_in_measurement_period as (\n\n    select\n          person_id\n        , dispensing_date\n    from rx_diabetes\n    inner join tuva.quality_measures._int_supd__performance_period pp\n        on dispensing_date between pp.performance_period_begin and pp.performance_period_end\n\n)\n\n/* \n    These patients need to pass a check\n    - Should have at least two distinct Date of Service (FillDate) for rx\n*/\n\n, rx_fill_order as (\n\n    select\n          person_id\n        , dispensing_date\n        , dense_rank() over (\n            partition by \n                  person_id\n            order by dispensing_date\n        ) as dr\n    from rx_diabetes_in_measurement_period\n\n)\n\n, check_passed_patients as (\n\n    select\n          person_id\n    from rx_fill_order\n    where dr = 2\n\n)\n\n, qualifying_patients_with_age as (\n    \n    select\n          patients.person_id\n        , floor(datediff(\n        hour,\n        birth_date,\n        pp.performance_period_begin\n        ) / 8760.0) as age\n        , performance_period_begin\n        , performance_period_end\n        , measure_id\n        , measure_name\n        , measure_version\n    from __dbt__cte___stg_patient patients\n    inner join check_passed_patients\n        on patients.person_id = check_passed_patients.person_id\n    cross join tuva.quality_measures._int_supd__performance_period pp\n    where patients.death_date is null\n\n)\n\n, denominator as (\n\n    select\n          person_id\n        , age\n        , performance_period_begin\n        , performance_period_end\n        , measure_id\n        , measure_name\n        , measure_version\n        , 1 as denominator_flag\n    from qualifying_patients_with_age\n    where age > 39 and age < 76\n\n)\n\n, add_data_types as (\n\n    select\n          cast(person_id as TEXT) as person_id\n        , cast(age as integer) as age\n        , cast(performance_period_begin as date) as performance_period_begin\n        , cast(performance_period_end as date) as performance_period_end\n        , cast(measure_id as TEXT) as measure_id\n        , cast(measure_name as TEXT) as measure_name\n        , cast(measure_version as TEXT) as measure_version\n        , cast(denominator_flag as integer) as denominator_flag\n    from denominator\n\n)\n\nselect\n      person_id\n    , age\n    , performance_period_begin\n    , performance_period_end\n    , measure_id\n    , measure_name\n    , measure_version\n    , denominator_flag\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.quality_measures._int_supd_denominator"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.850693Z", "completed_at": "2025-02-25T21:26:20.935692Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:20.936198Z", "completed_at": "2025-02-25T21:26:20.936211Z"}], "thread_id": "Thread-3", "execution_time": 1.2597870826721191, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__combined_institutional_line_level", "compiled": true, "compiled_code": "\n\nWITH combine_line_models AS (\n  \n\n        (\n            select\n                cast('tuva.claims_preprocessing.service_category__pharmacy_institutional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"CLAIM_LINE_NUMBER\" as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(10)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(25)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(25)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(52)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as character varying(16777216)) as \"CLAIM_LINE_ID\" \n\n            from tuva.claims_preprocessing.service_category__pharmacy_institutional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing.service_category__outpatient_radiology_institutional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"CLAIM_LINE_NUMBER\" as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(10)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(25)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(25)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(52)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as character varying(16777216)) as \"CLAIM_LINE_ID\" \n\n            from tuva.claims_preprocessing.service_category__outpatient_radiology_institutional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing._int_observation_institutional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"CLAIM_LINE_NUMBER\" as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(10)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(25)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(25)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(52)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as character varying(16777216)) as \"CLAIM_LINE_ID\" \n\n            from tuva.claims_preprocessing._int_observation_institutional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing._int_ambulance_institutional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"CLAIM_LINE_NUMBER\" as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(10)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(25)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(25)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(52)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(\"CLAIM_LINE_ID\" as character varying(16777216)) as \"CLAIM_LINE_ID\" \n\n            from tuva.claims_preprocessing._int_ambulance_institutional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.dbt_sarah.service_category__dme_institutional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"CLAIM_LINE_NUMBER\" as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(10)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(25)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(25)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(52)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(\"CLAIM_LINE_ID\" as character varying(16777216)) as \"CLAIM_LINE_ID\" \n\n            from tuva.dbt_sarah.service_category__dme_institutional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing._int_lab_institutional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"CLAIM_LINE_NUMBER\" as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(10)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(25)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(25)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(52)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as character varying(16777216)) as \"CLAIM_LINE_ID\" \n\n            from tuva.claims_preprocessing._int_lab_institutional\n\n            \n        )\n\n        \n)\n\nSELECT\n  l.claim_id,\n  l.claim_line_number,\n  l.service_category_1,\n  l.service_category_2,\n  l.service_category_3,\n  l.source_model_name\nFROM combine_line_models l", "relation_name": "tuva.claims_preprocessing._int_combined_institutional_line_level"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:21.101094Z", "completed_at": "2025-02-25T21:26:21.109000Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:21.109343Z", "completed_at": "2025-02-25T21:26:21.109351Z"}], "thread_id": "Thread-3", "execution_time": 0.009185791015625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__office_based_other_professional", "compiled": true, "compiled_code": "\n\n\n  select distinct  \n  med.claim_id\n, med.claim_line_number\n, med.claim_line_id\n, 'office-based' as service_category_1    \n, 'office-based other' as service_category_2\n, 'office-based other' as service_category_3\n, 'service_category__office_based_other_professional' as source_model_name\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\n  from tuva.claims_preprocessing.service_category__stg_office_based med\n  left join tuva.claims_preprocessing.service_category__pharmacy_professional pharm on med.claim_line_id = pharm.claim_line_id\n  left join tuva.claims_preprocessing.service_category__office_based_radiology rad on med.claim_line_id = rad.claim_line_id\n  left join tuva.claims_preprocessing._int_office_based_visit_professional visit on med.claim_line_id = visit.claim_line_id\n  left join tuva.claims_preprocessing.service_category__office_based_surgery_professional surg on med.claim_line_id = surg.claim_line_id\n  left join tuva.claims_preprocessing.service_category__office_based_physical_therapy_professional pt on med.claim_line_id = pt.claim_line_id\n  where pharm.claim_line_id is null \n  and rad.claim_line_id is null \n  and visit.claim_line_id is null\n  and surg.claim_line_id is null\n  and pt.claim_line_id is null", "relation_name": "tuva.claims_preprocessing.service_category__office_based_other_professional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:21.111088Z", "completed_at": "2025-02-25T21:26:21.116069Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:21.116364Z", "completed_at": "2025-02-25T21:26:21.116370Z"}], "thread_id": "Thread-3", "execution_time": 0.006128787994384766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.pharmacy__int_generic_cost", "compiled": true, "compiled_code": "\n\n/* for each brand rxcui, what is the average cost/unit of generics available*/\n\nselect\n    g.product_rxcui as brand_rxcui\n  , cl.data_source\n  , max(case when claim_count > 0 then 1 else 0 end) as prescribed_atleast_one_generic_history\n  , sum(case when total_units > 0 and paid_amount > 0 then paid_amount else null end)/sum(case when total_units > 0 and paid_amount > 0 then total_units else null end) as generic_average_cost_per_unit\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.pharmacy.rxnorm_generic_available as g\nleft join tuva.pharmacy._int_claims_current_cost as cl \n  on cl.ndc_code = g.ndc\nwhere cl.brand_vs_generic = 'generic'\ngroup by\n    g.product_rxcui\n  , cl.data_source", "relation_name": "tuva.pharmacy._int_generic_cost"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:21.117869Z", "completed_at": "2025-02-25T21:26:21.122617Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:21.122893Z", "completed_at": "2025-02-25T21:26:21.122900Z"}], "thread_id": "Thread-3", "execution_time": 0.005711793899536133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.pharmacy__int_generic_cost_by_ndc", "compiled": true, "compiled_code": "\n\n/* for each brand rxcui, what is the average cost/unit of all generics available*/\n\nselect\n    g.product_rxcui as brand_rxcui\n  , cl.data_source\n  , cl.ndc_code as generic_ndc_code\n  , cl.paid_amount\n  , cl.claim_count\n  , cl.total_units\n  , cl.cost_per_unit\n  , case when claim_count > 0 then 1 else 0 end as prescribed_atleast_one_generic_history\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.pharmacy.rxnorm_generic_available as g\nleft join tuva.pharmacy._int_claims_current_cost as cl \n  on cl.ndc_code = g.ndc\nwhere cl.brand_vs_generic = 'generic'", "relation_name": "tuva.pharmacy._int_generic_cost_by_ndc"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:21.124266Z", "completed_at": "2025-02-25T21:26:21.133785Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:21.134060Z", "completed_at": "2025-02-25T21:26:21.134068Z"}], "thread_id": "Thread-3", "execution_time": 0.010448932647705078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.quality_measures__int_adh_diabetes_numerator", "compiled": true, "compiled_code": "\n\nwith denominator as (\n\n    select\n          person_id\n        , dispensing_date\n        , ndc_code\n        , days_supply\n        , days_in_treatment_period\n        , performance_period_begin\n        , performance_period_end\n        , measure_id\n        , measure_name\n        , measure_version\n    from tuva.quality_measures._int_adh_diabetes_denominator\n\n)\n\n, performance_end as (\n\n    select\n      performance_period_end\n    from tuva.quality_measures._int_adh_diabetes__performance_period\n\n)\n\n/*\n  The below 3 cte identifies periods of continuous medication use for each patient by:\n  1. Assigning a row number and tracking the previous medication per patient.\n  2. Flagging when a medication change occurs.\n  3. Grouping consecutive periods of the same medication by assigning a group ID.\n*/\n\n, ranked_patient as (\n\n    select\n          person_id\n        , dispensing_date\n        , ndc_code\n        , days_supply\n        , dense_rank() over (partition by person_id order by dispensing_date) as dr\n        , lag(ndc_code) over (partition by person_id order by dispensing_date) as previous_ndc\n    from denominator\n\n)\n\n, grouped_meds as (\n\n    select\n          person_id\n        , dispensing_date\n        , ndc_code\n        , days_supply\n        , dr\n        , case\n            when (ndc_code != previous_ndc) or previous_ndc is null then 1\n            else 0\n          end as med_change_flag --to increment group when medication changes\n    from ranked_patient\n\n)\n\n, final_groups as (\n\n    select\n          person_id\n        , ndc_code\n        , dispensing_date\n        , days_supply\n        , sum(med_change_flag) over (\n              partition by person_id \n              order by dr \n              rows between unbounded preceding and current row\n          ) as group_id\n    from grouped_meds\n\n)\n\n/*\n  The ctes below calculates adjusted medication fill dates,\n  groups fills by continuous periods of use and ensures accurate start and end dates based \n  on previous fills and the performance period.\n*/\n\n, fills as (\n\n    select\n          person_id\n        , group_id\n        , dispensing_date\n        , days_supply\n        , \n\n    dateadd(\n        day,\n        -1,\n        \n\n    dateadd(\n        day,\n        days_supply,\n        dispensing_date\n        )\n\n\n        )\n\n as theoretical_end_date\n    from final_groups\n\n)\n\n, previous_fill_end_date as (\n    \n    select\n          person_id\n        , group_id\n        , dispensing_date\n        , days_supply\n        , theoretical_end_date\n        , lag(theoretical_end_date)\n          over (partition by \n                person_id\n              , group_id  \n            order by\n                dispensing_date\n          ) as previous_end_date\n    from fills\n\n)\n\n, adjusted_fills as (\n    \n    /* Adjust start dates based on the previous fill's end date + 1,\n    or use the current rx_fill_date */\n    select\n          person_id\n        , group_id\n        , dispensing_date\n        , days_supply\n        , theoretical_end_date\n        , coalesce(\n            greatest(\n                  dispensing_date\n                , \n\n    dateadd(\n        day,\n        1,\n        previous_end_date\n        )\n\n\n                )\n            , dispensing_date\n        ) as adjusted_start_date\n    from previous_fill_end_date\n\n)\n\n, final_fills as (\n\n    select\n        person_id\n      , group_id\n      , dispensing_date\n      , days_supply\n      , adjusted_start_date\n      , least(\n            \n\n    dateadd(\n        day,\n        -1,\n        \n\n    dateadd(\n        day,\n        days_supply,\n        adjusted_start_date\n        )\n\n\n        )\n\n\n          , performance_period_end\n      ) as final_end_date\n    from adjusted_fills\n    inner join performance_end\n      on adjusted_fills.adjusted_start_date <= performance_end.performance_period_end\n\n)\n\n, grouped_fill_ranges as (\n\n    select\n          person_id\n        , group_id\n        , dispensing_date\n        , days_supply\n        , adjusted_start_date\n        , final_end_date\n        , min(adjusted_start_date) over(partition by person_id, group_id) as first_disp_date\n        , max(adjusted_start_date) over(partition by person_id, group_id) as last_disp_date\n    from final_fills\n\n)\n\n, last_med_end_groupwise as (\n\n    select\n          person_id\n        , group_id\n        , dispensing_date\n        , days_supply\n        , adjusted_start_date\n        , final_end_date\n        , first_disp_date\n        , last_disp_date\n        , max(\n            case\n              when adjusted_start_date = last_disp_date\n              then days_supply\n              else null\n            end) over (partition by person_id, group_id) as last_days_supply\n    from grouped_fill_ranges\n\n)\n\n/*\n  1. Calculates the total covered days per medication group per patient\n  2. Then calculates the overlap between groups of medication per patient\n  3. Finally calculates the actual total covered days for each patient\n*/\n\n, covered_days_per_group as (\n    \n    select\n          person_id\n        , group_id\n        , first_disp_date\n        , last_disp_date\n        , last_days_supply\n        , sum( 1 + datediff(\n        day,\n        adjusted_start_date,\n        final_end_date\n        ) ) as covered_days\n    from last_med_end_groupwise\n    group by \n          person_id\n        , group_id\n        , first_disp_date\n        , last_disp_date\n        , last_days_supply\n\n)\n\n, final_with_lag as (\n\n    select\n          person_id\n        , group_id\n        , first_disp_date\n        , last_disp_date\n        , covered_days\n        , lag(last_disp_date) over(partition by person_id order by first_disp_date) as lag_date\n        , lag(last_days_supply) over(partition by person_id order by first_disp_date) as lag_days_supply\n    from covered_days_per_group\n\n)\n\n, overlap_days as (\n\n    select\n          person_id\n        , group_id\n        , first_disp_date\n        , last_disp_date\n        , covered_days\n        , lag_date\n        , case\n            when first_disp_date < \n                \n\n    dateadd(\n        day,\n        lag_days_supply,\n        lag_date\n        )\n\n\n            then\n                datediff(\n        day,\n        first_disp_date,\n        \n\n    dateadd(\n        day,\n        lag_days_supply,\n        lag_date\n        )\n\n\n        )\n            else 0\n          end as overlap\n    from final_with_lag\n\n)\n\n, final_covered_days as (\n\n    select \n          person_id\n        , sum(covered_days) - sum(overlap) as actual_covered_days\n    from overlap_days\n    group by person_id\n\n)\n\n, relevant_patients_from_deno as (\n\n    select\n          final_covered_days.person_id\n        , round(cast(actual_covered_days / days_in_treatment_period as numeric(28,6)), 4) as adherence\n        , dispensing_date as evidence_date\n        , days_supply as evidence_value\n    from final_covered_days\n    inner join denominator\n      on final_covered_days.person_id = denominator.person_id\n        \n)\n\n, numerator as (\n\n    select\n          person_id\n        , adherence * 100 as adherence --percent conversion\n        , evidence_date\n        , evidence_value\n        , 1 as numerator_flag\n    from relevant_patients_from_deno\n    where adherence >= 0.8\n\n)\n\n, add_data_types as (\n\n    select\n          cast(person_id as TEXT) as person_id\n        , cast(evidence_date as date) as evidence_date\n        , cast(evidence_value as TEXT) as evidence_value\n        , cast(adherence as numeric(28,6)) as adherence\n        , cast(numerator_flag as integer) as numerator_flag\n    from numerator\n\n)\n\nselect\n      person_id\n    , evidence_date\n    , evidence_value\n    , adherence\n    , numerator_flag\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.quality_measures._int_adh_diabetes_numerator"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:21.135270Z", "completed_at": "2025-02-25T21:26:21.144327Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:21.144578Z", "completed_at": "2025-02-25T21:26:21.144585Z"}], "thread_id": "Thread-3", "execution_time": 0.009862899780273438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.quality_measures__int_adh_statins_numerator", "compiled": true, "compiled_code": "\n\nwith denominator as (\n\n    select\n          person_id\n        , dispensing_date\n        , first_dispensing_date\n        , days_supply\n        , ndc_code\n        , performance_period_begin\n        , performance_period_end\n        , measure_id\n        , measure_name\n        , measure_version\n    from tuva.quality_measures._int_adh_statins_denominator\n\n)\n\n, performance_end as (\n\n    select\n      performance_period_end\n    from tuva.quality_measures._int_adh_statins__performance_period\n\n)\n\n/*\nThe below 3 cte identifies periods of continuous medication use for each patient by:\n1. Assigning a row number and tracking the previous medication per patient.\n2. Flagging when a medication change occurs.\n3. Grouping consecutive periods of the same medication by assigning a group ID.\n*/\n\n, ranked_patient as (\n\n    select\n          person_id\n        , dispensing_date\n        , ndc_code\n        , days_supply\n        , dense_rank() over (partition by person_id order by dispensing_date) as dense_rank\n        , lag(ndc_code) over (partition by person_id order by dispensing_date) as previous_ndc\n    from denominator\n\n)\n\n, grouped_meds as (\n\n    select\n          person_id\n        , dispensing_date\n        , ndc_code\n        , days_supply\n        , dense_rank\n        , case\n            when (ndc_code != previous_ndc) or previous_ndc is null then 1\n            else 0\n          end as med_change_flag --to increment group when medication changes\n    from ranked_patient\n\n)\n\n, final_groups as (\n\n    select\n          person_id\n        , ndc_code\n        , dispensing_date\n        , days_supply\n        , sum(med_change_flag) over (\n              partition by person_id \n              order by dense_rank \n              rows between unbounded preceding and current row\n          ) as group_id\n    from grouped_meds\n\n)\n\n/*\nThis cte theoretical_end_dates to final_fills calculates adjusted medication fill dates, \ngroups fills by continuous periods of use and ensures accurate start and end dates based \non previous fills and the performance period.\n*/\n\n, theoretical_end_dates as (\n\n    select\n          person_id\n        , group_id\n        , dispensing_date\n        , days_supply\n        , \n\n    dateadd(\n        day,\n        -1,\n        \n\n    dateadd(\n        day,\n        days_supply,\n        dispensing_date\n        )\n\n\n        )\n\n as theoretical_end_date\n    from final_groups\n\n)\n\n/* \nAdjust start dates based on the previous fill's end date + 1,\nor use the current rx_fill_date \n*/\n\n, previous_fill_end_dates as (\n    \n    select\n          person_id\n        , group_id\n        , dispensing_date\n        , days_supply\n        , theoretical_end_date\n        , lag(theoretical_end_date)\n          over (partition by \n                person_id\n              , group_id  \n            order by\n                dispensing_date\n          ) as previous_fill_end_date\n    from theoretical_end_dates\n\n)\n\n, adjusted_fill_dates as (\n    \n    select\n          person_id\n        , group_id\n        , dispensing_date\n        , days_supply\n        , theoretical_end_date\n        , coalesce(\n            greatest(\n                  dispensing_date\n                , \n\n    dateadd(\n        day,\n        1,\n        previous_fill_end_date\n        )\n\n\n                )\n            , dispensing_date\n        ) as adjusted_fill_date\n    from previous_fill_end_dates\n\n)\n\n\n, actual_end_dates as (\n\n    select\n        person_id\n      , group_id\n      , dispensing_date\n      , days_supply\n      , adjusted_fill_date\n      , least(\n            \n\n    dateadd(\n        day,\n        -1,\n        \n\n    dateadd(\n        day,\n        days_supply,\n        adjusted_fill_date\n        )\n\n\n        )\n\n\n          , performance_period_end\n      ) as actual_end_date\n    from adjusted_fill_dates\n    inner join performance_end\n      on adjusted_fill_dates.adjusted_fill_date <= performance_end.performance_period_end\n\n)\n\n, grouped_fill_ranges as (\n\n    select\n          person_id\n        , group_id\n        , dispensing_date\n        , days_supply\n        , adjusted_fill_date\n        , actual_end_date\n        , min(adjusted_fill_date) over(partition by person_id, group_id) as group_first\n        , max(adjusted_fill_date) over(partition by person_id, group_id) as group_last\n    from actual_end_dates\n\n)\n\n, final_fills as (\n\n    select\n          person_id\n        , group_id\n        , dispensing_date\n        , days_supply\n        , adjusted_fill_date\n        , actual_end_date\n        , group_first\n        , group_last\n        , max(\n            case\n              when adjusted_fill_date = group_last\n              then days_supply\n              else 0\n            end) over (partition by person_id, group_id) as group_last_days_supply\n    from grouped_fill_ranges\n\n)\n\n/*\n1. Calculates the total covered days per every medication group per patient\n2. Then, calculates the overlap between groups of medication per patient.\n3. Then, calculates the actual total covered days for each patient.\n*/\n\n, covered_days_per_groups as (\n    \n    select\n          person_id\n        , group_id\n        , group_first\n        , group_last\n        , group_last_days_supply\n        , sum( 1 + datediff(\n        day,\n        adjusted_fill_date,\n        actual_end_date\n        ) ) as covered_days_per_group\n    from final_fills\n    group by \n          person_id\n        , group_id\n        , group_first\n        , group_last\n        , group_last_days_supply\n\n)\n\n, with_lag as (\n\n    select\n          person_id\n        , group_id\n        , group_first\n        , group_last\n        , covered_days_per_group\n        , lag(group_last) over(partition by person_id order by group_first) as lag_date\n        , lag(group_last_days_supply) over(partition by person_id order by group_first) as lag_days_supply\n    from covered_days_per_groups\n\n)\n\n, overlap_days as (\n\n    select\n          person_id\n        , group_id\n        , group_first\n        , group_last\n        , covered_days_per_group\n        , lag_date\n        , case\n            when group_first < \n                \n\n    dateadd(\n        day,\n        lag_days_supply,\n        lag_date\n        )\n\n\n            then\n                datediff(\n        day,\n        group_first,\n        \n\n    dateadd(\n        day,\n        lag_days_supply,\n        lag_date\n        )\n\n\n        )\n            else 0\n          end as overlap\n    from with_lag\n\n)\n\n\n, final_covered_days as (\n\n    select \n          person_id\n        , sum(covered_days_per_group) - sum(overlap) as actual_covered_days\n    from overlap_days\n    group by person_id\n\n)\n\n, patient_with_treatment_period_days as (\n    select\n          person_id\n        , datediff(\n        day,\n        first_dispensing_date,\n        performance_period_end\n        ) as treatment_period_days\n    from denominator\n\n)\n\n, patient_with_pdc as (\n\n    select\n          final_covered_days.person_id\n        , round(cast(actual_covered_days * 100 / treatment_period_days as numeric(28,6)), 4) as adherence\n    from final_covered_days\n    inner join patient_with_treatment_period_days \n        on final_covered_days.person_id = patient_with_treatment_period_days.person_id\n\n)\n\n/*\nSelects only the patient whose pdc is greater than 80%.\n*/\n\n, valid_patients as (\n\n    select \n          patient_with_pdc.person_id\n        , adherence\n        , denominator.dispensing_date as evidence_date\n        , denominator.days_supply as evidence_value\n        , 1 as numerator_flag\n    from patient_with_pdc \n    inner join denominator\n        on patient_with_pdc.person_id = denominator.person_id \n    where patient_with_pdc.adherence >= 80.00 \n\n)\n\n, add_data_types as (\n\n    select\n          cast(person_id as TEXT) as person_id\n        , cast(evidence_date as date) as evidence_date\n        , cast(evidence_value as TEXT) as evidence_value\n        , cast(adherence as numeric(28,6)) as adherence\n        , cast(numerator_flag as integer) as numerator_flag\n    from valid_patients\n\n)\n\nselect\n      person_id\n    , evidence_date\n    , evidence_value\n    , adherence\n    , numerator_flag\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.quality_measures._int_adh_statins_numerator"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:21.145673Z", "completed_at": "2025-02-25T21:26:21.242000Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:21.242489Z", "completed_at": "2025-02-25T21:26:21.242499Z"}], "thread_id": "Thread-3", "execution_time": 0.09734392166137695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.quality_measures__int_adhras_numerator", "compiled": true, "compiled_code": "\n\nwith denominator as (\n\n    select\n          person_id\n        , dispensing_date\n        , first_dispensing_date\n        , days_supply\n        , ndc_code\n        , performance_period_begin\n        , performance_period_end\n        , measure_id\n        , measure_name\n        , measure_version\n    from tuva.quality_measures._int_adhras_denominator\n\n)\n\n, performance_end as (\n\n    select\n      performance_period_end\n    from tuva.quality_measures._int_adhras__performance_period\n\n)\n\n/*\nThe below 3 cte identifies periods of continuous medication use for each patient by:\n1. Assigning a row number and tracking the previous medication per patient.\n2. Flagging when a medication change occurs.\n3. Grouping consecutive periods of the same medication by assigning a group ID.\n*/\n\n, ranked_patient as (\n\n    select\n          person_id\n        , dispensing_date\n        , ndc_code\n        , days_supply\n        , dense_rank() over (partition by person_id order by dispensing_date) as dense_rank\n        , lag(ndc_code) over (partition by person_id order by dispensing_date) as previous_ndc\n    from denominator\n\n)\n\n, grouped_meds as (\n\n    select\n          person_id\n        , dispensing_date\n        , ndc_code\n        , days_supply\n        , dense_rank\n        , case\n            when (ndc_code != previous_ndc) or previous_ndc is null then 1\n            else 0\n          end as med_change_flag --to increment group when medication changes\n    from ranked_patient\n\n)\n\n, final_groups as (\n\n    select\n          person_id\n        , ndc_code\n        , dispensing_date\n        , days_supply\n        , sum(med_change_flag) over (\n              partition by person_id \n              order by dense_rank \n              rows between unbounded preceding and current row\n          ) as group_id\n    from grouped_meds\n\n)\n\n/*\nThis cte theoretical_end_dates to final_fills calculates adjusted medication fill dates, \ngroups fills by continuous periods of use and ensures accurate start and end dates based \non previous fills and the performance period.\n*/\n\n, theoretical_end_dates as (\n\n    select\n          person_id\n        , group_id\n        , dispensing_date\n        , days_supply\n        , \n\n    dateadd(\n        day,\n        -1,\n        \n\n    dateadd(\n        day,\n        days_supply,\n        dispensing_date\n        )\n\n\n        )\n\n as theoretical_end_date\n    from final_groups\n\n)\n\n/* \nAdjust start dates based on the previous fill's end date + 1,\nor use the current rx_fill_date \n*/\n\n, previous_fill_end_dates as (\n    \n    select\n          person_id\n        , group_id\n        , dispensing_date\n        , days_supply\n        , theoretical_end_date\n        , lag(theoretical_end_date)\n          over (partition by \n                person_id\n              , group_id  \n            order by\n                dispensing_date\n          ) as previous_fill_end_date\n    from theoretical_end_dates\n\n)\n\n, adjusted_fill_dates as (\n    \n    select\n          person_id\n        , group_id\n        , dispensing_date\n        , days_supply\n        , theoretical_end_date\n        , coalesce(\n            greatest(\n                  dispensing_date\n                , \n\n    dateadd(\n        day,\n        1,\n        previous_fill_end_date\n        )\n\n\n                )\n            , dispensing_date\n        ) as adjusted_fill_date\n    from previous_fill_end_dates\n\n)\n\n\n, actual_end_dates as (\n\n    select\n        person_id\n      , group_id\n      , dispensing_date\n      , days_supply\n      , adjusted_fill_date\n      , least(\n            \n\n    dateadd(\n        day,\n        -1,\n        \n\n    dateadd(\n        day,\n        days_supply,\n        adjusted_fill_date\n        )\n\n\n        )\n\n\n          , performance_period_end\n      ) as actual_end_date\n    from adjusted_fill_dates\n    inner join performance_end\n      on adjusted_fill_dates.adjusted_fill_date <= performance_end.performance_period_end\n\n)\n\n, grouped_fill_ranges as (\n\n    select\n          person_id\n        , group_id\n        , dispensing_date\n        , days_supply\n        , adjusted_fill_date\n        , actual_end_date\n        , min(adjusted_fill_date) over(partition by person_id, group_id) as group_first\n        , max(adjusted_fill_date) over(partition by person_id, group_id) as group_last\n    from actual_end_dates\n\n)\n\n, final_fills as (\n\n    select\n          person_id\n        , group_id\n        , dispensing_date\n        , days_supply\n        , adjusted_fill_date\n        , actual_end_date\n        , group_first\n        , group_last\n        , max(\n            case\n              when adjusted_fill_date = group_last\n              then days_supply\n              else 0\n            end) over (partition by person_id, group_id) as group_last_days_supply\n    from grouped_fill_ranges\n\n)\n\n/*\n1. Calculates the total covered days per every medication group per patient\n2. Then, calculates the overlap between groups of medication per patient.\n3. Then, calculates the actual total covered days for each patient.\n*/\n\n, covered_days_per_groups as (\n    \n    select\n          person_id\n        , group_id\n        , group_first\n        , group_last\n        , group_last_days_supply\n        , sum( 1 + datediff(\n        day,\n        adjusted_fill_date,\n        actual_end_date\n        ) ) as covered_days_per_group\n    from final_fills\n    group by \n          person_id\n        , group_id\n        , group_first\n        , group_last\n        , group_last_days_supply\n\n)\n\n, with_lag as (\n\n    select\n          person_id\n        , group_id\n        , group_first\n        , group_last\n        , covered_days_per_group\n        , lag(group_last) over(partition by person_id order by group_first) as lag_date\n        , lag(group_last_days_supply) over(partition by person_id order by group_first) as lag_days_supply\n    from covered_days_per_groups\n\n)\n\n, overlap_days as (\n\n    select\n          person_id\n        , group_id\n        , group_first\n        , group_last\n        , covered_days_per_group\n        , lag_date\n        , case\n            when group_first < \n                \n\n    dateadd(\n        day,\n        lag_days_supply,\n        lag_date\n        )\n\n\n            then\n                datediff(\n        day,\n        group_first,\n        \n\n    dateadd(\n        day,\n        lag_days_supply,\n        lag_date\n        )\n\n\n        )\n            else 0\n          end as overlap\n    from with_lag\n\n)\n\n\n, final_covered_days as (\n\n    select \n          person_id\n        , sum(covered_days_per_group) - sum(overlap) as actual_covered_days\n    from overlap_days\n    group by person_id\n\n)\n\n, patient_with_treatment_period_days as (\n    select\n          person_id\n        , datediff(\n        day,\n        first_dispensing_date,\n        performance_period_end\n        ) as treatment_period_days\n    from denominator\n\n)\n\n, patient_with_pdc as (\n\n    select\n          final_covered_days.person_id\n        , round(cast(actual_covered_days * 100 / treatment_period_days as numeric(28,6)), 4) as adherence\n    from final_covered_days\n    inner join patient_with_treatment_period_days \n        on final_covered_days.person_id = patient_with_treatment_period_days.person_id\n\n)\n\n/*\nSelects only the patient whose pdc is greater than 80%.\n*/\n\n, valid_patients as (\n\n    select \n          patient_with_pdc.person_id\n        , adherence\n        , denominator.dispensing_date as evidence_date\n        , denominator.days_supply as evidence_value\n        , 1 as numerator_flag\n    from patient_with_pdc \n    inner join denominator\n        on patient_with_pdc.person_id = denominator.person_id \n    where patient_with_pdc.adherence >= 80.00 \n\n)\n\n, add_data_types as (\n\n    select\n          cast(person_id as TEXT) as person_id\n        , cast(evidence_date as date) as evidence_date\n        , cast(evidence_value as TEXT) as evidence_value\n        , cast(adherence as numeric(28,6)) as adherence\n        , cast(numerator_flag as integer) as numerator_flag\n    from valid_patients\n\n)\n\nselect\n      person_id\n    , evidence_date\n    , evidence_value\n    , adherence\n    , numerator_flag\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.quality_measures._int_adhras_numerator"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:21.244647Z", "completed_at": "2025-02-25T21:26:21.260794Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:21.261111Z", "completed_at": "2025-02-25T21:26:21.261117Z"}], "thread_id": "Thread-3", "execution_time": 0.017885208129882812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.quality_measures__int_supd_numerator", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte___stg_pharmacy_claim as (\n\n\nselect\n      person_id\n    , dispensing_date\n    , ndc_code\n    , days_supply\n    , paid_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.pharmacy_claim\n\n\n), denominator as (\n\n    select\n          person_id\n        , performance_period_begin\n        , performance_period_end\n        , measure_id\n        , measure_name\n        , measure_version\n    from tuva.quality_measures._int_supd_denominator\n\n)\n\n, statin_codes as (\n\n    select\n        code\n      , code_system\n    from tuva.quality_measures._value_set_codes\n    where lower(concept_name) in (\n        'pqa statin medications'\n    )\n\n)\n\n, patients_taking_statin_meds as (\n\n    select\n        person_id\n      , dispensing_date\n    from __dbt__cte___stg_pharmacy_claim as pharmacy_claims\n    inner join statin_codes\n        on pharmacy_claims.ndc_code = statin_codes.code\n            and statin_codes.code_system = 'ndc'\n\n)\n\n, qualifying_patients_in_deno as (\n\n    select\n          patients_taking_statin_meds.person_id\n        , patients_taking_statin_meds.dispensing_date as evidence_date\n    from patients_taking_statin_meds\n    inner join denominator\n      on patients_taking_statin_meds.person_id = denominator.person_id\n        and dispensing_date between \n          denominator.performance_period_begin and denominator.performance_period_end\n        \n)\n\n, numerator as (\n\n    select\n          person_id\n        , evidence_date\n        , 1 as numerator_flag\n    from qualifying_patients_in_deno\n\n)\n\n, add_data_types as (\n\n    select\n          cast(person_id as TEXT) as person_id\n        , cast(evidence_date as date) as evidence_date\n        , cast(null as TEXT) as evidence_value\n        , cast(numerator_flag as integer) as numerator_flag\n    from numerator\n\n)\n\nselect\n      person_id\n    , evidence_date\n    , evidence_value\n    , numerator_flag\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.quality_measures._int_supd_numerator"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:18.311751Z", "completed_at": "2025-02-25T21:26:21.244097Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:21.257899Z", "completed_at": "2025-02-25T21:26:21.257907Z"}], "thread_id": "Thread-1", "execution_time": 3.1308250427246094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__data_quality_test_summary", "compiled": true, "compiled_code": "\n\nwith unioned_data as (\n\n  -- Unioning multiple data quality checks, excluding the _loaded_at field\n  \n\n        (\n            select\n                cast('tuva.data_quality.medical_claim_claim_line_fields' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"DATA_QUALITY_CHECK\" as character varying(64)) as \"DATA_QUALITY_CHECK\" ,\n                    cast(\"RESULT_COUNT\" as NUMBER(13,0)) as \"RESULT_COUNT\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.data_quality.medical_claim_claim_line_fields\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.data_quality.medical_claim_date_checks' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"DATA_QUALITY_CHECK\" as character varying(64)) as \"DATA_QUALITY_CHECK\" ,\n                    cast(\"RESULT_COUNT\" as NUMBER(13,0)) as \"RESULT_COUNT\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.data_quality.medical_claim_date_checks\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.data_quality.medical_claim_inst_header_fields' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"DATA_QUALITY_CHECK\" as character varying(64)) as \"DATA_QUALITY_CHECK\" ,\n                    cast(\"RESULT_COUNT\" as NUMBER(13,0)) as \"RESULT_COUNT\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.data_quality.medical_claim_inst_header_fields\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.data_quality.medical_claim_person_id' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"DATA_QUALITY_CHECK\" as character varying(64)) as \"DATA_QUALITY_CHECK\" ,\n                    cast(\"RESULT_COUNT\" as NUMBER(13,0)) as \"RESULT_COUNT\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.data_quality.medical_claim_person_id\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.data_quality.medical_claim_provider_npi' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"DATA_QUALITY_CHECK\" as character varying(64)) as \"DATA_QUALITY_CHECK\" ,\n                    cast(\"RESULT_COUNT\" as NUMBER(13,0)) as \"RESULT_COUNT\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.data_quality.medical_claim_provider_npi\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.data_quality.pharmacy_claim_date_checks' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"DATA_QUALITY_CHECK\" as character varying(64)) as \"DATA_QUALITY_CHECK\" ,\n                    cast(\"RESULT_COUNT\" as NUMBER(13,0)) as \"RESULT_COUNT\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.data_quality.pharmacy_claim_date_checks\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.data_quality.pharmacy_claim_ndc' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"DATA_QUALITY_CHECK\" as character varying(64)) as \"DATA_QUALITY_CHECK\" ,\n                    cast(\"RESULT_COUNT\" as NUMBER(13,0)) as \"RESULT_COUNT\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.data_quality.pharmacy_claim_ndc\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.data_quality.pharmacy_claim_npi' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"DATA_QUALITY_CHECK\" as character varying(64)) as \"DATA_QUALITY_CHECK\" ,\n                    cast(\"RESULT_COUNT\" as NUMBER(13,0)) as \"RESULT_COUNT\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.data_quality.pharmacy_claim_npi\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.data_quality.pharmacy_claim_prescription_details' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"DATA_QUALITY_CHECK\" as character varying(64)) as \"DATA_QUALITY_CHECK\" ,\n                    cast(\"RESULT_COUNT\" as NUMBER(13,0)) as \"RESULT_COUNT\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.data_quality.pharmacy_claim_prescription_details\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.data_quality.pharmacy_claim_person_id' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"DATA_QUALITY_CHECK\" as character varying(64)) as \"DATA_QUALITY_CHECK\" ,\n                    cast(\"RESULT_COUNT\" as NUMBER(13,0)) as \"RESULT_COUNT\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.data_quality.pharmacy_claim_person_id\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.data_quality.primary_key_check' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"DATA_QUALITY_CHECK\" as character varying(64)) as \"DATA_QUALITY_CHECK\" ,\n                    cast(\"RESULT_COUNT\" as NUMBER(13,0)) as \"RESULT_COUNT\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.data_quality.primary_key_check\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.data_quality.eligibility_date_checks' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"DATA_QUALITY_CHECK\" as character varying(64)) as \"DATA_QUALITY_CHECK\" ,\n                    cast(\"RESULT_COUNT\" as NUMBER(13,0)) as \"RESULT_COUNT\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.data_quality.eligibility_date_checks\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.data_quality.eligibility_demographics' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"DATA_QUALITY_CHECK\" as character varying(64)) as \"DATA_QUALITY_CHECK\" ,\n                    cast(\"RESULT_COUNT\" as NUMBER(13,0)) as \"RESULT_COUNT\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.data_quality.eligibility_demographics\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.data_quality.eligibility_missing_person_id' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"DATA_QUALITY_CHECK\" as character varying(64)) as \"DATA_QUALITY_CHECK\" ,\n                    cast(\"RESULT_COUNT\" as NUMBER(13,0)) as \"RESULT_COUNT\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.data_quality.eligibility_missing_person_id\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.data_quality.eligibility_missing_payer' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"DATA_QUALITY_CHECK\" as character varying(64)) as \"DATA_QUALITY_CHECK\" ,\n                    cast(\"RESULT_COUNT\" as NUMBER(13,0)) as \"RESULT_COUNT\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.data_quality.eligibility_missing_payer\n\n            \n        )\n\n        \n\n)\n\nselect\n  data_quality_check\n  , result_count\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom unioned_data\nwhere data_quality_check <> 'Percent of claims with secondary diagnosis'", "relation_name": "tuva.data_quality.data_quality_test_summary"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:21.442804Z", "completed_at": "2025-02-25T21:26:21.455872Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:21.456146Z", "completed_at": "2025-02-25T21:26:21.456153Z"}], "thread_id": "Thread-1", "execution_time": 0.014159917831420898, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.pharmacy__brand_generic_opportunity", "compiled": true, "compiled_code": "\n\n/* claimid/line/source grain. calculates opportunity at line level*/\n\nwith  __dbt__cte__stg_pharmacy_claim as (\n\n\nselect \n    p.ndc_code\n  , n.fda_description as ndc_description\n  , p.data_source\n  , n.rxcui\n  , p.paid_amount\n  , p.allowed_amount\n  , p.claim_id\n  , p.claim_line_number\n  , p.person_id\n  , p.member_id\n  , p.prescribing_provider_id\n  , p.dispensing_provider_id\n  , p.dispensing_date\n  , p.quantity\n  , p.days_supply\n  , p.refills\n  , p.paid_date\nfrom tuva.core.pharmacy_claim as p\nleft join tuva.terminology.ndc as n \n  on p.ndc_code = n.ndc\n), cpu as (\nselect claim_id\n,claim_line_number\n,data_source\n,case when quantity > 0 then paid_amount/quantity else null end as brand_cost_per_unit\nfrom __dbt__cte__stg_pharmacy_claim\n)\n\n\nselect \n    pc.data_source\n  , pc.claim_id\n  , pc.claim_line_number\n  , cc.ndc_code\n  , cc.ndc_description\n  , cc.rxcui as brand_rxcui\n  , cc.brand_vs_generic \n  , cc.generic_available\n  , pc.paid_amount\n  , pc.quantity as total_units\n  , cpu.brand_cost_per_unit\n  , gc.generic_average_cost_per_unit \n  , cpu.brand_cost_per_unit - gc.generic_average_cost_per_unit as brand_less_generic_cost_per_unit\n  , case \n      when cpu.brand_cost_per_unit - gc.generic_average_cost_per_unit > 0 \n        then (cpu.brand_cost_per_unit - gc.generic_average_cost_per_unit) * pc.quantity \n      else 0 \n    end as generic_available_total_opportunity\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom __dbt__cte__stg_pharmacy_claim as pc\ninner join cpu on pc.claim_id = cpu.claim_id\n  and\n  pc.claim_line_number = cpu.claim_line_number\n  and\n  pc.data_source = cpu.data_source\ninner join tuva.pharmacy._int_claims_current_cost cc\n  on cc.ndc_code = pc.ndc_code\n  and\n  cc.data_source = pc.data_source\ninner join tuva.pharmacy._int_generic_cost  as gc \n  on cc.rxcui = gc.brand_rxcui\n  and gc.data_source = cc.data_source\nwhere prescribed_atleast_one_generic_history = 1", "relation_name": "tuva.pharmacy.brand_generic_opportunity"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:21.457615Z", "completed_at": "2025-02-25T21:26:21.461574Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:21.461892Z", "completed_at": "2025-02-25T21:26:21.461899Z"}], "thread_id": "Thread-1", "execution_time": 0.004970073699951172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.not_null_data_quality__data_quality_test_summary_data_quality_check.dd0d557084", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect data_quality_check\nfrom tuva.data_quality.data_quality_test_summary\nwhere data_quality_check is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:21.463177Z", "completed_at": "2025-02-25T21:26:21.467904Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:21.468155Z", "completed_at": "2025-02-25T21:26:21.468162Z"}], "thread_id": "Thread-1", "execution_time": 0.0056192874908447266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.unique_data_quality__data_quality_test_summary_data_quality_check.952b80bd98", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    data_quality_check as unique_field,\n    count(*) as n_records\n\nfrom tuva.data_quality.data_quality_test_summary\nwhere data_quality_check is not null\ngroup by data_quality_check\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:21.469608Z", "completed_at": "2025-02-25T21:26:21.526285Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:21.530655Z", "completed_at": "2025-02-25T21:26:21.530670Z"}], "thread_id": "Thread-1", "execution_time": 0.06187701225280762, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.pharmacy__pharmacy_claim_expanded", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte__stg_pharmacy_claim as (\n\n\nselect \n    p.ndc_code\n  , n.fda_description as ndc_description\n  , p.data_source\n  , n.rxcui\n  , p.paid_amount\n  , p.allowed_amount\n  , p.claim_id\n  , p.claim_line_number\n  , p.person_id\n  , p.member_id\n  , p.prescribing_provider_id\n  , p.dispensing_provider_id\n  , p.dispensing_date\n  , p.quantity\n  , p.days_supply\n  , p.refills\n  , p.paid_date\nfrom tuva.core.pharmacy_claim as p\nleft join tuva.terminology.ndc as n \n  on p.ndc_code = n.ndc\n), all_drugs as (\n  select \n      p.data_source\n    , p.claim_id\n    , p.claim_line_number\n    , p.person_id\n    , p.member_id\n    , p.prescribing_provider_id\n    , p.dispensing_provider_id\n    , p.dispensing_date\n    , p.ndc_code\n    , p.ndc_description\n    , p.quantity\n    , p.days_supply\n    , p.refills\n    , p.paid_date\n    , p.paid_amount\n    , p.allowed_amount\n    , p.rxcui\n    , r.product_name\n    , r.product_tty\n    , r.brand_vs_generic\n    , r.brand_name\n    , r.clinical_product_rxcui as generic_rxcui\n    , r.clinical_product_name as generic_rxcui_description\n    , r.clinical_product_tty as generic_tty\n    , r.ingredient_name\n    , r.dose_form_name\n    , case \n        when ga.brand_with_generic_available is not null \n          then 'brand_with_generic_available' \n        else r.brand_vs_generic \n      end as generic_available\n    , opp.brand_cost_per_unit\n    , opp.generic_average_cost_per_unit\n    , opp.brand_less_generic_cost_per_unit\n    , opp.generic_available_total_opportunity\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\n  from __dbt__cte__stg_pharmacy_claim as p\n  left join tuva.terminology.rxnorm_brand_generic as r \n    on p.rxcui = r.product_rxcui\n  left join tuva.pharmacy._int_brand_with_generic_available as ga \n    on p.rxcui = ga.brand_with_generic_available\n  left join tuva.pharmacy.brand_generic_opportunity as opp \n    on p.claim_id = opp.claim_id\n    and p.claim_line_number = opp.claim_line_number\n    and p.data_source = opp.data_source\n)\n\n, generic_available as (\n  select \n      *\n    , row_number() over (order by ndc_code, data_source) as generic_available_sk\n  from all_drugs\n  where generic_available = 'brand_with_generic_available'\n)\n\nselect \n    a.data_source\n  , a.claim_id\n  , a.claim_line_number\n  , a.person_id\n  , a.prescribing_provider_id\n  , a.dispensing_provider_id\n  , a.dispensing_date\n  , a.ndc_code\n  , a.ndc_description\n  , a.quantity\n  , a.days_supply\n  , a.refills\n  , a.paid_date\n  , a.paid_amount\n  , a.allowed_amount\n  , a.rxcui\n  , a.product_name\n  , a.product_tty\n  , a.brand_vs_generic\n  , a.brand_name\n  , a.generic_rxcui\n  , a.generic_rxcui_description\n  , a.generic_tty\n  , a.ingredient_name\n  , a.dose_form_name\n  , a.generic_available\n  , a.brand_cost_per_unit\n  , a.generic_average_cost_per_unit\n  , a.brand_less_generic_cost_per_unit\n  , a.generic_available_total_opportunity\n  , g.generic_available_sk\nfrom all_drugs as a\nleft join generic_available as g \n  on a.claim_id = g.claim_id\n  and a.claim_line_number = g.claim_line_number\n  and a.data_source = g.data_source", "relation_name": "tuva.pharmacy.pharmacy_claim_expanded"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:21.538813Z", "completed_at": "2025-02-25T21:26:21.544843Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:21.545243Z", "completed_at": "2025-02-25T21:26:21.545252Z"}], "thread_id": "Thread-1", "execution_time": 0.00733637809753418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.dbt_utils_unique_combination_of_columns_pharmacy__brand_generic_opportunity_data_source__claim_id__claim_line_number.c19d0cecc7", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        data_source, claim_id, claim_line_number\n    from tuva.pharmacy.brand_generic_opportunity\n    group by data_source, claim_id, claim_line_number\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:21.546831Z", "completed_at": "2025-02-25T21:26:21.564038Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:21.564330Z", "completed_at": "2025-02-25T21:26:21.564337Z"}], "thread_id": "Thread-1", "execution_time": 0.01817917823791504, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.pharmacy__generic_available_list", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte__stg_pharmacy_claim as (\n\n\nselect \n    p.ndc_code\n  , n.fda_description as ndc_description\n  , p.data_source\n  , n.rxcui\n  , p.paid_amount\n  , p.allowed_amount\n  , p.claim_id\n  , p.claim_line_number\n  , p.person_id\n  , p.member_id\n  , p.prescribing_provider_id\n  , p.dispensing_provider_id\n  , p.dispensing_date\n  , p.quantity\n  , p.days_supply\n  , p.refills\n  , p.paid_date\nfrom tuva.core.pharmacy_claim as p\nleft join tuva.terminology.ndc as n \n  on p.ndc_code = n.ndc\n), generic_sk as (\n  select \n      generic_available_sk\n    , claim_id\n    , claim_line_number\n    , data_source\n  from tuva.pharmacy.pharmacy_claim_expanded as e\n  where generic_available_sk is not null\n)\n\nselect \n    sk.generic_available_sk\n  , p.data_source\n  , p.ndc_code as brand_ndc_code\n  , p.ndc_description as brand_ndc_description\n  , p.rxcui as brand_rxcui\n  , p.paid_amount as brand_paid_amount\n  , p.quantity as brand_units\n  , case \n      when p.quantity = 0 \n        then 0 \n      else p.paid_amount / p.quantity  \n    end as brand_paid_per_unit\n  , ga.ndc as generic_ndc\n  , n.fda_description as generic_ndc_description\n  , case \n      when gc.ndc_code is not null \n        then 1 \n      else 0 \n    end as generic_prescribed_history\n  , gc.cost_per_unit as generic_cost_per_unit\n  , gc.cost_per_unit * p.quantity as generic_cost_at_units\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom __dbt__cte__stg_pharmacy_claim as p\ninner join generic_sk as sk \n  on p.claim_id = sk.claim_id\n  and p.claim_line_number = sk.claim_line_number\n  and p.data_source = sk.data_source\ninner join tuva.pharmacy._int_brand_with_generic_available as b \n  on p.rxcui = b.brand_with_generic_available\ninner join tuva.pharmacy.rxnorm_generic_available as ga \n  on p.rxcui = ga.product_rxcui\n  and ga.ndc_product_tty in ('SCD','GPCK')\nleft join tuva.terminology.ndc as n \n  on ga.ndc = n.ndc\nleft join tuva.pharmacy._int_claims_current_cost as gc \n  on ga.ndc = gc.ndc_code\n  and gc.brand_vs_generic = 'generic'\n  and gc.data_source = p.data_source\nwhere \n    ga.product_startmarketingdate is not null\n    \n        and cast(ga.product_startmarketingdate as date) <= current_date\n", "relation_name": "tuva.pharmacy.generic_available_list"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:21.565667Z", "completed_at": "2025-02-25T21:26:21.569665Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:21.569976Z", "completed_at": "2025-02-25T21:26:21.569984Z"}], "thread_id": "Thread-1", "execution_time": 0.0050029754638671875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.dbt_utils_unique_combination_of_columns_pharmacy__pharmacy_claim_expanded_data_source__claim_id__claim_line_number.132bf82f59", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        data_source, claim_id, claim_line_number\n    from tuva.pharmacy.pharmacy_claim_expanded\n    group by data_source, claim_id, claim_line_number\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:21.571113Z", "completed_at": "2025-02-25T21:26:21.575323Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:21.575609Z", "completed_at": "2025-02-25T21:26:21.575616Z"}], "thread_id": "Thread-1", "execution_time": 0.00504612922668457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.mart_review__generics", "compiled": true, "compiled_code": "\n\nselect *\nfrom tuva.pharmacy.generic_available_list", "relation_name": "tuva.data_quality.mart_review__generics"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:21.576869Z", "completed_at": "2025-02-25T21:26:21.580651Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:21.580908Z", "completed_at": "2025-02-25T21:26:21.580915Z"}], "thread_id": "Thread-1", "execution_time": 0.004683017730712891, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.dbt_utils_unique_combination_of_columns_pharmacy__generic_available_list_generic_available_sk__generic_ndc.5460505c42", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        generic_available_sk, generic_ndc\n    from tuva.pharmacy.generic_available_list\n    group by generic_available_sk, generic_ndc\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:19.841727Z", "completed_at": "2025-02-25T21:26:22.933957Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:22.934439Z", "completed_at": "2025-02-25T21:26:22.934451Z"}], "thread_id": "Thread-2", "execution_time": 3.2504079341888428, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__combined_institutional_header_level", "compiled": true, "compiled_code": "\n\nWITH combine_header_models AS (\n  \n\n        (\n            select\n                cast('tuva.claims_preprocessing._int_acute_inpatient_institutional_other' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(10)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(29)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(29)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(59)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" \n\n            from tuva.claims_preprocessing._int_acute_inpatient_institutional_other\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing._int_acute_inpatient_institutional_maternity' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(10)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(29)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(29)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(59)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" \n\n            from tuva.claims_preprocessing._int_acute_inpatient_institutional_maternity\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing._int_acute_inpatient_institutional_med_surg' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(10)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(29)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(29)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(59)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" \n\n            from tuva.claims_preprocessing._int_acute_inpatient_institutional_med_surg\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing._int_inpatient_substance_use_institutional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(10)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(29)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(29)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(59)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" \n\n            from tuva.claims_preprocessing._int_inpatient_substance_use_institutional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing._int_ambulatory_surgery_institutional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(10)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(29)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(29)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(59)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" \n\n            from tuva.claims_preprocessing._int_ambulatory_surgery_institutional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing._int_dialysis_institutional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(10)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(29)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(29)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(59)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" \n\n            from tuva.claims_preprocessing._int_dialysis_institutional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing._int_emergency_department_institutional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(10)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(29)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(29)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(59)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" \n\n            from tuva.claims_preprocessing._int_emergency_department_institutional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing._int_home_health_institutional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(10)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(29)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(29)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(59)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" \n\n            from tuva.claims_preprocessing._int_home_health_institutional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing._int_inpatient_hospice_institutional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(10)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(29)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(29)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(59)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" \n\n            from tuva.claims_preprocessing._int_inpatient_hospice_institutional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing._int_outpatient_hospice_institutional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(10)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(29)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(29)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(59)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" \n\n            from tuva.claims_preprocessing._int_outpatient_hospice_institutional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing._int_outpatient_hospital_or_clinic_institutional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(10)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(29)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(29)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(59)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" \n\n            from tuva.claims_preprocessing._int_outpatient_hospital_or_clinic_institutional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing.service_category__outpatient_physical_therapy_institutional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(10)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(29)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(29)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(59)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(\"CLAIM_LINE_NUMBER\" as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" \n\n            from tuva.claims_preprocessing.service_category__outpatient_physical_therapy_institutional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing._int_outpatient_psychiatric_institutional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(10)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(29)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(29)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(59)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" \n\n            from tuva.claims_preprocessing._int_outpatient_psychiatric_institutional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing._int_inpatient_skilled_nursing_institutional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(10)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(29)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(29)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(59)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" \n\n            from tuva.claims_preprocessing._int_inpatient_skilled_nursing_institutional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing._int_urgent_care_institutional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(10)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(29)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(29)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(59)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" \n\n            from tuva.claims_preprocessing._int_urgent_care_institutional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing._int_inpatient_psychiatric_institutional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(10)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(29)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(29)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(59)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" \n\n            from tuva.claims_preprocessing._int_inpatient_psychiatric_institutional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing._int_inpatient_rehab_institutional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(10)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(29)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(29)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(59)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" \n\n            from tuva.claims_preprocessing._int_inpatient_rehab_institutional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing.service_category__outpatient_rehab_institutional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(10)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(29)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(29)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(59)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" \n\n            from tuva.claims_preprocessing.service_category__outpatient_rehab_institutional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing.service_category__outpatient_substance_use_institutional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(10)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(29)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(29)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(59)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" \n\n            from tuva.claims_preprocessing.service_category__outpatient_substance_use_institutional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing.service_category__outpatient_surgery_institutional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(10)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(29)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(29)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(59)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" \n\n            from tuva.claims_preprocessing.service_category__outpatient_surgery_institutional\n\n            \n        )\n\n        \n)\n\nSELECT\n  h.claim_id,\n  h.service_category_1,\n  h.service_category_2,\n  h.service_category_3,\n  h.source_model_name\nFROM combine_header_models h", "relation_name": "tuva.claims_preprocessing._int_combined_institutional_header_level"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:21.262198Z", "completed_at": "2025-02-25T21:26:25.487222Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.487788Z", "completed_at": "2025-02-25T21:26:25.487802Z"}], "thread_id": "Thread-3", "execution_time": 4.380285978317261, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__combined_professional", "compiled": true, "compiled_code": "\n\nWITH combined_professional_services AS (\n  \n\n        (\n            select\n                cast('tuva.claims_preprocessing._int_acute_inpatient_professional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"CLAIM_LINE_NUMBER\" as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" ,\n                    cast(\"CLAIM_LINE_ID\" as character varying(16777216)) as \"CLAIM_LINE_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(12)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(16777216)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(16777216)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(60)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.claims_preprocessing._int_acute_inpatient_professional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing._int_ambulatory_surgery_professional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"CLAIM_LINE_NUMBER\" as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" ,\n                    cast(\"CLAIM_LINE_ID\" as character varying(16777216)) as \"CLAIM_LINE_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(12)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(16777216)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(16777216)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(60)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.claims_preprocessing._int_ambulatory_surgery_professional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing._int_dialysis_professional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"CLAIM_LINE_NUMBER\" as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" ,\n                    cast(\"CLAIM_LINE_ID\" as character varying(16777216)) as \"CLAIM_LINE_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(12)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(16777216)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(16777216)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(60)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.claims_preprocessing._int_dialysis_professional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing._int_emergency_department_professional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"CLAIM_LINE_NUMBER\" as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" ,\n                    cast(\"CLAIM_LINE_ID\" as character varying(16777216)) as \"CLAIM_LINE_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(12)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(16777216)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(16777216)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(60)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.claims_preprocessing._int_emergency_department_professional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing._int_home_health_professional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"CLAIM_LINE_NUMBER\" as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" ,\n                    cast(\"CLAIM_LINE_ID\" as character varying(16777216)) as \"CLAIM_LINE_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(12)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(16777216)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(16777216)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(60)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.claims_preprocessing._int_home_health_professional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing._int_inpatient_hospice_professional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"CLAIM_LINE_NUMBER\" as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" ,\n                    cast(\"CLAIM_LINE_ID\" as character varying(16777216)) as \"CLAIM_LINE_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(12)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(16777216)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(16777216)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(60)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.claims_preprocessing._int_inpatient_hospice_professional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing._int_inpatient_psychiatric_professional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"CLAIM_LINE_NUMBER\" as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" ,\n                    cast(\"CLAIM_LINE_ID\" as character varying(16777216)) as \"CLAIM_LINE_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(12)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(16777216)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(16777216)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(60)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.claims_preprocessing._int_inpatient_psychiatric_professional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing._int_inpatient_rehab_professional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"CLAIM_LINE_NUMBER\" as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" ,\n                    cast(\"CLAIM_LINE_ID\" as character varying(16777216)) as \"CLAIM_LINE_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(12)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(16777216)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(16777216)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(60)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.claims_preprocessing._int_inpatient_rehab_professional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing._int_lab_professional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"CLAIM_LINE_NUMBER\" as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" ,\n                    cast(\"CLAIM_LINE_ID\" as character varying(16777216)) as \"CLAIM_LINE_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(12)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(16777216)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(16777216)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(60)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.claims_preprocessing._int_lab_professional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing.service_category__office_based_other_professional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"CLAIM_LINE_NUMBER\" as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" ,\n                    cast(\"CLAIM_LINE_ID\" as character varying(16777216)) as \"CLAIM_LINE_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(12)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(16777216)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(16777216)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(60)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.claims_preprocessing.service_category__office_based_other_professional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing.service_category__office_based_physical_therapy_professional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"CLAIM_LINE_NUMBER\" as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" ,\n                    cast(\"CLAIM_LINE_ID\" as character varying(16777216)) as \"CLAIM_LINE_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(12)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(16777216)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(16777216)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(60)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.claims_preprocessing.service_category__office_based_physical_therapy_professional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing.service_category__office_based_radiology' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"CLAIM_LINE_NUMBER\" as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" ,\n                    cast(\"CLAIM_LINE_ID\" as character varying(16777216)) as \"CLAIM_LINE_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(12)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(16777216)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(16777216)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(60)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.claims_preprocessing.service_category__office_based_radiology\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing.service_category__office_based_surgery_professional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"CLAIM_LINE_NUMBER\" as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" ,\n                    cast(\"CLAIM_LINE_ID\" as character varying(16777216)) as \"CLAIM_LINE_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(12)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(16777216)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(16777216)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(60)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.claims_preprocessing.service_category__office_based_surgery_professional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing._int_office_based_visit_professional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"CLAIM_LINE_NUMBER\" as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" ,\n                    cast(\"CLAIM_LINE_ID\" as character varying(16777216)) as \"CLAIM_LINE_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(12)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(16777216)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(16777216)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(60)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.claims_preprocessing._int_office_based_visit_professional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing._int_outpatient_hospital_or_clinic_professional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"CLAIM_LINE_NUMBER\" as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" ,\n                    cast(\"CLAIM_LINE_ID\" as character varying(16777216)) as \"CLAIM_LINE_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(12)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(16777216)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(16777216)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(60)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.claims_preprocessing._int_outpatient_hospital_or_clinic_professional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing._int_outpatient_psychiatric_professional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"CLAIM_LINE_NUMBER\" as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" ,\n                    cast(\"CLAIM_LINE_ID\" as character varying(16777216)) as \"CLAIM_LINE_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(12)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(16777216)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(16777216)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(60)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.claims_preprocessing._int_outpatient_psychiatric_professional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing._int_outpatient_rehab_professional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"CLAIM_LINE_NUMBER\" as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" ,\n                    cast(\"CLAIM_LINE_ID\" as character varying(16777216)) as \"CLAIM_LINE_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(12)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(16777216)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(16777216)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(60)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.claims_preprocessing._int_outpatient_rehab_professional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing._int_inpatient_skilled_nursing_professional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"CLAIM_LINE_NUMBER\" as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" ,\n                    cast(\"CLAIM_LINE_ID\" as character varying(16777216)) as \"CLAIM_LINE_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(12)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(16777216)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(16777216)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(60)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.claims_preprocessing._int_inpatient_skilled_nursing_professional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing._int_urgent_care_professional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"CLAIM_LINE_NUMBER\" as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" ,\n                    cast(\"CLAIM_LINE_ID\" as character varying(16777216)) as \"CLAIM_LINE_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(12)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(16777216)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(16777216)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(60)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.claims_preprocessing._int_urgent_care_professional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing._int_outpatient_hospice_professional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"CLAIM_LINE_NUMBER\" as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" ,\n                    cast(\"CLAIM_LINE_ID\" as character varying(16777216)) as \"CLAIM_LINE_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(12)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(16777216)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(16777216)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(60)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.claims_preprocessing._int_outpatient_hospice_professional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing.service_category__pharmacy_professional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"CLAIM_LINE_NUMBER\" as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" ,\n                    cast(\"CLAIM_LINE_ID\" as character varying(16777216)) as \"CLAIM_LINE_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(12)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(16777216)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(16777216)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(60)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.claims_preprocessing.service_category__pharmacy_professional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing.service_category__outpatient_substance_use_professional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"CLAIM_LINE_NUMBER\" as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" ,\n                    cast(\"CLAIM_LINE_ID\" as character varying(16777216)) as \"CLAIM_LINE_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(12)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(16777216)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(16777216)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(60)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.claims_preprocessing.service_category__outpatient_substance_use_professional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing.service_category__outpatient_physical_therapy_professional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"CLAIM_LINE_NUMBER\" as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" ,\n                    cast(\"CLAIM_LINE_ID\" as character varying(16777216)) as \"CLAIM_LINE_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(12)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(16777216)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(16777216)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(60)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.claims_preprocessing.service_category__outpatient_physical_therapy_professional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing.service_category__outpatient_radiology_professional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"CLAIM_LINE_NUMBER\" as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" ,\n                    cast(\"CLAIM_LINE_ID\" as character varying(16777216)) as \"CLAIM_LINE_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(12)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(16777216)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(16777216)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(60)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.claims_preprocessing.service_category__outpatient_radiology_professional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing._int_observation_professional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"CLAIM_LINE_NUMBER\" as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" ,\n                    cast(\"CLAIM_LINE_ID\" as character varying(16777216)) as \"CLAIM_LINE_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(12)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(16777216)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(16777216)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(60)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.claims_preprocessing._int_observation_professional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing._int_dme_professional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"CLAIM_LINE_NUMBER\" as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" ,\n                    cast(\"CLAIM_LINE_ID\" as character varying(16777216)) as \"CLAIM_LINE_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(12)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(16777216)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(16777216)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(60)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.claims_preprocessing._int_dme_professional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing._int_ambulance_professional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"CLAIM_LINE_NUMBER\" as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" ,\n                    cast(\"CLAIM_LINE_ID\" as character varying(16777216)) as \"CLAIM_LINE_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(12)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(16777216)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(16777216)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(60)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.claims_preprocessing._int_ambulance_professional\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing.service_category__outpatient_surgery_professional' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"CLAIM_ID\" as character varying(16777216)) as \"CLAIM_ID\" ,\n                    cast(\"CLAIM_LINE_NUMBER\" as NUMBER(38,0)) as \"CLAIM_LINE_NUMBER\" ,\n                    cast(null as character varying(16777216)) as \"CLAIM_LINE_ID\" ,\n                    cast(\"SERVICE_CATEGORY_1\" as character varying(12)) as \"SERVICE_CATEGORY_1\" ,\n                    cast(\"SERVICE_CATEGORY_2\" as character varying(16777216)) as \"SERVICE_CATEGORY_2\" ,\n                    cast(\"SERVICE_CATEGORY_3\" as character varying(16777216)) as \"SERVICE_CATEGORY_3\" ,\n                    cast(\"SOURCE_MODEL_NAME\" as character varying(60)) as \"SOURCE_MODEL_NAME\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.claims_preprocessing.service_category__outpatient_surgery_professional\n\n            \n        )\n\n        \n)\n\nSELECT\n    p.claim_id,\n    p.claim_line_number,\n    p.claim_line_id,\n    p.service_category_1,\n    p.service_category_2,\n    p.service_category_3,\n    p.tuva_last_run,\n    p.source_model_name\nFROM combined_professional_services p", "relation_name": "tuva.claims_preprocessing._int_combined_professional"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.645449Z", "completed_at": "2025-02-25T21:26:25.665874Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.666361Z", "completed_at": "2025-02-25T21:26:25.666372Z"}], "thread_id": "Thread-1", "execution_time": 0.022310972213745117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.service_category__service_category_grouper", "compiled": true, "compiled_code": "\n\nwith service_category_1_mapping as(\n    select distinct \n        a.claim_id\n        , a.claim_line_number\n        , a.claim_type\n        , case when s.service_category_1 is null and b.service_category_1 is not null then 'Service cat value not in seed table'\n            else b.service_category_1\n          end service_category_1\n        , case when s.service_category_2 is null and b.service_category_2 is not null then 'Service cat value not in seed table'\n            else s.service_category_2\n          end service_category_2\n        , case\n            when s.service_category_3 is null and b.service_category_3 is not null then 'Service cat value not in seed table'\n            else s.service_category_3\n          end service_category_3\n        ,b.service_category_2 as original_service_cat_2\n        ,b.service_category_3 as original_service_cat_3\n        , s.priority\n        , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\n        , b.source_model_name\n    from tuva.claims_preprocessing.service_category__stg_medical_claim a\n    left join tuva.claims_preprocessing._int_combined_professional b\n    on a.claim_id = b.claim_id\n    and a.claim_line_number = b.claim_line_number\n    left join tuva.claims_preprocessing.service_category__service_categories s on b.service_category_2 = s.service_category_2\n    and\n    b.service_category_3 = s.service_category_3\n    where a.claim_type = 'professional'\n\n    union all\n\n    select distinct \n        a.claim_id\n        , a.claim_line_number\n        , a.claim_type\n        , case when s.service_category_1 is null and b.service_category_1 is not null then 'Service cat value not in seed table'\n            else b.service_category_1\n          end service_category_1\n        , case when s.service_category_2 is null and b.service_category_2 is not null then 'Service cat value not in seed table'\n            else s.service_category_2\n          end service_category_2\n        , case\n            when s.service_category_3 is null and b.service_category_3 is not null then 'Service cat value not in seed table'\n            else s.service_category_3\n          end service_category_3\n        ,b.service_category_2 as original_service_cat_2\n        ,b.service_category_3 as original_service_cat_3\n        , s.priority\n        , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\n        , b.source_model_name\n    from tuva.claims_preprocessing.service_category__stg_medical_claim a\n    left join tuva.claims_preprocessing._int_combined_institutional_header_level b\n    on a.claim_id = b.claim_id\n    left join tuva.claims_preprocessing.service_category__service_categories s on b.service_category_2 = s.service_category_2\n    and\n    b.service_category_3 = s.service_category_3\n    where a.claim_type = 'institutional'\n\n    union all\n\n    select distinct \n        a.claim_id\n        , a.claim_line_number\n        , a.claim_type\n        , case when s.service_category_1 is null and b.service_category_1 is not null then 'Service cat value not in seed table'\n            else b.service_category_1\n          end service_category_1\n        , case when s.service_category_2 is null and b.service_category_2 is not null then 'Service cat value not in seed table'\n            else s.service_category_2\n          end service_category_2\n        , case\n            when s.service_category_3 is null and b.service_category_3 is not null then 'Service cat value not in seed table'\n            else s.service_category_3\n          end service_category_3\n        ,b.service_category_2 as original_service_cat_2\n        ,b.service_category_3 as original_service_cat_3\n        , s.priority\n        , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\n        , b.source_model_name\n    from tuva.claims_preprocessing.service_category__stg_medical_claim a\n    left join tuva.claims_preprocessing._int_combined_institutional_line_level b\n    on a.claim_id = b.claim_id\n    and a.claim_line_number = b.claim_line_number\n    left join tuva.claims_preprocessing.service_category__service_categories s on b.service_category_2 = s.service_category_2\n    and\n    b.service_category_3 = s.service_category_3\n    where a.claim_type = 'institutional'\n)\n\n, service_category_2_deduplication as(\n    select \n        claim_id\n        , claim_line_number\n        , claim_type\n        , service_category_1\n        , service_category_2\n        , service_category_3\n        , original_service_cat_2\n        , original_service_cat_3\n        , source_model_name\n        , row_number() over (partition by claim_id, claim_line_number order by coalesce(priority,99999)) as duplicate_row_number\n    from service_category_1_mapping\n)\n\nselect\n    d.claim_id\n    , d.claim_line_number\n    , d.claim_type\n    , coalesce(service_category_1,'other') as service_category_1\n    , coalesce(service_category_2,'other') as service_category_2\n    , coalesce(service_category_3,'other') as service_category_3\n    , original_service_cat_2\n    , original_service_cat_3\n    , duplicate_row_number\n    , s.ccs_category\n    , s.ccs_category_description\n    , s.drg_code\n    , s.drg_description\n    , s.place_of_service_code\n    , s.place_of_service_description\n    , s.revenue_center_code\n    , s.revenue_center_description\n    , s.hcpcs_code\n    , s.default_ccsr_category_ip\n    , s.default_ccsr_category_op\n    , s.default_ccsr_category_description_ip\n    , s.default_ccsr_category_description_op\n    , s.primary_taxonomy_code\n    , s.primary_specialty_description\n    , s.modality\n    , s.bill_type_code\n    , s.bill_type_description\n    , d.source_model_name\n    , s.data_source\nfrom service_category_2_deduplication d\ninner join tuva.claims_preprocessing.service_category__stg_medical_claim s on d.claim_id = s.claim_id\nand\nd.claim_line_number = s.claim_line_number", "relation_name": "tuva.claims_preprocessing.service_category_grouper"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.669368Z", "completed_at": "2025-02-25T21:26:25.681845Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.682267Z", "completed_at": "2025-02-25T21:26:25.682276Z"}], "thread_id": "Thread-3", "execution_time": 0.014336824417114258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.encounters__stg_medical_claim", "compiled": true, "compiled_code": "\n\n\nselect\n  m.person_id \n  , d.patient_data_source_id\n  , m.claim_id\n  , m.claim_line_number\n  , m.claim_id || '|' || cast(m.claim_line_number as TEXT) as claim_line_id\n  , m.claim_type\n  , coalesce(m.admission_date,m.claim_line_start_date,m.claim_start_date) as start_date\n  , coalesce(m.discharge_date,m.claim_line_end_date,m.claim_end_date) as end_date\n  , m.admission_date\n  , m.discharge_date\n  , m.claim_start_date\n  , m.claim_end_date\n  , m.claim_line_start_date\n  , m.claim_line_end_date\n  , g.service_category_1\n  , g.service_category_2\n  , g.service_category_3\n  , m.bill_type_code\n  , bt.bill_type_description\n  , m.hcpcs_code\n  , m.hcpcs_modifier_1\n  , m.hcpcs_modifier_2\n  , m.hcpcs_modifier_3\n  , m.hcpcs_modifier_4\n  , m.hcpcs_modifier_5\n  , c.ccs_category\n  , c.ccs_category_description\n  , m.drg_code_type\n  , m.drg_code\n  , coalesce(msdrg.ms_drg_description, aprdrg.apr_drg_description) as drg_description\n  , m.admit_source_code\n  , m.admit_type_code\n  , m.place_of_service_code\n  , pos.place_of_service_description\n  , m.revenue_center_code\n  , r.revenue_center_description\n  , m.diagnosis_code_type\n  , m.diagnosis_code_1\n  , dx.default_ccsr_category_ip\n  , dx.default_ccsr_category_op\n  , dx.default_ccsr_category_description_ip\n  , dx.default_ccsr_category_description_op\n  , p.primary_taxonomy_code\n  , p.primary_specialty_description\n  , n.modality\n  , m.billing_id\n  , m.rendering_id\n  , rend.primary_specialty_description as rend_primary_specialty_description\n  , m.facility_id\n  , m.discharge_disposition_code\n  , m.paid_amount\n  , m.charge_amount\n  , m.allowed_amount\n  , m.data_source\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.normalized_input_medical_claim m\ninner join tuva.claims_preprocessing.service_category_grouper g on m.claim_id = g.claim_id\nand\nm.claim_line_number = g.claim_line_number\nand g.duplicate_row_number = 1\ninner join tuva.claims_preprocessing.encounters__patient_data_source_id d on m.person_id = d.person_id\nand\nm.data_source = d.data_source\nleft join tuva.ccsr._value_set_dxccsr_v2023_1_cleaned_map dx on m.diagnosis_code_1 = dx.icd_10_cm_code\nleft join tuva.terminology.provider p on m.facility_id = p.npi\nleft join tuva.terminology.ccs_services_procedures c on m.hcpcs_code = c.hcpcs_code\nleft join tuva.terminology.nitos n on m.hcpcs_code = n.hcpcs_code\nleft join tuva.terminology.ms_drg msdrg on m.drg_code_type = 'ms-drg' and m.drg_code = msdrg.ms_drg_code\nleft join tuva.terminology.apr_drg aprdrg on m.drg_code_type = 'apr-drg' and m.drg_code = aprdrg.apr_drg_code\nleft join tuva.terminology.revenue_center r on m.revenue_center_code = r.revenue_center_code\nleft join tuva.terminology.place_of_service pos on m.place_of_service_code = pos.place_of_service_code\nleft join tuva.terminology.bill_type bt on m.bill_type_code = bt.bill_type_code\nleft join tuva.terminology.provider rend on m.rendering_id = rend.npi", "relation_name": "tuva.claims_preprocessing.encounters__stg_medical_claim"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.696394Z", "completed_at": "2025-02-25T21:26:25.701157Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.702019Z", "completed_at": "2025-02-25T21:26:25.702025Z"}], "thread_id": "Thread-3", "execution_time": 0.01659417152404785, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.asc__anchor_events", "compiled": true, "compiled_code": "\n\nwith service_category as (\n  select distinct\n      claim_id\n    , patient_data_source_id\n    , start_date\n    , end_date\n  from tuva.claims_preprocessing.encounters__stg_medical_claim\n  where\n    service_category_2 = 'ambulatory surgery center' -- include both professional and institutional claims as anchor events\n \n)\n\nselect distinct \nclaim_id\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom service_category", "relation_name": "tuva.claims_preprocessing.asc__anchor_events"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.686727Z", "completed_at": "2025-02-25T21:26:25.701502Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.702500Z", "completed_at": "2025-02-25T21:26:25.702504Z"}], "thread_id": "Thread-1", "execution_time": 0.017866849899291992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.acute_inpatient__generate_encounter_id", "compiled": true, "compiled_code": "\n\nwith claim_start_end as (\nselect claim_id\n,patient_data_source_id\n,min(start_date) as start_date\n,max(end_date) as end_date \n  from tuva.claims_preprocessing.encounters__stg_medical_claim\n  group by claim_id\n  ,patient_data_source_id\n)\n\n, base as (\n  select distinct\n      enc.claim_id\n    , enc.patient_data_source_id\n    , c.start_date\n    , c.end_date\n    , enc.facility_id\n    , enc.discharge_disposition_code\n  from tuva.claims_preprocessing.encounters__stg_medical_claim enc\n    inner join claim_start_end c on enc.claim_id = c.claim_id\n  and\n  c.patient_data_source_id = enc.patient_data_source_id\n  where\n    service_category_2 in ('acute inpatient')\n    and claim_type = 'institutional'\n)\n\n, add_row_num as (\n  select\n      patient_data_source_id\n    , claim_id\n    , start_date\n    , end_date\n    , discharge_disposition_code\n    , facility_id\n    , row_number() over (partition by patient_data_source_id order by end_date, start_date, claim_id) as row_num\n  from base\n)\n\n, check_for_merges_with_larger_row_num as (\n  select\n      aa.patient_data_source_id\n    , aa.claim_id as claim_id_a\n    , bb.claim_id as claim_id_b\n    , aa.row_num as row_num_a\n    , bb.row_num as row_num_b\n    , case\n        -- Claims with same end_date and same facility_id should be merged:\n        when aa.end_date = bb.end_date\n          and aa.facility_id = bb.facility_id then 1\n\n        -- Claims with different end_date and start_date that are\n        -- adjacent (i.e. separated by 1 day) should be merged:\n        when \n\n    dateadd(\n        day,\n        1,\n        aa.end_date\n        )\n\n = bb.start_date\n          and aa.facility_id = bb.facility_id\n          and aa.discharge_disposition_code = '30' then 1\n\n        -- Claims with different end_date \n        -- should be merged if they overlap:\n        when aa.end_date <> bb.end_date\n          and aa.end_date > bb.start_date\n          and aa.facility_id = bb.facility_id then 1\n        else 0\n      end as merge_flag\n  from add_row_num as aa\n  inner join add_row_num as bb\n    on aa.patient_data_source_id = bb.patient_data_source_id\n    and aa.row_num < bb.row_num\n  where aa.claim_id <> bb.claim_id\n)\n\n, merges_with_larger_row_num as (\n  select\n      patient_data_source_id\n    , claim_id_a\n    , claim_id_b\n    , row_num_a\n    , row_num_b\n    , merge_flag\n  from check_for_merges_with_larger_row_num\n  where merge_flag = 1\n)\n\n, claim_ids_that_merge_with_larger_row_num as (\n  select distinct\n      claim_id_a as claim_id\n  from merges_with_larger_row_num\n)\n\n, claim_ids_having_a_smaller_row_num_merging_with_a_larger_row_num as (\n  select distinct\n      aa.claim_id as claim_id\n  from add_row_num as aa\n  inner join merges_with_larger_row_num as bb\n    on aa.patient_data_source_id = bb.patient_data_source_id\n    and bb.row_num_a < aa.row_num\n    and bb.row_num_b > aa.row_num\n)\n\n, close_flags as (\n  select\n      aa.patient_data_source_id\n    , aa.claim_id\n    , aa.start_date\n    , aa.end_date\n    , aa.discharge_disposition_code\n    , aa.facility_id\n    , aa.row_num\n    , case\n        when bb.claim_id is null\n          and cc.claim_id is null then 1\n        else 0\n      end as close_flag\n  from add_row_num as aa\n  left join claim_ids_that_merge_with_larger_row_num as bb\n    on aa.claim_id = bb.claim_id\n  left join claim_ids_having_a_smaller_row_num_merging_with_a_larger_row_num as cc\n    on aa.claim_id = cc.claim_id\n)\n\n, join_every_row_to_later_closes as (\n  select\n      aa.patient_data_source_id\n    , aa.claim_id\n    , aa.row_num\n    , bb.row_num as row_num_b\n  from close_flags as aa\n  inner join close_flags as bb\n    on aa.patient_data_source_id = bb.patient_data_source_id\n    and aa.row_num <= bb.row_num\n  where bb.close_flag = 1\n)\n\n, find_min_closing_row_num_for_every_claim as (\n  select\n      patient_data_source_id\n    , claim_id\n    , min(row_num_b) as min_closing_row\n  from join_every_row_to_later_closes\n  group by\n      patient_data_source_id\n    , claim_id\n)\n\n, add_min_closing_row_to_every_claim as (\n  select\n      aa.patient_data_source_id\n    , aa.claim_id\n    , aa.start_date\n    , aa.end_date\n    , aa.discharge_disposition_code\n    , aa.facility_id\n    , aa.row_num\n    , aa.close_flag\n    , bb.min_closing_row\n  from close_flags as aa\n  left join find_min_closing_row_num_for_every_claim as bb\n    on aa.patient_data_source_id = bb.patient_data_source_id\n    and aa.claim_id = bb.claim_id\n)\n\n, add_encounter_id as (\n  select\n      aa.patient_data_source_id\n    , aa.claim_id\n    , aa.start_date\n    , aa.end_date\n    , aa.discharge_disposition_code\n    , aa.facility_id\n    , aa.row_num\n    , aa.close_flag\n    , aa.min_closing_row\n    , bb.claim_id as encounter_id\n  from add_min_closing_row_to_every_claim as aa\n  left join add_min_closing_row_to_every_claim as bb\n    on aa.patient_data_source_id = bb.patient_data_source_id\n    and aa.min_closing_row = bb.row_num\n)\n\nselect\n    patient_data_source_id\n  , claim_id\n  , start_date\n  , end_date\n  , discharge_disposition_code\n  , facility_id\n  , row_number() over (partition by encounter_id order by start_date, end_date, claim_id) as encounter_claim_number\n  , row_number() over (partition by encounter_id order by start_date desc, end_date desc, claim_id desc) as encounter_claim_number_desc\n  , close_flag\n  , min_closing_row\n  , dense_rank() over (order by encounter_id) as encounter_id\nfrom add_encounter_id", "relation_name": "tuva.claims_preprocessing.acute_inpatient__generate_encounter_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.692099Z", "completed_at": "2025-02-25T21:26:25.701775Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.703036Z", "completed_at": "2025-02-25T21:26:25.703040Z"}], "thread_id": "Thread-2", "execution_time": 0.017940044403076172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ambulance__anchor_events", "compiled": true, "compiled_code": "\n\nwith service_category as (\n  select distinct\n      claim_id\n    , patient_data_source_id\n    , start_date\n  from tuva.claims_preprocessing.encounters__stg_medical_claim\n  where\n    service_category_2 = 'ambulance' --both inst and prof\n    \n)\n\nselect distinct \nclaim_id\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom service_category", "relation_name": "tuva.claims_preprocessing.ambulance__anchor_events"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.706130Z", "completed_at": "2025-02-25T21:26:25.718512Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.718750Z", "completed_at": "2025-02-25T21:26:25.718755Z"}], "thread_id": "Thread-3", "execution_time": 0.014313936233520508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.dialysis__anchor_events", "compiled": true, "compiled_code": "\n\nwith service_category as (\n  select distinct\n      claim_id\n    , patient_data_source_id\n    , start_date\n  from tuva.claims_preprocessing.encounters__stg_medical_claim\n  where\n    service_category_2 = 'dialysis' --both inst and professional as anchor\n    \n)\n\nselect distinct \nclaim_id\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom service_category", "relation_name": "tuva.claims_preprocessing.dialysis__anchor_events"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.714638Z", "completed_at": "2025-02-25T21:26:25.719170Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.719707Z", "completed_at": "2025-02-25T21:26:25.719711Z"}], "thread_id": "Thread-2", "execution_time": 0.014671802520751953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.emergency_department__generate_encounter_id_pre_sort", "compiled": true, "compiled_code": "\n\nwith claim_start_end as (\n  select\n    claim_id,\n    patient_data_source_id,\n    min(start_date) as start_date,\n    max(end_date) as end_date\n  from tuva.claims_preprocessing.encounters__stg_medical_claim\n  group by claim_id, patient_data_source_id\n)\n\n, base as (\n  select distinct\n    enc.claim_id,\n    enc.patient_data_source_id,\n    c.start_date,\n    c.end_date,\n    enc.facility_id,\n    enc.discharge_disposition_code\n  from tuva.claims_preprocessing.encounters__stg_medical_claim enc\n  inner join claim_start_end c \n    on enc.claim_id = c.claim_id\n    and c.patient_data_source_id = enc.patient_data_source_id\n  where\n    enc.service_category_2 = 'emergency department' --both inst and prof\n)\n\n, add_row_num as (\n  select\n    patient_data_source_id,\n    claim_id,\n    start_date,\n    end_date,\n    discharge_disposition_code,\n    facility_id,\n    row_number() over (partition by patient_data_source_id order by end_date, start_date, claim_id) as row_num\n  from base\n)\n\n, check_for_merges_with_larger_row_num as (\n  select\n    aa.patient_data_source_id,\n    aa.claim_id as claim_id_a,\n    bb.claim_id as claim_id_b,\n    aa.row_num as row_num_a,\n    bb.row_num as row_num_b,\n    case\n      when aa.end_date = bb.end_date and aa.facility_id = bb.facility_id then 1\n      when \n\n    dateadd(\n        day,\n        1,\n        aa.end_date\n        )\n\n = bb.start_date\n        and aa.facility_id = bb.facility_id\n        and aa.discharge_disposition_code = '30' then 1\n      when aa.end_date <> bb.end_date\n        and aa.end_date >= bb.start_date\n        and aa.facility_id = bb.facility_id then 1\n      else 0\n    end as merge_flag\n  from add_row_num as aa\n  inner join add_row_num as bb\n    on aa.patient_data_source_id = bb.patient_data_source_id\n    and aa.row_num < bb.row_num\n    and aa.claim_id <> bb.claim_id\n)\n\n, merges_with_larger_row_num as (\n  select\n      patient_data_source_id\n    , claim_id_a\n    , claim_id_b\n    , row_num_a\n    , row_num_b\n    , merge_flag\n  from check_for_merges_with_larger_row_num\n  where merge_flag = 1\n)\n\n, claim_ids_that_merge_with_larger_row_num as (\n  select distinct\n      claim_id_a as claim_id\n  from merges_with_larger_row_num\n)\n\n, claim_ids_having_a_smaller_row_num_merging_with_a_larger_row_num as (\n  select distinct\n      aa.claim_id as claim_id\n  from add_row_num as aa\n  inner join merges_with_larger_row_num as bb\n    on aa.patient_data_source_id = bb.patient_data_source_id\n    and bb.row_num_a < aa.row_num\n    and bb.row_num_b > aa.row_num\n)\n\n, close_flags as (\n  select\n      aa.patient_data_source_id\n    , aa.claim_id\n    , aa.start_date\n    , aa.end_date\n    , aa.discharge_disposition_code\n    , aa.facility_id\n    , aa.row_num\n    , case\n        when bb.claim_id is null\n          and cc.claim_id is null then 1\n        else 0\n      end as close_flag\n  from add_row_num as aa\n  left join claim_ids_that_merge_with_larger_row_num as bb\n    on aa.claim_id = bb.claim_id\n  left join claim_ids_having_a_smaller_row_num_merging_with_a_larger_row_num as cc\n    on aa.claim_id = cc.claim_id\n)\n\n, join_every_row_to_later_closes as (\n  select\n      aa.patient_data_source_id\n    , aa.claim_id\n    , aa.row_num\n    , bb.row_num as row_num_b\n  from close_flags as aa\n  inner join close_flags as bb\n    on aa.patient_data_source_id = bb.patient_data_source_id\n    and aa.row_num <= bb.row_num\n  where bb.close_flag = 1\n)\n\n, find_min_closing_row_num_for_every_claim as (\n  select\n      patient_data_source_id\n    , claim_id\n    , min(row_num_b) as min_closing_row\n  from join_every_row_to_later_closes\n  group by\n      patient_data_source_id\n    , claim_id\n)\n\n, add_min_closing_row_to_every_claim as (\n  select\n      aa.patient_data_source_id\n    , aa.claim_id\n    , aa.start_date\n    , aa.end_date\n    , aa.discharge_disposition_code\n    , aa.facility_id\n    , aa.row_num\n    , aa.close_flag\n    , bb.min_closing_row\n  from close_flags as aa\n  left join find_min_closing_row_num_for_every_claim as bb\n    on aa.patient_data_source_id = bb.patient_data_source_id\n    and aa.claim_id = bb.claim_id\n)\n\n\n  select\n      aa.patient_data_source_id\n    , aa.claim_id\n    , aa.start_date\n    , aa.end_date\n    , aa.discharge_disposition_code\n    , aa.facility_id\n    , aa.row_num\n    , aa.close_flag\n    , aa.min_closing_row\n    , bb.claim_id as encounter_id\n  from add_min_closing_row_to_every_claim as aa\n  left join add_min_closing_row_to_every_claim as bb\n    on aa.patient_data_source_id = bb.patient_data_source_id\n    and aa.min_closing_row = bb.row_num", "relation_name": "tuva.claims_preprocessing.emergency_department__generate_encounter_id_pre_sort"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.710030Z", "completed_at": "2025-02-25T21:26:25.720083Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.720823Z", "completed_at": "2025-02-25T21:26:25.720827Z"}], "thread_id": "Thread-1", "execution_time": 0.01604771614074707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.dme__anchor_events", "compiled": true, "compiled_code": "\n\nwith service_category as (\n  select distinct\n      claim_id\n    , patient_data_source_id\n    , start_date\n  from tuva.claims_preprocessing.encounters__stg_medical_claim\n  where\n    service_category_2 = 'durable medical equipment' --both inst and prof\n    \n)\n\nselect distinct \nclaim_id\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom service_category", "relation_name": "tuva.claims_preprocessing.dme__anchor_events"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.721954Z", "completed_at": "2025-02-25T21:26:25.729872Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.733433Z", "completed_at": "2025-02-25T21:26:25.733439Z"}], "thread_id": "Thread-3", "execution_time": 0.013198137283325195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.home_health__anchor_events", "compiled": true, "compiled_code": "\n\nwith service_category as (\n  select distinct\n      claim_id\n    , patient_data_source_id\n    , start_date\n  from tuva.claims_preprocessing.encounters__stg_medical_claim\n  where\n    service_category_2 = 'home health' -- both prof and inst as anchors\n    \n)\n\nselect distinct \nclaim_id\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom service_category", "relation_name": "tuva.claims_preprocessing.home_health__anchor_events"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.726014Z", "completed_at": "2025-02-25T21:26:25.733815Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.734337Z", "completed_at": "2025-02-25T21:26:25.734341Z"}], "thread_id": "Thread-2", "execution_time": 0.012944936752319336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.inpatient_hospice__generate_encounter_id", "compiled": true, "compiled_code": "\n\nwith claim_start_end as (\n  select\n    claim_id,\n    patient_data_source_id,\n    min(start_date) as start_date,\n    max(end_date) as end_date\n  from tuva.claims_preprocessing.encounters__stg_medical_claim\n  group by claim_id, patient_data_source_id\n)\n\n, base as (\n  select distinct\n    enc.claim_id,\n    enc.patient_data_source_id,\n    c.start_date,\n    c.end_date,\n    enc.facility_id,\n    enc.discharge_disposition_code\n  from tuva.claims_preprocessing.encounters__stg_medical_claim enc\n  inner join claim_start_end c \n    on enc.claim_id = c.claim_id\n    and c.patient_data_source_id = enc.patient_data_source_id\n  where\n    enc.service_category_2 in ('inpatient hospice')\n    and enc.claim_type = 'institutional'\n)\n\n, add_row_num as (\n  select\n    patient_data_source_id,\n    claim_id,\n    start_date,\n    end_date,\n    discharge_disposition_code,\n    facility_id,\n    row_number() over (partition by patient_data_source_id order by end_date, start_date, claim_id) as row_num\n  from base\n)\n\n, check_for_merges_with_larger_row_num as (\n  select\n    aa.patient_data_source_id,\n    aa.claim_id as claim_id_a,\n    bb.claim_id as claim_id_b,\n    aa.row_num as row_num_a,\n    bb.row_num as row_num_b,\n    case\n      when aa.end_date = bb.end_date and aa.facility_id = bb.facility_id then 1\n      when \n\n    dateadd(\n        day,\n        1,\n        aa.end_date\n        )\n\n = bb.start_date\n        and aa.facility_id = bb.facility_id\n        and aa.discharge_disposition_code = '30' then 1\n      when aa.end_date <> bb.end_date\n        and aa.end_date > bb.start_date\n        and aa.facility_id = bb.facility_id then 1\n      else 0\n    end as merge_flag\n  from add_row_num as aa\n  inner join add_row_num as bb\n    on aa.patient_data_source_id = bb.patient_data_source_id\n    and aa.row_num < bb.row_num\n    and aa.claim_id <> bb.claim_id\n)\n\n\n, merges_with_larger_row_num as (\n  select\n      patient_data_source_id\n    , claim_id_a\n    , claim_id_b\n    , row_num_a\n    , row_num_b\n    , merge_flag\n  from check_for_merges_with_larger_row_num\n  where merge_flag = 1\n)\n\n, claim_ids_that_merge_with_larger_row_num as (\n  select distinct\n      claim_id_a as claim_id\n  from merges_with_larger_row_num\n)\n\n, claim_ids_having_a_smaller_row_num_merging_with_a_larger_row_num as (\n  select distinct\n      aa.claim_id as claim_id\n  from add_row_num as aa\n  inner join merges_with_larger_row_num as bb\n    on aa.patient_data_source_id = bb.patient_data_source_id\n    and bb.row_num_a < aa.row_num\n    and bb.row_num_b > aa.row_num\n)\n\n, close_flags as (\n  select\n      aa.patient_data_source_id\n    , aa.claim_id\n    , aa.start_date\n    , aa.end_date\n    , aa.discharge_disposition_code\n    , aa.facility_id\n    , aa.row_num\n    , case\n        when bb.claim_id is null\n          and cc.claim_id is null then 1\n        else 0\n      end as close_flag\n  from add_row_num as aa\n  left join claim_ids_that_merge_with_larger_row_num as bb\n    on aa.claim_id = bb.claim_id\n  left join claim_ids_having_a_smaller_row_num_merging_with_a_larger_row_num as cc\n    on aa.claim_id = cc.claim_id\n)\n\n, join_every_row_to_later_closes as (\n  select\n      aa.patient_data_source_id\n    , aa.claim_id\n    , aa.row_num\n    , bb.row_num as row_num_b\n  from close_flags as aa\n  inner join close_flags as bb\n    on aa.patient_data_source_id = bb.patient_data_source_id\n    and aa.row_num <= bb.row_num\n  where bb.close_flag = 1\n)\n\n, find_min_closing_row_num_for_every_claim as (\n  select\n      patient_data_source_id\n    , claim_id\n    , min(row_num_b) as min_closing_row\n  from join_every_row_to_later_closes\n  group by\n      patient_data_source_id\n    , claim_id\n)\n\n, add_min_closing_row_to_every_claim as (\n  select\n      aa.patient_data_source_id\n    , aa.claim_id\n    , aa.start_date\n    , aa.end_date\n    , aa.discharge_disposition_code\n    , aa.facility_id\n    , aa.row_num\n    , aa.close_flag\n    , bb.min_closing_row\n  from close_flags as aa\n  left join find_min_closing_row_num_for_every_claim as bb\n    on aa.patient_data_source_id = bb.patient_data_source_id\n    and aa.claim_id = bb.claim_id\n)\n\n, add_encounter_id as (\n  select\n      aa.patient_data_source_id\n    , aa.claim_id\n    , aa.start_date\n    , aa.end_date\n    , aa.discharge_disposition_code\n    , aa.facility_id\n    , aa.row_num\n    , aa.close_flag\n    , aa.min_closing_row\n    , bb.claim_id as encounter_id\n  from add_min_closing_row_to_every_claim as aa\n  left join add_min_closing_row_to_every_claim as bb\n    on aa.patient_data_source_id = bb.patient_data_source_id\n    and aa.min_closing_row = bb.row_num\n)\n\nselect\n    patient_data_source_id\n  , claim_id\n  , start_date\n  , end_date\n  , discharge_disposition_code\n  , facility_id\n  , row_number() over (partition by encounter_id order by start_date, end_date, claim_id) as encounter_claim_number\n  , row_number() over (partition by encounter_id order by start_date desc, end_date desc, claim_id desc) as encounter_claim_number_desc\n  , close_flag\n  , min_closing_row\n  , dense_rank() over (order by encounter_id) as encounter_id\nfrom add_encounter_id", "relation_name": "tuva.claims_preprocessing.inpatient_hospice__generate_encounter_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.730071Z", "completed_at": "2025-02-25T21:26:25.734971Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.735632Z", "completed_at": "2025-02-25T21:26:25.735635Z"}], "thread_id": "Thread-1", "execution_time": 0.009964942932128906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.inpatient_psych__generate_encounter_id", "compiled": true, "compiled_code": "\n\nwith claim_start_end as (\n  select\n    claim_id,\n    patient_data_source_id,\n    min(start_date) as start_date,\n    max(end_date) as end_date\n  from tuva.claims_preprocessing.encounters__stg_medical_claim\n  group by claim_id, patient_data_source_id\n)\n\n, base as (\n  select distinct\n    enc.claim_id,\n    enc.patient_data_source_id,\n    c.start_date,\n    c.end_date,\n    enc.facility_id,\n    enc.discharge_disposition_code\n  from tuva.claims_preprocessing.encounters__stg_medical_claim enc\n  inner join claim_start_end c \n    on enc.claim_id = c.claim_id\n    and c.patient_data_source_id = enc.patient_data_source_id\n  where\n    enc.service_category_2 = 'inpatient psychiatric'\n    and enc.claim_type = 'institutional'\n)\n\n, add_row_num as (\n  select\n    patient_data_source_id,\n    claim_id,\n    start_date,\n    end_date,\n    discharge_disposition_code,\n    facility_id,\n    row_number() over (partition by patient_data_source_id order by end_date, start_date, claim_id) as row_num\n  from base\n)\n\n, check_for_merges_with_larger_row_num as (\n  select\n    aa.patient_data_source_id,\n    aa.claim_id as claim_id_a,\n    bb.claim_id as claim_id_b,\n    aa.row_num as row_num_a,\n    bb.row_num as row_num_b,\n    case\n      when aa.end_date = bb.end_date and aa.facility_id = bb.facility_id then 1\n      when \n\n    dateadd(\n        day,\n        1,\n        aa.end_date\n        )\n\n = bb.start_date\n        and aa.facility_id = bb.facility_id\n        and aa.discharge_disposition_code = '30' then 1\n      when aa.end_date <> bb.end_date\n        and aa.end_date > bb.start_date\n        and aa.facility_id = bb.facility_id then 1\n      else 0\n    end as merge_flag\n  from add_row_num as aa\n  inner join add_row_num as bb\n    on aa.patient_data_source_id = bb.patient_data_source_id\n    and aa.row_num < bb.row_num\n    and aa.claim_id <> bb.claim_id\n)\n\n\n, merges_with_larger_row_num as (\n  select\n      patient_data_source_id\n    , claim_id_a\n    , claim_id_b\n    , row_num_a\n    , row_num_b\n    , merge_flag\n  from check_for_merges_with_larger_row_num\n  where merge_flag = 1\n)\n\n, claim_ids_that_merge_with_larger_row_num as (\n  select distinct\n      claim_id_a as claim_id\n  from merges_with_larger_row_num\n)\n\n, claim_ids_having_a_smaller_row_num_merging_with_a_larger_row_num as (\n  select distinct\n      aa.claim_id as claim_id\n  from add_row_num as aa\n  inner join merges_with_larger_row_num as bb\n    on aa.patient_data_source_id = bb.patient_data_source_id\n    and bb.row_num_a < aa.row_num\n    and bb.row_num_b > aa.row_num\n)\n\n, close_flags as (\n  select\n      aa.patient_data_source_id\n    , aa.claim_id\n    , aa.start_date\n    , aa.end_date\n    , aa.discharge_disposition_code\n    , aa.facility_id\n    , aa.row_num\n    , case\n        when bb.claim_id is null\n          and cc.claim_id is null then 1\n        else 0\n      end as close_flag\n  from add_row_num as aa\n  left join claim_ids_that_merge_with_larger_row_num as bb\n    on aa.claim_id = bb.claim_id\n  left join claim_ids_having_a_smaller_row_num_merging_with_a_larger_row_num as cc\n    on aa.claim_id = cc.claim_id\n)\n\n, join_every_row_to_later_closes as (\n  select\n      aa.patient_data_source_id\n    , aa.claim_id\n    , aa.row_num\n    , bb.row_num as row_num_b\n  from close_flags as aa\n  inner join close_flags as bb\n    on aa.patient_data_source_id = bb.patient_data_source_id\n    and aa.row_num <= bb.row_num\n  where bb.close_flag = 1\n)\n\n, find_min_closing_row_num_for_every_claim as (\n  select\n      patient_data_source_id\n    , claim_id\n    , min(row_num_b) as min_closing_row\n  from join_every_row_to_later_closes\n  group by\n      patient_data_source_id\n    , claim_id\n)\n\n, add_min_closing_row_to_every_claim as (\n  select\n      aa.patient_data_source_id\n    , aa.claim_id\n    , aa.start_date\n    , aa.end_date\n    , aa.discharge_disposition_code\n    , aa.facility_id\n    , aa.row_num\n    , aa.close_flag\n    , bb.min_closing_row\n  from close_flags as aa\n  left join find_min_closing_row_num_for_every_claim as bb\n    on aa.patient_data_source_id = bb.patient_data_source_id\n    and aa.claim_id = bb.claim_id\n)\n\n, add_encounter_id as (\n  select\n      aa.patient_data_source_id\n    , aa.claim_id\n    , aa.start_date\n    , aa.end_date\n    , aa.discharge_disposition_code\n    , aa.facility_id\n    , aa.row_num\n    , aa.close_flag\n    , aa.min_closing_row\n    , bb.claim_id as encounter_id\n  from add_min_closing_row_to_every_claim as aa\n  left join add_min_closing_row_to_every_claim as bb\n    on aa.patient_data_source_id = bb.patient_data_source_id\n    and aa.min_closing_row = bb.row_num\n)\n\nselect\n    patient_data_source_id\n  , claim_id\n  , start_date\n  , end_date\n  , discharge_disposition_code\n  , facility_id\n  , row_number() over (partition by encounter_id order by start_date, end_date, claim_id) as encounter_claim_number\n  , row_number() over (partition by encounter_id order by start_date desc, end_date desc, claim_id desc) as encounter_claim_number_desc\n  , close_flag\n  , min_closing_row\n  , dense_rank() over (order by encounter_id) as encounter_id\nfrom add_encounter_id", "relation_name": "tuva.claims_preprocessing.inpatient_psych__generate_encounter_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.736204Z", "completed_at": "2025-02-25T21:26:25.744814Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.748335Z", "completed_at": "2025-02-25T21:26:25.748340Z"}], "thread_id": "Thread-3", "execution_time": 0.013677120208740234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.inpatient_rehab__generate_encounter_id", "compiled": true, "compiled_code": "\n\nwith claim_start_end as (\n  select\n    claim_id,\n    patient_data_source_id,\n    min(start_date) as start_date,\n    max(end_date) as end_date\n  from tuva.claims_preprocessing.encounters__stg_medical_claim\n  group by claim_id, patient_data_source_id\n)\n\n, base as (\n  select distinct\n    enc.claim_id,\n    enc.patient_data_source_id,\n    c.start_date,\n    c.end_date,\n    enc.facility_id,\n    enc.discharge_disposition_code\n  from tuva.claims_preprocessing.encounters__stg_medical_claim enc\n  inner join claim_start_end c \n    on enc.claim_id = c.claim_id\n    and c.patient_data_source_id = enc.patient_data_source_id\n  where\n    enc.service_category_2 = 'inpatient rehabilitation'\n    and enc.claim_type = 'institutional'\n)\n\n, add_row_num as (\n  select\n    patient_data_source_id,\n    claim_id,\n    start_date,\n    end_date,\n    discharge_disposition_code,\n    facility_id,\n    row_number() over (partition by patient_data_source_id order by end_date, start_date, claim_id) as row_num\n  from base\n)\n\n, check_for_merges_with_larger_row_num as (\n  select\n    aa.patient_data_source_id,\n    aa.claim_id as claim_id_a,\n    bb.claim_id as claim_id_b,\n    aa.row_num as row_num_a,\n    bb.row_num as row_num_b,\n    case\n      when aa.end_date = bb.end_date and aa.facility_id = bb.facility_id then 1\n      when \n\n    dateadd(\n        day,\n        1,\n        aa.end_date\n        )\n\n = bb.start_date\n        and aa.facility_id = bb.facility_id\n        and aa.discharge_disposition_code = '30' then 1\n      when aa.end_date <> bb.end_date\n        and aa.end_date > bb.start_date\n        and aa.facility_id = bb.facility_id then 1\n      else 0\n    end as merge_flag\n  from add_row_num as aa\n  inner join add_row_num as bb\n    on aa.patient_data_source_id = bb.patient_data_source_id\n    and aa.row_num < bb.row_num\n    and aa.claim_id <> bb.claim_id\n)\n\n\n, merges_with_larger_row_num as (\n  select\n      patient_data_source_id\n    , claim_id_a\n    , claim_id_b\n    , row_num_a\n    , row_num_b\n    , merge_flag\n  from check_for_merges_with_larger_row_num\n  where merge_flag = 1\n)\n\n, claim_ids_that_merge_with_larger_row_num as (\n  select distinct\n      claim_id_a as claim_id\n  from merges_with_larger_row_num\n)\n\n, claim_ids_having_a_smaller_row_num_merging_with_a_larger_row_num as (\n  select distinct\n      aa.claim_id as claim_id\n  from add_row_num as aa\n  inner join merges_with_larger_row_num as bb\n    on aa.patient_data_source_id = bb.patient_data_source_id\n    and bb.row_num_a < aa.row_num\n    and bb.row_num_b > aa.row_num\n)\n\n, close_flags as (\n  select\n      aa.patient_data_source_id\n    , aa.claim_id\n    , aa.start_date\n    , aa.end_date\n    , aa.discharge_disposition_code\n    , aa.facility_id\n    , aa.row_num\n    , case\n        when bb.claim_id is null\n          and cc.claim_id is null then 1\n        else 0\n      end as close_flag\n  from add_row_num as aa\n  left join claim_ids_that_merge_with_larger_row_num as bb\n    on aa.claim_id = bb.claim_id\n  left join claim_ids_having_a_smaller_row_num_merging_with_a_larger_row_num as cc\n    on aa.claim_id = cc.claim_id\n)\n\n, join_every_row_to_later_closes as (\n  select\n      aa.patient_data_source_id\n    , aa.claim_id\n    , aa.row_num\n    , bb.row_num as row_num_b\n  from close_flags as aa\n  inner join close_flags as bb\n    on aa.patient_data_source_id = bb.patient_data_source_id\n    and aa.row_num <= bb.row_num\n  where bb.close_flag = 1\n)\n\n, find_min_closing_row_num_for_every_claim as (\n  select\n      patient_data_source_id\n    , claim_id\n    , min(row_num_b) as min_closing_row\n  from join_every_row_to_later_closes\n  group by\n      patient_data_source_id\n    , claim_id\n)\n\n, add_min_closing_row_to_every_claim as (\n  select\n      aa.patient_data_source_id\n    , aa.claim_id\n    , aa.start_date\n    , aa.end_date\n    , aa.discharge_disposition_code\n    , aa.facility_id\n    , aa.row_num\n    , aa.close_flag\n    , bb.min_closing_row\n  from close_flags as aa\n  left join find_min_closing_row_num_for_every_claim as bb\n    on aa.patient_data_source_id = bb.patient_data_source_id\n    and aa.claim_id = bb.claim_id\n)\n\n, add_encounter_id as (\n  select\n      aa.patient_data_source_id\n    , aa.claim_id\n    , aa.start_date\n    , aa.end_date\n    , aa.discharge_disposition_code\n    , aa.facility_id\n    , aa.row_num\n    , aa.close_flag\n    , aa.min_closing_row\n    , bb.claim_id as encounter_id\n  from add_min_closing_row_to_every_claim as aa\n  left join add_min_closing_row_to_every_claim as bb\n    on aa.patient_data_source_id = bb.patient_data_source_id\n    and aa.min_closing_row = bb.row_num\n)\n\nselect\n    patient_data_source_id\n  , claim_id\n  , start_date\n  , end_date\n  , discharge_disposition_code\n  , facility_id\n  , row_number() over (partition by encounter_id order by start_date, end_date, claim_id) as encounter_claim_number\n  , row_number() over (partition by encounter_id order by start_date desc, end_date desc, claim_id desc) as encounter_claim_number_desc\n  , close_flag\n  , min_closing_row\n  , dense_rank() over (order by encounter_id) as encounter_id\nfrom add_encounter_id", "relation_name": "tuva.claims_preprocessing.inpatient_rehab__generate_encounter_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.740337Z", "completed_at": "2025-02-25T21:26:25.749089Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.749747Z", "completed_at": "2025-02-25T21:26:25.749751Z"}], "thread_id": "Thread-2", "execution_time": 0.013821840286254883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.inpatient_snf__generate_encounter_id", "compiled": true, "compiled_code": "\n\nwith claim_start_end as (\n  select\n    claim_id,\n    patient_data_source_id,\n    min(start_date) as start_date,\n    max(end_date) as end_date\n  from tuva.claims_preprocessing.encounters__stg_medical_claim\n  group by claim_id, patient_data_source_id\n)\n\n, base as (\n  select distinct\n    enc.claim_id,\n    enc.patient_data_source_id,\n    c.start_date,\n    c.end_date,\n    enc.facility_id,\n    enc.discharge_disposition_code\n  from tuva.claims_preprocessing.encounters__stg_medical_claim enc\n  inner join claim_start_end c \n    on enc.claim_id = c.claim_id\n    and c.patient_data_source_id = enc.patient_data_source_id\n  where\n    enc.service_category_2 = 'skilled nursing'\n    and enc.claim_type = 'institutional'\n)\n\n, add_row_num as (\n  select\n    patient_data_source_id,\n    claim_id,\n    start_date,\n    end_date,\n    discharge_disposition_code,\n    facility_id,\n    row_number() over (partition by patient_data_source_id order by end_date, start_date, claim_id) as row_num\n  from base\n)\n\n, check_for_merges_with_larger_row_num as (\n  select\n    aa.patient_data_source_id,\n    aa.claim_id as claim_id_a,\n    bb.claim_id as claim_id_b,\n    aa.row_num as row_num_a,\n    bb.row_num as row_num_b,   \n    case\n      when aa.end_date = bb.end_date and aa.facility_id = bb.facility_id then 1\n      when \n\n    dateadd(\n        day,\n        1,\n        aa.end_date\n        )\n\n = bb.start_date\n        and aa.facility_id = bb.facility_id\n        and aa.discharge_disposition_code = '30' then 1\n      when aa.end_date <> bb.end_date\n        and aa.end_date > bb.start_date\n        and aa.facility_id = bb.facility_id then 1\n      else 0\n    end as merge_flag\n  from add_row_num as aa\n  inner join add_row_num as bb\n    on aa.patient_data_source_id = bb.patient_data_source_id\n    and aa.row_num < bb.row_num\n    and aa.claim_id <> bb.claim_id\n)\n\n, merges_with_larger_row_num as (\n  select\n      patient_data_source_id\n    , claim_id_a\n    , claim_id_b\n    , row_num_a\n    , row_num_b\n    , merge_flag\n  from check_for_merges_with_larger_row_num\n  where merge_flag = 1\n)\n\n, claim_ids_that_merge_with_larger_row_num as (\n  select distinct\n      claim_id_a as claim_id\n  from merges_with_larger_row_num\n)\n\n, claim_ids_having_a_smaller_row_num_merging_with_a_larger_row_num as (\n  select distinct\n      aa.claim_id as claim_id\n  from add_row_num as aa\n  inner join merges_with_larger_row_num as bb\n    on aa.patient_data_source_id = bb.patient_data_source_id\n    and bb.row_num_a < aa.row_num\n    and bb.row_num_b > aa.row_num\n)\n\n, close_flags as (\n  select\n      aa.patient_data_source_id\n    , aa.claim_id\n    , aa.start_date\n    , aa.end_date\n    , aa.discharge_disposition_code\n    , aa.facility_id\n    , aa.row_num\n    , case\n        when bb.claim_id is null\n          and cc.claim_id is null then 1\n        else 0\n      end as close_flag\n  from add_row_num as aa\n  left join claim_ids_that_merge_with_larger_row_num as bb\n    on aa.claim_id = bb.claim_id\n  left join claim_ids_having_a_smaller_row_num_merging_with_a_larger_row_num as cc\n    on aa.claim_id = cc.claim_id\n)\n\n, join_every_row_to_later_closes as (\n  select\n      aa.patient_data_source_id\n    , aa.claim_id\n    , aa.row_num\n    , bb.row_num as row_num_b\n  from close_flags as aa\n  inner join close_flags as bb\n    on aa.patient_data_source_id = bb.patient_data_source_id\n    and aa.row_num <= bb.row_num\n  where bb.close_flag = 1\n)\n\n, find_min_closing_row_num_for_every_claim as (\n  select\n      patient_data_source_id\n    , claim_id\n    , min(row_num_b) as min_closing_row\n  from join_every_row_to_later_closes\n  group by\n      patient_data_source_id\n    , claim_id\n)\n\n, add_min_closing_row_to_every_claim as (\n  select\n      aa.patient_data_source_id\n    , aa.claim_id\n    , aa.start_date\n    , aa.end_date\n    , aa.discharge_disposition_code\n    , aa.facility_id\n    , aa.row_num\n    , aa.close_flag\n    , bb.min_closing_row\n  from close_flags as aa\n  left join find_min_closing_row_num_for_every_claim as bb\n    on aa.patient_data_source_id = bb.patient_data_source_id\n    and aa.claim_id = bb.claim_id\n)\n\n, add_encounter_id as (\n  select\n      aa.patient_data_source_id\n    , aa.claim_id\n    , aa.start_date\n    , aa.end_date\n    , aa.discharge_disposition_code\n    , aa.facility_id\n    , aa.row_num\n    , aa.close_flag\n    , aa.min_closing_row\n    , bb.claim_id as encounter_id\n  from add_min_closing_row_to_every_claim as aa\n  left join add_min_closing_row_to_every_claim as bb\n    on aa.patient_data_source_id = bb.patient_data_source_id\n    and aa.min_closing_row = bb.row_num\n)\n\nselect\n    patient_data_source_id\n  , claim_id\n  , start_date\n  , end_date\n  , discharge_disposition_code\n  , facility_id\n  , row_number() over (partition by encounter_id order by start_date, end_date, claim_id) as encounter_claim_number\n  , row_number() over (partition by encounter_id order by start_date desc, end_date desc, claim_id desc) as encounter_claim_number_desc\n  , close_flag\n  , min_closing_row\n  , dense_rank() over (order by encounter_id) as encounter_id\nfrom add_encounter_id", "relation_name": "tuva.claims_preprocessing.inpatient_snf__generate_encounter_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.745040Z", "completed_at": "2025-02-25T21:26:25.749567Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.750310Z", "completed_at": "2025-02-25T21:26:25.750313Z"}], "thread_id": "Thread-1", "execution_time": 0.010257959365844727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.inpatient_substance_use__generate_encounter_id", "compiled": true, "compiled_code": "\n\nwith claim_start_end as (\n  select\n    claim_id,\n    patient_data_source_id,\n    min(start_date) as start_date,\n    max(end_date) as end_date\n  from tuva.claims_preprocessing.encounters__stg_medical_claim\n  group by claim_id, patient_data_source_id\n)\n\n, base as (\n  select distinct\n    enc.claim_id,\n    enc.patient_data_source_id,\n    c.start_date,\n    c.end_date,\n    enc.facility_id,\n    enc.discharge_disposition_code\n  from tuva.claims_preprocessing.encounters__stg_medical_claim enc\n  inner join claim_start_end c \n    on enc.claim_id = c.claim_id\n    and c.patient_data_source_id = enc.patient_data_source_id\n  where\n    enc.service_category_2 = 'inpatient substance use'\n    and enc.claim_type = 'institutional'\n)\n\n, add_row_num as (\n  select\n    patient_data_source_id,\n    claim_id,\n    start_date,\n    end_date,\n    discharge_disposition_code,\n    facility_id,\n    row_number() over (partition by patient_data_source_id order by end_date, start_date, claim_id) as row_num\n  from base\n)\n\n, check_for_merges_with_larger_row_num as (\n  select\n    aa.patient_data_source_id,\n    aa.claim_id as claim_id_a,\n    bb.claim_id as claim_id_b,\n    aa.row_num as row_num_a,\n    bb.row_num as row_num_b,\n    case\n      when aa.end_date = bb.end_date and aa.facility_id = bb.facility_id then 1\n      when \n\n    dateadd(\n        day,\n        1,\n        aa.end_date\n        )\n\n = bb.start_date\n        and aa.facility_id = bb.facility_id\n        and aa.discharge_disposition_code = '30' then 1\n      when aa.end_date <> bb.end_date\n        and aa.end_date > bb.start_date\n        and aa.facility_id = bb.facility_id then 1\n      else 0\n    end as merge_flag\n  from add_row_num as aa\n  inner join add_row_num as bb\n    on aa.patient_data_source_id = bb.patient_data_source_id\n    and aa.row_num < bb.row_num\n    and aa.claim_id <> bb.claim_id\n)\n\n\n, merges_with_larger_row_num as (\n  select\n      patient_data_source_id\n    , claim_id_a\n    , claim_id_b\n    , row_num_a\n    , row_num_b\n    , merge_flag\n  from check_for_merges_with_larger_row_num\n  where merge_flag = 1\n)\n\n, claim_ids_that_merge_with_larger_row_num as (\n  select distinct\n      claim_id_a as claim_id\n  from merges_with_larger_row_num\n)\n\n, claim_ids_having_a_smaller_row_num_merging_with_a_larger_row_num as (\n  select distinct\n      aa.claim_id as claim_id\n  from add_row_num as aa\n  inner join merges_with_larger_row_num as bb\n    on aa.patient_data_source_id = bb.patient_data_source_id\n    and bb.row_num_a < aa.row_num\n    and bb.row_num_b > aa.row_num\n)\n\n, close_flags as (\n  select\n      aa.patient_data_source_id\n    , aa.claim_id\n    , aa.start_date\n    , aa.end_date\n    , aa.discharge_disposition_code\n    , aa.facility_id\n    , aa.row_num\n    , case\n        when bb.claim_id is null\n          and cc.claim_id is null then 1\n        else 0\n      end as close_flag\n  from add_row_num as aa\n  left join claim_ids_that_merge_with_larger_row_num as bb\n    on aa.claim_id = bb.claim_id\n  left join claim_ids_having_a_smaller_row_num_merging_with_a_larger_row_num as cc\n    on aa.claim_id = cc.claim_id\n)\n\n, join_every_row_to_later_closes as (\n  select\n      aa.patient_data_source_id\n    , aa.claim_id\n    , aa.row_num\n    , bb.row_num as row_num_b\n  from close_flags as aa\n  inner join close_flags as bb\n    on aa.patient_data_source_id = bb.patient_data_source_id\n    and aa.row_num <= bb.row_num\n  where bb.close_flag = 1\n)\n\n, find_min_closing_row_num_for_every_claim as (\n  select\n      patient_data_source_id\n    , claim_id\n    , min(row_num_b) as min_closing_row\n  from join_every_row_to_later_closes\n  group by\n      patient_data_source_id\n    , claim_id\n)\n\n, add_min_closing_row_to_every_claim as (\n  select\n      aa.patient_data_source_id\n    , aa.claim_id\n    , aa.start_date\n    , aa.end_date\n    , aa.discharge_disposition_code\n    , aa.facility_id\n    , aa.row_num\n    , aa.close_flag\n    , bb.min_closing_row\n  from close_flags as aa\n  left join find_min_closing_row_num_for_every_claim as bb\n    on aa.patient_data_source_id = bb.patient_data_source_id\n    and aa.claim_id = bb.claim_id\n)\n\n, add_encounter_id as (\n  select\n      aa.patient_data_source_id\n    , aa.claim_id\n    , aa.start_date\n    , aa.end_date\n    , aa.discharge_disposition_code\n    , aa.facility_id\n    , aa.row_num\n    , aa.close_flag\n    , aa.min_closing_row\n    , bb.claim_id as encounter_id\n  from add_min_closing_row_to_every_claim as aa\n  left join add_min_closing_row_to_every_claim as bb\n    on aa.patient_data_source_id = bb.patient_data_source_id\n    and aa.min_closing_row = bb.row_num\n)\n\nselect\n    patient_data_source_id\n  , claim_id\n  , start_date\n  , end_date\n  , discharge_disposition_code\n  , facility_id\n  , row_number() over (partition by encounter_id order by start_date, end_date, claim_id) as encounter_claim_number\n  , row_number() over (partition by encounter_id order by start_date desc, end_date desc, claim_id desc) as encounter_claim_number_desc\n  , close_flag\n  , min_closing_row\n  , dense_rank() over (order by encounter_id) as encounter_id\nfrom add_encounter_id", "relation_name": "tuva.claims_preprocessing.inpatient_substance_use__generate_encounter_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.750895Z", "completed_at": "2025-02-25T21:26:25.755186Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.761198Z", "completed_at": "2025-02-25T21:26:25.761206Z"}], "thread_id": "Thread-3", "execution_time": 0.011961698532104492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.lab__anchor_events", "compiled": true, "compiled_code": "\n\nwith service_category as (\n  select distinct\n      claim_id\n    , patient_data_source_id\n    , start_date\n  from tuva.claims_preprocessing.encounters__stg_medical_claim\n  where\n    service_category_2 = 'lab' --both inst and prof\n    \n)\n\nselect distinct \nclaim_id\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom service_category", "relation_name": "tuva.claims_preprocessing.lab__anchor_events"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.755367Z", "completed_at": "2025-02-25T21:26:25.762690Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.767681Z", "completed_at": "2025-02-25T21:26:25.767688Z"}], "thread_id": "Thread-2", "execution_time": 0.013525009155273438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.office_visits__int_office_visits", "compiled": true, "compiled_code": "\n\nwith anchor as (\n    select distinct\n        mc.patient_data_source_id\n      , mc.start_date\n      , mc.claim_id\n      , mc.claim_line_number\n      , mc.service_category_1\n      , mc.service_category_2\n      , mc.service_category_3\n    from tuva.claims_preprocessing.encounters__stg_medical_claim as mc\n    inner join tuva.claims_preprocessing._int_combined_professional as p -- joining in all sc regardless of final priority\n      on mc.claim_id = p.claim_id\n      and mc.claim_line_number = p.claim_line_number\n    where p.service_category_1 = 'office-based'\n)\n\nselect\n    patient_data_source_id\n  , start_date\n  , claim_id\n  , claim_line_number\n  , service_category_1\n  , service_category_2\n  , service_category_3\n  , dense_rank() over (order by patient_data_source_id, start_date) as old_encounter_id\nfrom anchor", "relation_name": "tuva.claims_preprocessing.office_visits__int_office_visits"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.757992Z", "completed_at": "2025-02-25T21:26:25.762922Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.768129Z", "completed_at": "2025-02-25T21:26:25.768133Z"}], "thread_id": "Thread-1", "execution_time": 0.013638734817504883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.outpatient_hospice__anchor_events", "compiled": true, "compiled_code": "\n\nwith service_category as (\n  select distinct\n      claim_id\n    , patient_data_source_id\n    , start_date\n  from tuva.claims_preprocessing.encounters__stg_medical_claim\n  where\n    service_category_2 = 'outpatient hospice' --both inst and prof\n    \n)\n\nselect distinct \nclaim_id\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom service_category", "relation_name": "tuva.claims_preprocessing.outpatient_hospice__anchor_events"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.763141Z", "completed_at": "2025-02-25T21:26:25.769524Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.770187Z", "completed_at": "2025-02-25T21:26:25.770193Z"}], "thread_id": "Thread-3", "execution_time": 0.008095026016235352, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.outpatient_hospital_or_clinic__anchor_events", "compiled": true, "compiled_code": "\n\nwith service_category as (\n    select distinct\n        claim_id\n      , patient_data_source_id\n      , start_date\n    from tuva.claims_preprocessing.encounters__stg_medical_claim\n    where \n      service_category_2 in (\n          'outpatient hospital or clinic' -- both prof and inst\n        , 'observation' -- orphaned obs that didn't roll up to other encounter\n      )\n)\n\nselect distinct \n    claim_id\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom service_category", "relation_name": "tuva.claims_preprocessing.outpatient_hospital_or_clinic__anchor_events"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.770807Z", "completed_at": "2025-02-25T21:26:25.778989Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.782477Z", "completed_at": "2025-02-25T21:26:25.782484Z"}], "thread_id": "Thread-2", "execution_time": 0.013281106948852539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.outpatient_injections__anchor_events", "compiled": true, "compiled_code": "\n\nwith multiple_sources as \n(\nselect distinct\n    med.patient_data_source_id\n    ,med.start_date\nfrom tuva.claims_preprocessing.encounters__stg_medical_claim med\ninner join tuva.claims_preprocessing.encounters__stg_outpatient_institutional outpatient\n    on med.claim_id = outpatient.claim_id\nwhere substring(med.hcpcs_code,1,1) = 'J'\n)\n\n\nselect distinct \n    patient_data_source_id\n    ,start_date\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom multiple_sources", "relation_name": "tuva.claims_preprocessing.outpatient_injections__anchor_events"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.774953Z", "completed_at": "2025-02-25T21:26:25.782904Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.783538Z", "completed_at": "2025-02-25T21:26:25.783543Z"}], "thread_id": "Thread-1", "execution_time": 0.013887882232666016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.outpatient_psych__anchor_events", "compiled": true, "compiled_code": "\n\nwith service_category as (\n  select distinct\n      claim_id\n    , patient_data_source_id\n    , start_date\n  from tuva.claims_preprocessing.encounters__stg_medical_claim\n  where\n    service_category_2 = 'outpatient psychiatric' --both inst and prof as anchor\n)\n\nselect distinct \nclaim_id\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom service_category", "relation_name": "tuva.claims_preprocessing.outpatient_psych__anchor_events"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.779220Z", "completed_at": "2025-02-25T21:26:25.784512Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.785142Z", "completed_at": "2025-02-25T21:26:25.785146Z"}], "thread_id": "Thread-3", "execution_time": 0.006784915924072266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.outpatient_ptotst__anchor_events", "compiled": true, "compiled_code": "\n\nwith service_category as (\n  select distinct\n      claim_id\n    , patient_data_source_id\n    , start_date\n  from tuva.claims_preprocessing.encounters__stg_medical_claim\n  where\n    service_category_2 = 'outpatient pt/ot/st' --both inst and prof as anchor\n)\n\nselect distinct \nclaim_id\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom service_category", "relation_name": "tuva.claims_preprocessing.outpatient_ptotst__anchor_events"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.785489Z", "completed_at": "2025-02-25T21:26:25.793347Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.793809Z", "completed_at": "2025-02-25T21:26:25.793815Z"}], "thread_id": "Thread-2", "execution_time": 0.011169195175170898, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.outpatient_radiology__anchor_events", "compiled": true, "compiled_code": "\n\nwith service_category as (\n  select distinct\n    patient_data_source_id\n    , start_date\n    , hcpcs_code\n  from tuva.claims_preprocessing.encounters__stg_medical_claim\n  where\n    service_category_2 = 'outpatient radiology' --both professional and inst\n)\n\nselect distinct \n    patient_data_source_id\n    , start_date\n    , hcpcs_code\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom service_category", "relation_name": "tuva.claims_preprocessing.outpatient_radiology__anchor_events"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.789687Z", "completed_at": "2025-02-25T21:26:25.795471Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.799548Z", "completed_at": "2025-02-25T21:26:25.799554Z"}], "thread_id": "Thread-1", "execution_time": 0.014718294143676758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.outpatient_rehab__anchor_events", "compiled": true, "compiled_code": "\n\nwith service_category as (\n  select distinct\n      claim_id\n    , patient_data_source_id\n    , start_date\n  from tuva.claims_preprocessing.encounters__stg_medical_claim\n  where\n    service_category_2 = 'outpatient rehabilitation'\n)\n\nselect distinct \nclaim_id\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom service_category", "relation_name": "tuva.claims_preprocessing.outpatient_rehab__anchor_events"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.795686Z", "completed_at": "2025-02-25T21:26:25.801093Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.805675Z", "completed_at": "2025-02-25T21:26:25.805684Z"}], "thread_id": "Thread-3", "execution_time": 0.01277303695678711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.outpatient_substance_use__anchor_events", "compiled": true, "compiled_code": "\n\nwith service_category as (\n  select distinct\n      claim_id\n    , patient_data_source_id\n    , start_date\n  from tuva.claims_preprocessing.encounters__stg_medical_claim\n  where\n    service_category_2 = 'outpatient substance use'\n    and claim_type = 'institutional'\n)\n\nselect distinct \nclaim_id\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom service_category", "relation_name": "tuva.claims_preprocessing.outpatient_substance_use__anchor_events"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.801549Z", "completed_at": "2025-02-25T21:26:25.809848Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.810303Z", "completed_at": "2025-02-25T21:26:25.810308Z"}], "thread_id": "Thread-2", "execution_time": 0.010119915008544922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.outpatient_surgery__anchor_events", "compiled": true, "compiled_code": "\n\nwith service_category as (\n  select distinct\n      claim_id\n    , patient_data_source_id\n    , start_date\n  from tuva.claims_preprocessing.encounters__stg_medical_claim\n  where\n    service_category_2 in ('outpatient surgery') --both inst and prof anchor\n)\n\nselect distinct \nclaim_id\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom service_category", "relation_name": "tuva.claims_preprocessing.outpatient_surgery__anchor_events"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.806714Z", "completed_at": "2025-02-25T21:26:25.810703Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.814360Z", "completed_at": "2025-02-25T21:26:25.814366Z"}], "thread_id": "Thread-1", "execution_time": 0.013149023056030273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.urgent_care__anchor_events", "compiled": true, "compiled_code": "\n\n  select distinct\n      claim_id\n  from tuva.claims_preprocessing.encounters__stg_medical_claim\n  where\n    service_category_2 in ('urgent care') --both inst and prof anchor", "relation_name": "tuva.claims_preprocessing.urgent_care__anchor_events"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.810890Z", "completed_at": "2025-02-25T21:26:25.815641Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.818803Z", "completed_at": "2025-02-25T21:26:25.818807Z"}], "thread_id": "Thread-3", "execution_time": 0.009350776672363281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.asc__generate_encounter_id", "compiled": true, "compiled_code": "\n\nwith base_data as (\n    select distinct\n        m.patient_data_source_id\n      , m.start_date\n      , m.end_date\n      , m.claim_id\n    from tuva.claims_preprocessing.encounters__stg_medical_claim as m\n    inner join tuva.claims_preprocessing.asc__anchor_events as u\n      on m.claim_id = u.claim_id\n)\n\n-- Determine Previous Maximum End Date\n, grouped_data as (\n    select\n        bd.*\n      , max(end_date) over (\n            partition by patient_data_source_id \n            order by start_date, claim_id \n            rows between unbounded preceding and 1 preceding\n        ) as previous_max_end_date\n    from base_data as bd\n)\n\n-- Flag New Encounter Groups\n, flagged_data as (\n    select\n        gd.*\n      , case \n            when start_date > coalesce(previous_max_end_date, '1900-01-01') then 1 \n            else 0 \n        end as new_group_flag\n    from grouped_data as gd\n)\n\n-- Assign Encounter Groups per Patient\n, numbered_data as (\n    select\n        fd.*\n      , sum(new_group_flag) over (\n            partition by patient_data_source_id \n            order by start_date, claim_id \n            rows unbounded preceding\n        ) as encounter_group\n    from flagged_data as fd\n)\n\n-- Identify Unique Encounters\n, unique_encounters as (\n    select\n        patient_data_source_id\n      , encounter_group\n      , min(start_date) as encounter_start_date\n    from numbered_data\n    group by\n        patient_data_source_id\n      , encounter_group\n)\n\n-- Assign asc encounter_id\n, numbered_encounters as (\n    select\n        patient_data_source_id\n      , encounter_group\n      , row_number() over (\n            order by patient_data_source_id, encounter_start_date\n        ) as encounter_id\n    from unique_encounters\n)\n\n-- Merge Encounters with Claims\nselect\n    nd.patient_data_source_id\n  , nd.start_date\n  , nd.end_date\n  , nd.claim_id\n  , ne.encounter_id as old_encounter_id\nfrom numbered_data as nd\ninner join numbered_encounters as ne\n  on nd.patient_data_source_id = ne.patient_data_source_id\n  and nd.encounter_group = ne.encounter_group", "relation_name": "tuva.claims_preprocessing.asc__generate_encounter_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.816073Z", "completed_at": "2025-02-25T21:26:25.824245Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.824746Z", "completed_at": "2025-02-25T21:26:25.824753Z"}], "thread_id": "Thread-2", "execution_time": 0.009945154190063477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.acute_inpatient__start_end_dates", "compiled": true, "compiled_code": "\n\nselect encounter_id \n, min(start_date) as encounter_start_date\n, max(end_date) as encounter_end_date\nfrom tuva.claims_preprocessing.acute_inpatient__generate_encounter_id\ngroup by encounter_id", "relation_name": "tuva.claims_preprocessing.acute_inpatient__start_end_dates"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.819707Z", "completed_at": "2025-02-25T21:26:25.828194Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.828848Z", "completed_at": "2025-02-25T21:26:25.828854Z"}], "thread_id": "Thread-1", "execution_time": 0.013089179992675781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ambulance__generate_encounter_id", "compiled": true, "compiled_code": "\n\nwith anchor as \n(\nselect distinct m.patient_data_source_id\n , m.start_date\n , m.claim_id\nfrom tuva.claims_preprocessing.encounters__stg_medical_claim m\ninner join tuva.claims_preprocessing.ambulance__anchor_events u on m.claim_id = u.claim_id\n)\n\nselect patient_data_source_id\n,start_date\n,claim_id\n,dense_rank() over (order by patient_data_source_id, start_date) as old_encounter_id\nfrom anchor", "relation_name": "tuva.claims_preprocessing.ambulance__generate_encounter_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.825167Z", "completed_at": "2025-02-25T21:26:25.829997Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.833351Z", "completed_at": "2025-02-25T21:26:25.833357Z"}], "thread_id": "Thread-3", "execution_time": 0.009510993957519531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.dialysis__generate_encounter_id", "compiled": true, "compiled_code": "\n\nwith anchor as \n(\nselect distinct m.patient_data_source_id\n , m.start_date\n , m.claim_id\nfrom tuva.claims_preprocessing.encounters__stg_medical_claim m\ninner join tuva.claims_preprocessing.dialysis__anchor_events u on m.claim_id = u.claim_id\n)\n\nselect patient_data_source_id\n,start_date\n,claim_id\n,dense_rank() over (order by patient_data_source_id, start_date) as old_encounter_id\nfrom anchor", "relation_name": "tuva.claims_preprocessing.dialysis__generate_encounter_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.830439Z", "completed_at": "2025-02-25T21:26:25.838176Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.841878Z", "completed_at": "2025-02-25T21:26:25.841886Z"}], "thread_id": "Thread-2", "execution_time": 0.01270914077758789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.emergency_department__generate_encounter_id", "compiled": true, "compiled_code": "\n\n\nselect\n    patient_data_source_id\n  , claim_id\n  , start_date\n  , end_date\n  , discharge_disposition_code\n  , facility_id\n  , row_number() over (partition by encounter_id order by start_date, end_date, claim_id) as encounter_claim_number\n  , row_number() over (partition by encounter_id order by start_date desc, end_date desc, claim_id desc) as encounter_claim_number_desc\n  , close_flag\n  , min_closing_row\n  , dense_rank() over (order by encounter_id) as encounter_id\nfrom tuva.claims_preprocessing.emergency_department__generate_encounter_id_pre_sort", "relation_name": "tuva.claims_preprocessing.emergency_department__generate_encounter_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.834295Z", "completed_at": "2025-02-25T21:26:25.841643Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.842443Z", "completed_at": "2025-02-25T21:26:25.842447Z"}], "thread_id": "Thread-1", "execution_time": 0.012315034866333008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.dme__generate_encounter_id", "compiled": true, "compiled_code": "\n\nwith anchor as \n(\nselect distinct m.patient_data_source_id\n , m.start_date\n , m.claim_id\nfrom tuva.claims_preprocessing.encounters__stg_medical_claim m\ninner join tuva.claims_preprocessing.dme__anchor_events u on m.claim_id = u.claim_id\n)\n\nselect patient_data_source_id\n,start_date\n,claim_id\n,dense_rank() over (order by patient_data_source_id, start_date) as old_encounter_id\nfrom anchor", "relation_name": "tuva.claims_preprocessing.dme__generate_encounter_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.838432Z", "completed_at": "2025-02-25T21:26:25.843534Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.844222Z", "completed_at": "2025-02-25T21:26:25.844226Z"}], "thread_id": "Thread-3", "execution_time": 0.006766080856323242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.home_health__generate_encounter_id", "compiled": true, "compiled_code": "\n\nwith anchor as \n(\nselect distinct m.patient_data_source_id\n , m.start_date\n , m.claim_id\nfrom tuva.claims_preprocessing.encounters__stg_medical_claim m\ninner join tuva.claims_preprocessing.home_health__anchor_events u on m.claim_id = u.claim_id\n)\n\nselect patient_data_source_id\n,start_date\n,claim_id\n,dense_rank() over (order by patient_data_source_id, start_date) as old_encounter_id\nfrom anchor", "relation_name": "tuva.claims_preprocessing.home_health__generate_encounter_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.845247Z", "completed_at": "2025-02-25T21:26:25.856222Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.856767Z", "completed_at": "2025-02-25T21:26:25.856775Z"}], "thread_id": "Thread-2", "execution_time": 0.013166666030883789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.inpatient_hospice__start_end_dates", "compiled": true, "compiled_code": "\n\nselect encounter_id \n, min(start_date) as encounter_start_date\n, max(end_date) as encounter_end_date\nfrom tuva.claims_preprocessing.inpatient_hospice__generate_encounter_id\ngroup by encounter_id", "relation_name": "tuva.claims_preprocessing.inpatient_hospice__start_end_dates"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.849476Z", "completed_at": "2025-02-25T21:26:25.856477Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.857263Z", "completed_at": "2025-02-25T21:26:25.857268Z"}], "thread_id": "Thread-1", "execution_time": 0.013328790664672852, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.inpatient_psych__start_end_dates", "compiled": true, "compiled_code": "\n\nselect encounter_id \n, min(start_date) as encounter_start_date\n, max(end_date) as encounter_end_date\nfrom tuva.claims_preprocessing.inpatient_psych__generate_encounter_id\ngroup by encounter_id", "relation_name": "tuva.claims_preprocessing.inpatient_psych__start_end_dates"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.853330Z", "completed_at": "2025-02-25T21:26:25.857984Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.858770Z", "completed_at": "2025-02-25T21:26:25.858774Z"}], "thread_id": "Thread-3", "execution_time": 0.0064029693603515625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.inpatient_rehab__start_end_dates", "compiled": true, "compiled_code": "\n\nselect encounter_id \n, min(start_date) as encounter_start_date\n, max(end_date) as encounter_end_date\nfrom tuva.claims_preprocessing.inpatient_rehab__generate_encounter_id\ngroup by encounter_id", "relation_name": "tuva.claims_preprocessing.inpatient_rehab__start_end_dates"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.860218Z", "completed_at": "2025-02-25T21:26:25.869555Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.870328Z", "completed_at": "2025-02-25T21:26:25.870336Z"}], "thread_id": "Thread-2", "execution_time": 0.011942148208618164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.inpatient_snf__start_end_dates", "compiled": true, "compiled_code": "\n\nselect encounter_id \n, min(start_date) as encounter_start_date\n, max(end_date) as encounter_end_date\nfrom tuva.claims_preprocessing.inpatient_snf__generate_encounter_id\ngroup by encounter_id", "relation_name": "tuva.claims_preprocessing.inpatient_snf__start_end_dates"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.863537Z", "completed_at": "2025-02-25T21:26:25.870079Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.870798Z", "completed_at": "2025-02-25T21:26:25.870802Z"}], "thread_id": "Thread-1", "execution_time": 0.011801719665527344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.inpatient_substance_use__start_end_dates", "compiled": true, "compiled_code": "\n\nselect encounter_id \n, min(start_date) as encounter_start_date\n, max(end_date) as encounter_end_date\nfrom tuva.claims_preprocessing.inpatient_substance_use__generate_encounter_id\ngroup by encounter_id", "relation_name": "tuva.claims_preprocessing.inpatient_substance_use__start_end_dates"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.866671Z", "completed_at": "2025-02-25T21:26:25.872004Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.874167Z", "completed_at": "2025-02-25T21:26:25.874174Z"}], "thread_id": "Thread-3", "execution_time": 0.010999202728271484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.lab__generate_encounter_id", "compiled": true, "compiled_code": "\n\nwith anchor as \n(\nselect distinct m.patient_data_source_id\n , m.start_date\n , m.claim_id\nfrom tuva.claims_preprocessing.encounters__stg_medical_claim m\ninner join tuva.claims_preprocessing.lab__anchor_events u on m.claim_id = u.claim_id\n)\n\nselect patient_data_source_id\n,start_date\n,claim_id\n,dense_rank() over (order by patient_data_source_id, start_date) as old_encounter_id\nfrom anchor", "relation_name": "tuva.claims_preprocessing.lab__generate_encounter_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.875971Z", "completed_at": "2025-02-25T21:26:25.887380Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.888321Z", "completed_at": "2025-02-25T21:26:25.888329Z"}], "thread_id": "Thread-2", "execution_time": 0.014538049697875977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.office_visits__int_office_visits_em", "compiled": true, "compiled_code": "\n\nselect distinct\n    ov.patient_data_source_id\n    ,ov.start_date\n    ,ov.claim_id\n    ,ov.claim_line_number\n    ,ov.old_encounter_id\nfrom tuva.claims_preprocessing.office_visits__int_office_visits ov\nwhere service_category_2 = 'office-based visit'", "relation_name": "tuva.claims_preprocessing.office_visits__int_office_visits_em"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.880501Z", "completed_at": "2025-02-25T21:26:25.888065Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.888901Z", "completed_at": "2025-02-25T21:26:25.888905Z"}], "thread_id": "Thread-1", "execution_time": 0.014367818832397461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.office_visits__int_office_visits_injections", "compiled": true, "compiled_code": "\n\nselect distinct\n    ov.patient_data_source_id\n    ,ov.start_date\n    ,ov.claim_id\n    ,ov.claim_line_number\n    ,ov.old_encounter_id\nfrom tuva.claims_preprocessing.office_visits__int_office_visits ov\ninner join tuva.claims_preprocessing.encounters__stg_medical_claim mc on mc.claim_id = ov.claim_id\n    and mc.claim_line_number = ov.claim_line_number\nwhere substring(hcpcs_code,1,1) = 'J'", "relation_name": "tuva.claims_preprocessing.office_visits__int_office_visits_injections"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.884244Z", "completed_at": "2025-02-25T21:26:25.889249Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.890079Z", "completed_at": "2025-02-25T21:26:25.890083Z"}], "thread_id": "Thread-3", "execution_time": 0.009968280792236328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.office_visits__int_office_visits_ptotst", "compiled": true, "compiled_code": "\n\nselect distinct\n    ov.patient_data_source_id\n    ,ov.start_date\n    ,ov.claim_id\n    ,ov.claim_line_number\n    ,ov.old_encounter_id\nfrom tuva.claims_preprocessing.office_visits__int_office_visits ov\nwhere service_category_2 = 'office-based pt/ot/st'", "relation_name": "tuva.claims_preprocessing.office_visits__int_office_visits_ptotst"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.895136Z", "completed_at": "2025-02-25T21:26:25.901556Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.901989Z", "completed_at": "2025-02-25T21:26:25.901996Z"}], "thread_id": "Thread-1", "execution_time": 0.011363029479980469, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.office_visits__int_office_visits_surgery", "compiled": true, "compiled_code": "\n\nselect distinct\n    ov.patient_data_source_id\n    ,ov.start_date\n    ,ov.claim_id\n    ,ov.claim_line_number\n    ,ov.old_encounter_id\nfrom tuva.claims_preprocessing.office_visits__int_office_visits ov\nwhere service_category_2 = 'office-based surgery'", "relation_name": "tuva.claims_preprocessing.office_visits__int_office_visits_surgery"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.891815Z", "completed_at": "2025-02-25T21:26:25.901772Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.902602Z", "completed_at": "2025-02-25T21:26:25.902606Z"}], "thread_id": "Thread-2", "execution_time": 0.012176036834716797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.office_visits__int_office_visits_radiology", "compiled": true, "compiled_code": "\n\nwith max_encounter as (\n    select max(old_encounter_id) as max_encounter_id\n    from tuva.claims_preprocessing.office_visits__int_office_visits\n)\n\nselect distinct\n    ov.patient_data_source_id\n    ,ov.start_date\n    ,ov.claim_id\n    ,ov.claim_line_number\n    ,mc.hcpcs_code\n    ,dense_rank() over (order by ov.patient_data_source_id, ov.start_date, mc.hcpcs_code) + mx.max_encounter_id as old_encounter_id\nfrom tuva.claims_preprocessing.office_visits__int_office_visits ov\ncross join max_encounter mx\ninner join tuva.claims_preprocessing.encounters__stg_medical_claim mc on mc.claim_id = ov.claim_id\n    and mc.claim_line_number = ov.claim_line_number\ninner join tuva.claims_preprocessing.service_category__office_based_radiology scrad on mc.claim_id = scrad.claim_id\n    and mc.claim_line_number = scrad.claim_line_number", "relation_name": "tuva.claims_preprocessing.office_visits__int_office_visits_radiology"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.897925Z", "completed_at": "2025-02-25T21:26:25.902412Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.903222Z", "completed_at": "2025-02-25T21:26:25.903225Z"}], "thread_id": "Thread-3", "execution_time": 0.011687994003295898, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.office_visits__int_office_visits_telehealth", "compiled": true, "compiled_code": "\n\nselect distinct\n    ov.patient_data_source_id\n    ,ov.start_date\n    ,ov.claim_id\n    ,ov.claim_line_number\n    ,ov.old_encounter_id\nfrom tuva.claims_preprocessing.office_visits__int_office_visits ov\nwhere service_category_2 = 'telehealth visit'", "relation_name": "tuva.claims_preprocessing.office_visits__int_office_visits_telehealth"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.905185Z", "completed_at": "2025-02-25T21:26:25.913541Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.913782Z", "completed_at": "2025-02-25T21:26:25.913788Z"}], "thread_id": "Thread-1", "execution_time": 0.010035276412963867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.outpatient_hospice__generate_encounter_id", "compiled": true, "compiled_code": "\n\nwith anchor as \n(\nselect distinct m.patient_data_source_id\n , m.start_date\n , m.claim_id\nfrom tuva.claims_preprocessing.encounters__stg_medical_claim m\ninner join tuva.claims_preprocessing.outpatient_hospice__anchor_events u on m.claim_id = u.claim_id\n)\n\nselect patient_data_source_id\n,start_date\n,claim_id\n,dense_rank() over (order by patient_data_source_id, start_date) as old_encounter_id\nfrom anchor", "relation_name": "tuva.claims_preprocessing.outpatient_hospice__generate_encounter_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.908150Z", "completed_at": "2025-02-25T21:26:25.917650Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.917892Z", "completed_at": "2025-02-25T21:26:25.917897Z"}], "thread_id": "Thread-2", "execution_time": 0.013643026351928711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.outpatient_hospital_or_clinic__generate_encounter_id", "compiled": true, "compiled_code": "\n\nwith anchor as \n(\nselect distinct m.patient_data_source_id\n , m.start_date\n , m.claim_id\nfrom tuva.claims_preprocessing.encounters__stg_medical_claim m\ninner join tuva.claims_preprocessing.outpatient_hospital_or_clinic__anchor_events u on m.claim_id = u.claim_id\n)\n\nselect patient_data_source_id\n,start_date\n,claim_id\n,dense_rank() over (order by patient_data_source_id, start_date) as old_encounter_id\nfrom anchor", "relation_name": "tuva.claims_preprocessing.outpatient_hospital_or_clinic__generate_encounter_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.910902Z", "completed_at": "2025-02-25T21:26:25.918514Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.919046Z", "completed_at": "2025-02-25T21:26:25.919049Z"}], "thread_id": "Thread-3", "execution_time": 0.014321088790893555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.outpatient_injections__generate_encounter_id", "compiled": true, "compiled_code": "\n\nselect patient_data_source_id\n,start_date\n,dense_rank() over (order by patient_data_source_id, start_date) as old_encounter_id\nfrom tuva.claims_preprocessing.outpatient_injections__anchor_events", "relation_name": "tuva.claims_preprocessing.outpatient_injections__generate_encounter_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.914994Z", "completed_at": "2025-02-25T21:26:25.919396Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.920046Z", "completed_at": "2025-02-25T21:26:25.920050Z"}], "thread_id": "Thread-1", "execution_time": 0.005571126937866211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.outpatient_psych__generate_encounter_id", "compiled": true, "compiled_code": "\n\nwith anchor as \n(\nselect distinct m.patient_data_source_id\n , m.start_date\n , m.claim_id\nfrom tuva.claims_preprocessing.encounters__stg_medical_claim m\ninner join tuva.claims_preprocessing.outpatient_psych__anchor_events u on m.claim_id = u.claim_id\n)\n\nselect patient_data_source_id\n,start_date\n,claim_id\n,dense_rank() over (order by patient_data_source_id, start_date) as old_encounter_id\nfrom anchor", "relation_name": "tuva.claims_preprocessing.outpatient_psych__generate_encounter_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.920411Z", "completed_at": "2025-02-25T21:26:25.927550Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.927997Z", "completed_at": "2025-02-25T21:26:25.928002Z"}], "thread_id": "Thread-2", "execution_time": 0.00929570198059082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.outpatient_ptotst__generate_encounter_id", "compiled": true, "compiled_code": "\n\nwith anchor as \n(\nselect distinct m.patient_data_source_id\n , m.start_date\n , m.claim_id\nfrom tuva.claims_preprocessing.encounters__stg_medical_claim m\ninner join tuva.claims_preprocessing.outpatient_ptotst__anchor_events u on m.claim_id = u.claim_id\n)\n\nselect patient_data_source_id\n,start_date\n,claim_id\n,dense_rank() over (order by patient_data_source_id, start_date) as old_encounter_id\nfrom anchor", "relation_name": "tuva.claims_preprocessing.outpatient_ptotst__generate_encounter_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.924087Z", "completed_at": "2025-02-25T21:26:25.931327Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.931853Z", "completed_at": "2025-02-25T21:26:25.931857Z"}], "thread_id": "Thread-3", "execution_time": 0.008852005004882812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.outpatient_radiology__generate_encounter_id", "compiled": true, "compiled_code": "\n\nselect patient_data_source_id\n,start_date\n,hcpcs_code\n,dense_rank() over (order by patient_data_source_id, start_date, hcpcs_code) as old_encounter_id\nfrom tuva.claims_preprocessing.outpatient_radiology__anchor_events", "relation_name": "tuva.claims_preprocessing.outpatient_radiology__generate_encounter_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.928378Z", "completed_at": "2025-02-25T21:26:25.932249Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.932919Z", "completed_at": "2025-02-25T21:26:25.932923Z"}], "thread_id": "Thread-1", "execution_time": 0.009119987487792969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.outpatient_rehab__generate_encounter_id", "compiled": true, "compiled_code": "\n\nwith anchor as \n(\nselect distinct m.patient_data_source_id\n , m.start_date\n , m.claim_id\nfrom tuva.claims_preprocessing.encounters__stg_medical_claim m\ninner join tuva.claims_preprocessing.outpatient_rehab__anchor_events u on m.claim_id = u.claim_id\n)\n\nselect patient_data_source_id\n,start_date\n,claim_id\n,dense_rank() over (order by patient_data_source_id, start_date) as old_encounter_id\nfrom anchor", "relation_name": "tuva.claims_preprocessing.outpatient_rehab__generate_encounter_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.933275Z", "completed_at": "2025-02-25T21:26:25.939648Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.940080Z", "completed_at": "2025-02-25T21:26:25.940085Z"}], "thread_id": "Thread-2", "execution_time": 0.00855708122253418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.outpatient_substance_use__generate_encounter_id", "compiled": true, "compiled_code": "\nwith anchor as \n(\nselect distinct m.patient_data_source_id\n , m.start_date\n , m.claim_id\nfrom tuva.claims_preprocessing.encounters__stg_medical_claim m\ninner join tuva.claims_preprocessing.outpatient_substance_use__anchor_events u on m.claim_id = u.claim_id\n)\n\nselect patient_data_source_id\n,start_date\n,claim_id\n,dense_rank() over (order by patient_data_source_id, start_date) as old_encounter_id\nfrom anchor", "relation_name": "tuva.claims_preprocessing.outpatient_substance_use__generate_encounter_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.937006Z", "completed_at": "2025-02-25T21:26:25.943404Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.944018Z", "completed_at": "2025-02-25T21:26:25.944022Z"}], "thread_id": "Thread-3", "execution_time": 0.008142948150634766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.outpatient_surgery__generate_encounter_id", "compiled": true, "compiled_code": "\nwith anchor as \n(\nselect distinct m.patient_data_source_id\n , m.start_date\n , m.claim_id\nfrom tuva.claims_preprocessing.encounters__stg_medical_claim m\ninner join tuva.claims_preprocessing.outpatient_surgery__anchor_events u on m.claim_id = u.claim_id\n)\n\nselect patient_data_source_id\n,start_date\n,claim_id\n,dense_rank() over (order by patient_data_source_id, start_date) as old_encounter_id\nfrom anchor", "relation_name": "tuva.claims_preprocessing.outpatient_surgery__generate_encounter_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.940458Z", "completed_at": "2025-02-25T21:26:25.944616Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.948574Z", "completed_at": "2025-02-25T21:26:25.948579Z"}], "thread_id": "Thread-1", "execution_time": 0.01188516616821289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.urgent_care__generate_encounter_id", "compiled": true, "compiled_code": "\n\nwith anchor as \n(\nselect distinct m.patient_data_source_id\n , m.start_date\n , m.claim_id\nfrom tuva.claims_preprocessing.encounters__stg_medical_claim m\ninner join tuva.claims_preprocessing.urgent_care__anchor_events u on m.claim_id = u.claim_id\n)\n\nselect patient_data_source_id\n,start_date\n,claim_id\n,dense_rank() over (order by patient_data_source_id, start_date) as old_encounter_id\nfrom anchor", "relation_name": "tuva.claims_preprocessing.urgent_care__generate_encounter_id"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.945074Z", "completed_at": "2025-02-25T21:26:25.950017Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.953359Z", "completed_at": "2025-02-25T21:26:25.953364Z"}], "thread_id": "Thread-2", "execution_time": 0.009663820266723633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.asc__start_end_dates", "compiled": true, "compiled_code": "\n\nselect\n    patient_data_source_id\n  , old_encounter_id\n  , min(start_date) as encounter_start_date\n  , max(end_date) as encounter_end_date\nfrom tuva.claims_preprocessing.asc__generate_encounter_id\ngroup by\n    patient_data_source_id\n  , old_encounter_id", "relation_name": "tuva.claims_preprocessing.asc__start_end_dates"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.950192Z", "completed_at": "2025-02-25T21:26:25.956677Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.957243Z", "completed_at": "2025-02-25T21:26:25.957248Z"}], "thread_id": "Thread-3", "execution_time": 0.008355855941772461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.acute_inpatient__prof_claims", "compiled": true, "compiled_code": "\n\nwith first_claim as (\n    select *\n    from tuva.claims_preprocessing.acute_inpatient__generate_encounter_id\n    where encounter_claim_number = 1\n)\n\n,join_first_claim_dates as (\n    select f.*\n    ,dat.encounter_end_date\n    ,dat.encounter_start_date\n    from first_claim f \n    inner join tuva.claims_preprocessing.acute_inpatient__start_end_dates dat on f.encounter_id = dat.encounter_id\n)\n\n-- ensuring each prof claim is only attributed to one institutional claim with claim_attribution_number\nselect dat.encounter_id\n,dat.encounter_start_date\n,dat.encounter_end_date\n,prof.claim_id\n,prof.claim_line_number\n,row_number () over (partition by prof.claim_line_id order by dat.encounter_id) as claim_attribution_number\nfrom tuva.claims_preprocessing.encounters__stg_medical_claim med\ninner join tuva.claims_preprocessing.encounters__stg_professional prof on med.claim_line_id = prof.claim_line_id\ninner join join_first_claim_dates dat on med.patient_data_source_id = dat.patient_data_source_id\nand med.start_date between dat.encounter_start_date and dat.encounter_end_date", "relation_name": "tuva.claims_preprocessing.acute_inpatient__prof_claims"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.953773Z", "completed_at": "2025-02-25T21:26:25.957807Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.960978Z", "completed_at": "2025-02-25T21:26:25.960983Z"}], "thread_id": "Thread-1", "execution_time": 0.011269092559814453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ambulance__match_claims_to_anchor", "compiled": true, "compiled_code": "\n\nselect distinct m.patient_data_source_id\n , m.start_date\n , m.claim_id\n , m.claim_line_number\n , u.old_encounter_id\nfrom tuva.claims_preprocessing.encounters__stg_medical_claim m\ninner join tuva.claims_preprocessing.ambulance__generate_encounter_id u on m.patient_data_source_id = u.patient_data_source_id\nand\nm.start_date = u.start_date\nwhere m.service_category_2 = 'ambulance'", "relation_name": "tuva.claims_preprocessing.ambulance__match_claims_to_anchor"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.958256Z", "completed_at": "2025-02-25T21:26:25.962326Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.965192Z", "completed_at": "2025-02-25T21:26:25.965197Z"}], "thread_id": "Thread-2", "execution_time": 0.008273839950561523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.dialysis__match_claims_to_anchor", "compiled": true, "compiled_code": "\n\nselect distinct m.patient_data_source_id\n , m.start_date\n , m.claim_id\n , m.claim_line_number\n , u.old_encounter_id\nfrom tuva.claims_preprocessing.encounters__stg_medical_claim m\ninner join tuva.claims_preprocessing.dialysis__generate_encounter_id u on m.patient_data_source_id = u.patient_data_source_id\nand\nm.start_date = u.start_date", "relation_name": "tuva.claims_preprocessing.dialysis__match_claims_to_anchor"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.962520Z", "completed_at": "2025-02-25T21:26:25.968784Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.969196Z", "completed_at": "2025-02-25T21:26:25.969200Z"}], "thread_id": "Thread-3", "execution_time": 0.007910966873168945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.emergency_department__start_end_dates", "compiled": true, "compiled_code": "\n\nselect encounter_id \n, min(start_date) as encounter_start_date\n, max(end_date) as encounter_end_date\nfrom tuva.claims_preprocessing.emergency_department__generate_encounter_id\ngroup by encounter_id", "relation_name": "tuva.claims_preprocessing.emergency_department__start_end_dates"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.965587Z", "completed_at": "2025-02-25T21:26:25.973172Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.973737Z", "completed_at": "2025-02-25T21:26:25.973742Z"}], "thread_id": "Thread-1", "execution_time": 0.011693954467773438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.dme__match_claims_to_anchor", "compiled": true, "compiled_code": "\n\nselect distinct m.patient_data_source_id\n , m.start_date\n , m.claim_id\n , m.claim_line_number\n , u.old_encounter_id\nfrom tuva.claims_preprocessing.encounters__stg_medical_claim m\ninner join tuva.claims_preprocessing.dme__generate_encounter_id u on m.patient_data_source_id = u.patient_data_source_id\nand\nm.start_date = u.start_date\nwhere m.service_category_2 = 'durable medical equipment'", "relation_name": "tuva.claims_preprocessing.dme__match_claims_to_anchor"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.969554Z", "completed_at": "2025-02-25T21:26:25.974608Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.975220Z", "completed_at": "2025-02-25T21:26:25.975223Z"}], "thread_id": "Thread-2", "execution_time": 0.006731986999511719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.home_health__match_claims_to_anchor", "compiled": true, "compiled_code": "\n\nselect distinct m.patient_data_source_id\n , m.start_date\n , m.claim_id\n , m.claim_line_number\n , u.old_encounter_id\nfrom tuva.claims_preprocessing.encounters__stg_medical_claim m\ninner join tuva.claims_preprocessing.home_health__generate_encounter_id u on m.patient_data_source_id = u.patient_data_source_id\nand\nm.start_date = u.start_date", "relation_name": "tuva.claims_preprocessing.home_health__match_claims_to_anchor"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.975588Z", "completed_at": "2025-02-25T21:26:25.985475Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.985922Z", "completed_at": "2025-02-25T21:26:25.985928Z"}], "thread_id": "Thread-3", "execution_time": 0.011855125427246094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.inpatient_hospice__prof_claims", "compiled": true, "compiled_code": "\n\nwith first_claim as (\n    select *\n    from tuva.claims_preprocessing.inpatient_hospice__generate_encounter_id\n    where encounter_claim_number = 1\n)\n\n, join_first_claim_dates as (\n    select f.*\n    ,dat.encounter_end_date\n    ,dat.encounter_start_date\n    from first_claim f \n    inner join tuva.claims_preprocessing.inpatient_hospice__start_end_dates dat on f.encounter_id = dat.encounter_id\n)\n\n-- ensuring each prof claim is only attributed to one institutional claim with claim_attribution_number\nselect dat.encounter_id\n,dat.encounter_start_date\n,dat.encounter_end_date\n,prof.claim_id\n,prof.claim_line_number\n,row_number () over (partition by prof.claim_line_id order by dat.encounter_id) as claim_attribution_number\nfrom tuva.claims_preprocessing.encounters__stg_medical_claim med\ninner join tuva.claims_preprocessing.encounters__stg_professional prof on med.claim_line_id = prof.claim_line_id\ninner join join_first_claim_dates dat on med.patient_data_source_id = dat.patient_data_source_id\nand med.start_date between dat.encounter_start_date and dat.encounter_end_date", "relation_name": "tuva.claims_preprocessing.inpatient_hospice__prof_claims"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.979077Z", "completed_at": "2025-02-25T21:26:25.985735Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.986338Z", "completed_at": "2025-02-25T21:26:25.986341Z"}], "thread_id": "Thread-1", "execution_time": 0.011394739151000977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.inpatient_psych__prof_claims", "compiled": true, "compiled_code": "\n\nwith first_claim as (\n    select *\n    from tuva.claims_preprocessing.inpatient_psych__generate_encounter_id\n    where encounter_claim_number = 1\n)\n\n,join_first_claim_dates as (\n    select f.*\n    ,dat.encounter_end_date\n    ,dat.encounter_start_date\n    from first_claim f \n    inner join tuva.claims_preprocessing.inpatient_psych__start_end_dates dat on f.encounter_id = dat.encounter_id\n)\n\n-- ensuring each prof claim is only attributed to one institutional claim with claim_attribution_number\nselect dat.encounter_id\n,dat.encounter_start_date\n,dat.encounter_end_date\n,prof.claim_id\n,prof.claim_line_number\n,row_number () over (partition by prof.claim_line_id order by dat.encounter_id) as claim_attribution_number\nfrom tuva.claims_preprocessing.encounters__stg_medical_claim med\ninner join tuva.claims_preprocessing.encounters__stg_professional prof on med.claim_line_id = prof.claim_line_id\ninner join join_first_claim_dates dat on med.patient_data_source_id = dat.patient_data_source_id\nand med.start_date between dat.encounter_start_date and dat.encounter_end_date", "relation_name": "tuva.claims_preprocessing.inpatient_psych__prof_claims"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.982543Z", "completed_at": "2025-02-25T21:26:25.986689Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.987368Z", "completed_at": "2025-02-25T21:26:25.987371Z"}], "thread_id": "Thread-2", "execution_time": 0.005408048629760742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.inpatient_rehab__prof_claims", "compiled": true, "compiled_code": "\n\nwith first_claim as (\n    select *\n    from tuva.claims_preprocessing.inpatient_rehab__generate_encounter_id\n    where encounter_claim_number = 1\n)\n\n,join_first_claim_dates as (\n    select f.*\n    ,dat.encounter_end_date\n    ,dat.encounter_start_date\n    from first_claim f \n    inner join tuva.claims_preprocessing.inpatient_rehab__start_end_dates dat on f.encounter_id = dat.encounter_id\n)\n\n-- ensuring each prof claim is only attributed to one institutional claim with claim_attribution_number\nselect dat.encounter_id\n,dat.encounter_start_date\n,dat.encounter_end_date\n,prof.claim_id\n,prof.claim_line_number\n,row_number () over (partition by prof.claim_line_id order by dat.encounter_id) as claim_attribution_number\nfrom tuva.claims_preprocessing.encounters__stg_medical_claim med\ninner join tuva.claims_preprocessing.encounters__stg_professional prof on med.claim_line_id = prof.claim_line_id\ninner join join_first_claim_dates dat on med.patient_data_source_id = dat.patient_data_source_id\nand med.start_date between dat.encounter_start_date and dat.encounter_end_date", "relation_name": "tuva.claims_preprocessing.inpatient_rehab__prof_claims"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.991973Z", "completed_at": "2025-02-25T21:26:25.998837Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.999249Z", "completed_at": "2025-02-25T21:26:25.999254Z"}], "thread_id": "Thread-1", "execution_time": 0.011390924453735352, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.inpatient_substance_use__prof_claims", "compiled": true, "compiled_code": "\n\nwith first_claim as (\n    select *\n    from tuva.claims_preprocessing.inpatient_substance_use__generate_encounter_id\n    where encounter_claim_number = 1\n)\n\n,join_first_claim_dates as (\n    select f.*\n    ,dat.encounter_end_date\n    ,dat.encounter_start_date\n    from first_claim f \n    inner join tuva.claims_preprocessing.inpatient_substance_use__start_end_dates dat on f.encounter_id = dat.encounter_id\n)\n\n-- ensuring each prof claim is only attributed to one institutional claim with claim_attribution_number\nselect dat.encounter_id\n,dat.encounter_start_date\n,dat.encounter_end_date\n,prof.claim_id\n,prof.claim_line_number\n-- ,med.start_date\n-- ,med.end_date\n-- ,med.place_of_service_code\n-- ,med.place_of_service_description\n,row_number () over (partition by prof.claim_line_id order by dat.encounter_id) as claim_attribution_number\nfrom tuva.claims_preprocessing.encounters__stg_medical_claim med\ninner join tuva.claims_preprocessing.encounters__stg_professional prof on med.claim_line_id = prof.claim_line_id\ninner join join_first_claim_dates dat on med.patient_data_source_id = dat.patient_data_source_id\nand med.start_date between dat.encounter_start_date and dat.encounter_end_date", "relation_name": "tuva.claims_preprocessing.inpatient_substance_use__prof_claims"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.988985Z", "completed_at": "2025-02-25T21:26:25.999036Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:25.999816Z", "completed_at": "2025-02-25T21:26:25.999820Z"}], "thread_id": "Thread-3", "execution_time": 0.012174844741821289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.inpatient_snf__prof_claims", "compiled": true, "compiled_code": "\n\nwith first_claim as (\n    select *\n    from tuva.claims_preprocessing.inpatient_snf__generate_encounter_id\n    where encounter_claim_number = 1\n)\n\n,join_first_claim_dates as (\n    select f.*\n    ,dat.encounter_end_date\n    ,dat.encounter_start_date\n    from first_claim f \n    inner join tuva.claims_preprocessing.inpatient_snf__start_end_dates dat on f.encounter_id = dat.encounter_id\n)\n\n-- ensuring each prof claim is only attributed to one institutional claim with claim_attribution_number\nselect dat.encounter_id\n,dat.encounter_start_date\n,dat.encounter_end_date\n,prof.claim_id\n,prof.claim_line_number\n,row_number () over (partition by prof.claim_line_id order by dat.encounter_id) as claim_attribution_number\nfrom tuva.claims_preprocessing.encounters__stg_medical_claim med\ninner join tuva.claims_preprocessing.encounters__stg_professional prof on med.claim_line_id = prof.claim_line_id\ninner join join_first_claim_dates dat on med.patient_data_source_id = dat.patient_data_source_id\nand med.start_date between dat.encounter_start_date and dat.encounter_end_date", "relation_name": "tuva.claims_preprocessing.inpatient_snf__prof_claims"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:25.996138Z", "completed_at": "2025-02-25T21:26:25.999635Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.000434Z", "completed_at": "2025-02-25T21:26:26.000437Z"}], "thread_id": "Thread-2", "execution_time": 0.011708974838256836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.lab__match_claims_to_anchor", "compiled": true, "compiled_code": "\n\nselect distinct m.patient_data_source_id\n , m.start_date\n , m.claim_id\n , m.claim_line_number\n , u.old_encounter_id\nfrom tuva.claims_preprocessing.encounters__stg_medical_claim m\ninner join tuva.claims_preprocessing.lab__generate_encounter_id u on m.patient_data_source_id = u.patient_data_source_id\nand\nm.start_date = u.start_date\nwhere m.service_category_2 = 'lab'", "relation_name": "tuva.claims_preprocessing.lab__match_claims_to_anchor"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.002313Z", "completed_at": "2025-02-25T21:26:26.012699Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.013139Z", "completed_at": "2025-02-25T21:26:26.013145Z"}], "thread_id": "Thread-1", "execution_time": 0.012211084365844727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.office_visits__int_office_visits_union", "compiled": true, "compiled_code": "\n\n\nselect claim_id\n,claim_line_number\n,old_encounter_id\n,'office visit radiology' as encounter_type\n,0 as priority_number\nfrom tuva.claims_preprocessing.office_visits__int_office_visits_radiology\n\n\nunion distinct\n\n\nselect claim_id\n,claim_line_number\n,old_encounter_id\n,'office visit surgery' as encounter_type\n,1 as priority_number\nfrom tuva.claims_preprocessing.office_visits__int_office_visits_surgery\n\n\nunion distinct\n\n\nselect claim_id\n,claim_line_number\n,old_encounter_id\n,'office visit injections' as encounter_type\n,2 as priority_number\nfrom tuva.claims_preprocessing.office_visits__int_office_visits_injections\n\n\nunion distinct\n\n\nselect claim_id\n,claim_line_number\n,old_encounter_id\n,'office visit pt/ot/st' as encounter_type\n,3 as priority_number\nfrom tuva.claims_preprocessing.office_visits__int_office_visits_ptotst\n\n\nunion distinct\n\n\nselect claim_id\n,claim_line_number\n,old_encounter_id\n,'office visit' as encounter_type\n,4 as priority_number\nfrom tuva.claims_preprocessing.office_visits__int_office_visits_em\n\n\nunion distinct\n\n\nselect claim_id\n,claim_line_number\n,old_encounter_id\n,'telehealth' as encounter_type\n,5 as priority_number\nfrom tuva.claims_preprocessing.office_visits__int_office_visits_telehealth\n\n\nunion distinct\n\n\nselect claim_id\n,claim_line_number\n,old_encounter_id\n,'office visit - other' as encounter_type\n,9999 as priority_number\nfrom tuva.claims_preprocessing.office_visits__int_office_visits", "relation_name": "tuva.claims_preprocessing.office_visits__int_office_visits_union"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.007281Z", "completed_at": "2025-02-25T21:26:26.012937Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.013575Z", "completed_at": "2025-02-25T21:26:26.013579Z"}], "thread_id": "Thread-3", "execution_time": 0.012134075164794922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.outpatient_hospice__match_claims_to_anchor", "compiled": true, "compiled_code": "\n\nselect distinct m.patient_data_source_id\n , m.start_date\n , m.claim_id\n , m.claim_line_number\n , u.old_encounter_id\nfrom tuva.claims_preprocessing.encounters__stg_medical_claim m\ninner join tuva.claims_preprocessing.outpatient_hospice__generate_encounter_id u on m.patient_data_source_id = u.patient_data_source_id\nand\nm.start_date = u.start_date", "relation_name": "tuva.claims_preprocessing.outpatient_hospice__match_claims_to_anchor"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.009982Z", "completed_at": "2025-02-25T21:26:26.013906Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.014643Z", "completed_at": "2025-02-25T21:26:26.014646Z"}], "thread_id": "Thread-2", "execution_time": 0.012786149978637695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.outpatient_hospital_or_clinic__match_claims_to_anchor", "compiled": true, "compiled_code": "\n\nselect distinct m.patient_data_source_id\n , m.start_date\n , m.claim_id\n , m.claim_line_number\n , u.old_encounter_id\nfrom tuva.claims_preprocessing.encounters__stg_medical_claim m\ninner join tuva.claims_preprocessing.outpatient_hospital_or_clinic__generate_encounter_id u on m.patient_data_source_id = u.patient_data_source_id\nand\nm.start_date = u.start_date", "relation_name": "tuva.claims_preprocessing.outpatient_hospital_or_clinic__match_claims_to_anchor"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.016333Z", "completed_at": "2025-02-25T21:26:26.025685Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.026118Z", "completed_at": "2025-02-25T21:26:26.026123Z"}], "thread_id": "Thread-1", "execution_time": 0.011204242706298828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.outpatient_injections__match_claims_to_anchor", "compiled": true, "compiled_code": "\n\nselect distinct m.patient_data_source_id\n , m.start_date\n , m.claim_id\n , m.claim_line_number\n , u.old_encounter_id\nfrom tuva.claims_preprocessing.encounters__stg_medical_claim m\ninner join tuva.claims_preprocessing.outpatient_injections__generate_encounter_id u on m.patient_data_source_id = u.patient_data_source_id\nand\nm.start_date = u.start_date", "relation_name": "tuva.claims_preprocessing.outpatient_injections__match_claims_to_anchor"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.019083Z", "completed_at": "2025-02-25T21:26:26.025906Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.026534Z", "completed_at": "2025-02-25T21:26:26.026538Z"}], "thread_id": "Thread-3", "execution_time": 0.011378049850463867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.outpatient_psych__match_claims_to_anchor", "compiled": true, "compiled_code": "\n\nselect distinct m.patient_data_source_id\n , m.start_date\n , m.claim_id\n , m.claim_line_number\n , u.old_encounter_id\nfrom tuva.claims_preprocessing.encounters__stg_medical_claim m\ninner join tuva.claims_preprocessing.outpatient_psych__generate_encounter_id u on m.patient_data_source_id = u.patient_data_source_id\nand\nm.start_date = u.start_date", "relation_name": "tuva.claims_preprocessing.outpatient_psych__match_claims_to_anchor"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.022994Z", "completed_at": "2025-02-25T21:26:26.026889Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.027635Z", "completed_at": "2025-02-25T21:26:26.027639Z"}], "thread_id": "Thread-2", "execution_time": 0.011591196060180664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.outpatient_ptotst__match_claims_to_anchor", "compiled": true, "compiled_code": "\n\nselect distinct m.patient_data_source_id\n , m.start_date\n , m.claim_id\n , m.claim_line_number\n , u.old_encounter_id\nfrom tuva.claims_preprocessing.encounters__stg_medical_claim m\ninner join tuva.claims_preprocessing.outpatient_ptotst__generate_encounter_id u on m.patient_data_source_id = u.patient_data_source_id\nand\nm.start_date = u.start_date", "relation_name": "tuva.claims_preprocessing.outpatient_ptotst__match_claims_to_anchor"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.029297Z", "completed_at": "2025-02-25T21:26:26.039446Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.040096Z", "completed_at": "2025-02-25T21:26:26.040102Z"}], "thread_id": "Thread-1", "execution_time": 0.012185096740722656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.outpatient_radiology__match_claims_to_anchor", "compiled": true, "compiled_code": "\n\nselect distinct m.patient_data_source_id\n , m.start_date\n , m.claim_id\n , m.claim_line_number\n , m.hcpcs_code\n , u.old_encounter_id\nfrom tuva.claims_preprocessing.encounters__stg_medical_claim m\ninner join tuva.claims_preprocessing.outpatient_radiology__generate_encounter_id u on m.patient_data_source_id = u.patient_data_source_id\nand\nm.start_date = u.start_date\nand\nm.hcpcs_code = u.hcpcs_code", "relation_name": "tuva.claims_preprocessing.outpatient_radiology__match_claims_to_anchor"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.032149Z", "completed_at": "2025-02-25T21:26:26.039670Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.040664Z", "completed_at": "2025-02-25T21:26:26.040668Z"}], "thread_id": "Thread-3", "execution_time": 0.012504816055297852, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.outpatient_rehab__match_claims_to_anchor", "compiled": true, "compiled_code": "\n\nselect distinct m.patient_data_source_id\n , m.start_date\n , m.claim_id\n , m.claim_line_number\n , u.old_encounter_id\nfrom tuva.claims_preprocessing.encounters__stg_medical_claim m\ninner join tuva.claims_preprocessing.outpatient_rehab__generate_encounter_id u on m.patient_data_source_id = u.patient_data_source_id\nand\nm.start_date = u.start_date", "relation_name": "tuva.claims_preprocessing.outpatient_rehab__match_claims_to_anchor"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.035753Z", "completed_at": "2025-02-25T21:26:26.040466Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.041445Z", "completed_at": "2025-02-25T21:26:26.041448Z"}], "thread_id": "Thread-2", "execution_time": 0.012424945831298828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.outpatient_substance_use__match_claims_to_anchor", "compiled": true, "compiled_code": "\n\nselect distinct m.patient_data_source_id\n , m.start_date\n , m.claim_id\n , m.claim_line_number\n , u.old_encounter_id\nfrom tuva.claims_preprocessing.encounters__stg_medical_claim m\ninner join tuva.claims_preprocessing.outpatient_substance_use__generate_encounter_id u on m.patient_data_source_id = u.patient_data_source_id\nand\nm.start_date = u.start_date", "relation_name": "tuva.claims_preprocessing.outpatient_substance_use__match_claims_to_anchor"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.043862Z", "completed_at": "2025-02-25T21:26:26.054031Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.054287Z", "completed_at": "2025-02-25T21:26:26.054294Z"}], "thread_id": "Thread-1", "execution_time": 0.011930227279663086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.outpatient_surgery__match_claims_to_anchor", "compiled": true, "compiled_code": "\n\nselect distinct m.patient_data_source_id\n , m.start_date\n , m.claim_id\n , m.claim_line_number\n , u.old_encounter_id\nfrom tuva.claims_preprocessing.encounters__stg_medical_claim m\ninner join tuva.claims_preprocessing.outpatient_surgery__generate_encounter_id u on m.patient_data_source_id = u.patient_data_source_id\nand\nm.start_date = u.start_date", "relation_name": "tuva.claims_preprocessing.outpatient_surgery__match_claims_to_anchor"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.048395Z", "completed_at": "2025-02-25T21:26:26.055008Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.055630Z", "completed_at": "2025-02-25T21:26:26.055633Z"}], "thread_id": "Thread-3", "execution_time": 0.012693166732788086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.urgent_care__match_claims_to_anchor", "compiled": true, "compiled_code": "\n\nselect distinct m.patient_data_source_id\n , m.start_date\n , m.claim_id\n , m.claim_line_number\n , u.old_encounter_id\nfrom tuva.claims_preprocessing.encounters__stg_medical_claim m\ninner join tuva.claims_preprocessing.urgent_care__generate_encounter_id u on m.patient_data_source_id = u.patient_data_source_id\nand\nm.start_date = u.start_date", "relation_name": "tuva.claims_preprocessing.urgent_care__match_claims_to_anchor"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.051192Z", "completed_at": "2025-02-25T21:26:26.055422Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.056186Z", "completed_at": "2025-02-25T21:26:26.056190Z"}], "thread_id": "Thread-2", "execution_time": 0.012804031372070312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.asc__match_claims_to_anchor", "compiled": true, "compiled_code": "\n\nselect\n    dat.old_encounter_id\n  , dat.encounter_start_date\n  , dat.encounter_end_date\n  , med.claim_id\n  , med.claim_line_number\n  , row_number() over (\n        partition by med.claim_id, med.claim_line_number\n        order by dat.old_encounter_id\n    ) as claim_attribution_number\nfrom tuva.claims_preprocessing.encounters__stg_medical_claim as med\ninner join tuva.claims_preprocessing.asc__start_end_dates as dat\n  on med.patient_data_source_id = dat.patient_data_source_id\n  and med.start_date between dat.encounter_start_date and dat.encounter_end_date", "relation_name": "tuva.claims_preprocessing.asc__match_claims_to_anchor"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.056806Z", "completed_at": "2025-02-25T21:26:26.063458Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.063676Z", "completed_at": "2025-02-25T21:26:26.063681Z"}], "thread_id": "Thread-1", "execution_time": 0.008536100387573242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.emergency_department__prof_claims", "compiled": true, "compiled_code": "\n\nwith first_claim as (\n    select *\n    from tuva.claims_preprocessing.emergency_department__generate_encounter_id\n    where encounter_claim_number = 1\n)\n\n,join_first_claim_dates as (\n    select f.*\n    ,dat.encounter_end_date\n    ,dat.encounter_start_date\n    from first_claim f \n    inner join tuva.claims_preprocessing.emergency_department__start_end_dates dat on f.encounter_id = dat.encounter_id\n)\n\n\n-- ensuring each claim is only attributed to one encounter with claim_attribution_number\n,inst_and_prof as (\nselect dat.encounter_id\n,dat.encounter_start_date\n,dat.encounter_end_date\n,prof.claim_id\n,prof.claim_line_number\nfrom tuva.claims_preprocessing.encounters__stg_medical_claim med\ninner join tuva.claims_preprocessing.encounters__stg_professional prof on med.claim_line_id = prof.claim_line_id\ninner join join_first_claim_dates dat on med.patient_data_source_id = dat.patient_data_source_id\nand med.start_date between dat.encounter_start_date and dat.encounter_end_date\n\nunion all \n\nselect dat.encounter_id\n,dat.encounter_start_date\n,dat.encounter_end_date\n,med.claim_id\n,med.claim_line_number\nfrom tuva.claims_preprocessing.encounters__stg_medical_claim med\ninner join tuva.claims_preprocessing.encounters__stg_outpatient_institutional inst on med.claim_id = inst.claim_id\ninner join join_first_claim_dates dat on med.patient_data_source_id = dat.patient_data_source_id\nand med.start_date between dat.encounter_start_date and dat.encounter_end_date \nwhere dat.claim_id <> med.claim_id\n)\n\nselect distinct encounter_id\n,encounter_start_date\n,encounter_end_date\n,claim_id\n,claim_line_number\n,row_number () over (partition by claim_id ,claim_line_number order by encounter_id) as claim_attribution_number\nfrom inst_and_prof", "relation_name": "tuva.claims_preprocessing.emergency_department__prof_claims"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.060886Z", "completed_at": "2025-02-25T21:26:26.064106Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.064309Z", "completed_at": "2025-02-25T21:26:26.064312Z"}], "thread_id": "Thread-3", "execution_time": 0.004008054733276367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.office_visits__int_office_visits_encounter_ranking", "compiled": true, "compiled_code": "\n\nwith rank_cte as (\nselect *\nfrom  tuva.claims_preprocessing.office_visits__int_office_visits_union\n)\n\n,dist_encounter as (\nselect distinct old_encounter_id\n,encounter_type\n,priority_number\nfrom rank_cte\n)\n\nselect \nold_encounter_id\n,encounter_type\n,priority_number\n,row_number() over (partition by old_encounter_id order by priority_number) as relative_rank\nfrom dist_encounter", "relation_name": "tuva.claims_preprocessing.office_visits__int_office_visits_encounter_ranking"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.065366Z", "completed_at": "2025-02-25T21:26:26.068201Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.068403Z", "completed_at": "2025-02-25T21:26:26.068408Z"}], "thread_id": "Thread-2", "execution_time": 0.0035109519958496094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.office_visits__int_office_visits_claim_line", "compiled": true, "compiled_code": "\n\nwith rank_cte as (\nselect *\nfrom tuva.claims_preprocessing.office_visits__int_office_visits_union\n)\n\n,crosswalk_cte as (\nselect old_encounter_id\n,encounter_type\nfrom tuva.claims_preprocessing.office_visits__int_office_visits_encounter_ranking\nwhere relative_rank = 1\n)\n\nselect r.claim_id\n, r.claim_line_number\n, r.old_encounter_id\n, x.encounter_type\nfrom rank_cte r\ninner join crosswalk_cte x on r.old_encounter_id = x.old_encounter_id", "relation_name": "tuva.claims_preprocessing.office_visits__int_office_visits_claim_line"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.069459Z", "completed_at": "2025-02-25T21:26:26.078699Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.078909Z", "completed_at": "2025-02-25T21:26:26.078914Z"}], "thread_id": "Thread-3", "execution_time": 0.009927988052368164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.encounters__combined_claim_line_crosswalk", "compiled": true, "compiled_code": "\n\nwith cte as \n(\nselect claim_id\n ,claim_line_number\n ,encounter_id\n ,'acute inpatient' as encounter_type\n ,'inpatient' as encounter_group\n ,0 as priority_number\nfrom tuva.claims_preprocessing.acute_inpatient__prof_claims\nwhere claim_attribution_number = 1\n\nunion all\n\nselect enc.claim_id\n,med.claim_line_number\n,enc.encounter_id\n,'acute inpatient' as encounter_type\n,'inpatient' as encounter_group\n,0 as priority_number\nfrom tuva.claims_preprocessing.acute_inpatient__generate_encounter_id enc\ninner join tuva.claims_preprocessing.encounters__stg_medical_claim med on enc.claim_id = med.claim_id\n\nunion all\n\nselect claim_id\n ,claim_line_number\n ,encounter_id\n ,'emergency department' as encounter_type\n ,'outpatient' as encounter_group\n ,1 as priority_number\nfrom tuva.claims_preprocessing.acute_inpatient__prof_claims\nwhere claim_attribution_number = 1\n\nunion all\n\nselect enc.claim_id\n,med.claim_line_number\n,enc.encounter_id\n,'emergency department' as encounter_type\n,'outpatient' as encounter_group\n,1 as priority_number\nfrom tuva.claims_preprocessing.emergency_department__generate_encounter_id enc\ninner join tuva.claims_preprocessing.encounters__stg_medical_claim med on enc.claim_id = med.claim_id\n\nunion all\n\nselect claim_id\n ,claim_line_number\n ,encounter_id\n ,'emergency department' as encounter_type\n ,'outpatient' as encounter_group\n ,1 as priority_number\nfrom tuva.claims_preprocessing.emergency_department__prof_claims\nwhere claim_attribution_number = 1\n\nunion all\n\nselect enc.claim_id\n,med.claim_line_number\n,enc.encounter_id\n,'inpatient hospice' as encounter_type\n,'inpatient' as encounter_group\n,1 as priority_number\nfrom tuva.claims_preprocessing.inpatient_hospice__generate_encounter_id enc\ninner join tuva.claims_preprocessing.encounters__stg_medical_claim med on enc.claim_id = med.claim_id\n\nunion all\n\nselect claim_id\n,claim_line_number\n,encounter_id\n,'inpatient psych' as encounter_type\n,'inpatient' as encounter_group\n,2 as priority_number\nfrom tuva.claims_preprocessing.inpatient_psych__prof_claims\nwhere claim_attribution_number = 1\n\nunion all\n\nselect enc.claim_id\n,med.claim_line_number\n,enc.encounter_id\n,'inpatient psych' as encounter_type\n,'inpatient' as encounter_group\n,2 as priority_number\nfrom tuva.claims_preprocessing.inpatient_psych__generate_encounter_id enc\ninner join tuva.claims_preprocessing.encounters__stg_medical_claim med on enc.claim_id = med.claim_id\n\nunion all\n\nselect claim_id\n,claim_line_number\n,encounter_id\n,'inpatient rehabilitation' as encounter_type\n,'inpatient' as encounter_group\n,3 as priority_number\nfrom tuva.claims_preprocessing.inpatient_rehab__prof_claims\nwhere claim_attribution_number = 1\n\nunion all \n\nselect enc.claim_id\n,med.claim_line_number\n,enc.encounter_id\n,'inpatient rehabilitation' as encounter_type\n,'inpatient' as encounter_group\n,3 as priority_number\nfrom tuva.claims_preprocessing.inpatient_rehab__generate_encounter_id enc\ninner join tuva.claims_preprocessing.encounters__stg_medical_claim med on enc.claim_id = med.claim_id\n\nunion all\n\nselect claim_id\n,claim_line_number\n,encounter_id\n,'inpatient skilled nursing' as encounter_type\n,'inpatient' as encounter_group\n,4 as priority_number\nfrom tuva.claims_preprocessing.inpatient_snf__prof_claims\nwhere claim_attribution_number = 1\n\nunion all \n\nselect enc.claim_id\n,med.claim_line_number\n,enc.encounter_id\n,'inpatient skilled nursing' as encounter_type\n,'inpatient' as encounter_group\n,4 as priority_number\nfrom tuva.claims_preprocessing.inpatient_snf__generate_encounter_id enc\ninner join tuva.claims_preprocessing.encounters__stg_medical_claim med on enc.claim_id = med.claim_id\n\nunion all\n\nselect claim_id\n,claim_line_number\n,encounter_id\n,'inpatient substance use' as encounter_type\n,'inpatient' as encounter_group\n,5 as priority_number\nfrom tuva.claims_preprocessing.inpatient_substance_use__prof_claims\nwhere claim_attribution_number = 1\n\nunion all \n\nselect enc.claim_id\n,med.claim_line_number\n,enc.encounter_id\n,'inpatient substance use' as encounter_type\n,'inpatient' as encounter_group\n,5 as priority_number\nfrom tuva.claims_preprocessing.inpatient_substance_use__generate_encounter_id enc\ninner join tuva.claims_preprocessing.encounters__stg_medical_claim med on enc.claim_id = med.claim_id\n\nunion all\n\nselect claim_id\n,claim_line_number\n,old_encounter_id\n,encounter_type\n,'office based' as encounter_group\n,9 as priority_number --priority set in combined office visit encounter ranking model\nfrom tuva.claims_preprocessing.office_visits__int_office_visits_claim_line\nwhere encounter_type = 'office visit radiology'\n\n\nunion all\n\nselect claim_id\n,claim_line_number\n,old_encounter_id\n,encounter_type\n,'office based' as encounter_group\n,10 as priority_number --priority set in combined office visit encounter ranking model\nfrom tuva.claims_preprocessing.office_visits__int_office_visits_claim_line\nwhere encounter_type <> 'office visit radiology'\n\n\nunion all\n\nselect claim_id\n,claim_line_number\n,old_encounter_id\n,'urgent care' as encounter_type\n,'outpatient' as encounter_group\n,11 as priority_number --urgent care needs to be lower than ed and inpatient\nfrom tuva.claims_preprocessing.urgent_care__match_claims_to_anchor\n\nunion all\n\nselect claim_id\n,claim_line_number\n,old_encounter_id\n,'outpatient psych' as encounter_type\n,'outpatient' as encounter_group\n,12 as priority_number \nfrom tuva.claims_preprocessing.outpatient_psych__match_claims_to_anchor\n\nunion all\n\nselect claim_id\n,claim_line_number\n,old_encounter_id\n,'outpatient rehabilitation' as encounter_type\n,'outpatient' as encounter_group\n,13 as priority_number \nfrom tuva.claims_preprocessing.outpatient_rehab__match_claims_to_anchor\n\nunion all\n\nselect claim_id\n,claim_line_number\n,old_encounter_id\n,'ambulatory surgery center' as encounter_type\n,'outpatient' as encounter_group\n,14 as priority_number \nfrom tuva.claims_preprocessing.asc__match_claims_to_anchor\n\nunion all\n\n\nselect claim_id\n,claim_line_number\n,old_encounter_id\n,'outpatient hospital or clinic' as encounter_type\n,'outpatient' as encounter_group\n,999 as priority_number \nfrom tuva.claims_preprocessing.outpatient_hospital_or_clinic__match_claims_to_anchor --lowest outpatient priority, roll up to more specific encounter type when available\n\nunion all\n\nselect claim_id\n,claim_line_number\n,old_encounter_id\n,'outpatient surgery' as encounter_type\n,'outpatient' as encounter_group\n,18 as priority_number \nfrom tuva.claims_preprocessing.outpatient_surgery__match_claims_to_anchor \n\n\nunion all\n\nselect claim_id\n,claim_line_number\n,old_encounter_id\n,'dialysis' as encounter_type\n,'outpatient' as encounter_group\n,15 as priority_number \nfrom tuva.claims_preprocessing.dialysis__match_claims_to_anchor \n\nunion all\n\nselect claim_id\n,claim_line_number\n,old_encounter_id\n,'outpatient hospice' as encounter_type\n,'outpatient' as encounter_group\n,16 as priority_number \nfrom tuva.claims_preprocessing.outpatient_hospice__match_claims_to_anchor \n\nunion all\n\nselect claim_id\n,claim_line_number\n,old_encounter_id\n,'home health' as encounter_type\n,'outpatient' as encounter_group\n,17 as priority_number \nfrom tuva.claims_preprocessing.home_health__match_claims_to_anchor \n\nunion all\n\nselect claim_id\n,claim_line_number\n,old_encounter_id\n,'outpatient injections' as encounter_type\n,'outpatient' as encounter_group\n,19 as priority_number \nfrom tuva.claims_preprocessing.outpatient_injections__match_claims_to_anchor\n\nunion all\n\nselect claim_id\n,claim_line_number\n,old_encounter_id\n,'outpatient pt/ot/st' as encounter_type\n,'outpatient' as encounter_group\n,20 as priority_number \nfrom tuva.claims_preprocessing.outpatient_ptotst__match_claims_to_anchor \n\nunion all\n\nselect claim_id\n,claim_line_number\n,old_encounter_id\n,'outpatient substance use' as encounter_type\n,'outpatient' as encounter_group\n,21 as priority_number \nfrom tuva.claims_preprocessing.outpatient_substance_use__match_claims_to_anchor \n\nunion all\n\nselect claim_id\n,claim_line_number\n,old_encounter_id\n,'outpatient radiology' as encounter_type\n,'outpatient' as encounter_group\n,22 as priority_number \nfrom tuva.claims_preprocessing.outpatient_radiology__match_claims_to_anchor \n\nunion all\n\nselect claim_id\n,claim_line_number\n,old_encounter_id\n,'lab - orphaned' as encounter_type\n,'other' as encounter_group\n,1000000 as priority_number \nfrom tuva.claims_preprocessing.lab__match_claims_to_anchor \n\nunion all\n\nselect claim_id\n,claim_line_number\n,old_encounter_id\n,'dme - orphaned' as encounter_type\n,'other' as encounter_group\n,1000001 as priority_number \nfrom tuva.claims_preprocessing.dme__match_claims_to_anchor \n\nunion all\n\nselect claim_id\n,claim_line_number\n,old_encounter_id\n,'ambulance - orphaned' as encounter_type\n,'other' as encounter_group\n,1000002 as priority_number \nfrom tuva.claims_preprocessing.ambulance__match_claims_to_anchor \n\n)\n\n\nselect \n  claim_id\n, claim_line_number\n, encounter_id as old_encounter_id\n, dense_rank() over (order by encounter_type, encounter_id) as encounter_id\n, encounter_type\n, encounter_group\n, priority_number\n, row_number() over (partition by claim_id , claim_line_number order by priority_number) as claim_line_attribution_number\nfrom cte", "relation_name": "tuva.claims_preprocessing.encounters__combined_claim_line_crosswalk"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.081321Z", "completed_at": "2025-02-25T21:26:26.097367Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.097588Z", "completed_at": "2025-02-25T21:26:26.097594Z"}], "thread_id": "Thread-2", "execution_time": 0.017608165740966797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.acute_inpatient__encounter_grain", "compiled": true, "compiled_code": "\n\nwith detail_values as (\n    select stg.*\n    ,cli.encounter_id\n    ,cli.old_encounter_id\n    ,ed.encounter_start_date\n    ,ed.encounter_end_date\n    ,cli.encounter_type\n    ,cli.encounter_group\n    from  tuva.claims_preprocessing.encounters__stg_medical_claim stg\n    inner join tuva.claims_preprocessing.encounters__combined_claim_line_crosswalk cli on stg.claim_id = cli.claim_id  --replace this ref with the deduped version when complete\n    and\n    stg.claim_line_number = cli.claim_line_number\n    and\n    cli.encounter_type = 'acute inpatient'\n    and\n    cli.claim_line_attribution_number = 1\n    inner join tuva.claims_preprocessing.acute_inpatient__start_end_dates ed on cli.old_encounter_id = ed.encounter_id\n)\n\n,encounter_cross_walk as (\n  select distinct encounter_id\n  ,old_encounter_id\n  from detail_values\n)\n\n,first_last_inst_inst_values as (\nselect *\n,row_number() over (partition by encounter_id order by start_date, claim_id) as first_num\n,row_number() over (partition by encounter_id order by end_date desc, claim_id) as last_num\nfrom detail_values\nwhere claim_type = 'institutional'\n)\n\n, institutional_claim_details as (\n    select distinct\n        d.encounter_id\n        , f.diagnosis_code_1\n        , f.diagnosis_code_type\n        , f.facility_id as facility_id\n        , f.drg_code_type\n        , f.drg_code\n        , f.admit_source_code as admit_source_code\n        , f.admit_type_code as admit_type_code\n        , l.discharge_disposition_code as discharge_disposition_code\n        , d.patient_data_source_id\n        , d.data_source\n    from detail_values d\n    inner join first_last_inst_inst_values f on d.encounter_id = f.encounter_id\n    and\n    f.first_num =1 \n    inner join first_last_inst_inst_values l on d.encounter_id = l.encounter_id\n    and\n    l.last_num = 1 \n)\n\n, service_category_flags as (\n    select distinct\n        d.encounter_id\n       ,max(case when d.service_category_3 in ( 'l/d - cesarean delivery', 'l/d - vaginal delivery') then 1 else 0 end ) as delivery_flag\n       ,max(case when d.service_category_3 ='l/d - cesarean delivery' then 1 else 0 end ) as cesarean_delivery\n       ,max(case when d.service_category_3 ='l/d - vaginal delivery' then 1 else 0 end ) as vaginal_delivery\n       ,max(case when d.service_category_3 in ('l/d - newborn','l/d - newborn nicu') then 1 else 0 end ) as newborn_flag\n       ,max(case when d.service_category_3 ='l/d - newborn nicu' then 1 else 0 end ) as nicu_flag\n       ,max(case when scr.service_category_2 = 'observation' then 1 else 0 end) as observation_flag\n       ,max(case when scr.service_category_2 = 'emergency department' then 1 else 0 end) as ed_flag\n       ,max(case when scr.service_category_2 = 'lab' then 1 else 0 end) as lab_flag\n       ,max(case when scr.service_category_2 = 'ambulance' then 1 else 0 end) as ambulance_flag\n       ,max(case when scr.service_category_2 = 'durable medical equipment' then 1 else 0 end) as dme_flag\n       ,max(case when scr.service_category_2 = 'pharmacy' then 1 \n              else 0 end) as pharmacy_flag\n    from detail_values d\n    left join tuva.claims_preprocessing.service_category_grouper scr on d.claim_id = scr.claim_id \n    and\n    scr.claim_line_number = d.claim_line_number\n    group by d.encounter_id\n)\n\n\n\n, patient as (\n    select \n        patient_data_source_id\n        , birth_date\n        , gender\n        , race\n    from tuva.claims_preprocessing.encounters__stg_eligibility\n    where patient_row_num = 1\n    )\n\n, total_amounts as (\n    select \n    encounter_id\n    , encounter_type\n    , encounter_group\n    , sum(paid_amount) as total_paid_amount\n    , sum(allowed_amount) as total_allowed_amount\n    , sum(charge_amount) as total_charge_amount\n    , count(distinct claim_id) as claim_count\n    , count(distinct(case when claim_type = 'institutional' then claim_id else null end))  as inst_claim_count\n    , count(distinct(case when claim_type = 'professional' then claim_id else null end))  as prof_claim_count\nfrom detail_values\ngroup by encounter_id\n,encounter_type -- not changing grain, but bringing into final\n,encounter_group\n)\n\n\n\nselect\n  x.encounter_id\n, a.encounter_start_date\n, a.encounter_end_date\n, c.patient_data_source_id\n, tot.encounter_type\n, tot.encounter_group\n, datediff(\n        day,\n        birth_date,\n        encounter_end_date\n        )/365 as admit_age\n, e.gender\n, e.race\n, c.diagnosis_code_type as primary_diagnosis_code_type\n, c.diagnosis_code_1 as primary_diagnosis_code\n, coalesce(icd10cm.long_description, icd9cm.long_description) as primary_diagnosis_description\n, c.facility_id as facility_id\n, sc.observation_flag\n, sc.ed_flag\n, sc.lab_flag\n, sc.dme_flag\n, sc.ambulance_flag\n, sc.pharmacy_flag\n, b.provider_organization_name as facility_name\n, b.primary_specialty_description as facility_type\n, sc.delivery_flag\n, case when sc.cesarean_delivery = 1 then 'cesarean'\n       when sc.vaginal_delivery = 1 then 'vaginal'\n       else null end as delivery_type\n, sc.newborn_flag\n, sc.nicu_flag\n, c.drg_code_type\n, c.drg_code\n, coalesce(msdrg.ms_drg_description, aprdrg.apr_drg_description) as drg_description\n, coalesce(msdrg.medical_surgical, aprdrg.medical_surgical) as medical_surgical\n, c.admit_source_code\n, h.admit_source_description\n, c.admit_type_code\n, i.admit_type_description\n, c.discharge_disposition_code\n, g.discharge_disposition_description\n, tot.total_paid_amount\n, tot.total_allowed_amount\n, tot.total_charge_amount\n, tot.claim_count\n, tot.inst_claim_count\n, tot.prof_claim_count\n, datediff(\n        day,\n        a.encounter_start_date,\n        a.encounter_end_date\n        ) as length_of_stay\n, case\n    when c.discharge_disposition_code = '20' then 1\n    else 0\n  end mortality_flag\n, c.data_source\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.acute_inpatient__start_end_dates a\ninner join encounter_cross_walk x on a.encounter_id = x.old_encounter_id\ninner join total_amounts tot on x.encounter_id = tot.encounter_id\ninner join service_category_flags sc on x.encounter_id = sc.encounter_id\nleft join institutional_claim_details c\n  on x.encounter_id = c.encounter_id\nleft join patient e\n  on c.patient_data_source_id = e.patient_data_source_id\nleft join tuva.terminology.provider b\n  on c.facility_id = b.npi\nleft join tuva.terminology.discharge_disposition g\n  on c.discharge_disposition_code = g.discharge_disposition_code\nleft join tuva.terminology.admit_source h\n  on c.admit_source_code = h.admit_source_code\nleft join tuva.terminology.admit_type i\n  on c.admit_type_code = i.admit_type_code\nleft join tuva.terminology.ms_drg msdrg\n  on c.drg_code_type = 'ms-drg'\n  and c.drg_code = msdrg.ms_drg_code\nleft join tuva.terminology.apr_drg aprdrg\n  on c.drg_code_type = 'apr-drg'\n  and c.drg_code = aprdrg.apr_drg_code\nleft join tuva.terminology.icd_10_cm icd10cm\n  on c.diagnosis_code_1 = icd10cm.icd_10_cm\n  and c.diagnosis_code_type = 'icd-10-cm'\nleft join tuva.terminology.icd_9_cm icd9cm\n  on c.diagnosis_code_1 = icd9cm.icd_9_cm\n  and c.diagnosis_code_type = 'icd-9-cm'", "relation_name": "tuva.claims_preprocessing.acute_inpatient__encounter_grain"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.087581Z", "completed_at": "2025-02-25T21:26:26.098599Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.111603Z", "completed_at": "2025-02-25T21:26:26.111611Z"}], "thread_id": "Thread-1", "execution_time": 0.03117680549621582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ambulance__encounter_grain", "compiled": true, "compiled_code": "\n\nwith encounter_date as (\n  select distinct old_encounter_id\n  ,start_date as encounter_start_date\n  from tuva.claims_preprocessing.ambulance__generate_encounter_id\n)\n\n,detail_values as (\n    select stg.*\n    ,cli.encounter_id\n    ,cli.old_encounter_id\n    ,cli.encounter_type\n    ,cli.encounter_group\n    ,d.encounter_start_date \n    , row_number() over (partition by cli.encounter_id order by stg.claim_type, stg.start_date) as encounter_row_number --institutional then professional\n    from  tuva.claims_preprocessing.encounters__stg_medical_claim stg\n    inner join tuva.claims_preprocessing.encounters__combined_claim_line_crosswalk cli on stg.claim_id = cli.claim_id  \n    and\n    stg.claim_line_number = cli.claim_line_number\n    and\n    cli.encounter_type = 'ambulance - orphaned'\n    and\n    cli.claim_line_attribution_number = 1\n    inner join encounter_date d on cli.old_encounter_id = d.old_encounter_id\n)\n\n, patient as (\n    select \n        patient_data_source_id\n        , birth_date\n        , gender\n        , race\n    from tuva.claims_preprocessing.encounters__stg_eligibility\n    where patient_row_num = 1\n    )\n\n, total_amounts as (\n    select \n    encounter_id\n    , encounter_type\n    , encounter_group\n    , sum(paid_amount) as total_paid_amount\n    , sum(allowed_amount) as total_allowed_amount\n    , sum(charge_amount) as total_charge_amount\n    , count(distinct claim_id) as claim_count\n    , count(distinct(case when claim_type = 'institutional' then claim_id else null end))  as inst_claim_count\n    , count(distinct(case when claim_type = 'professional' then claim_id else null end))  as prof_claim_count\nfrom detail_values\ngroup by encounter_id\n, encounter_type -- not changing grain, but bringing into final\n, encounter_group\n\n)\n\n\n,highest_paid_diagnosis as \n(\n  select encounter_id\n  , diagnosis_code_1\n  , diagnosis_code_type\n  , row_number() over (partition by encounter_id order by sum(paid_amount) desc ) as paid_order\n  , sum(paid_amount) as paid_amount\n  from detail_values\n  where diagnosis_code_1 is not null\n  group by diagnosis_code_1\n  , encounter_id\n  , diagnosis_code_type\n)\n\n,highest_paid_facility as \n(\n  select encounter_id\n  , facility_id\n  , row_number() over (partition by encounter_id order by sum(paid_amount) desc ) as paid_order\n  , sum(paid_amount) as paid_amount\n  from detail_values\n  where facility_id is not null\n  group by \n   encounter_id\n  , facility_id\n)\n\n,highest_paid_pos as \n(\n  select encounter_id\n  , place_of_service_code\n  , place_of_service_description\n  , row_number() over (partition by encounter_id order by sum(paid_amount) desc ) as paid_order\n  , sum(paid_amount) as paid_amount\n  from detail_values\n  where place_of_service_code is not null\n  group by \n   encounter_id\n  , place_of_service_code\n  , place_of_service_description\n)\n\n\n, service_category_flags as (\n    select distinct\n        d.encounter_id\n       ,max(case when scr.service_category_2 = 'lab' then 1 else 0 end) as lab_flag\n       ,max(case when scr.service_category_2 = 'ambulance' then 1 else 0 end) as ambulance_flag\n       ,max(case when scr.service_category_2 = 'durable medical equipment' then 1 else 0 end) as dme_flag\n       ,max(case when scr.service_category_2 = 'outpatient pharmacy' then 1 \n                when scr.service_category_2 = 'office-based pharmacy' then 1 else 0 end) as pharmacy_flag\n    from detail_values d\n    left join tuva.claims_preprocessing.service_category_grouper scr on d.claim_id = scr.claim_id \n    and\n    scr.claim_line_number = d.claim_line_number\n    group by d.encounter_id\n)\n\n\n\nselect   d.encounter_id\n, d.encounter_start_date\n, d.patient_data_source_id\n\n,tot.encounter_type\n,tot.encounter_group\n, datediff(\n        day,\n        birth_date,\n        d.encounter_start_date\n        )/365 as admit_age\n, e.gender\n, e.race\n, hp.diagnosis_code_type as primary_diagnosis_code_type\n, hp.diagnosis_code_1 as primary_diagnosis_code\n, coalesce(icd10cm.long_description, icd9cm.long_description) as primary_diagnosis_description\n, hf.facility_id as facility_id\n, b.provider_organization_name as facility_name\n, b.primary_specialty_description as facility_type\n, sc.lab_flag\n, sc.dme_flag\n, sc.ambulance_flag\n, sc.pharmacy_flag, pos.place_of_service_code\n, pos.place_of_service_description\n, tot.total_paid_amount\n, tot.total_allowed_amount\n, tot.total_charge_amount\n, tot.claim_count\n, tot.inst_claim_count\n, tot.prof_claim_count\n, d.data_source\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom detail_values d\ninner join total_amounts tot on d.encounter_id = tot.encounter_id\ninner join service_category_flags sc on d.encounter_id = sc.encounter_id\nleft join highest_paid_diagnosis hp on d.encounter_id = hp.encounter_id\nand\nhp.paid_order = 1\nleft join highest_paid_facility hf on d.encounter_id = hf.encounter_id\nand\nhf.paid_order = 1\nleft join highest_paid_pos pos on d.encounter_id = pos.encounter_id\nand\npos.paid_order = 1\nleft join patient e\n  on d.patient_data_source_id = e.patient_data_source_id\nleft join tuva.terminology.provider b\n  on hf.facility_id = b.npi\nleft join tuva.terminology.icd_10_cm icd10cm\n  on hp.diagnosis_code_1 = icd10cm.icd_10_cm\n  and hp.diagnosis_code_type = 'icd-10-cm'\nleft join tuva.terminology.icd_9_cm icd9cm\n  on hp.diagnosis_code_1 = icd9cm.icd_9_cm\n  and hp.diagnosis_code_type = 'icd-9-cm'\nwhere d.encounter_row_number = 1", "relation_name": "tuva.claims_preprocessing.ambulance__encounter_grain"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.092251Z", "completed_at": "2025-02-25T21:26:26.098841Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.112293Z", "completed_at": "2025-02-25T21:26:26.112297Z"}], "thread_id": "Thread-3", "execution_time": 0.031430959701538086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.asc__encounter_grain", "compiled": true, "compiled_code": "\n\n\n\nwith detail_values as (\n    select stg.*\n    ,cli.encounter_id\n    ,cli.old_encounter_id\n      ,cli.encounter_type\n    ,cli.encounter_group\n    ,ed.encounter_start_date \n    ,ed.encounter_end_date \n    , row_number() over (partition by cli.encounter_id order by stg.claim_type, stg.start_date) as encounter_row_number --institutional then professional\n    from  tuva.claims_preprocessing.encounters__stg_medical_claim stg\n    inner join tuva.claims_preprocessing.encounters__combined_claim_line_crosswalk cli on stg.claim_id = cli.claim_id  \n    and\n    stg.claim_line_number = cli.claim_line_number\n    and\n    cli.encounter_type = 'ambulatory surgery center'\n    and\n    cli.claim_line_attribution_number = 1\n    inner join tuva.claims_preprocessing.asc__start_end_dates ed on cli.old_encounter_id = ed.old_encounter_id\n)\n\n, patient as (\n    select \n        patient_data_source_id\n        , birth_date\n        , gender\n        , race\n    from tuva.claims_preprocessing.encounters__stg_eligibility\n    where patient_row_num = 1\n    )\n\n, total_amounts as (\n    select \n    encounter_id\n    , encounter_type\n    , encounter_group\n    , sum(paid_amount) as total_paid_amount\n    , sum(allowed_amount) as total_allowed_amount\n    , sum(charge_amount) as total_charge_amount\n    , count(distinct claim_id) as claim_count\n    , count(distinct(case when claim_type = 'institutional' then claim_id else null end))  as inst_claim_count\n    , count(distinct(case when claim_type = 'professional' then claim_id else null end))  as prof_claim_count\nfrom detail_values\ngroup by encounter_id\n,encounter_type \n,encounter_group\n)\n\n\n,highest_paid_diagnosis as \n(\n  select encounter_id\n  , diagnosis_code_1\n  , diagnosis_code_type\n  , row_number() over (partition by encounter_id order by sum(paid_amount) desc ) as paid_order\n  , sum(paid_amount) as paid_amount\n  from detail_values\n  where diagnosis_code_1 is not null\n  group by diagnosis_code_1\n  , encounter_id\n  , diagnosis_code_type\n)\n\n,highest_paid_facility as \n(\n  select encounter_id\n  , facility_id\n  , row_number() over (partition by encounter_id order by sum(paid_amount) desc ) as paid_order\n  , sum(paid_amount) as paid_amount\n  from detail_values\n  where facility_id is not null\n  group by \n   encounter_id\n  , facility_id\n)\n\n,highest_paid_hcpc as \n(\n  select encounter_id\n  , hcpcs_code\n  , row_number() over (partition by encounter_id order by sum(paid_amount) desc ) as paid_order\n  , sum(paid_amount) as paid_amount\n  from detail_values\n  where hcpcs_code is not null\n  group by \n   encounter_id\n  , hcpcs_code\n)\n\n, service_category_flags as (\n    select distinct\n        d.encounter_id\n       ,max(case when scr.service_category_2 = 'lab' then 1 else 0 end) as lab_flag\n       ,max(case when scr.service_category_2 = 'ambulance' then 1 else 0 end) as ambulance_flag\n       ,max(case when scr.service_category_2 = 'durable medical equipment' then 1 else 0 end) as dme_flag\n       ,max(case when scr.service_category_2 = 'outpatient pharmacy' then 1 \n                when scr.service_category_2 = 'office-based pharmacy' then 1 else 0 end) as pharmacy_flag\n    from detail_values d\n    left join tuva.claims_preprocessing.service_category_grouper scr on d.claim_id = scr.claim_id \n    and\n    scr.claim_line_number = d.claim_line_number\n    group by d.encounter_id\n)\n\n\nselect   d.encounter_id\n, d.encounter_start_date\n, d.encounter_end_date\n, d.patient_data_source_id\n,tot.encounter_type\n,tot.encounter_group\n, datediff(\n        day,\n        birth_date,\n        d.encounter_start_date\n        )/365 as admit_age\n, datediff(\n        day,\n        d.encounter_start_date,\n        d.encounter_end_date\n        ) as length_of_stay\n, e.gender\n, e.race\n, hp.diagnosis_code_type as primary_diagnosis_code_type\n, hp.diagnosis_code_1 as primary_diagnosis_code\n, coalesce(icd10cm.long_description, icd9cm.long_description) as primary_diagnosis_description\n, hf.facility_id as facility_id\n, b.provider_organization_name as facility_name\n, b.primary_specialty_description as facility_type\n, sc.lab_flag\n, sc.dme_flag\n, sc.ambulance_flag\n, sc.pharmacy_flag\n, hcpc.hcpcs_code\n, tot.total_paid_amount\n, tot.total_allowed_amount\n, tot.total_charge_amount\n, tot.claim_count\n, tot.inst_claim_count\n, tot.prof_claim_count\n, d.data_source\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom detail_values d\ninner join total_amounts tot on d.encounter_id = tot.encounter_id\ninner join service_category_flags sc on d.encounter_id = sc.encounter_id\nleft join highest_paid_diagnosis hp on d.encounter_id = hp.encounter_id\nand\nhp.paid_order = 1\nleft join highest_paid_facility hf on d.encounter_id = hf.encounter_id\nand\nhf.paid_order = 1\nleft join highest_paid_hcpc hcpc on d.encounter_id = hcpc.encounter_id\nand\nhcpc.paid_order = 1\nleft join patient e\n  on d.patient_data_source_id = e.patient_data_source_id\nleft join tuva.terminology.provider b\n  on hf.facility_id = b.npi\nleft join tuva.terminology.icd_10_cm icd10cm\n  on hp.diagnosis_code_1 = icd10cm.icd_10_cm\n  and hp.diagnosis_code_type = 'icd-10-cm'\nleft join tuva.terminology.icd_9_cm icd9cm\n  on hp.diagnosis_code_1 = icd9cm.icd_9_cm\n  and hp.diagnosis_code_type = 'icd-9-cm'\nwhere d.encounter_row_number = 1", "relation_name": "tuva.claims_preprocessing.asc__encounter_grain"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.099037Z", "completed_at": "2025-02-25T21:26:26.113751Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.114327Z", "completed_at": "2025-02-25T21:26:26.114331Z"}], "thread_id": "Thread-2", "execution_time": 0.01618480682373047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.core__stg_claims_condition", "compiled": true, "compiled_code": "\n\n-- *************************************************\n-- This dbt model creates the condition table in core.\n-- *************************************************\n\nwith unpivot_cte as (\n\nselect\n    claim_id\n  , claim_line_number\n  , person_id\n  , member_id\n  , coalesce(admission_date\n           , claim_start_date\n           , discharge_date\n           , claim_end_date\n    ) as recorded_date\n  , 'discharge_diagnosis' as condition_type\n  , diagnosis_code_type as source_code_type\n  , diagnosis_code_1 as source_code\n  , 1 as diagnosis_rank\n  , diagnosis_poa_1 as present_on_admit_code\n  , data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim \nwhere diagnosis_code_1 is not null\n\nunion all \n\nselect\n    claim_id\n  , claim_line_number\n  , person_id\n  , member_id\n  , coalesce(admission_date\n           , claim_start_date\n\t       , discharge_date\n\t       , claim_end_date\n    ) as recorded_date\n  , 'discharge_diagnosis' as condition_type\n  , diagnosis_code_type as source_code_type\n  , diagnosis_code_2 as source_code\n  , 2 as diagnosis_rank\n  , diagnosis_poa_2 as present_on_admit_code\n  , data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim\nwhere diagnosis_code_2 is not null\n\nunion all \n\nselect\n    claim_id\n  , claim_line_number\n  , person_id\n  , member_id\n  , coalesce(admission_date\n           , claim_start_date\n           , discharge_date\n           , claim_end_date\n    ) as recorded_date\n  , 'discharge_diagnosis' as condition_type\n  , diagnosis_code_type as source_code_type\n  , diagnosis_code_3 as source_code\n  , 3 as diagnosis_rank\n  , diagnosis_poa_3 as present_on_admit_code\n  , data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim\nwhere diagnosis_code_3 is not null\n\nunion all \n\nselect\n    claim_id\n  , claim_line_number\n  , person_id\n  , member_id\n  , coalesce(admission_date\n           , claim_start_date\n           , discharge_date\n           , claim_end_date\n    ) as recorded_date\n  , 'discharge_diagnosis' as condition_type\n  , diagnosis_code_type as source_code_type\n  , diagnosis_code_4 as source_code\n  , 4 as diagnosis_rank\n  , diagnosis_poa_4 as present_on_admit_code\n  , data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim\nwhere diagnosis_code_4 is not null\n\nunion all \n\nselect\n    claim_id\n  , claim_line_number\n  , person_id\n  , member_id\n  , coalesce(admission_date\n           , claim_start_date\n           , discharge_date\n           , claim_end_date\n    ) as recorded_date\n  , 'discharge_diagnosis' as condition_type\n  , diagnosis_code_type as source_code_type\n  , diagnosis_code_5 as source_code\n  , 5 as diagnosis_rank\n  , diagnosis_poa_5 as present_on_admit_code\n  , data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim\nwhere diagnosis_code_5 is not null\n\nunion all \n\nselect\n    claim_id\n  , claim_line_number\n  , person_id\n  , member_id\n  , coalesce(admission_date\n           , claim_start_date\n           , discharge_date\n           , claim_end_date\n    ) as recorded_date\n  , 'discharge_diagnosis' as condition_type\n  , diagnosis_code_type as source_code_type\n  , diagnosis_code_6 as source_code\n  , 6 as diagnosis_rank\n  , diagnosis_poa_6 as present_on_admit_code\n  , data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim\nwhere diagnosis_code_6 is not null\n\nunion all \n\nselect\n    claim_id\n  , claim_line_number\n  , person_id\n  , member_id\n  , coalesce(admission_date\n           , claim_start_date\n           , discharge_date\n           , claim_end_date\n    ) as recorded_date\n  , 'discharge_diagnosis' as condition_type\n  , diagnosis_code_type as source_code_type\n  , diagnosis_code_7 as source_code\n  , 7 as diagnosis_rank\n  , diagnosis_poa_7 as present_on_admit_code\n  , data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim\nwhere diagnosis_code_7 is not null\n\nunion all \n\nselect\n    claim_id\n  , claim_line_number\n  , person_id\n  , member_id\n  , coalesce(admission_date\n           , claim_start_date\n           , discharge_date\n           , claim_end_date\n    ) as recorded_date\n  , 'discharge_diagnosis' as condition_type\n  , diagnosis_code_type as source_code_type\n  , diagnosis_code_8 as source_code\n  , 8 as diagnosis_rank\n  , diagnosis_poa_8 as present_on_admit_code\n  , data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim\nwhere diagnosis_code_8 is not null\n\nunion all \n\nselect\n    claim_id\n  , claim_line_number\n  , person_id\n  , member_id\n  , coalesce(admission_date\n           , claim_start_date\n           , discharge_date\n           , claim_end_date\n    ) as recorded_date\n  , 'discharge_diagnosis' as condition_type\n  , diagnosis_code_type as source_code_type\n  , diagnosis_code_9 as source_code\n  , 9 as diagnosis_rank\n  , diagnosis_poa_9 as present_on_admit_code\n  , data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim\nwhere diagnosis_code_9 is not null\n\nunion all \n\nselect\n    claim_id\n  , claim_line_number\n  , person_id\n  , member_id\n  , coalesce(admission_date\n           , claim_start_date\n           , discharge_date\n           , claim_end_date\n    ) as recorded_date\n  , 'discharge_diagnosis' as condition_type\n  , diagnosis_code_type as source_code_type\n  , diagnosis_code_10 as source_code\n  , 10 as diagnosis_rank\n  , diagnosis_poa_10 as present_on_admit_code\n  , data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim\nwhere diagnosis_code_10 is not null\n\nunion all \n\nselect\n    claim_id\n  , claim_line_number\n  , person_id\n  , member_id\n  , coalesce(admission_date\n           , claim_start_date\n           , discharge_date\n           , claim_end_date\n    ) as recorded_date\n  , 'discharge_diagnosis' as condition_type\n  , diagnosis_code_type as source_code_type\n  , diagnosis_code_11 as source_code\n  , 11 as diagnosis_rank\n  , diagnosis_poa_11 as present_on_admit_code\n  , data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim\nwhere diagnosis_code_11 is not null\n\nunion all \n\nselect\n    claim_id\n  , claim_line_number\n  , person_id\n  , member_id\n  , coalesce(admission_date\n           , claim_start_date\n           , discharge_date\n           , claim_end_date\n    ) as recorded_date\n  , 'discharge_diagnosis' as condition_type\n  , diagnosis_code_type as source_code_type\n  , diagnosis_code_12 as source_code\n  , 12 as diagnosis_rank\n  , diagnosis_poa_12 as present_on_admit_code\n  , data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim\nwhere diagnosis_code_12 is not null\n\nunion all \n\nselect\n    claim_id\n  , claim_line_number\n  , person_id\n  , member_id\n  , coalesce(admission_date\n           , claim_start_date\n           , discharge_date\n           , claim_end_date\n    ) as recorded_date\n  , 'discharge_diagnosis' as condition_type\n  , diagnosis_code_type as source_code_type\n  , diagnosis_code_13 as source_code\n  , 13 as diagnosis_rank\n  , diagnosis_poa_13 as present_on_admit_code\n  , data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim\nwhere diagnosis_code_13 is not null\n\nunion all \n\nselect\n    claim_id\n  , claim_line_number\n  , person_id\n  , member_id\n  , coalesce(admission_date\n           , claim_start_date\n           , discharge_date\n           , claim_end_date\n    ) as recorded_date\n  , 'discharge_diagnosis' as condition_type\n  , diagnosis_code_type as source_code_type\n  , diagnosis_code_14 as source_code\n  , 14 as diagnosis_rank\n  , diagnosis_poa_14 as present_on_admit_code\n  , data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim\nwhere diagnosis_code_14 is not null\n\nunion all \n\nselect\n    claim_id\n  , claim_line_number\n  , person_id\n  , member_id\n  , coalesce(admission_date\n           , claim_start_date\n           , discharge_date\n           , claim_end_date\n    ) as recorded_date\n  , 'discharge_diagnosis' as condition_type\n  , diagnosis_code_type as source_code_type\n  , diagnosis_code_15 as source_code\n  , 15 as diagnosis_rank\n  , diagnosis_poa_15 as present_on_admit_code\n  , data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim\nwhere diagnosis_code_15 is not null\n\nunion all \n\nselect\n    claim_id\n  , claim_line_number\n  , person_id\n  , member_id\n  , coalesce(admission_date\n           , claim_start_date\n           , discharge_date\n           , claim_end_date\n    ) as recorded_date\n  , 'discharge_diagnosis' as condition_type\n  , diagnosis_code_type as source_code_type\n  , diagnosis_code_16 as source_code\n  , 16 as diagnosis_rank\n  , diagnosis_poa_16 as present_on_admit_code\n  , data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim\nwhere diagnosis_code_16 is not null\n\nunion all \n\nselect\n    claim_id\n  , claim_line_number\n  , person_id\n  , member_id\n  , coalesce(admission_date\n           , claim_start_date\n           , discharge_date\n           , claim_end_date\n    ) as recorded_date\n  , 'discharge_diagnosis' as condition_type\n  , diagnosis_code_type as source_code_type\n  , diagnosis_code_17 as source_code\n  , 17 as diagnosis_rank\n  , diagnosis_poa_17 as present_on_admit_code\n  , data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim\nwhere diagnosis_code_17 is not null\n\nunion all \n\nselect\n    claim_id\n  , claim_line_number\n  , person_id\n  , member_id\n  , coalesce(admission_date\n           , claim_start_date\n           , discharge_date\n           , claim_end_date\n    ) as recorded_date\n  , 'discharge_diagnosis' as condition_type\n  , diagnosis_code_type as source_code_type\n  , diagnosis_code_18 as source_code\n  , 18 as diagnosis_rank\n  , diagnosis_poa_18 as present_on_admit_code\n  , data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim\nwhere diagnosis_code_18 is not null\n\nunion all \n\nselect\n    claim_id\n  , claim_line_number\n  , person_id\n  , member_id\n  , coalesce(admission_date\n           , claim_start_date\n           , discharge_date\n           , claim_end_date\n    ) as recorded_date\n  , 'discharge_diagnosis' as condition_type\n  , diagnosis_code_type as source_code_type\n  , diagnosis_code_19 as source_code\n  , 19 as diagnosis_rank\n  , diagnosis_poa_19 as present_on_admit_code\n  , data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim\nwhere diagnosis_code_19 is not null\n\nunion all \n\nselect\n    claim_id\n  , claim_line_number\n  , person_id\n  , member_id\n  , coalesce(admission_date\n           , claim_start_date\n           , discharge_date\n           , claim_end_date\n    ) as recorded_date\n  , 'discharge_diagnosis' as condition_type\n  , diagnosis_code_type as source_code_type\n  , diagnosis_code_20 as source_code\n  , 20 as diagnosis_rank\n  , diagnosis_poa_20 as present_on_admit_code\n  , data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim\nwhere diagnosis_code_20 is not null\n\nunion all \n\nselect\n    claim_id\n  , claim_line_number\n  , person_id\n  , member_id\n  , coalesce(admission_date\n           , claim_start_date\n           , discharge_date\n           , claim_end_date\n    ) as recorded_date\n  , 'discharge_diagnosis' as condition_type\n  , diagnosis_code_type as source_code_type\n  , diagnosis_code_21 as source_code\n  , 21 as diagnosis_rank\n  , diagnosis_poa_21 as present_on_admit_code\n  , data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim\nwhere diagnosis_code_21 is not null\n\nunion all \n\nselect\n    claim_id\n  , claim_line_number\n  , person_id\n  , member_id\n  , coalesce(admission_date\n           , claim_start_date\n           , discharge_date\n           , claim_end_date\n    ) as recorded_date\n  , 'discharge_diagnosis' as condition_type\n  , diagnosis_code_type as source_code_type\n  , diagnosis_code_22 as source_code\n  , 22 as diagnosis_rank\n  , diagnosis_poa_22 as present_on_admit_code\n  , data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim\nwhere diagnosis_code_22 is not null\n\nunion all \n\nselect\n    claim_id\n  , claim_line_number\n  , person_id\n  , member_id\n  , coalesce(admission_date\n           , claim_start_date\n           , discharge_date\n           , claim_end_date\n    ) as recorded_date\n  , 'discharge_diagnosis' as condition_type\n  , diagnosis_code_type as source_code_type\n  , diagnosis_code_23 as source_code\n  , 23 as diagnosis_rank\n  , diagnosis_poa_23 as present_on_admit_code\n  , data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim\nwhere diagnosis_code_23 is not null\n\nunion all \n\nselect\n    claim_id\n  , claim_line_number\n  , person_id\n  , member_id\n  , coalesce(admission_date\n           , claim_start_date\n           , discharge_date\n           , claim_end_date\n    ) as recorded_date\n  , 'discharge_diagnosis' as condition_type\n  , diagnosis_code_type as source_code_type\n  , diagnosis_code_24 as source_code\n  , 24 as diagnosis_rank\n  , diagnosis_poa_24 as present_on_admit_code\n  , data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim\nwhere diagnosis_code_24 is not null\n\nunion all \n\nselect\n    claim_id\n  , claim_line_number\n  , person_id\n  , member_id\n  , coalesce(admission_date\n           , claim_start_date\n           , discharge_date\n           , claim_end_date\n    ) as recorded_date\n  , 'discharge_diagnosis' as condition_type\n  , diagnosis_code_type as source_code_type\n  , diagnosis_code_25 as source_code\n  , 25 as diagnosis_rank\n  , diagnosis_poa_25 as present_on_admit_code\n  , data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim\nwhere diagnosis_code_25 is not null\n\n)\n\nselect distinct\n\n    \n        try_cast(CAST(unpivot_cte.data_source AS TEXT) || '_' || CAST(unpivot_cte.claim_id AS TEXT) || '_' || CAST(unpivot_cte.diagnosis_rank AS TEXT) || '_' || CAST(unpivot_cte.source_code AS TEXT) as TEXT)\n     as condition_id\n    , cast(unpivot_cte.person_id as TEXT ) as person_id\n    , cast(unpivot_cte.member_id as TEXT ) as member_id\n    , cast(null as TEXT ) as patient_id\n    , cast(null as TEXT ) as encounter_id --one claim can be on multiple encounters, so nulling out for now\n    , cast(unpivot_cte.claim_id as TEXT ) as claim_id\n    , try_cast( unpivot_cte.recorded_date as date ) as recorded_date\n    , try_cast( null as date ) as onset_date\n    , try_cast( null as date ) as resolved_date\n    , cast('active' as TEXT ) as status\n    , cast(unpivot_cte.condition_type as TEXT ) as condition_type\n    , cast(unpivot_cte.source_code_type as TEXT ) as source_code_type\n    , cast(unpivot_cte.source_code as TEXT ) as source_code\n    , cast(null as TEXT ) as source_description\n    , cast(\n        case\n        when icd.icd_10_cm is not null then 'icd-10-cm'\n        end as TEXT\n      ) as normalized_code_type\n    , cast(icd.icd_10_cm as TEXT ) as normalized_code\n    , cast(icd.long_description as TEXT ) as normalized_description\n    , cast(unpivot_cte.diagnosis_rank as integer ) as condition_rank\n    , cast(unpivot_cte.present_on_admit_code as TEXT ) as present_on_admit_code\n    , cast(poa.present_on_admit_description as TEXT ) as present_on_admit_description\n    , cast(unpivot_cte.data_source as TEXT ) as data_source\n    , cast('2025-02-25 21:25:59.177756+00:00' as timestamp ) as tuva_last_run\nfrom unpivot_cte\n--inner join tuva.claims_preprocessing.encounters__combined_claim_line_crosswalk x on unpivot_cte.claim_id = x.claim_id\n--and\n--unpivot_cte.claim_line_number = x.claim_line_number\n--and\n--x.claim_line_attribution_number = 1\nleft join tuva.terminology.icd_10_cm icd\n    on unpivot_cte.source_code = icd.icd_10_cm\nleft join tuva.terminology.present_on_admission as poa\n    on unpivot_cte.present_on_admit_code = poa.present_on_admit_code", "relation_name": "tuva.core._stg_claims_condition"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.128716Z", "completed_at": "2025-02-25T21:26:26.141602Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.142012Z", "completed_at": "2025-02-25T21:26:26.142018Z"}], "thread_id": "Thread-3", "execution_time": 0.028534889221191406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.dialysis__encounter_grain", "compiled": true, "compiled_code": "\n\nwith encounter_date as (\n  select distinct old_encounter_id\n  ,start_date as encounter_start_date\n  from tuva.claims_preprocessing.dialysis__generate_encounter_id\n)\n\n,detail_values as (\n    select stg.*\n    ,cli.encounter_id\n    ,cli.old_encounter_id\n      ,cli.encounter_type\n    ,cli.encounter_group\n    ,d.encounter_start_date \n    , row_number() over (partition by cli.encounter_id order by stg.claim_type, stg.start_date) as encounter_row_number --institutional then professional\n    from  tuva.claims_preprocessing.encounters__stg_medical_claim stg\n    inner join tuva.claims_preprocessing.encounters__combined_claim_line_crosswalk cli on stg.claim_id = cli.claim_id  \n    and\n    stg.claim_line_number = cli.claim_line_number\n    and\n    cli.encounter_type = 'dialysis'\n    and\n    cli.claim_line_attribution_number = 1\n    inner join encounter_date d on cli.old_encounter_id = d.old_encounter_id\n)\n\n, patient as (\n    select \n        patient_data_source_id\n        , birth_date\n        , gender\n        , race\n    from tuva.claims_preprocessing.encounters__stg_eligibility\n    where patient_row_num = 1\n    )\n\n, total_amounts as (\n    select \n    encounter_id\n    , encounter_type\n    , encounter_group\n    , sum(paid_amount) as total_paid_amount\n    , sum(allowed_amount) as total_allowed_amount\n    , sum(charge_amount) as total_charge_amount\n    , count(distinct claim_id) as claim_count\n    , count(distinct(case when claim_type = 'institutional' then claim_id else null end))  as inst_claim_count\n    , count(distinct(case when claim_type = 'professional' then claim_id else null end))  as prof_claim_count\nfrom detail_values\ngroup by encounter_id\n,encounter_type \n,encounter_group\n)\n\n\n,highest_paid_diagnosis as \n(\n  select encounter_id\n  , diagnosis_code_1\n  , diagnosis_code_type\n  , row_number() over (partition by encounter_id order by sum(paid_amount) desc ) as paid_order\n  , sum(paid_amount) as paid_amount\n  from detail_values\n  where diagnosis_code_1 is not null\n  group by diagnosis_code_1\n  , encounter_id\n  , diagnosis_code_type\n)\n\n,highest_paid_facility as \n(\n  select encounter_id\n  , facility_id\n  , row_number() over (partition by encounter_id order by sum(paid_amount) desc ) as paid_order\n  , sum(paid_amount) as paid_amount\n  from detail_values\n  where facility_id is not null\n  group by \n   encounter_id\n  , facility_id\n)\n\n, service_category_flags as (\n    select distinct\n        d.encounter_id\n       ,max(case when scr.service_category_2 = 'lab' then 1 else 0 end) as lab_flag\n       ,max(case when scr.service_category_2 = 'ambulance' then 1 else 0 end) as ambulance_flag\n       ,max(case when scr.service_category_2 = 'durable medical equipment' then 1 else 0 end) as dme_flag\n       ,max(case when scr.service_category_2 = 'outpatient pharmacy' then 1 \n                when scr.service_category_2 = 'office-based pharmacy' then 1 else 0 end) as pharmacy_flag\n    from detail_values d\n    left join tuva.claims_preprocessing.service_category_grouper scr on d.claim_id = scr.claim_id \n    and\n    scr.claim_line_number = d.claim_line_number\n    group by d.encounter_id\n)\n\n\n\nselect   d.encounter_id\n, d.encounter_start_date\n, d.patient_data_source_id\n,tot.encounter_type\n,tot.encounter_group\n, datediff(\n        day,\n        birth_date,\n        d.encounter_start_date\n        )/365 as admit_age\n, e.gender\n, e.race\n, hp.diagnosis_code_type as primary_diagnosis_code_type\n, hp.diagnosis_code_1 as primary_diagnosis_code\n, coalesce(icd10cm.long_description, icd9cm.long_description) as primary_diagnosis_description\n, hf.facility_id as facility_id\n, b.provider_organization_name as facility_name\n, b.primary_specialty_description as facility_type\n, sc.lab_flag\n, sc.dme_flag\n, sc.ambulance_flag\n, sc.pharmacy_flag\n, tot.total_paid_amount\n, tot.total_allowed_amount\n, tot.total_charge_amount\n, tot.claim_count\n, tot.inst_claim_count\n, tot.prof_claim_count\n, d.data_source\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom detail_values d\ninner join total_amounts tot on d.encounter_id = tot.encounter_id\ninner join service_category_flags sc on d.encounter_id = sc.encounter_id\nleft join highest_paid_diagnosis hp on d.encounter_id = hp.encounter_id\nand\nhp.paid_order = 1\nleft join highest_paid_facility hf on d.encounter_id = hf.encounter_id\nand\nhf.paid_order = 1\nleft join patient e\n  on d.patient_data_source_id = e.patient_data_source_id\nleft join tuva.terminology.provider b\n  on hf.facility_id = b.npi\nleft join tuva.terminology.icd_10_cm icd10cm\n  on hp.diagnosis_code_1 = icd10cm.icd_10_cm\n  and hp.diagnosis_code_type = 'icd-10-cm'\nleft join tuva.terminology.icd_9_cm icd9cm\n  on hp.diagnosis_code_1 = icd9cm.icd_9_cm\n  and hp.diagnosis_code_type = 'icd-9-cm'\nwhere d.encounter_row_number = 1", "relation_name": "tuva.claims_preprocessing.dialysis__encounter_grain"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.114672Z", "completed_at": "2025-02-25T21:26:26.141806Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.142396Z", "completed_at": "2025-02-25T21:26:26.142399Z"}], "thread_id": "Thread-1", "execution_time": 0.029226064682006836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.core__stg_claims_procedure", "compiled": true, "compiled_code": "\n\n-- *************************************************\n-- This dbt model creates the procedure table in core.\n-- *************************************************\n\nwith unpivot_cte as (\n\nselect\n    claim_id as claim_id\n  , claim_line_number as procedure_sequence_id\n  , person_id\n  , member_id\n  , coalesce(claim_line_start_date\n           , claim_start_date\n           , admission_date\n           , discharge_date\n           , claim_end_date\n    ) as procedure_date\n  , 'hcpcs' as source_code_type\n  , hcpcs_code as source_code\n  , rendering_id as practitioner_npi\n  , hcpcs_modifier_1 as modifier_1\n  , hcpcs_modifier_2 as modifier_2\n  , hcpcs_modifier_3 as modifier_3\n  , hcpcs_modifier_4 as modifier_4\n  , hcpcs_modifier_5 as modifier_5\n  , data_source as data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim\nwhere hcpcs_code is not null\n\n\nunion distinct\n\n\nselect\n    claim_id as claim_id\n  , 1 as procedure_sequence_id\n  , person_id\n  , member_id\n  , procedure_date_1 as procedure_date\n  , procedure_code_type as source_code_type\n  , procedure_code_1 as source_code\n  , rendering_id as practitioner_npi\n  , null as modifier_1\n  , null as modifier_2\n  , null as modifier_3\n  , null as modifier_4\n  , null as modifier_5\n  , data_source as data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim \nwhere procedure_code_1 is not null\n    \n\nunion distinct\n\n\nselect\n    claim_id as claim_id\n  , 2 as procedure_sequence_id\n  , person_id\n  , member_id\n  , procedure_date_2 as procedure_date\n  , procedure_code_type as source_code_type\n  , procedure_code_2 as source_code\n  , rendering_id as practitioner_npi\n  , null as modifier_1\n  , null as modifier_2\n  , null as modifier_3\n  , null as modifier_4\n  , null as modifier_5\n  , data_source as data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim \nwhere procedure_code_2 is not null\n\n\nunion distinct\n\n\nselect\n    claim_id as claim_id\n  , 3 as procedure_sequence_id\n  , person_id\n  , member_id\n  , procedure_date_3 as procedure_date\n  , procedure_code_type as source_code_type\n  , procedure_code_3 as source_code\n  , rendering_id as practitioner_npi\n  , null as modifier_1\n  , null as modifier_2\n  , null as modifier_3\n  , null as modifier_4\n  , null as modifier_5\n  , data_source as data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim \nwhere procedure_code_3 is not null\n\n\nunion distinct\n\n\nselect\n    claim_id as claim_id\n  , 4 as procedure_sequence_id\n  , person_id\n  , member_id\n  , procedure_date_4 as procedure_date\n  , procedure_code_type as source_code_type\n  , procedure_code_4 as source_code\n  , rendering_id as practitioner_npi\n  , null as modifier_1\n  , null as modifier_2\n  , null as modifier_3\n  , null as modifier_4\n  , null as modifier_5\n  , data_source as data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim \nwhere procedure_code_4 is not null\n\n\nunion distinct\n\n\nselect\n    claim_id as claim_id\n  , 5 as procedure_sequence_id\n  , person_id\n  , member_id\n  , procedure_date_5 as procedure_date\n  , procedure_code_type as source_code_type\n  , procedure_code_5 as source_code\n  , rendering_id as practitioner_npi\n  , null as modifier_1\n  , null as modifier_2\n  , null as modifier_3\n  , null as modifier_4\n  , null as modifier_5\n  , data_source as data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim \nwhere procedure_code_5 is not null\n\n\nunion distinct\n\n\nselect\n    claim_id as claim_id\n  , 6 as procedure_sequence_id\n  , person_id\n  , member_id\n  , procedure_date_6 as procedure_date\n  , procedure_code_type as source_code_type\n  , procedure_code_6 as source_code\n  , rendering_id as practitioner_npi\n  , null as modifier_1\n  , null as modifier_2\n  , null as modifier_3\n  , null as modifier_4\n  , null as modifier_5\n  , data_source as data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim \nwhere procedure_code_6 is not null\n\n\nunion distinct\n\n\nselect\n    claim_id as claim_id\n  , 7 as procedure_sequence_id\n  , person_id\n  , member_id\n  , procedure_date_7 as procedure_date\n  , procedure_code_type as source_code_type\n  , procedure_code_7 as source_code\n  , rendering_id as practitioner_npi\n  , null as modifier_1\n  , null as modifier_2\n  , null as modifier_3\n  , null as modifier_4\n  , null as modifier_5\n  , data_source as data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim \nwhere procedure_code_7 is not null\n\n\nunion distinct\n\n\nselect\n    claim_id as claim_id\n  , 8 as procedure_sequence_id\n  , person_id\n  , member_id\n  , procedure_date_8 as procedure_date\n  , procedure_code_type as source_code_type\n  , procedure_code_8 as source_code\n  , rendering_id as practitioner_npi\n  , null as modifier_1\n  , null as modifier_2\n  , null as modifier_3\n  , null as modifier_4\n  , null as modifier_5\n  , data_source as data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim \nwhere procedure_code_8 is not null\n\n\nunion distinct\n\n\nselect\n    claim_id as claim_id\n  , 9 as procedure_sequence_id\n  , person_id\n  , member_id\n  , procedure_date_9 as procedure_date\n  , procedure_code_type as source_code_type\n  , procedure_code_9 as source_code\n  , rendering_id as practitioner_npi\n  , null as modifier_1\n  , null as modifier_2\n  , null as modifier_3\n  , null as modifier_4\n  , null as modifier_5\n  , data_source as data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim \nwhere procedure_code_9 is not null\n\n\nunion distinct\n\n\nselect\n    claim_id as claim_id\n  , 10 as procedure_sequence_id\n  , person_id\n  , member_id\n  , procedure_date_10 as procedure_date\n  , procedure_code_type as source_code_type\n  , procedure_code_10 as source_code\n  , rendering_id as practitioner_npi\n  , null as modifier_1\n  , null as modifier_2\n  , null as modifier_3\n  , null as modifier_4\n  , null as modifier_5\n  , data_source as data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim \nwhere procedure_code_10 is not null\n\n\nunion distinct\n\n\nselect\n    claim_id as claim_id\n  , 11 as procedure_sequence_id\n  , person_id\n  , member_id\n  , procedure_date_11 as procedure_date\n  , procedure_code_type as source_code_type\n  , procedure_code_11 as source_code\n  , rendering_id as practitioner_npi\n  , null as modifier_1\n  , null as modifier_2\n  , null as modifier_3\n  , null as modifier_4\n  , null as modifier_5\n  , data_source as data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim \nwhere procedure_code_11 is not null\n\n\nunion distinct\n\n\nselect\n    claim_id as claim_id\n  , 12 as procedure_sequence_id\n  , person_id\n  , member_id\n  , procedure_date_12 as procedure_date\n  , procedure_code_type as source_code_type\n  , procedure_code_12 as source_code\n  , rendering_id as practitioner_npi\n  , null as modifier_1\n  , null as modifier_2\n  , null as modifier_3\n  , null as modifier_4\n  , null as modifier_5\n  , data_source as data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim \nwhere procedure_code_12 is not null\n\n\nunion distinct\n\n\nselect\n    claim_id as claim_id\n  , 13 as procedure_sequence_id\n  , person_id\n  , member_id\n  , procedure_date_13 as procedure_date\n  , procedure_code_type as source_code_type\n  , procedure_code_13 as source_code\n  , rendering_id as practitioner_npi\n  , null as modifier_1\n  , null as modifier_2\n  , null as modifier_3\n  , null as modifier_4\n  , null as modifier_5\n  , data_source as data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim \nwhere procedure_code_13 is not null\n\n\nunion distinct\n\n\nselect\n    claim_id as claim_id\n  , 14 as procedure_sequence_id\n  , person_id\n  , member_id\n  , procedure_date_14 as procedure_date\n  , procedure_code_type as source_code_type\n  , procedure_code_14 as source_code\n  , rendering_id as practitioner_npi\n  , null as modifier_1\n  , null as modifier_2\n  , null as modifier_3\n  , null as modifier_4\n  , null as modifier_5\n  , data_source as data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim \nwhere procedure_code_14 is not null\n\n\nunion distinct\n\n\nselect\n    claim_id as claim_id\n  , 15 as procedure_sequence_id\n  , person_id\n  , member_id\n  , procedure_date_15 as procedure_date\n  , procedure_code_type as source_code_type\n  , procedure_code_15 as source_code\n  , rendering_id as practitioner_npi\n  , null as modifier_1\n  , null as modifier_2\n  , null as modifier_3\n  , null as modifier_4\n  , null as modifier_5\n  , data_source as data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim \nwhere procedure_code_15 is not null\n\n\nunion distinct\n\n\nselect\n    claim_id as claim_id\n  , 16 as procedure_sequence_id\n  , person_id\n  , member_id\n  , procedure_date_16 as procedure_date\n  , procedure_code_type as source_code_type\n  , procedure_code_16 as source_code\n  , rendering_id as practitioner_npi\n  , null as modifier_1\n  , null as modifier_2\n  , null as modifier_3\n  , null as modifier_4\n  , null as modifier_5\n  , data_source as data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim \nwhere procedure_code_16 is not null\n    \n\nunion distinct\n\n\nselect\n    claim_id as claim_id\n  , 17 as procedure_sequence_id\n  , person_id\n  , member_id\n  , procedure_date_17 as procedure_date\n  , procedure_code_type as source_code_type\n  , procedure_code_17 as source_code\n  , rendering_id as practitioner_npi\n  , null as modifier_1\n  , null as modifier_2\n  , null as modifier_3\n  , null as modifier_4\n  , null as modifier_5\n  , data_source as data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim \nwhere procedure_code_17 is not null\n\n\nunion distinct\n\n\nselect\n    claim_id as claim_id\n  , 18 as procedure_sequence_id\n  , person_id\n  , member_id\n  , procedure_date_18 as procedure_date\n  , procedure_code_type as source_code_type\n  , procedure_code_18 as source_code\n  , rendering_id as practitioner_npi\n  , null as modifier_1\n  , null as modifier_2\n  , null as modifier_3\n  , null as modifier_4\n  , null as modifier_5\n  , data_source as data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim \nwhere procedure_code_18 is not null\n\n\nunion distinct\n\n\nselect\n    claim_id as claim_id\n  , 19 as procedure_sequence_id\n  , person_id\n  , member_id\n  , procedure_date_19 as procedure_date\n  , procedure_code_type as source_code_type\n  , procedure_code_19 as source_code\n  , rendering_id as practitioner_npi\n  , null as modifier_1\n  , null as modifier_2\n  , null as modifier_3\n  , null as modifier_4\n  , null as modifier_5\n  , data_source as data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim \nwhere procedure_code_19 is not null\n\n\nunion distinct\n\n\nselect\n    claim_id as claim_id\n  , 20 as procedure_sequence_id\n  , person_id\n  , member_id\n  , procedure_date_20 as procedure_date\n  , procedure_code_type as source_code_type\n  , procedure_code_20 as source_code\n  , rendering_id as practitioner_npi\n  , null as modifier_1\n  , null as modifier_2\n  , null as modifier_3\n  , null as modifier_4\n  , null as modifier_5\n  , data_source as data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim \nwhere procedure_code_20 is not null\n\n\nunion distinct\n\n\nselect\n    claim_id as claim_id\n  , 21 as procedure_sequence_id\n  , person_id\n  , member_id\n  , procedure_date_21 as procedure_date\n  , procedure_code_type as source_code_type\n  , procedure_code_21 as source_code\n  , rendering_id as practitioner_npi\n  , null as modifier_1\n  , null as modifier_2\n  , null as modifier_3\n  , null as modifier_4\n  , null as modifier_5\n  , data_source as data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim \nwhere procedure_code_21 is not null\n\n\nunion distinct\n\n\nselect\n    claim_id as claim_id\n  , 22 as procedure_sequence_id\n  , person_id\n  , member_id\n  , procedure_date_22 as procedure_date\n  , procedure_code_type as source_code_type\n  , procedure_code_22 as source_code\n  , rendering_id as practitioner_npi\n  , null as modifier_1\n  , null as modifier_2\n  , null as modifier_3\n  , null as modifier_4\n  , null as modifier_5\n  , data_source as data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim \nwhere procedure_code_22 is not null\n\n\nunion distinct\n\n\nselect\n    claim_id as claim_id\n  , 23 as procedure_sequence_id\n  , person_id\n  , member_id\n  , procedure_date_23 as procedure_date\n  , procedure_code_type as source_code_type\n  , procedure_code_23 as source_code\n  , rendering_id as practitioner_npi\n  , null as modifier_1\n  , null as modifier_2\n  , null as modifier_3\n  , null as modifier_4\n  , null as modifier_5\n  , data_source as data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim \nwhere procedure_code_23 is not null\n\n\nunion distinct\n\n\nselect\n    claim_id as claim_id\n  , 24 as procedure_sequence_id\n  , person_id\n  , member_id\n  , procedure_date_24 as procedure_date\n  , procedure_code_type as source_code_type\n  , procedure_code_24 as source_code\n  , rendering_id as practitioner_npi\n  , null as modifier_1\n  , null as modifier_2\n  , null as modifier_3\n  , null as modifier_4\n  , null as modifier_5\n  , data_source as data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim \nwhere procedure_code_24 is not null\n\n\nunion distinct\n\n\nselect\n    claim_id as claim_id\n  , 25 as procedure_sequence_id\n  , person_id\n  , member_id\n  , procedure_date_25 as procedure_date\n  , procedure_code_type as source_code_type\n  , procedure_code_25 as source_code\n  , rendering_id as practitioner_npi\n  , null as modifier_1\n  , null as modifier_2\n  , null as modifier_3\n  , null as modifier_4\n  , null as modifier_5\n  , data_source as data_source\nfrom tuva.claims_preprocessing.normalized_input_medical_claim \nwhere procedure_code_25 is not null\n\n)\n\nselect distinct\n\n    \n        try_cast(unpivot_cte.data_source || '_' || unpivot_cte.claim_id || '_' || unpivot_cte.procedure_sequence_id || '_' || unpivot_cte.source_code || case when unpivot_cte.modifier_1 is not null then CONCAT('_', unpivot_cte.modifier_1) else '' end || case when unpivot_cte.modifier_2 is not null then CONCAT('_', unpivot_cte.modifier_2) else '' end || case when unpivot_cte.modifier_3 is not null then CONCAT('_', unpivot_cte.modifier_3) else '' end || case when unpivot_cte.modifier_4 is not null then CONCAT('_', unpivot_cte.modifier_4) else '' end || case when unpivot_cte.modifier_5 is not null then CONCAT('_', unpivot_cte.modifier_5) else '' end || case when unpivot_cte.practitioner_npi is not null then CONCAT('_', unpivot_cte.practitioner_npi) else '' end as TEXT)\n     as procedure_id\n    , cast(unpivot_cte.person_id as TEXT ) as person_id\n    , cast(unpivot_cte.member_id as TEXT ) as member_id\n    , cast(null as TEXT ) as patient_id\n    , cast(null as TEXT ) as encounter_id --one claim can be on multiple encounters, so nulling out for now\n    , cast(unpivot_cte.claim_id as TEXT ) as claim_id\n    , try_cast( unpivot_cte.procedure_date as date ) as procedure_date\n    , cast(unpivot_cte.source_code_type as TEXT ) as source_code_type\n    , cast(unpivot_cte.source_code as TEXT ) as source_code\n    , cast(null as TEXT ) as source_description\n    , cast(\n        case\n        when icd.icd_10_pcs is not null then 'icd-10-pcs'\n        when hcpcs.hcpcs is not null then 'hcpcs'\n        end\n      as TEXT ) as normalized_code_type\n    , cast (\n        coalesce (\n            icd.icd_10_pcs\n          , hcpcs.hcpcs\n        )\n      as TEXT ) as normalized_code\n    , cast (\n        coalesce (\n            icd.description\n          , hcpcs.short_description\n        )\n      as TEXT ) as normalized_description\n    , cast(unpivot_cte.modifier_1 as TEXT ) as modifier_1\n    , cast(unpivot_cte.modifier_2 as TEXT ) as modifier_2\n    , cast(unpivot_cte.modifier_3 as TEXT ) as modifier_3\n    , cast(unpivot_cte.modifier_4 as TEXT ) as modifier_4\n    , cast(unpivot_cte.modifier_5 as TEXT ) as modifier_5\n    , cast(unpivot_cte.practitioner_npi as TEXT ) as practitioner_id\n    , cast(unpivot_cte.data_source as TEXT ) as data_source\n    , cast('2025-02-25 21:25:59.177756+00:00' as timestamp ) as tuva_last_run\nfrom unpivot_cte\n--inner join tuva.claims_preprocessing.encounters__combined_claim_line_crosswalk x on unpivot_cte.claim_id = x.claim_id\n--and\n--unpivot_cte.claim_line_number = x.claim_line_number\n--and\n--x.claim_line_attribution_number = 1\nleft join tuva.terminology.icd_10_pcs as icd\n    on unpivot_cte.source_code = icd.icd_10_pcs\nleft join tuva.terminology.hcpcs_level_2 as hcpcs\n    on unpivot_cte.source_code = hcpcs.hcpcs", "relation_name": "tuva.core._stg_claims_procedure"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.136823Z", "completed_at": "2025-02-25T21:26:26.142998Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.143676Z", "completed_at": "2025-02-25T21:26:26.143679Z"}], "thread_id": "Thread-2", "execution_time": 0.007363080978393555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.dme__encounter_grain", "compiled": true, "compiled_code": "\n\nwith encounter_date as (\n  select distinct old_encounter_id\n  ,start_date as encounter_start_date\n  from tuva.claims_preprocessing.dme__generate_encounter_id\n)\n\n,detail_values as (\n    select stg.*\n    ,cli.encounter_id\n    ,cli.old_encounter_id\n      ,cli.encounter_type\n    ,cli.encounter_group\n    ,d.encounter_start_date \n    , row_number() over (partition by cli.encounter_id order by stg.claim_type, stg.start_date) as encounter_row_number --institutional then professional\n    from  tuva.claims_preprocessing.encounters__stg_medical_claim stg\n    inner join tuva.claims_preprocessing.encounters__combined_claim_line_crosswalk cli on stg.claim_id = cli.claim_id  \n    and\n    stg.claim_line_number = cli.claim_line_number\n    and\n    cli.encounter_type = 'dme - orphaned'\n    and\n    cli.claim_line_attribution_number = 1\n    inner join encounter_date d on cli.old_encounter_id = d.old_encounter_id\n)\n\n, patient as (\n    select \n        patient_data_source_id\n        , birth_date\n        , gender\n        , race\n    from tuva.claims_preprocessing.encounters__stg_eligibility\n    where patient_row_num = 1\n    )\n\n, total_amounts as (\n    select \n    encounter_id\n    , encounter_type\n    , encounter_group\n    , sum(paid_amount) as total_paid_amount\n    , sum(allowed_amount) as total_allowed_amount\n    , sum(charge_amount) as total_charge_amount\n    , count(distinct claim_id) as claim_count\n    , count(distinct(case when claim_type = 'institutional' then claim_id else null end))  as inst_claim_count\n    , count(distinct(case when claim_type = 'professional' then claim_id else null end))  as prof_claim_count\nfrom detail_values\ngroup by encounter_id\n,encounter_type \n,encounter_group\n)\n\n\n,highest_paid_diagnosis as \n(\n  select encounter_id\n  , diagnosis_code_1\n  , diagnosis_code_type\n  , row_number() over (partition by encounter_id order by sum(paid_amount) desc ) as paid_order\n  , sum(paid_amount) as paid_amount\n  from detail_values\n  where diagnosis_code_1 is not null\n  group by diagnosis_code_1\n  , encounter_id\n  , diagnosis_code_type\n)\n\n,highest_paid_facility as \n(\n  select encounter_id\n  , facility_id\n  , row_number() over (partition by encounter_id order by sum(paid_amount) desc ) as paid_order\n  , sum(paid_amount) as paid_amount\n  from detail_values\n  where facility_id is not null\n  group by \n   encounter_id\n  , facility_id\n)\n\n,highest_paid_pos as \n(\n  select encounter_id\n  , place_of_service_code\n  , place_of_service_description\n  , row_number() over (partition by encounter_id order by sum(paid_amount) desc ) as paid_order\n  , sum(paid_amount) as paid_amount\n  from detail_values\n  where place_of_service_code is not null\n  group by \n   encounter_id\n  , place_of_service_code\n  , place_of_service_description\n)\n\n\n\n\n, service_category_flags as (\n    select distinct\n        d.encounter_id\n       ,max(case when scr.service_category_2 = 'lab' then 1 else 0 end) as lab_flag\n       ,max(case when scr.service_category_2 = 'ambulance' then 1 else 0 end) as ambulance_flag\n       ,max(case when scr.service_category_2 = 'durable medical equipment' then 1 else 0 end) as dme_flag\n       ,max(case when scr.service_category_2 = 'outpatient pharmacy' then 1 \n                when scr.service_category_2 = 'office-based pharmacy' then 1 else 0 end) as pharmacy_flag\n    from detail_values d\n    left join tuva.claims_preprocessing.service_category_grouper scr on d.claim_id = scr.claim_id \n    and\n    scr.claim_line_number = d.claim_line_number\n    group by d.encounter_id\n)\n\n\n\nselect   d.encounter_id\n, d.encounter_start_date\n, d.patient_data_source_id\n\n,tot.encounter_type\n,tot.encounter_group\n, datediff(\n        day,\n        birth_date,\n        d.encounter_start_date\n        )/365 as admit_age\n, e.gender\n, e.race\n, hp.diagnosis_code_type as primary_diagnosis_code_type\n, hp.diagnosis_code_1 as primary_diagnosis_code\n, coalesce(icd10cm.long_description, icd9cm.long_description) as primary_diagnosis_description\n, hf.facility_id as facility_id\n, b.provider_organization_name as facility_name\n, b.primary_specialty_description as facility_type\n, sc.lab_flag\n, sc.dme_flag\n, sc.ambulance_flag\n, sc.pharmacy_flag\n, pos.place_of_service_code\n, pos.place_of_service_description\n, tot.total_paid_amount\n, tot.total_allowed_amount\n, tot.total_charge_amount\n, tot.claim_count\n, tot.inst_claim_count\n, tot.prof_claim_count\n, d.data_source\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom detail_values d\ninner join total_amounts tot on d.encounter_id = tot.encounter_id\ninner join service_category_flags sc on d.encounter_id = sc.encounter_id\nleft join highest_paid_diagnosis hp on d.encounter_id = hp.encounter_id\nand\nhp.paid_order = 1\nleft join highest_paid_facility hf on d.encounter_id = hf.encounter_id\nand\nhf.paid_order = 1\nleft join highest_paid_pos pos on d.encounter_id = pos.encounter_id\nand\npos.paid_order = 1\nleft join patient e\n  on d.patient_data_source_id = e.patient_data_source_id\nleft join tuva.terminology.provider b\n  on hf.facility_id = b.npi\nleft join tuva.terminology.icd_10_cm icd10cm\n  on hp.diagnosis_code_1 = icd10cm.icd_10_cm\n  and hp.diagnosis_code_type = 'icd-10-cm'\nleft join tuva.terminology.icd_9_cm icd9cm\n  on hp.diagnosis_code_1 = icd9cm.icd_9_cm\n  and hp.diagnosis_code_type = 'icd-9-cm'\nwhere d.encounter_row_number = 1", "relation_name": "tuva.claims_preprocessing.dme__encounter_grain"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.144857Z", "completed_at": "2025-02-25T21:26:26.159276Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.159541Z", "completed_at": "2025-02-25T21:26:26.159547Z"}], "thread_id": "Thread-3", "execution_time": 0.01618504524230957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.emergency_department__encounter_grain", "compiled": true, "compiled_code": "\n\nwith detail_values as (\n    select stg.*\n    ,cli.encounter_id\n    ,cli.old_encounter_id\n    ,ed.encounter_start_date\n    ,ed.encounter_end_date\n    ,cli.encounter_type\n    ,cli.encounter_group\n    from  tuva.claims_preprocessing.encounters__stg_medical_claim stg\n    inner join tuva.claims_preprocessing.encounters__combined_claim_line_crosswalk cli on stg.claim_id = cli.claim_id  --replace this ref with the deduped version when complete\n    and\n    stg.claim_line_number = cli.claim_line_number\n    and\n    cli.encounter_type = 'emergency department'\n    and\n    cli.claim_line_attribution_number = 1\n    inner join tuva.claims_preprocessing.emergency_department__start_end_dates ed on cli.old_encounter_id = ed.encounter_id\n)\n\n,encounter_cross_walk as (\n  select distinct encounter_id\n  ,old_encounter_id\n  from detail_values\n)\n\n,first_last_inst_inst_values as (\nselect *\n,row_number() over (partition by encounter_id order by start_date, claim_id) as first_num\n,row_number() over (partition by encounter_id order by end_date desc, claim_id) as last_num\nfrom detail_values\nwhere claim_type = 'institutional'\n)\n\n,encounter_header_values as (\n  select distinct patient_data_source_id\n  ,data_source\n  ,encounter_id\n  from detail_values\n)\n\n, institutional_claim_details as (\n    select distinct\n        d.encounter_id\n        , f.diagnosis_code_1\n        , f.diagnosis_code_type\n        , f.facility_id as facility_id\n        , f.drg_code_type as drg_code_type\n        , f.drg_code as drg_code\n        , f.admit_source_code as admit_source_code\n        , f.admit_type_code as admit_type_code\n        , l.discharge_disposition_code as discharge_disposition_code\n        , d.patient_data_source_id\n        , d.data_source\n    from detail_values d\n    inner join first_last_inst_inst_values f on d.encounter_id = f.encounter_id\n    and\n    f.first_num =1 \n    inner join first_last_inst_inst_values l on d.encounter_id = l.encounter_id\n    and\n    l.last_num = 1 \n\n)\n\n, patient as (\n    select \n        patient_data_source_id\n        , birth_date\n        , gender\n        , race\n    from tuva.claims_preprocessing.encounters__stg_eligibility\n    where patient_row_num = 1\n    )\n\n, total_amounts as (\n    select \n    encounter_id\n    ,encounter_type\n    , encounter_group\n    , sum(paid_amount) as total_paid_amount\n    , sum(allowed_amount) as total_allowed_amount\n    , sum(charge_amount) as total_charge_amount\n    , count(distinct claim_id) as claim_count\n    , count(distinct(case when claim_type = 'institutional' then claim_id else null end))  as inst_claim_count\n    , count(distinct(case when claim_type = 'professional' then claim_id else null end))  as prof_claim_count\nfrom detail_values\ngroup by encounter_id\n,encounter_type -- not changing grain, but bringing into final\n, encounter_group\n)\n\n\n\n\n, service_category_flags as (\n    select distinct\n        d.encounter_id\n       ,max(case when scr.service_category_2 = 'lab' then 1 else 0 end) as lab_flag\n       ,max(case when scr.service_category_2 = 'ambulance' then 1 else 0 end) as ambulance_flag\n       ,max(case when scr.service_category_2 = 'durable medical equipment' then 1 else 0 end) as dme_flag\n       ,max(case when scr.service_category_2 = 'observation' then 1 else 0 end) as observation_flag\n       ,max(case when scr.service_category_2 = 'pharmacy' then 1 \n              else 0 end) as pharmacy_flag\n    from detail_values d\n    left join tuva.claims_preprocessing.service_category_grouper scr on d.claim_id = scr.claim_id \n    and\n    scr.claim_line_number = d.claim_line_number\n    group by d.encounter_id\n)\n\n\nselect\n  x.encounter_id\n, a.encounter_start_date\n, a.encounter_end_date\n, ehv.patient_data_source_id\n,tot.encounter_type\n,tot.encounter_group\n, datediff(\n        day,\n        birth_date,\n        a.encounter_end_date\n        )/365 as admit_age\n, e.gender\n, e.race\n, c.diagnosis_code_type as primary_diagnosis_code_type\n, c.diagnosis_code_1 as primary_diagnosis_code\n, coalesce(icd10cm.long_description, icd9cm.long_description) as primary_diagnosis_description\n, sc.observation_flag\n, c.facility_id as facility_id\n, b.provider_organization_name as facility_name\n, b.primary_specialty_description as facility_type\n, sc.lab_flag\n, sc.dme_flag\n, sc.ambulance_flag\n, sc.pharmacy_flag\n, c.drg_code_type\n, c.drg_code\n, coalesce(msdrg.ms_drg_description, aprdrg.apr_drg_description) as drg_description\n, coalesce(msdrg.medical_surgical, aprdrg.medical_surgical) as medical_surgical\n, c.admit_source_code\n, h.admit_source_description\n, c.admit_type_code\n, i.admit_type_description\n, c.discharge_disposition_code\n, g.discharge_disposition_description\n, tot.total_paid_amount\n, tot.total_allowed_amount\n, tot.total_charge_amount\n, tot.claim_count\n, tot.inst_claim_count\n, tot.prof_claim_count\n, datediff(\n        day,\n        a.encounter_start_date,\n        a.encounter_end_date\n        ) as length_of_stay\n, case\n    when c.discharge_disposition_code = '20' then 1\n    else 0\n  end mortality_flag\n, ehv.data_source\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.emergency_department__start_end_dates a\ninner join encounter_cross_walk x on a.encounter_id = x.old_encounter_id\ninner join total_amounts tot on x.encounter_id = tot.encounter_id\ninner join service_category_flags sc on x.encounter_id = sc.encounter_id\ninner join encounter_header_values ehv on x.encounter_id = ehv.encounter_id\nleft join institutional_claim_details c\n  on x.encounter_id = c.encounter_id\nleft join patient e\n  on c.patient_data_source_id = e.patient_data_source_id\nleft join tuva.terminology.provider b\n  on c.facility_id = b.npi\nleft join tuva.terminology.discharge_disposition g\n  on c.discharge_disposition_code = g.discharge_disposition_code\nleft join tuva.terminology.admit_source h\n  on c.admit_source_code = h.admit_source_code\nleft join tuva.terminology.admit_type i\n  on c.admit_type_code = i.admit_type_code\nleft join tuva.terminology.ms_drg msdrg\n  on c.drg_code_type = 'ms-drg'\n  and c.drg_code = msdrg.ms_drg_code\nleft join tuva.terminology.apr_drg aprdrg\n  on c.drg_code_type = 'apr-drg'\n  and c.drg_code = aprdrg.apr_drg_code\nleft join tuva.terminology.icd_10_cm icd10cm\n  on c.diagnosis_code_1 = icd10cm.icd_10_cm\n  and c.diagnosis_code_type = 'icd-10-cm'\nleft join tuva.terminology.icd_9_cm icd9cm\n  on c.diagnosis_code_1 = icd9cm.icd_9_cm\n  and c.diagnosis_code_type = 'icd-9-cm'", "relation_name": "tuva.claims_preprocessing.emergency_department__encounter_grain"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.151609Z", "completed_at": "2025-02-25T21:26:26.160217Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.160829Z", "completed_at": "2025-02-25T21:26:26.160832Z"}], "thread_id": "Thread-1", "execution_time": 0.01686692237854004, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.encounters__orphaned_claims", "compiled": true, "compiled_code": "\n\nwith cte as (\n  select stg.claim_id\n  ,stg.claim_line_number\n  ,stg.service_category_1\n  ,stg.service_category_2\n  ,stg.service_category_3\n  ,stg.claim_type\n  ,stg.claim_start_date\n  ,stg.claim_end_date\n  ,stg.start_date\n  ,stg.end_date\n  ,stg.patient_data_source_id\n  from tuva.claims_preprocessing.encounters__stg_medical_claim stg\n  left join  tuva.claims_preprocessing.encounters__combined_claim_line_crosswalk enc on stg.claim_id = enc.claim_id\n  and\n  stg.claim_line_number = enc.claim_line_number\n  where enc.claim_id is null -- missing from encounter mapping table\n)\n\n,max_encounter as (\n  select max(encounter_id) max_encounter_id\n  from tuva.claims_preprocessing.encounters__combined_claim_line_crosswalk\n)\n\nselect \n  claim_id\n, claim_line_number\n, dense_rank() over (order by patient_data_source_id, claim_id) + max_encounter.max_encounter_id as encounter_id\n, 'orphaned claim' as encounter_type\n, 'other' as encounter_group\nfrom cte\ncross join max_encounter", "relation_name": "tuva.claims_preprocessing.encounters__orphaned_claims"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.154698Z", "completed_at": "2025-02-25T21:26:26.160639Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.161386Z", "completed_at": "2025-02-25T21:26:26.161389Z"}], "thread_id": "Thread-2", "execution_time": 0.010065793991088867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.home_health__encounter_grain", "compiled": true, "compiled_code": "\n\nwith encounter_date as (\n  select distinct old_encounter_id\n  ,start_date as encounter_start_date\n  from tuva.claims_preprocessing.home_health__generate_encounter_id\n)\n\n,detail_values as (\n    select stg.*\n    ,cli.encounter_id\n    ,cli.old_encounter_id\n      ,cli.encounter_type\n    ,cli.encounter_group\n    ,d.encounter_start_date \n    , row_number() over (partition by cli.encounter_id order by stg.claim_type, stg.start_date) as encounter_row_number --institutional then professional\n    from  tuva.claims_preprocessing.encounters__stg_medical_claim stg\n    inner join tuva.claims_preprocessing.encounters__combined_claim_line_crosswalk cli on stg.claim_id = cli.claim_id  \n    and\n    stg.claim_line_number = cli.claim_line_number\n    and\n    cli.encounter_type = 'home health'\n    and\n    cli.claim_line_attribution_number = 1\n    inner join encounter_date d on cli.old_encounter_id = d.old_encounter_id\n)\n\n, patient as (\n    select \n        patient_data_source_id\n        , birth_date\n        , gender\n        , race\n    from tuva.claims_preprocessing.encounters__stg_eligibility\n    where patient_row_num = 1\n    )\n\n, total_amounts as (\n    select \n    encounter_id\n    , encounter_type\n    , encounter_group\n    , sum(paid_amount) as total_paid_amount\n    , sum(allowed_amount) as total_allowed_amount\n    , sum(charge_amount) as total_charge_amount\n    , count(distinct claim_id) as claim_count\n    , count(distinct(case when claim_type = 'institutional' then claim_id else null end))  as inst_claim_count\n    , count(distinct(case when claim_type = 'professional' then claim_id else null end))  as prof_claim_count\nfrom detail_values\ngroup by encounter_id\n,encounter_type \n,encounter_group\n)\n\n\n,highest_paid_diagnosis as \n(\n  select encounter_id\n  , diagnosis_code_1\n  , diagnosis_code_type\n  , row_number() over (partition by encounter_id order by sum(paid_amount) desc ) as paid_order\n  , sum(paid_amount) as paid_amount\n  from detail_values\n  where diagnosis_code_1 is not null\n  group by diagnosis_code_1\n  , encounter_id\n  , diagnosis_code_type\n)\n\n,highest_paid_facility as \n(\n  select encounter_id\n  , facility_id\n  , row_number() over (partition by encounter_id order by sum(paid_amount) desc ) as paid_order\n  , sum(paid_amount) as paid_amount\n  from detail_values\n  where facility_id is not null\n  group by \n   encounter_id\n  , facility_id\n)\n\n\n\n, service_category_flags as (\n    select distinct\n        d.encounter_id\n       ,max(case when scr.service_category_2 = 'lab' then 1 else 0 end) as lab_flag\n       ,max(case when scr.service_category_2 = 'ambulance' then 1 else 0 end) as ambulance_flag\n       ,max(case when scr.service_category_2 = 'durable medical equipment' then 1 else 0 end) as dme_flag\n       ,max(case when scr.service_category_2 = 'outpatient pharmacy' then 1 \n                when scr.service_category_2 = 'office-based pharmacy' then 1 else 0 end) as pharmacy_flag\n    from detail_values d\n    left join tuva.claims_preprocessing.service_category_grouper scr on d.claim_id = scr.claim_id \n    and\n    scr.claim_line_number = d.claim_line_number\n    group by d.encounter_id\n)\n\n\n\nselect   d.encounter_id\n, d.encounter_start_date\n, d.patient_data_source_id\n\n,tot.encounter_type\n,tot.encounter_group\n, datediff(\n        day,\n        birth_date,\n        d.encounter_start_date\n        )/365 as admit_age\n, e.gender\n, e.race\n, hp.diagnosis_code_type as primary_diagnosis_code_type\n, hp.diagnosis_code_1 as primary_diagnosis_code\n, coalesce(icd10cm.long_description, icd9cm.long_description) as primary_diagnosis_description\n, hf.facility_id as facility_id\n, b.provider_organization_name as facility_name\n, b.primary_specialty_description as facility_type\n, sc.lab_flag\n, sc.dme_flag\n, sc.ambulance_flag\n, sc.pharmacy_flag\n, tot.total_paid_amount\n, tot.total_allowed_amount\n, tot.total_charge_amount\n, tot.claim_count\n, tot.inst_claim_count\n, tot.prof_claim_count\n, d.data_source\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom detail_values d\ninner join total_amounts tot on d.encounter_id = tot.encounter_id\ninner join service_category_flags sc on d.encounter_id = sc.encounter_id\nleft join highest_paid_diagnosis hp on d.encounter_id = hp.encounter_id\nand\nhp.paid_order = 1\nleft join highest_paid_facility hf on d.encounter_id = hf.encounter_id\nand\nhf.paid_order = 1\nleft join patient e\n  on d.patient_data_source_id = e.patient_data_source_id\nleft join tuva.terminology.provider b\n  on hf.facility_id = b.npi\nleft join tuva.terminology.icd_10_cm icd10cm\n  on hp.diagnosis_code_1 = icd10cm.icd_10_cm\n  and hp.diagnosis_code_type = 'icd-10-cm'\nleft join tuva.terminology.icd_9_cm icd9cm\n  on hp.diagnosis_code_1 = icd9cm.icd_9_cm\n  and hp.diagnosis_code_type = 'icd-9-cm'\nwhere d.encounter_row_number = 1", "relation_name": "tuva.claims_preprocessing.home_health__encounter_grain"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.161960Z", "completed_at": "2025-02-25T21:26:26.168796Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.180794Z", "completed_at": "2025-02-25T21:26:26.180799Z"}], "thread_id": "Thread-3", "execution_time": 0.020462751388549805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.inpatient_hospice__encounter_grain", "compiled": true, "compiled_code": "\n\nwith detail_values as (\n    select stg.*\n    , cli.encounter_id\n    , cli.old_encounter_id\n    , ed.encounter_start_date\n    , ed.encounter_end_date\n    , cli.encounter_type\n    , cli.encounter_group\n    from  tuva.claims_preprocessing.encounters__stg_medical_claim stg\n    inner join tuva.claims_preprocessing.encounters__combined_claim_line_crosswalk cli on stg.claim_id = cli.claim_id  --replace this ref with the deduped version when complete\n    and\n    stg.claim_line_number = cli.claim_line_number\n    and\n    cli.encounter_type = 'inpatient hospice'\n    and\n    cli.claim_line_attribution_number = 1\n    inner join tuva.claims_preprocessing.inpatient_hospice__start_end_dates ed on cli.old_encounter_id = ed.encounter_id\n)\n\n,encounter_cross_walk as (\n  select distinct encounter_id\n  ,old_encounter_id\n  from detail_values\n)\n\n,first_last_inst_inst_values as (\nselect *\n,row_number() over (partition by encounter_id order by start_date, claim_id) as first_num\n,row_number() over (partition by encounter_id order by end_date desc, claim_id) as last_num\nfrom detail_values\nwhere claim_type = 'institutional'\n)\n\n, institutional_claim_details as (\n    select distinct\n        d.encounter_id\n        , f.diagnosis_code_1\n        , f.diagnosis_code_type\n        , f.facility_id as facility_id\n        , f.drg_code_type\n        , f.drg_code as drg_code\n        , f.admit_source_code as admit_source_code\n        , f.admit_type_code as admit_type_code\n        , l.discharge_disposition_code as discharge_disposition_code\n        , d.patient_data_source_id\n        , d.data_source\n    from detail_values d\n    inner join first_last_inst_inst_values f on d.encounter_id = f.encounter_id\n    and\n    f.first_num =1 \n    inner join first_last_inst_inst_values l on d.encounter_id = l.encounter_id\n    and\n    l.last_num = 1 \n\n)\n\n, patient as (\n    select \n        patient_data_source_id\n        , birth_date\n        , gender\n        , race\n    from tuva.claims_preprocessing.encounters__stg_eligibility\n    where patient_row_num = 1\n    )\n\n, total_amounts as (\n    select \n    encounter_id\n    ,encounter_type\n    ,encounter_group\n    , sum(paid_amount) as total_paid_amount\n    , sum(allowed_amount) as total_allowed_amount\n    , sum(charge_amount) as total_charge_amount\n    , count(distinct claim_id) as claim_count\n    , count(distinct(case when claim_type = 'institutional' then claim_id else null end))  as inst_claim_count\n    , count(distinct(case when claim_type = 'professional' then claim_id else null end))  as prof_claim_count\nfrom detail_values\ngroup by encounter_id\n,encounter_type \n, encounter_group\n\n)\n\n\n\n, service_category_flags as (\n    select distinct\n        d.encounter_id\n       ,max(case when scr.service_category_2 = 'lab' then 1 else 0 end) as lab_flag\n       ,max(case when scr.service_category_2 = 'ambulance' then 1 else 0 end) as ambulance_flag\n       ,max(case when scr.service_category_2 = 'durable medical equipment' then 1 else 0 end) as dme_flag\n       ,max(case when scr.service_category_2 = 'observation' then 1 else 0 end) as observation_flag\n       ,max(case when scr.service_category_2 = 'emergency department' then 1 else 0 end) as ed_flag\n       ,max(case when scr.service_category_2 = 'pharmacy' then 1 else 0 end) as pharmacy_flag\n    from detail_values d\n    left join tuva.claims_preprocessing.service_category_grouper scr on d.claim_id = scr.claim_id \n    and\n    scr.claim_line_number = d.claim_line_number\n    group by d.encounter_id\n)\n\nselect\n  x.encounter_id\n, a.encounter_start_date\n, a.encounter_end_date\n, c.patient_data_source_id\n,tot.encounter_type\n,tot.encounter_group\n, datediff(\n        day,\n        birth_date,\n        encounter_end_date\n        )/365 as admit_age\n, e.gender\n, e.race\n, c.diagnosis_code_type as primary_diagnosis_code_type\n, c.diagnosis_code_1 as primary_diagnosis_code\n, coalesce(icd10cm.long_description, icd9cm.long_description) as primary_diagnosis_description\n, c.facility_id as facility_id\n, b.provider_organization_name as facility_name\n, b.primary_specialty_description as facility_type\n, sc.lab_flag\n, sc.dme_flag\n, sc.ambulance_flag\n, sc.pharmacy_flag\n, sc.observation_flag\n, sc.ed_flag\n, c.drg_code_type\n, c.drg_code\n, coalesce(msdrg.ms_drg_description, aprdrg.apr_drg_description) as drg_description\n, coalesce(msdrg.medical_surgical, aprdrg.medical_surgical) as medical_surgical\n, c.admit_source_code\n, h.admit_source_description\n, c.admit_type_code\n, i.admit_type_description\n, c.discharge_disposition_code\n, g.discharge_disposition_description\n, tot.total_paid_amount\n, tot.total_allowed_amount\n, tot.total_charge_amount\n, tot.claim_count\n, tot.inst_claim_count\n, tot.prof_claim_count\n, datediff(\n        day,\n        a.encounter_start_date,\n        a.encounter_end_date\n        ) as length_of_stay\n, case\n    when c.discharge_disposition_code = '20' then 1\n    else 0\n  end mortality_flag\n, c.data_source\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.inpatient_hospice__start_end_dates a\ninner join encounter_cross_walk x on a.encounter_id = x.old_encounter_id\ninner join total_amounts tot on x.encounter_id = tot.encounter_id\ninner join service_category_flags sc on x.encounter_id = sc.encounter_id\nleft join institutional_claim_details c\n  on x.encounter_id = c.encounter_id\nleft join patient e\n  on c.patient_data_source_id = e.patient_data_source_id\nleft join tuva.terminology.provider b\n  on c.facility_id = b.npi\nleft join tuva.terminology.discharge_disposition g\n  on c.discharge_disposition_code = g.discharge_disposition_code\nleft join tuva.terminology.admit_source h\n  on c.admit_source_code = h.admit_source_code\nleft join tuva.terminology.admit_type i\n  on c.admit_type_code = i.admit_type_code\nleft join tuva.terminology.ms_drg msdrg\n  on c.drg_code_type = 'ms-drg'\n  and c.drg_code = msdrg.ms_drg_code\nleft join tuva.terminology.apr_drg aprdrg\n  on c.drg_code_type = 'apr-drg'\n  and c.drg_code = aprdrg.apr_drg_code\nleft join tuva.terminology.icd_10_cm icd10cm\n  on c.diagnosis_code_1 = icd10cm.icd_10_cm\n  and c.diagnosis_code_type = 'icd-10-cm'\nleft join tuva.terminology.icd_9_cm icd9cm\n  on c.diagnosis_code_1 = icd9cm.icd_9_cm\n  and c.diagnosis_code_type = 'icd-9-cm'", "relation_name": "tuva.claims_preprocessing.inpatient_hospice__encounter_grain"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.168971Z", "completed_at": "2025-02-25T21:26:26.182006Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.188150Z", "completed_at": "2025-02-25T21:26:26.188156Z"}], "thread_id": "Thread-1", "execution_time": 0.020325183868408203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.inpatient_psych__encounter_grain", "compiled": true, "compiled_code": "\n\nwith detail_values as (\n    select stg.*\n    , cli.encounter_id\n    , cli.old_encounter_id\n    , ed.encounter_start_date\n    , ed.encounter_end_date\n    , cli.encounter_type\n    , cli.encounter_group\n    from  tuva.claims_preprocessing.encounters__stg_medical_claim stg\n    inner join tuva.claims_preprocessing.encounters__combined_claim_line_crosswalk cli on stg.claim_id = cli.claim_id  --replace this ref with the deduped version when complete\n    and\n    stg.claim_line_number = cli.claim_line_number\n    and\n    cli.encounter_type = 'inpatient psych'\n    and\n    cli.claim_line_attribution_number = 1\n    inner join tuva.claims_preprocessing.inpatient_psych__start_end_dates ed on cli.old_encounter_id = ed.encounter_id\n)\n\n,encounter_cross_walk as (\n  select distinct encounter_id\n  ,old_encounter_id\n  from detail_values\n)\n\n,first_last_inst_inst_values as (\nselect *\n,row_number() over (partition by encounter_id order by start_date, claim_id) as first_num\n,row_number() over (partition by encounter_id order by end_date desc, claim_id) as last_num\nfrom detail_values\nwhere claim_type = 'institutional'\n)\n\n, institutional_claim_details as (\n    select distinct\n        d.encounter_id\n        , f.diagnosis_code_1\n        , f.diagnosis_code_type\n        , f.facility_id as facility_id\n        , f.drg_code_type\n        , f.drg_code as drg_code\n        , f.admit_source_code as admit_source_code\n        , f.admit_type_code as admit_type_code\n        , l.discharge_disposition_code as discharge_disposition_code\n        , d.patient_data_source_id\n        , d.data_source\n    from detail_values d\n    inner join first_last_inst_inst_values f on d.encounter_id = f.encounter_id\n    and\n    f.first_num =1 \n    inner join first_last_inst_inst_values l on d.encounter_id = l.encounter_id\n    and\n    l.last_num = 1 \n\n)\n\n, patient as (\n    select \n        patient_data_source_id\n        , birth_date\n        , gender\n        , race\n    from tuva.claims_preprocessing.encounters__stg_eligibility\n    where patient_row_num = 1\n    )\n\n, total_amounts as (\n    select \n    encounter_id\n    ,encounter_type\n    , encounter_group\n    , sum(paid_amount) as total_paid_amount\n    , sum(allowed_amount) as total_allowed_amount\n    , sum(charge_amount) as total_charge_amount\n    , count(distinct claim_id) as claim_count\n    , count(distinct(case when claim_type = 'institutional' then claim_id else null end))  as inst_claim_count\n    , count(distinct(case when claim_type = 'professional' then claim_id else null end))  as prof_claim_count\nfrom detail_values\ngroup by encounter_id\n,encounter_type\n, encounter_group\n\n)\n\n\n\n, service_category_flags as (\n    select distinct\n        d.encounter_id\n       ,max(case when scr.service_category_2 = 'lab' then 1 else 0 end) as lab_flag\n       ,max(case when scr.service_category_2 = 'ambulance' then 1 else 0 end) as ambulance_flag\n       ,max(case when scr.service_category_2 = 'durable medical equipment' then 1 else 0 end) as dme_flag\n       ,max(case when scr.service_category_2 = 'observation' then 1 else 0 end) as observation_flag\n       ,max(case when scr.service_category_2 = 'emergency department' then 1 else 0 end) as ed_flag\n       ,max(case when scr.service_category_2 = 'pharmacy' then 1 \n              else 0 end) as pharmacy_flag\n    from detail_values d\n    left join tuva.claims_preprocessing.service_category_grouper scr on d.claim_id = scr.claim_id \n    and\n    scr.claim_line_number = d.claim_line_number\n    group by d.encounter_id\n)\n\nselect\n  x.encounter_id\n, a.encounter_start_date\n, a.encounter_end_date\n, c.patient_data_source_id\n,tot.encounter_type\n,tot.encounter_group\n, datediff(\n        day,\n        birth_date,\n        encounter_end_date\n        )/365 as admit_age\n, e.gender\n, e.race\n, c.diagnosis_code_type as primary_diagnosis_code_type\n, c.diagnosis_code_1 as primary_diagnosis_code\n, coalesce(icd10cm.long_description, icd9cm.long_description) as primary_diagnosis_description\n, c.facility_id as facility_id\n, b.provider_organization_name as facility_name\n, b.primary_specialty_description as facility_type\n, sc.lab_flag\n, sc.dme_flag\n, sc.ambulance_flag\n, sc.pharmacy_flag\n, sc.observation_flag\n, sc.ed_flag\n, c.drg_code_type\n, c.drg_code\n, coalesce(msdrg.ms_drg_description, aprdrg.apr_drg_description) as drg_description\n, coalesce(msdrg.medical_surgical, aprdrg.medical_surgical) as medical_surgical\n, c.admit_source_code\n, h.admit_source_description\n, c.admit_type_code\n, i.admit_type_description\n, c.discharge_disposition_code\n, g.discharge_disposition_description\n, tot.total_paid_amount\n, tot.total_allowed_amount\n, tot.total_charge_amount\n, tot.claim_count\n, tot.inst_claim_count\n, tot.prof_claim_count\n, datediff(\n        day,\n        a.encounter_start_date,\n        a.encounter_end_date\n        ) as length_of_stay\n, case\n    when c.discharge_disposition_code = '20' then 1\n    else 0\n  end mortality_flag\n, c.data_source\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.inpatient_psych__start_end_dates a\ninner join encounter_cross_walk x on a.encounter_id = x.old_encounter_id\ninner join total_amounts tot on x.encounter_id = tot.encounter_id\ninner join service_category_flags sc on x.encounter_id = sc.encounter_id\nleft join institutional_claim_details c\n  on x.encounter_id = c.encounter_id\nleft join patient e\n  on c.patient_data_source_id = e.patient_data_source_id\nleft join tuva.terminology.provider b\n  on c.facility_id = b.npi\nleft join tuva.terminology.discharge_disposition g\n  on c.discharge_disposition_code = g.discharge_disposition_code\nleft join tuva.terminology.admit_source h\n  on c.admit_source_code = h.admit_source_code\nleft join tuva.terminology.admit_type i\n  on c.admit_type_code = i.admit_type_code\nleft join tuva.terminology.ms_drg msdrg\n  on c.drg_code_type = 'ms-drg'\n  and c.drg_code = msdrg.ms_drg_code\nleft join tuva.terminology.apr_drg aprdrg\n  on c.drg_code_type = 'apr-drg'\n  and c.drg_code = aprdrg.apr_drg_code\nleft join tuva.terminology.icd_10_cm icd10cm\n  on c.diagnosis_code_1 = icd10cm.icd_10_cm\n  and c.diagnosis_code_type = 'icd-10-cm'\nleft join tuva.terminology.icd_9_cm icd9cm\n  on c.diagnosis_code_1 = icd9cm.icd_9_cm\n  and c.diagnosis_code_type = 'icd-9-cm'", "relation_name": "tuva.claims_preprocessing.inpatient_psych__encounter_grain"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.175298Z", "completed_at": "2025-02-25T21:26:26.187493Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.188818Z", "completed_at": "2025-02-25T21:26:26.188823Z"}], "thread_id": "Thread-2", "execution_time": 0.02071666717529297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.inpatient_rehab__encounter_grain", "compiled": true, "compiled_code": "\n\nwith detail_values as (\n    select stg.*\n    ,cli.encounter_id\n    ,cli.old_encounter_id\n    ,ed.encounter_start_date\n    ,ed.encounter_end_date\n      ,cli.encounter_type\n    ,cli.encounter_group\n    from  tuva.claims_preprocessing.encounters__stg_medical_claim stg\n    inner join tuva.claims_preprocessing.encounters__combined_claim_line_crosswalk cli on stg.claim_id = cli.claim_id  --replace this ref with the deduped version when complete\n    and\n    stg.claim_line_number = cli.claim_line_number\n    and\n    cli.encounter_type = 'inpatient rehabilitation'\n    and\n    cli.claim_line_attribution_number = 1\n    inner join tuva.claims_preprocessing.inpatient_rehab__start_end_dates ed on cli.old_encounter_id = ed.encounter_id\n)\n\n,encounter_cross_walk as (\n  select distinct encounter_id\n  ,old_encounter_id\n  from detail_values\n)\n\n,first_last_inst_inst_values as (\nselect *\n,row_number() over (partition by encounter_id order by start_date, claim_id) as first_num\n,row_number() over (partition by encounter_id order by end_date desc, claim_id) as last_num\nfrom detail_values\nwhere claim_type = 'institutional'\n)\n\n, institutional_claim_details as (\n    select distinct\n        d.encounter_id\n        , f.diagnosis_code_1\n        , f.diagnosis_code_type\n        , f.facility_id as facility_id\n        , f.drg_code_type\n        , f.drg_code as drg_code\n        , f.admit_source_code as admit_source_code\n        , f.admit_type_code as admit_type_code\n        , l.discharge_disposition_code as discharge_disposition_code\n        , d.patient_data_source_id\n        , d.data_source\n    from detail_values d\n    inner join first_last_inst_inst_values f on d.encounter_id = f.encounter_id\n    and\n    f.first_num =1 \n    inner join first_last_inst_inst_values l on d.encounter_id = l.encounter_id\n    and\n    l.last_num = 1 \n\n)\n\n, patient as (\n    select \n        patient_data_source_id\n        , birth_date\n        , gender\n        , race\n    from tuva.claims_preprocessing.encounters__stg_eligibility\n    where patient_row_num = 1\n    )\n\n, total_amounts as (\n    select \n    encounter_id\n, encounter_group\n    ,encounter_type\n    , sum(paid_amount) as total_paid_amount\n    , sum(allowed_amount) as total_allowed_amount\n    , sum(charge_amount) as total_charge_amount\n    , count(distinct claim_id) as claim_count\n    , count(distinct(case when claim_type = 'institutional' then claim_id else null end))  as inst_claim_count\n    , count(distinct(case when claim_type = 'professional' then claim_id else null end))  as prof_claim_count\nfrom detail_values\ngroup by encounter_id\n,encounter_type\n, encounter_group\n\n)\n\n\n\n, service_category_flags as (\n    select distinct\n        d.encounter_id\n       ,max(case when scr.service_category_2 = 'lab' then 1 else 0 end) as lab_flag\n       ,max(case when scr.service_category_2 = 'ambulance' then 1 else 0 end) as ambulance_flag\n       ,max(case when scr.service_category_2 = 'durable medical equipment' then 1 else 0 end) as dme_flag\n       ,max(case when scr.service_category_2 = 'observation' then 1 else 0 end) as observation_flag\n       ,max(case when scr.service_category_2 = 'emergency department' then 1 else 0 end) as ed_flag\n       ,max(case when scr.service_category_2 = 'pharmacy' then 1 \n              else 0 end) as pharmacy_flag\n    from detail_values d\n    left join tuva.claims_preprocessing.service_category_grouper scr on d.claim_id = scr.claim_id \n    and\n    scr.claim_line_number = d.claim_line_number\n    group by d.encounter_id\n)\n\nselect\n  x.encounter_id\n, a.encounter_start_date\n, a.encounter_end_date\n, c.patient_data_source_id\n,tot.encounter_type\n,tot.encounter_group\n, datediff(\n        day,\n        birth_date,\n        encounter_end_date\n        )/365 as admit_age\n, e.gender\n, e.race\n, c.diagnosis_code_type as primary_diagnosis_code_type\n, c.diagnosis_code_1 as primary_diagnosis_code\n, coalesce(icd10cm.long_description, icd9cm.long_description) as primary_diagnosis_description\n, c.facility_id as facility_id\n, b.provider_organization_name as facility_name\n, b.primary_specialty_description as facility_type\n, sc.lab_flag\n, sc.dme_flag\n, sc.ambulance_flag\n, sc.pharmacy_flag\n, sc.observation_flag\n, sc.ed_flag\n, c.drg_code_type\n, c.drg_code\n, coalesce(msdrg.ms_drg_description, aprdrg.apr_drg_description) as drg_description\n, coalesce(msdrg.medical_surgical, aprdrg.medical_surgical) as medical_surgical\n, c.admit_source_code\n, h.admit_source_description\n, c.admit_type_code\n, i.admit_type_description\n, c.discharge_disposition_code\n, g.discharge_disposition_description\n, tot.total_paid_amount\n, tot.total_allowed_amount\n, tot.total_charge_amount\n, tot.claim_count\n, tot.inst_claim_count\n, tot.prof_claim_count\n, datediff(\n        day,\n        a.encounter_start_date,\n        a.encounter_end_date\n        ) as length_of_stay\n, case\n    when c.discharge_disposition_code = '20' then 1\n    else 0\n  end mortality_flag\n, c.data_source\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.inpatient_rehab__start_end_dates a\ninner join encounter_cross_walk x on a.encounter_id = x.old_encounter_id\ninner join total_amounts tot on x.encounter_id = tot.encounter_id\ninner join service_category_flags sc on x.encounter_id = sc.encounter_id\nleft join institutional_claim_details c\n  on x.encounter_id = c.encounter_id\nleft join patient e\n  on c.patient_data_source_id = e.patient_data_source_id\nleft join tuva.terminology.provider b\n  on c.facility_id = b.npi\nleft join tuva.terminology.discharge_disposition g\n  on c.discharge_disposition_code = g.discharge_disposition_code\nleft join tuva.terminology.admit_source h\n  on c.admit_source_code = h.admit_source_code\nleft join tuva.terminology.admit_type i\n  on c.admit_type_code = i.admit_type_code\nleft join tuva.terminology.ms_drg msdrg\n  on c.drg_code_type = 'ms-drg'\n  and c.drg_code = msdrg.ms_drg_code\nleft join tuva.terminology.apr_drg aprdrg\n  on c.drg_code_type = 'apr-drg'\n  and c.drg_code = aprdrg.apr_drg_code\nleft join tuva.terminology.icd_10_cm icd10cm\n  on c.diagnosis_code_1 = icd10cm.icd_10_cm\n  and c.diagnosis_code_type = 'icd-10-cm'\nleft join tuva.terminology.icd_9_cm icd9cm\n  on c.diagnosis_code_1 = icd9cm.icd_9_cm\n  and c.diagnosis_code_type = 'icd-9-cm'", "relation_name": "tuva.claims_preprocessing.inpatient_rehab__encounter_grain"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.182213Z", "completed_at": "2025-02-25T21:26:26.191235Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.192105Z", "completed_at": "2025-02-25T21:26:26.192109Z"}], "thread_id": "Thread-3", "execution_time": 0.010599851608276367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.inpatient_snf__encounter_grain", "compiled": true, "compiled_code": "\n\nwith detail_values as (\n    select stg.*\n    ,cli.encounter_id\n    ,cli.old_encounter_id\n    ,ed.encounter_start_date\n    ,ed.encounter_end_date\n      ,cli.encounter_type\n    ,cli.encounter_group\n    from  tuva.claims_preprocessing.encounters__stg_medical_claim stg\n    inner join tuva.claims_preprocessing.encounters__combined_claim_line_crosswalk cli on stg.claim_id = cli.claim_id  --replace this ref with the deduped version when complete\n    and\n    stg.claim_line_number = cli.claim_line_number\n    and\n    cli.encounter_type = 'inpatient skilled nursing'\n    and\n    cli.claim_line_attribution_number = 1\n    inner join tuva.claims_preprocessing.inpatient_snf__start_end_dates ed on cli.old_encounter_id = ed.encounter_id\n)\n\n,encounter_cross_walk as (\n  select distinct encounter_id\n  ,old_encounter_id\n  from detail_values\n)\n\n,first_last_inst_inst_values as (\nselect *\n,row_number() over (partition by encounter_id order by start_date, claim_id) as first_num\n,row_number() over (partition by encounter_id order by end_date desc, claim_id) as last_num\nfrom detail_values\nwhere claim_type = 'institutional'\n)\n\n, institutional_claim_details as (\n    select distinct\n        d.encounter_id\n        , f.diagnosis_code_1\n        , f.diagnosis_code_type\n        , f.facility_id as facility_id\n        , f.drg_code_type\n        , f.drg_code as drg_code\n        , f.admit_source_code as admit_source_code\n        , f.admit_type_code as admit_type_code\n        , l.discharge_disposition_code as discharge_disposition_code\n        , d.patient_data_source_id\n        , d.data_source\n    from detail_values d\n    inner join first_last_inst_inst_values f on d.encounter_id = f.encounter_id\n    and\n    f.first_num =1 \n    inner join first_last_inst_inst_values l on d.encounter_id = l.encounter_id\n    and\n    l.last_num = 1 \n\n)\n\n, patient as (\n    select \n        patient_data_source_id\n        , birth_date\n        , gender\n        , race\n    from tuva.claims_preprocessing.encounters__stg_eligibility\n    where patient_row_num = 1\n    )\n\n, total_amounts as (\n    select \n    encounter_id\n    ,encounter_type\n    , encounter_group\n    , sum(paid_amount) as total_paid_amount\n    , sum(allowed_amount) as total_allowed_amount\n    , sum(charge_amount) as total_charge_amount\n    , count(distinct claim_id) as claim_count\n    , count(distinct(case when claim_type = 'institutional' then claim_id else null end))  as inst_claim_count\n    , count(distinct(case when claim_type = 'professional' then claim_id else null end))  as prof_claim_count\nfrom detail_values\ngroup by encounter_id\n, encounter_type\n, encounter_group\n)\n\n\n\n, service_category_flags as (\n    select distinct\n        d.encounter_id\n       ,max(case when scr.service_category_2 = 'lab' then 1 else 0 end) as lab_flag\n       ,max(case when scr.service_category_2 = 'ambulance' then 1 else 0 end) as ambulance_flag\n       ,max(case when scr.service_category_2 = 'durable medical equipment' then 1 else 0 end) as dme_flag\n       ,max(case when scr.service_category_2 = 'observation' then 1 else 0 end) as observation_flag\n       ,max(case when scr.service_category_2 = 'emergency department' then 1 else 0 end) as ed_flag\n       ,max(case when scr.service_category_2 = 'pharmacy' then 1 \n              else 0 end) as pharmacy_flag\n    from detail_values d\n    left join tuva.claims_preprocessing.service_category_grouper scr on d.claim_id = scr.claim_id \n    and\n    scr.claim_line_number = d.claim_line_number\n    group by d.encounter_id\n)\n\nselect\n  x.encounter_id\n, a.encounter_start_date\n, a.encounter_end_date\n, c.patient_data_source_id\n,tot.encounter_type\n,tot.encounter_group\n, datediff(\n        day,\n        birth_date,\n        encounter_end_date\n        )/365 as admit_age\n, e.gender\n, e.race\n, c.diagnosis_code_type as primary_diagnosis_code_type\n, c.diagnosis_code_1 as primary_diagnosis_code\n, coalesce(icd10cm.long_description, icd9cm.long_description) as primary_diagnosis_description\n, c.facility_id as facility_id\n, b.provider_organization_name as facility_name\n, b.primary_specialty_description as facility_type\n, sc.lab_flag\n, sc.dme_flag\n, sc.ambulance_flag\n, sc.pharmacy_flag\n, sc.observation_flag\n, sc.ed_flag\n, c.drg_code_type\n, c.drg_code\n, coalesce(msdrg.ms_drg_description, aprdrg.apr_drg_description) as drg_description\n, coalesce(msdrg.medical_surgical, aprdrg.medical_surgical) as medical_surgical\n, c.admit_source_code\n, h.admit_source_description\n, c.admit_type_code\n, i.admit_type_description\n, c.discharge_disposition_code\n, g.discharge_disposition_description\n, tot.total_paid_amount\n, tot.total_allowed_amount\n, tot.total_charge_amount\n, tot.claim_count\n, tot.inst_claim_count\n, tot.prof_claim_count\n, datediff(\n        day,\n        a.encounter_start_date,\n        a.encounter_end_date\n        ) as length_of_stay\n, case\n    when c.discharge_disposition_code = '20' then 1\n    else 0\n  end mortality_flag\n, c.data_source\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.inpatient_snf__start_end_dates a\ninner join encounter_cross_walk x on a.encounter_id = x.old_encounter_id\ninner join total_amounts tot on x.encounter_id = tot.encounter_id\ninner join service_category_flags sc on x.encounter_id = sc.encounter_id\nleft join institutional_claim_details c\n  on x.encounter_id = c.encounter_id\nleft join patient e\n  on c.patient_data_source_id = e.patient_data_source_id\nleft join tuva.terminology.provider b\n  on c.facility_id = b.npi\nleft join tuva.terminology.discharge_disposition g\n  on c.discharge_disposition_code = g.discharge_disposition_code\nleft join tuva.terminology.admit_source h\n  on c.admit_source_code = h.admit_source_code\nleft join tuva.terminology.admit_type i\n  on c.admit_type_code = i.admit_type_code\nleft join tuva.terminology.ms_drg msdrg\n  on c.drg_code_type = 'ms-drg'\n  and c.drg_code = msdrg.ms_drg_code\nleft join tuva.terminology.apr_drg aprdrg\n  on c.drg_code_type = 'apr-drg'\n  and c.drg_code = aprdrg.apr_drg_code\nleft join tuva.terminology.icd_10_cm icd10cm\n  on c.diagnosis_code_1 = icd10cm.icd_10_cm\n  and c.diagnosis_code_type = 'icd-10-cm'\nleft join tuva.terminology.icd_9_cm icd9cm\n  on c.diagnosis_code_1 = icd9cm.icd_9_cm\n  and c.diagnosis_code_type = 'icd-9-cm'", "relation_name": "tuva.claims_preprocessing.inpatient_snf__encounter_grain"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.193306Z", "completed_at": "2025-02-25T21:26:26.211922Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.212455Z", "completed_at": "2025-02-25T21:26:26.212461Z"}], "thread_id": "Thread-1", "execution_time": 0.02109813690185547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.inpatient_substance_use__encounter_grain", "compiled": true, "compiled_code": "\n\nwith detail_values as (\n    select stg.*\n    ,cli.encounter_id\n    ,cli.old_encounter_id\n    ,ed.encounter_start_date\n    ,ed.encounter_end_date\n      ,cli.encounter_type\n    ,cli.encounter_group\n    from  tuva.claims_preprocessing.encounters__stg_medical_claim stg\n    inner join tuva.claims_preprocessing.encounters__combined_claim_line_crosswalk cli on stg.claim_id = cli.claim_id  --replace this ref with the deduped version when complete\n    and\n    stg.claim_line_number = cli.claim_line_number\n    and\n    cli.encounter_type = 'inpatient substance use'\n    and\n    cli.claim_line_attribution_number = 1\n    inner join tuva.claims_preprocessing.inpatient_substance_use__start_end_dates ed on cli.old_encounter_id = ed.encounter_id\n)\n\n,encounter_cross_walk as (\n  select distinct encounter_id\n  ,old_encounter_id\n  from detail_values\n)\n\n,first_last_inst_inst_values as (\nselect *\n,row_number() over (partition by encounter_id order by start_date, claim_id) as first_num\n,row_number() over (partition by encounter_id order by end_date desc, claim_id) as last_num\nfrom detail_values\nwhere claim_type = 'institutional'\n)\n\n, institutional_claim_details as (\n    select distinct\n        d.encounter_id\n        , f.diagnosis_code_1\n        , f.diagnosis_code_type\n        , f.facility_id as facility_id\n        , f.drg_code_type\n        , f.drg_code as drg_code\n        , f.admit_source_code as admit_source_code\n        , f.admit_type_code as admit_type_code\n        , l.discharge_disposition_code as discharge_disposition_code\n        , d.patient_data_source_id\n        , d.data_source\n    from detail_values d\n    inner join first_last_inst_inst_values f on d.encounter_id = f.encounter_id\n    and\n    f.first_num =1 \n    inner join first_last_inst_inst_values l on d.encounter_id = l.encounter_id\n    and\n    l.last_num = 1 \n\n)\n\n, patient as (\n    select \n        patient_data_source_id\n        , birth_date\n        , gender\n        , race\n    from tuva.claims_preprocessing.encounters__stg_eligibility\n    where patient_row_num = 1\n    )\n\n, total_amounts as (\n    select \n    encounter_id\n    , encounter_type\n    , encounter_group\n    , sum(paid_amount) as total_paid_amount\n    , sum(allowed_amount) as total_allowed_amount\n    , sum(charge_amount) as total_charge_amount\n    , count(distinct claim_id) as claim_count\n    , count(distinct(case when claim_type = 'institutional' then claim_id else null end))  as inst_claim_count\n    , count(distinct(case when claim_type = 'professional' then claim_id else null end))  as prof_claim_count\nfrom detail_values\ngroup by encounter_id\n, encounter_type\n, encounter_group\n\n)\n\n\n\n, service_category_flags as (\n    select distinct\n        d.encounter_id\n       ,max(case when scr.service_category_2 = 'lab' then 1 else 0 end) as lab_flag\n       ,max(case when scr.service_category_2 = 'ambulance' then 1 else 0 end) as ambulance_flag\n       ,max(case when scr.service_category_2 = 'durable medical equipment' then 1 else 0 end) as dme_flag\n       ,max(case when scr.service_category_2 = 'observation' then 1 else 0 end) as observation_flag\n       ,max(case when scr.service_category_2 = 'emergency department' then 1 else 0 end) as ed_flag\n       ,max(case when scr.service_category_2 = 'pharmacy' then 1 \n              else 0 end) as pharmacy_flag\n    from detail_values d\n    left join tuva.claims_preprocessing.service_category_grouper scr on d.claim_id = scr.claim_id \n    and\n    scr.claim_line_number = d.claim_line_number\n    group by d.encounter_id\n)\n\nselect\n  x.encounter_id\n, a.encounter_start_date\n, a.encounter_end_date\n, c.patient_data_source_id\n,tot.encounter_type\n,tot.encounter_group\n, datediff(\n        day,\n        birth_date,\n        encounter_end_date\n        )/365 as admit_age\n, e.gender\n, e.race\n, c.diagnosis_code_type as primary_diagnosis_code_type\n, c.diagnosis_code_1 as primary_diagnosis_code\n, coalesce(icd10cm.long_description, icd9cm.long_description) as primary_diagnosis_description\n, c.facility_id as facility_id\n, b.provider_organization_name as facility_name\n, b.primary_specialty_description as facility_type\n, sc.lab_flag\n, sc.dme_flag\n, sc.ambulance_flag\n, sc.pharmacy_flag\n, sc.observation_flag\n, sc.ed_flag\n, c.drg_code_type\n, c.drg_code\n, coalesce(msdrg.ms_drg_description, aprdrg.apr_drg_description) as drg_description\n, coalesce(msdrg.medical_surgical, aprdrg.medical_surgical) as medical_surgical\n, c.admit_source_code\n, h.admit_source_description\n, c.admit_type_code\n, i.admit_type_description\n, c.discharge_disposition_code\n, g.discharge_disposition_description\n, tot.total_paid_amount\n, tot.total_allowed_amount\n, tot.total_charge_amount\n, tot.claim_count\n, tot.inst_claim_count\n, tot.prof_claim_count\n, datediff(\n        day,\n        a.encounter_start_date,\n        a.encounter_end_date\n        ) as length_of_stay\n, case\n    when c.discharge_disposition_code = '20' then 1\n    else 0\n  end mortality_flag\n, c.data_source\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.claims_preprocessing.inpatient_substance_use__start_end_dates a\ninner join encounter_cross_walk x on a.encounter_id = x.old_encounter_id\ninner join total_amounts tot on x.encounter_id = tot.encounter_id\ninner join service_category_flags sc on x.encounter_id = sc.encounter_id\nleft join institutional_claim_details c\n  on x.encounter_id = c.encounter_id\nleft join patient e\n  on c.patient_data_source_id = e.patient_data_source_id\nleft join tuva.terminology.provider b\n  on c.facility_id = b.npi\nleft join tuva.terminology.discharge_disposition g\n  on c.discharge_disposition_code = g.discharge_disposition_code\nleft join tuva.terminology.admit_source h\n  on c.admit_source_code = h.admit_source_code\nleft join tuva.terminology.admit_type i\n  on c.admit_type_code = i.admit_type_code\nleft join tuva.terminology.ms_drg msdrg\n  on c.drg_code_type = 'ms-drg'\n  and c.drg_code = msdrg.ms_drg_code\nleft join tuva.terminology.apr_drg aprdrg\n  on c.drg_code_type = 'apr-drg'\n  and c.drg_code = aprdrg.apr_drg_code\nleft join tuva.terminology.icd_10_cm icd10cm\n  on c.diagnosis_code_1 = icd10cm.icd_10_cm\n  and c.diagnosis_code_type = 'icd-10-cm'\nleft join tuva.terminology.icd_9_cm icd9cm\n  on c.diagnosis_code_1 = icd9cm.icd_9_cm\n  and c.diagnosis_code_type = 'icd-9-cm'", "relation_name": "tuva.claims_preprocessing.inpatient_substance_use__encounter_grain"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.199321Z", "completed_at": "2025-02-25T21:26:26.212134Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.213065Z", "completed_at": "2025-02-25T21:26:26.213068Z"}], "thread_id": "Thread-2", "execution_time": 0.02144908905029297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.lab__encounter_grain", "compiled": true, "compiled_code": "\n\nwith encounter_date as (\n  select distinct old_encounter_id\n  ,start_date as encounter_start_date\n  from tuva.claims_preprocessing.lab__generate_encounter_id\n)\n\n,detail_values as (\n    select stg.*\n    ,cli.encounter_id\n    ,cli.old_encounter_id\n      ,cli.encounter_type\n    ,cli.encounter_group\n    ,d.encounter_start_date \n    , row_number() over (partition by cli.encounter_id order by stg.claim_type, stg.start_date) as encounter_row_number --institutional then professional\n    from  tuva.claims_preprocessing.encounters__stg_medical_claim stg\n    inner join tuva.claims_preprocessing.encounters__combined_claim_line_crosswalk cli on stg.claim_id = cli.claim_id  \n    and\n    stg.claim_line_number = cli.claim_line_number\n    and\n    cli.encounter_type = 'lab - orphaned'\n    and\n    cli.claim_line_attribution_number = 1\n    inner join encounter_date d on cli.old_encounter_id = d.old_encounter_id\n)\n\n, patient as (\n    select \n        patient_data_source_id\n        , birth_date\n        , gender\n        , race\n    from tuva.claims_preprocessing.encounters__stg_eligibility\n    where patient_row_num = 1\n    )\n\n, total_amounts as (\n    select \n    encounter_id\n    , encounter_type\n    , encounter_group\n    , sum(paid_amount) as total_paid_amount\n    , sum(allowed_amount) as total_allowed_amount\n    , sum(charge_amount) as total_charge_amount\n    , count(distinct claim_id) as claim_count\n    , count(distinct(case when claim_type = 'institutional' then claim_id else null end))  as inst_claim_count\n    , count(distinct(case when claim_type = 'professional' then claim_id else null end))  as prof_claim_count\nfrom detail_values\ngroup by encounter_id\n,encounter_type \n,encounter_group\n)\n\n\n,highest_paid_diagnosis as \n(\n  select encounter_id\n  , diagnosis_code_1\n  , diagnosis_code_type\n  , row_number() over (partition by encounter_id order by sum(paid_amount) desc ) as paid_order\n  , sum(paid_amount) as paid_amount\n  from detail_values\n  where diagnosis_code_1 is not null\n  group by diagnosis_code_1\n  , encounter_id\n  , diagnosis_code_type\n)\n\n,highest_paid_facility as \n(\n  select encounter_id\n  , facility_id\n  , row_number() over (partition by encounter_id order by sum(paid_amount) desc ) as paid_order\n  , sum(paid_amount) as paid_amount\n  from detail_values\n  where facility_id is not null\n  group by \n   encounter_id\n  , facility_id\n)\n\n,highest_paid_pos as \n(\n  select encounter_id\n  , place_of_service_code\n  , place_of_service_description\n  , row_number() over (partition by encounter_id order by sum(paid_amount) desc ) as paid_order\n  , sum(paid_amount) as paid_amount\n  from detail_values\n  where place_of_service_code is not null\n  group by \n   encounter_id\n  , place_of_service_code\n  , place_of_service_description\n)\n\n\n\n\n, service_category_flags as (\n    select distinct\n        d.encounter_id\n       ,max(case when scr.service_category_2 = 'lab' then 1 else 0 end) as lab_flag\n       ,max(case when scr.service_category_2 = 'ambulance' then 1 else 0 end) as ambulance_flag\n       ,max(case when scr.service_category_2 = 'durable medical equipment' then 1 else 0 end) as dme_flag\n       ,max(case when scr.service_category_2 = 'outpatient pharmacy' then 1 \n                when scr.service_category_2 = 'office-based pharmacy' then 1 else 0 end) as pharmacy_flag\n    from detail_values d\n    left join tuva.claims_preprocessing.service_category_grouper scr on d.claim_id = scr.claim_id \n    and\n    scr.claim_line_number = d.claim_line_number\n    group by d.encounter_id\n)\n\n\n\nselect   d.encounter_id\n, d.encounter_start_date\n, d.patient_data_source_id\n\n,tot.encounter_type\n,tot.encounter_group\n, datediff(\n        day,\n        birth_date,\n        d.encounter_start_date\n        )/365 as admit_age\n, e.gender\n, e.race\n, hp.diagnosis_code_type as primary_diagnosis_code_type\n, hp.diagnosis_code_1 as primary_diagnosis_code\n, coalesce(icd10cm.long_description, icd9cm.long_description) as primary_diagnosis_description\n, hf.facility_id as facility_id\n, b.provider_organization_name as facility_name\n, b.primary_specialty_description as facility_type\n, sc.lab_flag\n, sc.dme_flag\n, sc.ambulance_flag\n, sc.pharmacy_flag\n, pos.place_of_service_code\n, pos.place_of_service_description\n, tot.total_paid_amount\n, tot.total_allowed_amount\n, tot.total_charge_amount\n, tot.claim_count\n, tot.inst_claim_count\n, tot.prof_claim_count\n, d.data_source\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom detail_values d\ninner join total_amounts tot on d.encounter_id = tot.encounter_id\ninner join service_category_flags sc on d.encounter_id = sc.encounter_id\nleft join highest_paid_diagnosis hp on d.encounter_id = hp.encounter_id\nand\nhp.paid_order = 1\nleft join highest_paid_facility hf on d.encounter_id = hf.encounter_id\nand\nhf.paid_order = 1\nleft join highest_paid_pos pos on d.encounter_id = pos.encounter_id\nand\npos.paid_order = 1\nleft join patient e\n  on d.patient_data_source_id = e.patient_data_source_id\nleft join tuva.terminology.provider b\n  on hf.facility_id = b.npi\nleft join tuva.terminology.icd_10_cm icd10cm\n  on hp.diagnosis_code_1 = icd10cm.icd_10_cm\n  and hp.diagnosis_code_type = 'icd-10-cm'\nleft join tuva.terminology.icd_9_cm icd9cm\n  on hp.diagnosis_code_1 = icd9cm.icd_9_cm\n  and hp.diagnosis_code_type = 'icd-9-cm'\nwhere d.encounter_row_number = 1", "relation_name": "tuva.claims_preprocessing.lab__encounter_grain"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.204845Z", "completed_at": "2025-02-25T21:26:26.213401Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.214216Z", "completed_at": "2025-02-25T21:26:26.214220Z"}], "thread_id": "Thread-3", "execution_time": 0.010283946990966797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.office_visit__encounter_grain", "compiled": true, "compiled_code": "\n\nwith encounter_date as (\n  select distinct old_encounter_id\n  ,start_date as encounter_start_date\n  ,'office visit surgery' as encounter_type\n  from tuva.claims_preprocessing.office_visits__int_office_visits_surgery\n\n  union all\n\nselect distinct old_encounter_id\n  ,start_date as encounter_start_date\n  ,'office visit injections' as encounter_type\n  from tuva.claims_preprocessing.office_visits__int_office_visits_injections\n\n  union all \n\nselect distinct old_encounter_id\n  ,start_date as encounter_start_date\n  ,'office visit radiology' as encounter_type\n  from tuva.claims_preprocessing.office_visits__int_office_visits_radiology\n\n  union all\n\nselect distinct old_encounter_id\n  ,start_date as encounter_start_date\n  ,'office visit - other' as encounter_type\n  from tuva.claims_preprocessing.office_visits__int_office_visits\n\n  union all \n\nselect distinct old_encounter_id\n  ,start_date as encounter_start_date\n  ,'office visit' as encounter_type\n  from tuva.claims_preprocessing.office_visits__int_office_visits_em\n\n  union all \n\nselect distinct old_encounter_id\n  ,start_date as encounter_start_date\n  ,'telehealth' as encounter_type\n  from tuva.claims_preprocessing.office_visits__int_office_visits_telehealth\n\n  union all \n\nselect distinct old_encounter_id\n  ,start_date as encounter_start_date\n  ,'office visit pt/ot/st' as encounter_type\n  from tuva.claims_preprocessing.office_visits__int_office_visits\n)\n\n,detail_values as (\n    select stg.*\n    ,cli.encounter_id\n    ,cli.old_encounter_id\n      ,cli.encounter_type\n    ,cli.encounter_group\n    ,d.encounter_start_date \n    , row_number() over (partition by cli.encounter_id order by stg.claim_type, stg.start_date) as encounter_row_number --institutional then professional\n    from  tuva.claims_preprocessing.encounters__stg_medical_claim stg\n    inner join tuva.claims_preprocessing.encounters__combined_claim_line_crosswalk cli on stg.claim_id = cli.claim_id  \n    and\n    stg.claim_line_number = cli.claim_line_number\n    and\n    cli.encounter_group = 'office based'\n    and\n    cli.claim_line_attribution_number = 1\n    inner join encounter_date d on cli.old_encounter_id = d.old_encounter_id\n    and\n    d.encounter_type = cli.encounter_type\n)\n\n, patient as (\n    select \n        patient_data_source_id\n        , birth_date\n        , gender\n        , race\n    from tuva.claims_preprocessing.encounters__stg_eligibility\n    where patient_row_num = 1\n    )\n\n, total_amounts as (\n    select \n    encounter_id\n    , encounter_type\n    , encounter_group\n    , sum(paid_amount) as total_paid_amount\n    , sum(allowed_amount) as total_allowed_amount\n    , sum(charge_amount) as total_charge_amount\n    , count(distinct claim_id) as claim_count\n    , count(distinct(case when claim_type = 'institutional' then claim_id else null end))  as inst_claim_count\n    , count(distinct(case when claim_type = 'professional' then claim_id else null end))  as prof_claim_count\nfrom detail_values\ngroup by encounter_id\n,encounter_type \n,encounter_group\n)\n\n\n,highest_paid_diagnosis as \n(\n  select encounter_id\n  , diagnosis_code_1\n  , diagnosis_code_type\n  , row_number() over (partition by encounter_id order by sum(paid_amount) desc ) as paid_order\n  , sum(paid_amount) as paid_amount\n  from detail_values\n  where diagnosis_code_1 is not null\n  group by diagnosis_code_1\n  , encounter_id\n  , diagnosis_code_type\n)\n\n,highest_paid_facility as \n(\n  select encounter_id\n  , facility_id\n  , row_number() over (partition by encounter_id order by sum(paid_amount) desc ) as paid_order\n  , sum(paid_amount) as paid_amount\n  from detail_values\n  where facility_id is not null\n  group by \n   encounter_id\n  , facility_id\n)\n\n,highest_paid_physician as \n(\n  select encounter_id\n  , billing_id\n  , row_number() over (partition by encounter_id order by sum(paid_amount) desc ) as paid_order\n  , sum(paid_amount) as paid_amount\n  from detail_values\n  where billing_id is not null\n  group by \n   encounter_id\n  , billing_id\n)\n\n,highest_paid_hcpc as \n(\n  select encounter_id\n  , hcpcs_code\n  , ccs_category\n  , ccs_category_description\n  , row_number() over (partition by encounter_id order by sum(paid_amount) desc ) as paid_order\n  , sum(paid_amount) as paid_amount\n  from detail_values\n  where hcpcs_code is not null\n  group by \n   encounter_id\n  , hcpcs_code\n  , ccs_category\n  , ccs_category_description\n)\n\n\n\n, service_category_flags as (\n    select distinct\n        d.encounter_id\n       ,max(case when scr.service_category_2 = 'lab' then 1 else 0 end) as lab_flag\n       ,max(case when scr.service_category_2 = 'ambulance' then 1 else 0 end) as ambulance_flag\n       ,max(case when scr.service_category_2 = 'durable medical equipment' then 1 else 0 end) as dme_flag\n       ,max(case when scr.service_category_2 = 'observation' then 1 else 0 end) as observation_flag\n       ,max(case when scr.service_category_2 = 'pharmacy' then 1 \n              else 0 end) as pharmacy_flag\n    from detail_values d\n    left join tuva.claims_preprocessing.service_category_grouper scr on d.claim_id = scr.claim_id \n    and\n    scr.claim_line_number = d.claim_line_number\n    group by d.encounter_id\n)\n\n\nselect   d.encounter_id\n, d.encounter_start_date\n, d.patient_data_source_id\n\n,tot.encounter_type\n,tot.encounter_group\n, datediff(\n        day,\n        birth_date,\n        d.encounter_start_date\n        )/365 as admit_age\n, e.gender\n, e.race\n, hp.diagnosis_code_type as primary_diagnosis_code_type\n, hp.diagnosis_code_1 as primary_diagnosis_code\n, coalesce(icd10cm.long_description, icd9cm.long_description) as primary_diagnosis_description\n, hf.facility_id as facility_id\n, b.provider_organization_name as facility_name\n, phy.billing_id\n, b2.provider_first_name || ' ' || b2.provider_last_name as provider_name\n, b2.primary_specialty_description as provider_specialty\n, sc.lab_flag\n, sc.dme_flag\n, sc.ambulance_flag\n, sc.pharmacy_flag\n, hcpc.hcpcs_code\n, hcpc.ccs_category\n, hcpc.ccs_category_description\n, tot.total_paid_amount\n, tot.total_allowed_amount\n, tot.total_charge_amount\n, tot.claim_count\n, tot.inst_claim_count\n, tot.prof_claim_count\n, d.data_source\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom detail_values d\ninner join total_amounts tot on d.encounter_id = tot.encounter_id\ninner join service_category_flags sc on d.encounter_id = sc.encounter_id\nleft join highest_paid_diagnosis hp on d.encounter_id = hp.encounter_id\nand\nhp.paid_order = 1\nleft join highest_paid_facility hf on d.encounter_id = hf.encounter_id\nand\nhf.paid_order = 1\nleft join highest_paid_physician phy on d.encounter_id = phy.encounter_id\nand\nphy.paid_order = 1\nleft join highest_paid_hcpc hcpc on d.encounter_id = hcpc.encounter_id\nand\nhcpc.paid_order = 1\nleft join patient e\n  on d.patient_data_source_id = e.patient_data_source_id\nleft join tuva.terminology.provider b\n  on hf.facility_id = b.npi\nleft join tuva.terminology.provider b2\n  on phy.billing_id = b2.npi\nleft join tuva.terminology.icd_10_cm icd10cm\n  on hp.diagnosis_code_1 = icd10cm.icd_10_cm\n  and hp.diagnosis_code_type = 'icd-10-cm'\nleft join tuva.terminology.icd_9_cm icd9cm\n  on hp.diagnosis_code_1 = icd9cm.icd_9_cm\n  and hp.diagnosis_code_type = 'icd-9-cm'\nwhere d.encounter_row_number = 1", "relation_name": "tuva.claims_preprocessing.office_visit__encounter_grain"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.220757Z", "completed_at": "2025-02-25T21:26:26.230468Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.230921Z", "completed_at": "2025-02-25T21:26:26.230927Z"}], "thread_id": "Thread-2", "execution_time": 0.01618504524230957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.outpatient_hospital_or_clinic__encounter_grain", "compiled": true, "compiled_code": "\n\nwith encounter_date as (\n  select distinct old_encounter_id\n  ,start_date as encounter_start_date\n  from tuva.claims_preprocessing.outpatient_hospital_or_clinic__generate_encounter_id\n)\n\n,detail_values as (\n    select stg.*\n    ,cli.encounter_id\n    ,cli.old_encounter_id\n      ,cli.encounter_type\n    ,cli.encounter_group\n    ,d.encounter_start_date \n    , row_number() over (partition by cli.encounter_id order by stg.claim_type, stg.start_date) as encounter_row_number --institutional then professional\n    from  tuva.claims_preprocessing.encounters__stg_medical_claim stg\n    inner join tuva.claims_preprocessing.encounters__combined_claim_line_crosswalk cli on stg.claim_id = cli.claim_id  \n    and\n    stg.claim_line_number = cli.claim_line_number\n    and\n    cli.encounter_type = 'outpatient hospital or clinic'\n    and\n    cli.claim_line_attribution_number = 1\n    inner join encounter_date d on cli.old_encounter_id = d.old_encounter_id\n)\n\n, patient as (\n    select \n        patient_data_source_id\n        , birth_date\n        , gender\n        , race\n    from tuva.claims_preprocessing.encounters__stg_eligibility\n    where patient_row_num = 1\n    )\n\n, total_amounts as (\n    select \n    encounter_id\n    , encounter_type\n    , encounter_group\n    , sum(paid_amount) as total_paid_amount\n    , sum(allowed_amount) as total_allowed_amount\n    , sum(charge_amount) as total_charge_amount\n    , count(distinct claim_id) as claim_count\n    , count(distinct(case when claim_type = 'institutional' then claim_id else null end))  as inst_claim_count\n    , count(distinct(case when claim_type = 'professional' then claim_id else null end))  as prof_claim_count\nfrom detail_values\ngroup by encounter_id\n,encounter_type \n,encounter_group\n)\n\n\n,highest_paid_diagnosis as \n(\n  select encounter_id\n  , diagnosis_code_1\n  , diagnosis_code_type\n  , row_number() over (partition by encounter_id order by sum(paid_amount) desc ) as paid_order\n  , sum(paid_amount) as paid_amount\n  from detail_values\n  where diagnosis_code_1 is not null\n  group by diagnosis_code_1\n  , encounter_id\n  , diagnosis_code_type\n)\n\n,highest_paid_facility as \n(\n  select encounter_id\n  , facility_id\n  , row_number() over (partition by encounter_id order by sum(paid_amount) desc ) as paid_order\n  , sum(paid_amount) as paid_amount\n  from detail_values\n  where facility_id is not null\n  group by \n   encounter_id\n  , facility_id\n)\n\n\n\n, service_category_flags as (\n    select distinct\n        d.encounter_id\n       ,max(case when scr.service_category_2 = 'lab' then 1 else 0 end) as lab_flag\n       ,max(case when scr.service_category_2 = 'ambulance' then 1 else 0 end) as ambulance_flag\n       ,max(case when scr.service_category_2 = 'durable medical equipment' then 1 else 0 end) as dme_flag\n       ,max(case when scr.service_category_2 = 'observation' then 1 else 0 end) as observation_flag\n       ,max(case when scr.service_category_2 = 'pharmacy' then 1 \n              else 0 end) as pharmacy_flag\n    from detail_values d\n    left join tuva.claims_preprocessing.service_category_grouper scr on d.claim_id = scr.claim_id \n    and\n    scr.claim_line_number = d.claim_line_number\n    group by d.encounter_id\n)\n\n\nselect   d.encounter_id\n, d.encounter_start_date\n, d.patient_data_source_id\n\n,tot.encounter_type\n,tot.encounter_group\n, datediff(\n        day,\n        birth_date,\n        d.encounter_start_date\n        )/365 as admit_age\n, e.gender\n, e.race\n, hp.diagnosis_code_type as primary_diagnosis_code_type\n, hp.diagnosis_code_1 as primary_diagnosis_code\n, coalesce(icd10cm.long_description, icd9cm.long_description) as primary_diagnosis_description\n, hf.facility_id as facility_id\n, b.provider_organization_name as facility_name\n, b.primary_specialty_description as facility_type\n, sc.lab_flag\n, sc.dme_flag\n, sc.ambulance_flag\n, sc.pharmacy_flag, sc.observation_flag\n, tot.total_paid_amount\n, tot.total_allowed_amount\n, tot.total_charge_amount\n, tot.claim_count\n, tot.inst_claim_count\n, tot.prof_claim_count\n, d.data_source\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom detail_values d\ninner join total_amounts tot on d.encounter_id = tot.encounter_id\ninner join service_category_flags sc on d.encounter_id = sc.encounter_id\nleft join highest_paid_diagnosis hp on d.encounter_id = hp.encounter_id\nand\nhp.paid_order = 1\nleft join highest_paid_facility hf on d.encounter_id = hf.encounter_id\nand\nhf.paid_order = 1\nleft join patient e\n  on d.patient_data_source_id = e.patient_data_source_id\nleft join tuva.terminology.provider b\n  on hf.facility_id = b.npi\nleft join tuva.terminology.icd_10_cm icd10cm\n  on hp.diagnosis_code_1 = icd10cm.icd_10_cm\n  and hp.diagnosis_code_type = 'icd-10-cm'\nleft join tuva.terminology.icd_9_cm icd9cm\n  on hp.diagnosis_code_1 = icd9cm.icd_9_cm\n  and hp.diagnosis_code_type = 'icd-9-cm'\nwhere d.encounter_row_number = 1", "relation_name": "tuva.claims_preprocessing.outpatient_hospital_or_clinic__encounter_grain"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.215884Z", "completed_at": "2025-02-25T21:26:26.230704Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.231317Z", "completed_at": "2025-02-25T21:26:26.231321Z"}], "thread_id": "Thread-1", "execution_time": 0.01679515838623047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.outpatient_hospice__encounter_grain", "compiled": true, "compiled_code": "\n\nwith encounter_date as (\n  select distinct old_encounter_id\n  ,start_date as encounter_start_date\n  from tuva.claims_preprocessing.outpatient_hospice__generate_encounter_id\n)\n\n,detail_values as (\n    select stg.*\n    ,cli.encounter_id\n    ,cli.old_encounter_id\n      ,cli.encounter_type\n    ,cli.encounter_group\n    ,d.encounter_start_date \n    , row_number() over (partition by cli.encounter_id order by stg.claim_type, stg.start_date) as encounter_row_number --institutional then professional\n    from  tuva.claims_preprocessing.encounters__stg_medical_claim stg\n    inner join tuva.claims_preprocessing.encounters__combined_claim_line_crosswalk cli on stg.claim_id = cli.claim_id  \n    and\n    stg.claim_line_number = cli.claim_line_number\n    and\n    cli.encounter_type = 'outpatient hospice'\n    and\n    cli.claim_line_attribution_number = 1\n    inner join encounter_date d on cli.old_encounter_id = d.old_encounter_id\n)\n\n, patient as (\n    select \n        patient_data_source_id\n        , birth_date\n        , gender\n        , race\n    from tuva.claims_preprocessing.encounters__stg_eligibility\n    where patient_row_num = 1\n    )\n\n, total_amounts as (\n    select \n    encounter_id\n    , encounter_type\n    , encounter_group\n    , sum(paid_amount) as total_paid_amount\n    , sum(allowed_amount) as total_allowed_amount\n    , sum(charge_amount) as total_charge_amount\n    , count(distinct claim_id) as claim_count\n    , count(distinct(case when claim_type = 'institutional' then claim_id else null end))  as inst_claim_count\n    , count(distinct(case when claim_type = 'professional' then claim_id else null end))  as prof_claim_count\nfrom detail_values\ngroup by encounter_id\n,encounter_type \n,encounter_group\n)\n\n\n,highest_paid_diagnosis as \n(\n  select encounter_id\n  , diagnosis_code_1\n  , diagnosis_code_type\n  , row_number() over (partition by encounter_id order by sum(paid_amount) desc ) as paid_order\n  , sum(paid_amount) as paid_amount\n  from detail_values\n  where diagnosis_code_1 is not null\n  group by diagnosis_code_1\n  , encounter_id\n  , diagnosis_code_type\n)\n\n,highest_paid_facility as \n(\n  select encounter_id\n  , facility_id\n  , row_number() over (partition by encounter_id order by sum(paid_amount) desc ) as paid_order\n  , sum(paid_amount) as paid_amount\n  from detail_values\n  where facility_id is not null\n  group by \n   encounter_id\n  , facility_id\n)\n\n\n\n, service_category_flags as (\n    select distinct\n        d.encounter_id\n       ,max(case when scr.service_category_2 = 'lab' then 1 else 0 end) as lab_flag\n       ,max(case when scr.service_category_2 = 'ambulance' then 1 else 0 end) as ambulance_flag\n       ,max(case when scr.service_category_2 = 'durable medical equipment' then 1 else 0 end) as dme_flag\n       ,max(case when scr.service_category_2 = 'observation' then 1 else 0 end) as observation_flag\n       ,max(case when scr.service_category_2 = 'pharmacy' then 1 \n              else 0 end) as pharmacy_flag\n    from detail_values d\n    left join tuva.claims_preprocessing.service_category_grouper scr on d.claim_id = scr.claim_id \n    and\n    scr.claim_line_number = d.claim_line_number\n    group by d.encounter_id\n)\n\n\nselect   d.encounter_id\n, d.encounter_start_date\n, d.patient_data_source_id\n, tot.encounter_type\n, tot.encounter_group\n, datediff(\n        day,\n        birth_date,\n        d.encounter_start_date\n        )/365 as admit_age\n, e.gender\n, e.race\n, hp.diagnosis_code_type as primary_diagnosis_code_type\n, hp.diagnosis_code_1 as primary_diagnosis_code\n, coalesce(icd10cm.long_description, icd9cm.long_description) as primary_diagnosis_description\n, hf.facility_id as facility_id\n, b.provider_organization_name as facility_name\n, b.primary_specialty_description as facility_type\n, sc.lab_flag\n, sc.dme_flag\n, sc.ambulance_flag\n, sc.pharmacy_flag\n, sc.observation_flag\n, tot.total_paid_amount\n, tot.total_allowed_amount\n, tot.total_charge_amount\n, tot.claim_count\n, tot.inst_claim_count\n, tot.prof_claim_count\n, d.data_source\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom detail_values d\ninner join total_amounts tot on d.encounter_id = tot.encounter_id\ninner join service_category_flags sc on d.encounter_id = sc.encounter_id\nleft join highest_paid_diagnosis hp on d.encounter_id = hp.encounter_id\nand\nhp.paid_order = 1\nleft join highest_paid_facility hf on d.encounter_id = hf.encounter_id\nand\nhf.paid_order = 1\nleft join patient e\n  on d.patient_data_source_id = e.patient_data_source_id\nleft join tuva.terminology.provider b\n  on hf.facility_id = b.npi\nleft join tuva.terminology.icd_10_cm icd10cm\n  on hp.diagnosis_code_1 = icd10cm.icd_10_cm\n  and hp.diagnosis_code_type = 'icd-10-cm'\nleft join tuva.terminology.icd_9_cm icd9cm\n  on hp.diagnosis_code_1 = icd9cm.icd_9_cm\n  and hp.diagnosis_code_type = 'icd-9-cm'\nwhere d.encounter_row_number = 1", "relation_name": "tuva.claims_preprocessing.outpatient_hospice__encounter_grain"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.225603Z", "completed_at": "2025-02-25T21:26:26.231939Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.232592Z", "completed_at": "2025-02-25T21:26:26.232596Z"}], "thread_id": "Thread-3", "execution_time": 0.0169827938079834, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.outpatient_injections__encounter_grain", "compiled": true, "compiled_code": "\n\nwith encounter_date as (\n  select distinct old_encounter_id\n  ,start_date as encounter_start_date\n  from tuva.claims_preprocessing.outpatient_injections__generate_encounter_id\n)\n\n,detail_values as (\n    select stg.*\n    ,cli.encounter_id\n    ,cli.old_encounter_id\n      ,cli.encounter_type\n    ,cli.encounter_group\n    ,d.encounter_start_date \n    , row_number() over (partition by cli.encounter_id order by stg.claim_type, stg.start_date) as encounter_row_number --institutional then professional\n    from  tuva.claims_preprocessing.encounters__stg_medical_claim stg\n    inner join tuva.claims_preprocessing.encounters__combined_claim_line_crosswalk cli on stg.claim_id = cli.claim_id  \n    and\n    stg.claim_line_number = cli.claim_line_number\n    and\n    cli.encounter_type = 'outpatient injections'\n    and\n    cli.claim_line_attribution_number = 1\n    inner join encounter_date d on cli.old_encounter_id = d.old_encounter_id\n)\n\n, patient as (\n    select \n        patient_data_source_id\n        , birth_date\n        , gender\n        , race\n    from tuva.claims_preprocessing.encounters__stg_eligibility\n    where patient_row_num = 1\n    )\n\n, total_amounts as (\n    select \n    encounter_id\n    , encounter_type\n    , encounter_group\n    , sum(paid_amount) as total_paid_amount\n    , sum(allowed_amount) as total_allowed_amount\n    , sum(charge_amount) as total_charge_amount\n    , count(distinct claim_id) as claim_count\n    , count(distinct(case when claim_type = 'institutional' then claim_id else null end))  as inst_claim_count\n    , count(distinct(case when claim_type = 'professional' then claim_id else null end))  as prof_claim_count\nfrom detail_values\ngroup by encounter_id\n,encounter_type \n,encounter_group\n)\n\n\n,highest_paid_diagnosis as \n(\n  select encounter_id\n  , diagnosis_code_1\n  , diagnosis_code_type\n  , row_number() over (partition by encounter_id order by sum(paid_amount) desc ) as paid_order\n  , sum(paid_amount) as paid_amount\n  from detail_values\n  where diagnosis_code_1 is not null\n  group by diagnosis_code_1\n  , encounter_id\n  , diagnosis_code_type\n)\n\n,highest_paid_facility as \n(\n  select encounter_id\n  , facility_id\n  , row_number() over (partition by encounter_id order by sum(paid_amount) desc ) as paid_order\n  , sum(paid_amount) as paid_amount\n  from detail_values\n  where facility_id is not null\n  group by \n   encounter_id\n  , facility_id\n)\n\n,highest_paid_hcpc as \n(\n  select encounter_id\n  , hcpcs_code\n  , row_number() over (partition by encounter_id order by sum(paid_amount) desc ) as paid_order\n  , sum(paid_amount) as paid_amount\n  from detail_values\n  where substring(hcpcs_code,1,1)='J'\n\n  group by \n   encounter_id\n  , hcpcs_code\n)\n\n\n\n, service_category_flags as (\n    select distinct\n        d.encounter_id\n       ,max(case when scr.service_category_2 = 'lab' then 1 else 0 end) as lab_flag\n       ,max(case when scr.service_category_2 = 'ambulance' then 1 else 0 end) as ambulance_flag\n       ,max(case when scr.service_category_2 = 'durable medical equipment' then 1 else 0 end) as dme_flag\n       ,max(case when scr.service_category_2 = 'observation' then 1 else 0 end) as observation_flag\n       ,max(case when scr.service_category_2 = 'pharmacy' then 1 \n              else 0 end) as pharmacy_flag\n    from detail_values d\n    left join tuva.claims_preprocessing.service_category_grouper scr on d.claim_id = scr.claim_id \n    and\n    scr.claim_line_number = d.claim_line_number\n    group by d.encounter_id\n)\n\n\nselect   d.encounter_id\n, d.encounter_start_date\n, d.patient_data_source_id\n\n,tot.encounter_type\n,tot.encounter_group\n, datediff(\n        day,\n        birth_date,\n        d.encounter_start_date\n        )/365 as admit_age\n, e.gender\n, e.race\n, hp.diagnosis_code_type as primary_diagnosis_code_type\n, hp.diagnosis_code_1 as primary_diagnosis_code\n, coalesce(icd10cm.long_description, icd9cm.long_description) as primary_diagnosis_description\n, hf.facility_id as facility_id\n, b.provider_organization_name as facility_name\n, b.primary_specialty_description as facility_type\n, sc.lab_flag\n, sc.dme_flag\n, sc.ambulance_flag\n, sc.pharmacy_flag, sc.observation_flag\n, hcpc.hcpcs_code\n, tot.total_paid_amount\n, tot.total_allowed_amount\n, tot.total_charge_amount\n, tot.claim_count\n, tot.inst_claim_count\n, tot.prof_claim_count\n, d.data_source\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom detail_values d\ninner join total_amounts tot on d.encounter_id = tot.encounter_id\ninner join service_category_flags sc on d.encounter_id = sc.encounter_id\nleft join highest_paid_diagnosis hp on d.encounter_id = hp.encounter_id\nand\nhp.paid_order = 1\nleft join highest_paid_facility hf on d.encounter_id = hf.encounter_id\nand\nhf.paid_order = 1\nleft join highest_paid_hcpc hcpc on d.encounter_id = hcpc.encounter_id\nand\nhcpc.paid_order = 1\nleft join patient e\n  on d.patient_data_source_id = e.patient_data_source_id\nleft join tuva.terminology.provider b\n  on hf.facility_id = b.npi\nleft join tuva.terminology.icd_10_cm icd10cm\n  on hp.diagnosis_code_1 = icd10cm.icd_10_cm\n  and hp.diagnosis_code_type = 'icd-10-cm'\nleft join tuva.terminology.icd_9_cm icd9cm\n  on hp.diagnosis_code_1 = icd9cm.icd_9_cm\n  and hp.diagnosis_code_type = 'icd-9-cm'\nwhere d.encounter_row_number = 1", "relation_name": "tuva.claims_preprocessing.outpatient_injections__encounter_grain"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.233778Z", "completed_at": "2025-02-25T21:26:26.249215Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.249497Z", "completed_at": "2025-02-25T21:26:26.249505Z"}], "thread_id": "Thread-2", "execution_time": 0.017215967178344727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.outpatient_psych__encounter_grain", "compiled": true, "compiled_code": "\n\nwith encounter_date as (\n  select distinct old_encounter_id\n  ,start_date as encounter_start_date\n  from tuva.claims_preprocessing.outpatient_psych__generate_encounter_id\n)\n\n,detail_values as (\n    select stg.*\n    ,cli.encounter_id\n    ,cli.old_encounter_id\n      ,cli.encounter_type\n    ,cli.encounter_group\n    ,d.encounter_start_date \n    , row_number() over (partition by cli.encounter_id order by stg.claim_type, stg.start_date) as encounter_row_number --institutional then professional\n    from  tuva.claims_preprocessing.encounters__stg_medical_claim stg\n    inner join tuva.claims_preprocessing.encounters__combined_claim_line_crosswalk cli on stg.claim_id = cli.claim_id  \n    and\n    stg.claim_line_number = cli.claim_line_number\n    and\n    cli.encounter_type = 'outpatient psych'\n    and\n    cli.claim_line_attribution_number = 1\n    inner join encounter_date d on cli.old_encounter_id = d.old_encounter_id\n)\n\n, patient as (\n    select \n        patient_data_source_id\n        , birth_date\n        , gender\n        , race\n    from tuva.claims_preprocessing.encounters__stg_eligibility\n    where patient_row_num = 1\n    )\n\n, total_amounts as (\n    select \n    encounter_id\n    , encounter_type\n    , encounter_group\n    , sum(paid_amount) as total_paid_amount\n    , sum(allowed_amount) as total_allowed_amount\n    , sum(charge_amount) as total_charge_amount\n    , count(distinct claim_id) as claim_count\n    , count(distinct(case when claim_type = 'institutional' then claim_id else null end))  as inst_claim_count\n    , count(distinct(case when claim_type = 'professional' then claim_id else null end))  as prof_claim_count\nfrom detail_values\ngroup by encounter_id\n,encounter_type \n,encounter_group\n)\n\n\n,highest_paid_diagnosis as \n(\n  select encounter_id\n  , diagnosis_code_1\n  , diagnosis_code_type\n  , row_number() over (partition by encounter_id order by sum(paid_amount) desc ) as paid_order\n  , sum(paid_amount) as paid_amount\n  from detail_values\n  where diagnosis_code_1 is not null\n  group by diagnosis_code_1\n  , encounter_id\n  , diagnosis_code_type\n)\n\n,highest_paid_facility as \n(\n  select encounter_id\n  , facility_id\n  , row_number() over (partition by encounter_id order by sum(paid_amount) desc ) as paid_order\n  , sum(paid_amount) as paid_amount\n  from detail_values\n  where facility_id is not null\n  group by \n   encounter_id\n  , facility_id\n)\n\n\n\n, service_category_flags as (\n    select distinct\n        d.encounter_id\n       ,max(case when scr.service_category_2 = 'lab' then 1 else 0 end) as lab_flag\n       ,max(case when scr.service_category_2 = 'ambulance' then 1 else 0 end) as ambulance_flag\n       ,max(case when scr.service_category_2 = 'durable medical equipment' then 1 else 0 end) as dme_flag\n       ,max(case when scr.service_category_2 = 'observation' then 1 else 0 end) as observation_flag\n       ,max(case when scr.service_category_2 = 'pharmacy' then 1 \n              else 0 end) as pharmacy_flag\n    from detail_values d\n    left join tuva.claims_preprocessing.service_category_grouper scr on d.claim_id = scr.claim_id \n    and\n    scr.claim_line_number = d.claim_line_number\n    group by d.encounter_id\n)\n\n\nselect   d.encounter_id\n, d.encounter_start_date\n, d.patient_data_source_id\n\n,tot.encounter_type\n,tot.encounter_group\n, datediff(\n        day,\n        birth_date,\n        d.encounter_start_date\n        )/365 as admit_age\n, e.gender\n, e.race\n, hp.diagnosis_code_type as primary_diagnosis_code_type\n, hp.diagnosis_code_1 as primary_diagnosis_code\n, coalesce(icd10cm.long_description, icd9cm.long_description) as primary_diagnosis_description\n, hf.facility_id as facility_id\n, b.provider_organization_name as facility_name\n, b.primary_specialty_description as facility_type\n, sc.lab_flag\n, sc.dme_flag\n, sc.ambulance_flag\n, sc.pharmacy_flag, sc.observation_flag\n, tot.total_paid_amount\n, tot.total_allowed_amount\n, tot.total_charge_amount\n, tot.claim_count\n, tot.inst_claim_count\n, tot.prof_claim_count\n, d.data_source\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom detail_values d\ninner join total_amounts tot on d.encounter_id = tot.encounter_id\ninner join service_category_flags sc on d.encounter_id = sc.encounter_id\nleft join highest_paid_diagnosis hp on d.encounter_id = hp.encounter_id\nand\nhp.paid_order = 1\nleft join highest_paid_facility hf on d.encounter_id = hf.encounter_id\nand\nhf.paid_order = 1\nleft join patient e\n  on d.patient_data_source_id = e.patient_data_source_id\nleft join tuva.terminology.provider b\n  on hf.facility_id = b.npi\nleft join tuva.terminology.icd_10_cm icd10cm\n  on hp.diagnosis_code_1 = icd10cm.icd_10_cm\n  and hp.diagnosis_code_type = 'icd-10-cm'\nleft join tuva.terminology.icd_9_cm icd9cm\n  on hp.diagnosis_code_1 = icd9cm.icd_9_cm\n  and hp.diagnosis_code_type = 'icd-9-cm'\nwhere d.encounter_row_number = 1", "relation_name": "tuva.claims_preprocessing.outpatient_psych__encounter_grain"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.238673Z", "completed_at": "2025-02-25T21:26:26.250167Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.250694Z", "completed_at": "2025-02-25T21:26:26.250699Z"}], "thread_id": "Thread-1", "execution_time": 0.017806053161621094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.outpatient_ptotst__encounter_grain", "compiled": true, "compiled_code": "\n\nwith encounter_date as (\n  select distinct old_encounter_id\n  ,start_date as encounter_start_date\n  from tuva.claims_preprocessing.outpatient_ptotst__generate_encounter_id\n)\n\n,detail_values as (\n    select stg.*\n    ,cli.encounter_id\n    ,cli.old_encounter_id\n      ,cli.encounter_type\n    ,cli.encounter_group\n    ,d.encounter_start_date \n    , row_number() over (partition by cli.encounter_id order by stg.claim_type, stg.start_date) as encounter_row_number --institutional then professional\n    from  tuva.claims_preprocessing.encounters__stg_medical_claim stg\n    inner join tuva.claims_preprocessing.encounters__combined_claim_line_crosswalk cli on stg.claim_id = cli.claim_id  \n    and\n    stg.claim_line_number = cli.claim_line_number\n    and\n    cli.encounter_type = 'outpatient pt/ot/st'\n    and\n    cli.claim_line_attribution_number = 1\n    inner join encounter_date d on cli.old_encounter_id = d.old_encounter_id\n)\n\n, patient as (\n    select \n        patient_data_source_id\n        , birth_date\n        , gender\n        , race\n    from tuva.claims_preprocessing.encounters__stg_eligibility\n    where patient_row_num = 1\n    )\n\n, total_amounts as (\n    select \n    encounter_id\n    , encounter_type\n    , encounter_group\n    , sum(paid_amount) as total_paid_amount\n    , sum(allowed_amount) as total_allowed_amount\n    , sum(charge_amount) as total_charge_amount\n    , count(distinct claim_id) as claim_count\n    , count(distinct(case when claim_type = 'institutional' then claim_id else null end))  as inst_claim_count\n    , count(distinct(case when claim_type = 'professional' then claim_id else null end))  as prof_claim_count\nfrom detail_values\ngroup by encounter_id\n,encounter_type \n,encounter_group\n)\n\n\n,highest_paid_diagnosis as \n(\n  select encounter_id\n  , diagnosis_code_1\n  , diagnosis_code_type\n  , row_number() over (partition by encounter_id order by sum(paid_amount) desc ) as paid_order\n  , sum(paid_amount) as paid_amount\n  from detail_values\n  where diagnosis_code_1 is not null\n  group by diagnosis_code_1\n  , encounter_id\n  , diagnosis_code_type\n)\n\n,highest_paid_facility as \n(\n  select encounter_id\n  , facility_id\n  , row_number() over (partition by encounter_id order by sum(paid_amount) desc ) as paid_order\n  , sum(paid_amount) as paid_amount\n  from detail_values\n  where facility_id is not null\n  group by \n   encounter_id\n  , facility_id\n)\n\n\n\n, service_category_flags as (\n    select distinct\n        d.encounter_id\n       ,max(case when scr.service_category_2 = 'lab' then 1 else 0 end) as lab_flag\n       ,max(case when scr.service_category_2 = 'ambulance' then 1 else 0 end) as ambulance_flag\n       ,max(case when scr.service_category_2 = 'durable medical equipment' then 1 else 0 end) as dme_flag\n       ,max(case when scr.service_category_2 = 'observation' then 1 else 0 end) as observation_flag\n       ,max(case when scr.service_category_2 = 'pharmacy' then 1 \n              else 0 end) as pharmacy_flag\n    from detail_values d\n    left join tuva.claims_preprocessing.service_category_grouper scr on d.claim_id = scr.claim_id \n    and\n    scr.claim_line_number = d.claim_line_number\n    group by d.encounter_id\n)\n\n\nselect   d.encounter_id\n, d.encounter_start_date\n, d.patient_data_source_id\n\n,tot.encounter_type\n,tot.encounter_group\n, datediff(\n        day,\n        birth_date,\n        d.encounter_start_date\n        )/365 as admit_age\n, e.gender\n, e.race\n, hp.diagnosis_code_type as primary_diagnosis_code_type\n, hp.diagnosis_code_1 as primary_diagnosis_code\n, coalesce(icd10cm.long_description, icd9cm.long_description) as primary_diagnosis_description\n, hf.facility_id as facility_id\n, b.provider_organization_name as facility_name\n, b.primary_specialty_description as facility_type\n, sc.lab_flag\n, sc.dme_flag\n, sc.ambulance_flag\n, sc.pharmacy_flag, sc.observation_flag\n, tot.total_paid_amount\n, tot.total_allowed_amount\n, tot.total_charge_amount\n, tot.claim_count\n, tot.inst_claim_count\n, tot.prof_claim_count\n, d.data_source\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom detail_values d\ninner join total_amounts tot on d.encounter_id = tot.encounter_id\ninner join service_category_flags sc on d.encounter_id = sc.encounter_id\nleft join highest_paid_diagnosis hp on d.encounter_id = hp.encounter_id\nand\nhp.paid_order = 1\nleft join highest_paid_facility hf on d.encounter_id = hf.encounter_id\nand\nhf.paid_order = 1\nleft join patient e\n  on d.patient_data_source_id = e.patient_data_source_id\nleft join tuva.terminology.provider b\n  on hf.facility_id = b.npi\nleft join tuva.terminology.icd_10_cm icd10cm\n  on hp.diagnosis_code_1 = icd10cm.icd_10_cm\n  and hp.diagnosis_code_type = 'icd-10-cm'\nleft join tuva.terminology.icd_9_cm icd9cm\n  on hp.diagnosis_code_1 = icd9cm.icd_9_cm\n  and hp.diagnosis_code_type = 'icd-9-cm'\nwhere d.encounter_row_number = 1", "relation_name": "tuva.claims_preprocessing.outpatient_ptotst__encounter_grain"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.244594Z", "completed_at": "2025-02-25T21:26:26.251079Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.251732Z", "completed_at": "2025-02-25T21:26:26.251735Z"}], "thread_id": "Thread-3", "execution_time": 0.01335287094116211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.outpatient_radiology__encounter_grain", "compiled": true, "compiled_code": "\n\nwith encounter_date as (\n  select distinct old_encounter_id\n  ,start_date as encounter_start_date\n  from tuva.claims_preprocessing.outpatient_radiology__generate_encounter_id\n)\n\n,detail_values as (\n    select stg.*\n    ,cli.encounter_id\n    ,cli.old_encounter_id\n      ,cli.encounter_type\n    ,cli.encounter_group\n    ,d.encounter_start_date \n    , row_number() over (partition by cli.encounter_id order by stg.claim_type, stg.start_date) as encounter_row_number --institutional then professional\n    from  tuva.claims_preprocessing.encounters__stg_medical_claim stg\n    inner join tuva.claims_preprocessing.encounters__combined_claim_line_crosswalk cli on stg.claim_id = cli.claim_id  \n    and\n    stg.claim_line_number = cli.claim_line_number\n    and\n    cli.encounter_type = 'outpatient radiology'\n    and\n    cli.claim_line_attribution_number = 1\n    inner join encounter_date d on cli.old_encounter_id = d.old_encounter_id\n)\n\n, patient as (\n    select \n        patient_data_source_id\n        , birth_date\n        , gender\n        , race\n    from tuva.claims_preprocessing.encounters__stg_eligibility\n    where patient_row_num = 1\n    )\n\n, total_amounts as (\n    select \n    encounter_id\n    , encounter_type\n    , encounter_group\n    , sum(paid_amount) as total_paid_amount\n    , sum(allowed_amount) as total_allowed_amount\n    , sum(charge_amount) as total_charge_amount\n    , count(distinct claim_id) as claim_count\n    , count(distinct(case when claim_type = 'institutional' then claim_id else null end))  as inst_claim_count\n    , count(distinct(case when claim_type = 'professional' then claim_id else null end))  as prof_claim_count\nfrom detail_values\ngroup by encounter_id\n,encounter_type \n,encounter_group\n)\n\n\n,highest_paid_diagnosis as \n(\n  select encounter_id\n  , diagnosis_code_1\n  , diagnosis_code_type\n  , row_number() over (partition by encounter_id order by sum(paid_amount) desc ) as paid_order\n  , sum(paid_amount) as paid_amount\n  from detail_values\n  where diagnosis_code_1 is not null\n  group by diagnosis_code_1\n  , encounter_id\n  , diagnosis_code_type\n)\n\n,highest_paid_facility as \n(\n  select encounter_id\n  , facility_id\n  , row_number() over (partition by encounter_id order by sum(paid_amount) desc ) as paid_order\n  , sum(paid_amount) as paid_amount\n  from detail_values\n  where facility_id is not null\n  group by \n   encounter_id\n  , facility_id\n)\n\n,hcpcs_code as \n(\n  select distinct hcpcs_code\n  ,encounter_id\n  from detail_values\n\n)\n\n\n\n, service_category_flags as (\n    select distinct\n        d.encounter_id\n       ,max(case when scr.service_category_2 = 'lab' then 1 else 0 end) as lab_flag\n       ,max(case when scr.service_category_2 = 'ambulance' then 1 else 0 end) as ambulance_flag\n       ,max(case when scr.service_category_2 = 'durable medical equipment' then 1 else 0 end) as dme_flag\n       ,max(case when scr.service_category_2 = 'observation' then 1 else 0 end) as observation_flag\n       ,max(case when scr.service_category_2 = 'pharmacy' then 1 \n              else 0 end) as pharmacy_flag\n    from detail_values d\n    left join tuva.claims_preprocessing.service_category_grouper scr on d.claim_id = scr.claim_id \n    and\n    scr.claim_line_number = d.claim_line_number\n    group by d.encounter_id\n)\n\n\nselect   d.encounter_id\n, d.encounter_start_date\n, d.patient_data_source_id\n\n,tot.encounter_type\n,tot.encounter_group\n, datediff(\n        day,\n        birth_date,\n        d.encounter_start_date\n        )/365 as admit_age\n, e.gender\n, e.race\n, hp.diagnosis_code_type as primary_diagnosis_code_type\n, hp.diagnosis_code_1 as primary_diagnosis_code\n, coalesce(icd10cm.long_description, icd9cm.long_description) as primary_diagnosis_description\n, hf.facility_id as facility_id\n, b.provider_organization_name as facility_name\n, b.primary_specialty_description as facility_type\n, sc.lab_flag\n, sc.dme_flag\n, sc.ambulance_flag\n, sc.pharmacy_flag, sc.observation_flag\n, hcpc.hcpcs_code\n, tot.total_paid_amount\n, tot.total_allowed_amount\n, tot.total_charge_amount\n, tot.claim_count\n, tot.inst_claim_count\n, tot.prof_claim_count\n, d.data_source\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom detail_values d\ninner join total_amounts tot on d.encounter_id = tot.encounter_id\ninner join service_category_flags sc on d.encounter_id = sc.encounter_id\nleft join highest_paid_diagnosis hp on d.encounter_id = hp.encounter_id\nand\nhp.paid_order = 1\nleft join highest_paid_facility hf on d.encounter_id = hf.encounter_id\nand\nhf.paid_order = 1\nleft join hcpcs_code hcpc on d.encounter_id = hcpc.encounter_id\nleft join patient e\n  on d.patient_data_source_id = e.patient_data_source_id\nleft join tuva.terminology.provider b\n  on hf.facility_id = b.npi\nleft join tuva.terminology.icd_10_cm icd10cm\n  on hp.diagnosis_code_1 = icd10cm.icd_10_cm\n  and hp.diagnosis_code_type = 'icd-10-cm'\nleft join tuva.terminology.icd_9_cm icd9cm\n  on hp.diagnosis_code_1 = icd9cm.icd_9_cm\n  and hp.diagnosis_code_type = 'icd-9-cm'\nwhere d.encounter_row_number = 1", "relation_name": "tuva.claims_preprocessing.outpatient_radiology__encounter_grain"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.252092Z", "completed_at": "2025-02-25T21:26:26.263229Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.263703Z", "completed_at": "2025-02-25T21:26:26.263710Z"}], "thread_id": "Thread-2", "execution_time": 0.01335597038269043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.outpatient_rehab__encounter_grain", "compiled": true, "compiled_code": "\n\nwith encounter_date as (\n  select distinct old_encounter_id\n  ,start_date as encounter_start_date\n  from tuva.claims_preprocessing.outpatient_rehab__generate_encounter_id\n)\n\n,detail_values as (\n    select stg.*\n    ,cli.encounter_id\n    ,cli.old_encounter_id\n      ,cli.encounter_type\n    ,cli.encounter_group\n    ,d.encounter_start_date \n    , row_number() over (partition by cli.encounter_id order by stg.claim_type, stg.start_date) as encounter_row_number --institutional then professional\n    from  tuva.claims_preprocessing.encounters__stg_medical_claim stg\n    inner join tuva.claims_preprocessing.encounters__combined_claim_line_crosswalk cli on stg.claim_id = cli.claim_id  \n    and\n    stg.claim_line_number = cli.claim_line_number\n    and\n    cli.encounter_type = 'outpatient rehabilitation'\n    and\n    cli.claim_line_attribution_number = 1\n    inner join encounter_date d on cli.old_encounter_id = d.old_encounter_id\n)\n\n, patient as (\n    select \n        patient_data_source_id\n        , birth_date\n        , gender\n        , race\n    from tuva.claims_preprocessing.encounters__stg_eligibility\n    where patient_row_num = 1\n    )\n\n, total_amounts as (\n    select \n    encounter_id\n    , encounter_type\n    , encounter_group\n    , sum(paid_amount) as total_paid_amount\n    , sum(allowed_amount) as total_allowed_amount\n    , sum(charge_amount) as total_charge_amount\n    , count(distinct claim_id) as claim_count\n    , count(distinct(case when claim_type = 'institutional' then claim_id else null end))  as inst_claim_count\n    , count(distinct(case when claim_type = 'professional' then claim_id else null end))  as prof_claim_count\nfrom detail_values\ngroup by encounter_id\n,encounter_type \n,encounter_group\n)\n\n\n,highest_paid_diagnosis as \n(\n  select encounter_id\n  , diagnosis_code_1\n  , diagnosis_code_type\n  , row_number() over (partition by encounter_id order by sum(paid_amount) desc ) as paid_order\n  , sum(paid_amount) as paid_amount\n  from detail_values\n  where diagnosis_code_1 is not null\n  group by diagnosis_code_1\n  , encounter_id\n  , diagnosis_code_type\n)\n\n,highest_paid_facility as \n(\n  select encounter_id\n  , facility_id\n  , row_number() over (partition by encounter_id order by sum(paid_amount) desc ) as paid_order\n  , sum(paid_amount) as paid_amount\n  from detail_values\n  where facility_id is not null\n  group by \n   encounter_id\n  , facility_id\n)\n\n\n\n, service_category_flags as (\n    select distinct\n        d.encounter_id\n       ,max(case when scr.service_category_2 = 'lab' then 1 else 0 end) as lab_flag\n       ,max(case when scr.service_category_2 = 'ambulance' then 1 else 0 end) as ambulance_flag\n       ,max(case when scr.service_category_2 = 'durable medical equipment' then 1 else 0 end) as dme_flag\n       ,max(case when scr.service_category_2 = 'observation' then 1 else 0 end) as observation_flag\n       ,max(case when scr.service_category_2 = 'pharmacy' then 1 \n              else 0 end) as pharmacy_flag\n    from detail_values d\n    left join tuva.claims_preprocessing.service_category_grouper scr on d.claim_id = scr.claim_id \n    and\n    scr.claim_line_number = d.claim_line_number\n    group by d.encounter_id\n)\n\n\nselect   d.encounter_id\n, d.encounter_start_date\n, d.patient_data_source_id\n\n,tot.encounter_type\n,tot.encounter_group\n, datediff(\n        day,\n        birth_date,\n        d.encounter_start_date\n        )/365 as admit_age\n, e.gender\n, e.race\n, hp.diagnosis_code_type as primary_diagnosis_code_type\n, hp.diagnosis_code_1 as primary_diagnosis_code\n, coalesce(icd10cm.long_description, icd9cm.long_description) as primary_diagnosis_description\n, hf.facility_id as facility_id\n, b.provider_organization_name as facility_name\n, b.primary_specialty_description as facility_type\n, sc.lab_flag\n, sc.dme_flag\n, sc.ambulance_flag\n, sc.pharmacy_flag, sc.observation_flag\n, tot.total_paid_amount\n, tot.total_allowed_amount\n, tot.total_charge_amount\n, tot.claim_count\n, tot.inst_claim_count\n, tot.prof_claim_count\n, d.data_source\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom detail_values d\ninner join total_amounts tot on d.encounter_id = tot.encounter_id\ninner join service_category_flags sc on d.encounter_id = sc.encounter_id\nleft join highest_paid_diagnosis hp on d.encounter_id = hp.encounter_id\nand\nhp.paid_order = 1\nleft join highest_paid_facility hf on d.encounter_id = hf.encounter_id\nand\nhf.paid_order = 1\nleft join patient e\n  on d.patient_data_source_id = e.patient_data_source_id\nleft join tuva.terminology.provider b\n  on hf.facility_id = b.npi\nleft join tuva.terminology.icd_10_cm icd10cm\n  on hp.diagnosis_code_1 = icd10cm.icd_10_cm\n  and hp.diagnosis_code_type = 'icd-10-cm'\nleft join tuva.terminology.icd_9_cm icd9cm\n  on hp.diagnosis_code_1 = icd9cm.icd_9_cm\n  and hp.diagnosis_code_type = 'icd-9-cm'\nwhere d.encounter_row_number = 1", "relation_name": "tuva.claims_preprocessing.outpatient_rehab__encounter_grain"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.258299Z", "completed_at": "2025-02-25T21:26:26.269464Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.269999Z", "completed_at": "2025-02-25T21:26:26.270004Z"}], "thread_id": "Thread-1", "execution_time": 0.012872934341430664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.outpatient_substance_use__encounter_grain", "compiled": true, "compiled_code": "\n\nwith encounter_date as (\n  select distinct old_encounter_id\n  ,start_date as encounter_start_date\n  from tuva.claims_preprocessing.outpatient_substance_use__generate_encounter_id\n)\n\n,detail_values as (\n    select stg.*\n    ,cli.encounter_id\n    ,cli.old_encounter_id\n      ,cli.encounter_type\n    ,cli.encounter_group\n    ,d.encounter_start_date \n    , row_number() over (partition by cli.encounter_id order by stg.claim_type, stg.start_date) as encounter_row_number --institutional then professional\n    from  tuva.claims_preprocessing.encounters__stg_medical_claim stg\n    inner join tuva.claims_preprocessing.encounters__combined_claim_line_crosswalk cli on stg.claim_id = cli.claim_id  \n    and\n    stg.claim_line_number = cli.claim_line_number\n    and\n    cli.encounter_type = 'outpatient substance use'\n    and\n    cli.claim_line_attribution_number = 1\n    inner join encounter_date d on cli.old_encounter_id = d.old_encounter_id\n)\n\n, patient as (\n    select \n        patient_data_source_id\n        , birth_date\n        , gender\n        , race\n    from tuva.claims_preprocessing.encounters__stg_eligibility\n    where patient_row_num = 1\n    )\n\n, total_amounts as (\n    select \n    encounter_id\n    , encounter_type\n    , encounter_group\n    , sum(paid_amount) as total_paid_amount\n    , sum(allowed_amount) as total_allowed_amount\n    , sum(charge_amount) as total_charge_amount\n    , count(distinct claim_id) as claim_count\n    , count(distinct(case when claim_type = 'institutional' then claim_id else null end))  as inst_claim_count\n    , count(distinct(case when claim_type = 'professional' then claim_id else null end))  as prof_claim_count\nfrom detail_values\ngroup by encounter_id\n,encounter_type \n,encounter_group\n)\n\n\n,highest_paid_diagnosis as \n(\n  select encounter_id\n  , diagnosis_code_1\n  , diagnosis_code_type\n  , row_number() over (partition by encounter_id order by sum(paid_amount) desc ) as paid_order\n  , sum(paid_amount) as paid_amount\n  from detail_values\n  where diagnosis_code_1 is not null\n  group by diagnosis_code_1\n  , encounter_id\n  , diagnosis_code_type\n)\n\n,highest_paid_facility as \n(\n  select encounter_id\n  , facility_id\n  , row_number() over (partition by encounter_id order by sum(paid_amount) desc ) as paid_order\n  , sum(paid_amount) as paid_amount\n  from detail_values\n  where facility_id is not null\n  group by \n   encounter_id\n  , facility_id\n)\n\n\n\n, service_category_flags as (\n    select distinct\n        d.encounter_id\n       ,max(case when scr.service_category_2 = 'lab' then 1 else 0 end) as lab_flag\n       ,max(case when scr.service_category_2 = 'ambulance' then 1 else 0 end) as ambulance_flag\n       ,max(case when scr.service_category_2 = 'durable medical equipment' then 1 else 0 end) as dme_flag\n       ,max(case when scr.service_category_2 = 'observation' then 1 else 0 end) as observation_flag\n       ,max(case when scr.service_category_2 = 'pharmacy' then 1 \n              else 0 end) as pharmacy_flag\n    from detail_values d\n    left join tuva.claims_preprocessing.service_category_grouper scr on d.claim_id = scr.claim_id \n    and\n    scr.claim_line_number = d.claim_line_number\n    group by d.encounter_id\n)\n\nselect   d.encounter_id\n, d.encounter_start_date\n, d.patient_data_source_id\n\n,tot.encounter_type\n,tot.encounter_group\n, datediff(\n        day,\n        birth_date,\n        d.encounter_start_date\n        )/365 as admit_age\n, e.gender\n, e.race\n, hp.diagnosis_code_type as primary_diagnosis_code_type\n, hp.diagnosis_code_1 as primary_diagnosis_code\n, coalesce(icd10cm.long_description, icd9cm.long_description) as primary_diagnosis_description\n, hf.facility_id as facility_id\n, b.provider_organization_name as facility_name\n, b.primary_specialty_description as facility_type\n, sc.lab_flag\n, sc.dme_flag\n, sc.ambulance_flag\n, sc.pharmacy_flag, sc.observation_flag\n, tot.total_paid_amount\n, tot.total_allowed_amount\n, tot.total_charge_amount\n, tot.claim_count\n, tot.inst_claim_count\n, tot.prof_claim_count\n, d.data_source\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom detail_values d\ninner join total_amounts tot on d.encounter_id = tot.encounter_id\ninner join service_category_flags sc on d.encounter_id = sc.encounter_id\nleft join highest_paid_diagnosis hp on d.encounter_id = hp.encounter_id\nand\nhp.paid_order = 1\nleft join highest_paid_facility hf on d.encounter_id = hf.encounter_id\nand\nhf.paid_order = 1\nleft join patient e\n  on d.patient_data_source_id = e.patient_data_source_id\nleft join tuva.terminology.provider b\n  on hf.facility_id = b.npi\nleft join tuva.terminology.icd_10_cm icd10cm\n  on hp.diagnosis_code_1 = icd10cm.icd_10_cm\n  and hp.diagnosis_code_type = 'icd-10-cm'\nleft join tuva.terminology.icd_9_cm icd9cm\n  on hp.diagnosis_code_1 = icd9cm.icd_9_cm\n  and hp.diagnosis_code_type = 'icd-9-cm'\nwhere d.encounter_row_number = 1", "relation_name": "tuva.claims_preprocessing.outpatient_substance_use__encounter_grain"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.264144Z", "completed_at": "2025-02-25T21:26:26.270576Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.277080Z", "completed_at": "2025-02-25T21:26:26.277088Z"}], "thread_id": "Thread-3", "execution_time": 0.019104957580566406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.outpatient_surgery__encounter_grain", "compiled": true, "compiled_code": "\n\nwith encounter_date as (\n  select distinct old_encounter_id\n  ,start_date as encounter_start_date\n  from tuva.claims_preprocessing.outpatient_surgery__generate_encounter_id\n)\n\n,detail_values as (\n    select stg.*\n    ,cli.encounter_id\n    ,cli.old_encounter_id\n      ,cli.encounter_type\n    ,cli.encounter_group\n    ,d.encounter_start_date \n    , row_number() over (partition by cli.encounter_id order by stg.claim_type, stg.start_date) as encounter_row_number --institutional then professional\n    from  tuva.claims_preprocessing.encounters__stg_medical_claim stg\n    inner join tuva.claims_preprocessing.encounters__combined_claim_line_crosswalk cli on stg.claim_id = cli.claim_id  \n    and\n    stg.claim_line_number = cli.claim_line_number\n    and\n    cli.encounter_type = 'outpatient surgery'\n    and\n    cli.claim_line_attribution_number = 1\n    inner join encounter_date d on cli.old_encounter_id = d.old_encounter_id\n)\n\n, patient as (\n    select \n        patient_data_source_id\n        , birth_date\n        , gender\n        , race\n    from tuva.claims_preprocessing.encounters__stg_eligibility\n    where patient_row_num = 1\n    )\n\n, total_amounts as (\n    select \n    encounter_id\n    , encounter_type\n    , encounter_group\n    , sum(paid_amount) as total_paid_amount\n    , sum(allowed_amount) as total_allowed_amount\n    , sum(charge_amount) as total_charge_amount\n    , count(distinct claim_id) as claim_count\n    , count(distinct(case when claim_type = 'institutional' then claim_id else null end))  as inst_claim_count\n    , count(distinct(case when claim_type = 'professional' then claim_id else null end))  as prof_claim_count\nfrom detail_values\ngroup by encounter_id\n,encounter_type \n,encounter_group\n)\n\n\n,highest_paid_diagnosis as \n(\n  select encounter_id\n  , diagnosis_code_1\n  , diagnosis_code_type\n  , row_number() over (partition by encounter_id order by sum(paid_amount) desc ) as paid_order\n  , sum(paid_amount) as paid_amount\n  from detail_values\n  where diagnosis_code_1 is not null\n  group by diagnosis_code_1\n  , encounter_id\n  , diagnosis_code_type\n)\n\n,highest_paid_facility as \n(\n  select encounter_id\n  , facility_id\n  , row_number() over (partition by encounter_id order by sum(paid_amount) desc ) as paid_order\n  , sum(paid_amount) as paid_amount\n  from detail_values\n  where facility_id is not null\n  group by \n   encounter_id\n  , facility_id\n)\n\n\n\n, service_category_flags as (\n    select distinct\n        d.encounter_id\n       ,max(case when scr.service_category_2 = 'lab' then 1 else 0 end) as lab_flag\n       ,max(case when scr.service_category_2 = 'ambulance' then 1 else 0 end) as ambulance_flag\n       ,max(case when scr.service_category_2 = 'durable medical equipment' then 1 else 0 end) as dme_flag\n       ,max(case when scr.service_category_2 = 'observation' then 1 else 0 end) as observation_flag\n       ,max(case when scr.service_category_2 = 'pharmacy' then 1 \n              else 0 end) as pharmacy_flag\n    from detail_values d\n    left join tuva.claims_preprocessing.service_category_grouper scr on d.claim_id = scr.claim_id \n    and\n    scr.claim_line_number = d.claim_line_number\n    group by d.encounter_id\n)\n\n\nselect   d.encounter_id\n, d.encounter_start_date\n, d.patient_data_source_id\n\n,tot.encounter_type\n,tot.encounter_group\n, datediff(\n        day,\n        birth_date,\n        d.encounter_start_date\n        )/365 as admit_age\n, e.gender\n, e.race\n, hp.diagnosis_code_type as primary_diagnosis_code_type\n, hp.diagnosis_code_1 as primary_diagnosis_code\n, coalesce(icd10cm.long_description, icd9cm.long_description) as primary_diagnosis_description\n, hf.facility_id as facility_id\n, b.provider_organization_name as facility_name\n, b.primary_specialty_description as facility_type\n, sc.lab_flag\n, sc.dme_flag\n, sc.ambulance_flag\n, sc.pharmacy_flag, sc.observation_flag\n, tot.total_paid_amount\n, tot.total_allowed_amount\n, tot.total_charge_amount\n, tot.claim_count\n, tot.inst_claim_count\n, tot.prof_claim_count\n, d.data_source\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom detail_values d\ninner join total_amounts tot on d.encounter_id = tot.encounter_id\ninner join service_category_flags sc on d.encounter_id = sc.encounter_id\nleft join highest_paid_diagnosis hp on d.encounter_id = hp.encounter_id\nand\nhp.paid_order = 1\nleft join highest_paid_facility hf on d.encounter_id = hf.encounter_id\nand\nhf.paid_order = 1\nleft join patient e\n  on d.patient_data_source_id = e.patient_data_source_id\nleft join tuva.terminology.provider b\n  on hf.facility_id = b.npi\nleft join tuva.terminology.icd_10_cm icd10cm\n  on hp.diagnosis_code_1 = icd10cm.icd_10_cm\n  and hp.diagnosis_code_type = 'icd-10-cm'\nleft join tuva.terminology.icd_9_cm icd9cm\n  on hp.diagnosis_code_1 = icd9cm.icd_9_cm\n  and hp.diagnosis_code_type = 'icd-9-cm'\nwhere d.encounter_row_number = 1", "relation_name": "tuva.claims_preprocessing.outpatient_surgery__encounter_grain"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.271031Z", "completed_at": "2025-02-25T21:26:26.278607Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.285079Z", "completed_at": "2025-02-25T21:26:26.285086Z"}], "thread_id": "Thread-2", "execution_time": 0.015437126159667969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.urgent_care__encounter_grain", "compiled": true, "compiled_code": "\n\nwith encounter_date as (\n  select distinct old_encounter_id\n  ,start_date as encounter_start_date\n  from tuva.claims_preprocessing.urgent_care__generate_encounter_id\n)\n\n,detail_values as (\n    select stg.*\n    ,cli.encounter_id\n    ,cli.old_encounter_id\n      ,cli.encounter_type\n    ,cli.encounter_group\n    ,d.encounter_start_date \n    , row_number() over (partition by cli.encounter_id order by stg.claim_type, stg.start_date) as encounter_row_number --institutional then professional\n    from  tuva.claims_preprocessing.encounters__stg_medical_claim stg\n    inner join tuva.claims_preprocessing.encounters__combined_claim_line_crosswalk cli on stg.claim_id = cli.claim_id  \n    and\n    stg.claim_line_number = cli.claim_line_number\n    and\n    cli.encounter_type = 'urgent care'\n    and\n    cli.claim_line_attribution_number = 1\n    inner join encounter_date d on cli.old_encounter_id = d.old_encounter_id\n)\n\n, patient as (\n    select \n        patient_data_source_id\n        , birth_date\n        , gender\n        , race\n    from tuva.claims_preprocessing.encounters__stg_eligibility\n    where patient_row_num = 1\n    )\n\n, total_amounts as (\n    select \n    encounter_id\n    , encounter_type\n    , encounter_group\n    , sum(paid_amount) as total_paid_amount\n    , sum(allowed_amount) as total_allowed_amount\n    , sum(charge_amount) as total_charge_amount\n    , count(distinct claim_id) as claim_count\n    , count(distinct(case when claim_type = 'institutional' then claim_id else null end))  as inst_claim_count\n    , count(distinct(case when claim_type = 'professional' then claim_id else null end))  as prof_claim_count\nfrom detail_values\ngroup by encounter_id\n,encounter_type \n,encounter_group\n)\n\n\n,highest_paid_diagnosis as \n(\n  select encounter_id\n  , diagnosis_code_1\n  , diagnosis_code_type\n  , row_number() over (partition by encounter_id order by sum(paid_amount) desc ) as paid_order\n  , sum(paid_amount) as paid_amount\n  from detail_values\n  where diagnosis_code_1 is not null\n  group by diagnosis_code_1\n  , encounter_id\n  , diagnosis_code_type\n)\n\n,highest_paid_facility as \n(\n  select encounter_id\n  , facility_id\n  , row_number() over (partition by encounter_id order by sum(paid_amount) desc ) as paid_order\n  , sum(paid_amount) as paid_amount\n  from detail_values\n  where facility_id is not null\n  group by \n   encounter_id\n  , facility_id\n)\n\n\n\n, service_category_flags as (\n    select distinct\n        d.encounter_id\n       ,max(case when scr.service_category_2 = 'lab' then 1 else 0 end) as lab_flag\n       ,max(case when scr.service_category_2 = 'ambulance' then 1 else 0 end) as ambulance_flag\n       ,max(case when scr.service_category_2 = 'durable medical equipment' then 1 else 0 end) as dme_flag\n       ,max(case when scr.service_category_2 = 'observation' then 1 else 0 end) as observation_flag\n       ,max(case when scr.service_category_2 = 'pharmacy' then 1 \n              else 0 end) as pharmacy_flag\n    from detail_values d\n    left join tuva.claims_preprocessing.service_category_grouper scr on d.claim_id = scr.claim_id \n    and\n    scr.claim_line_number = d.claim_line_number\n    group by d.encounter_id\n)\n\n\nselect   d.encounter_id\n, d.encounter_start_date\n, d.patient_data_source_id\n\n,tot.encounter_type\n,tot.encounter_group\n, datediff(\n        day,\n        birth_date,\n        d.encounter_start_date\n        )/365 as admit_age\n, e.gender\n, e.race\n, hp.diagnosis_code_type as primary_diagnosis_code_type\n, hp.diagnosis_code_1 as primary_diagnosis_code\n, coalesce(icd10cm.long_description, icd9cm.long_description) as primary_diagnosis_description\n, hf.facility_id as facility_id\n, b.provider_organization_name as facility_name\n, b.primary_specialty_description as facility_type\n, sc.lab_flag\n, sc.dme_flag\n, sc.ambulance_flag\n, sc.pharmacy_flag\n, sc.observation_flag\n, tot.total_paid_amount\n, tot.total_allowed_amount\n, tot.total_charge_amount\n, tot.claim_count\n, tot.inst_claim_count\n, tot.prof_claim_count\n, d.data_source\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom detail_values d\ninner join total_amounts tot on d.encounter_id = tot.encounter_id\ninner join service_category_flags sc on d.encounter_id = sc.encounter_id\nleft join highest_paid_diagnosis hp on d.encounter_id = hp.encounter_id\nand\nhp.paid_order = 1\nleft join highest_paid_facility hf on d.encounter_id = hf.encounter_id\nand\nhf.paid_order = 1\nleft join patient e\n  on d.patient_data_source_id = e.patient_data_source_id\nleft join tuva.terminology.provider b\n  on hf.facility_id = b.npi\nleft join tuva.terminology.icd_10_cm icd10cm\n  on hp.diagnosis_code_1 = icd10cm.icd_10_cm\n  and hp.diagnosis_code_type = 'icd-10-cm'\nleft join tuva.terminology.icd_9_cm icd9cm\n  on hp.diagnosis_code_1 = icd9cm.icd_9_cm\n  and hp.diagnosis_code_type = 'icd-9-cm'\nwhere d.encounter_row_number = 1", "relation_name": "tuva.claims_preprocessing.urgent_care__encounter_grain"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.278795Z", "completed_at": "2025-02-25T21:26:26.299301Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.306431Z", "completed_at": "2025-02-25T21:26:26.306443Z"}], "thread_id": "Thread-1", "execution_time": 0.029005050659179688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.core__condition", "compiled": true, "compiled_code": "\n\n\nwith all_conditions as (\nselect *\n    from tuva.core._stg_claims_condition\n    union all\n    select *\n    from tuva.core._stg_clinical_condition\n\n\n)\n\n\n\n\nselect\n    all_conditions.condition_id\n  , all_conditions.person_id\n  , all_conditions.member_id\n  , all_conditions.patient_id\n  , all_conditions.encounter_id\n  , all_conditions.claim_id\n  , all_conditions.recorded_date\n  , all_conditions.onset_date\n  , all_conditions.resolved_date\n  , all_conditions.status\n  , all_conditions.condition_type\n  , all_conditions.source_code_type\n  , all_conditions.source_code\n  , all_conditions.source_description\n  , case\n        when all_conditions.normalized_code_type is not null then all_conditions.normalized_code_type\n        when icd10.icd_10_cm is not null then 'icd-10-cm'\n        when icd9.icd_9_cm is not null then 'icd-9-cm'\n        when snomed_ct.snomed_ct is not null then 'snomed-ct'\n        else null end as normalized_code_type\n  , coalesce(\n        all_conditions.normalized_code\n      , icd10.icd_10_cm\n      , icd9.icd_9_cm\n      , snomed_ct.snomed_ct) as normalized_code\n  , coalesce(\n        all_conditions.normalized_description\n      , icd10.short_description\n      , icd9.short_description\n      , snomed_ct.description) as normalized_description\n  , case when coalesce(all_conditions.normalized_code, all_conditions.normalized_description) is not null then 'manual'\n         when coalesce(icd10.icd_10_cm,icd9.icd_9_cm, snomed_ct.snomed_ct) is not null then 'automatic'\n         end as mapping_method\n  , all_conditions.condition_rank\n  , all_conditions.present_on_admit_code\n  , all_conditions.present_on_admit_description\n  , all_conditions.data_source\n  , all_conditions.tuva_last_run\nfrom\nall_conditions\nleft join tuva.terminology.icd_10_cm icd10\n    on all_conditions.source_code_type = 'icd-10-cm'\n        and replace(all_conditions.source_code,'.','') = icd10.icd_10_cm\nleft join tuva.terminology.icd_9_cm icd9\n    on all_conditions.source_code_type = 'icd-9-cm'\n        and replace(all_conditions.source_code,'.','') = icd9.icd_9_cm\nleft join tuva.terminology.snomed_ct snomed_ct\n    on all_conditions.source_code_type = 'snomed-ct'\n        and all_conditions.source_code = snomed_ct.snomed_ct\n\n\n\n\n", "relation_name": "tuva.core.condition"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.285536Z", "completed_at": "2025-02-25T21:26:26.308530Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.309163Z", "completed_at": "2025-02-25T21:26:26.309168Z"}], "thread_id": "Thread-3", "execution_time": 0.030848026275634766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.core__procedure", "compiled": true, "compiled_code": "\n\n\nwith all_procedures as (\nselect * from tuva.core._stg_claims_procedure\nunion all\nselect * from tuva.core._stg_clinical_procedure\n\n\n)\n\n\n\nselect\n    all_procedures.procedure_id\n  , all_procedures.person_id\n  , all_procedures.member_id\n  , all_procedures.patient_id\n  , all_procedures.encounter_id\n  , all_procedures.claim_id\n  , all_procedures.procedure_date\n  , all_procedures.source_code_type\n  , all_procedures.source_code\n  , all_procedures.source_description\n  , case when all_procedures.normalized_code_type is not null then  all_procedures.normalized_code_type\n      when icd10.icd_10_pcs is not null then 'icd-10-pcs'\n      when icd9.icd_9_pcs is not null then 'icd-9-pcs'\n      when hcpcs.hcpcs is not null then 'hcpcs'\n      when snomed_ct.snomed_ct is not null then 'snomed-ct'\n      end as normalized_code_type\n  , coalesce(all_procedures.normalized_code\n      , icd10.icd_10_pcs\n      , icd9.icd_9_pcs\n      , hcpcs.hcpcs\n      ,snomed_ct.snomed_ct ) as normalized_code\n  ,  coalesce(all_procedures.normalized_description\n      , icd10.description\n      , icd9.short_description\n      , hcpcs.short_description\n      , snomed_ct.description) normalized_description\n  , case when coalesce(all_procedures.normalized_code, all_procedures.normalized_description) is not null then 'manual'\n         when coalesce(icd10.icd_10_pcs,icd9.icd_9_pcs, hcpcs.hcpcs, snomed_ct.snomed_ct) is not null then 'automatic'\n         end as mapping_method\n  , all_procedures.modifier_1\n  , all_procedures.modifier_2\n  , all_procedures.modifier_3\n  , all_procedures.modifier_4\n  , all_procedures.modifier_5\n  , all_procedures.practitioner_id\n  , all_procedures.data_source\n  , all_procedures.tuva_last_run\nfrom all_procedures\nleft join tuva.terminology.icd_10_pcs icd10\n    on all_procedures.source_code_type = 'icd-10-pcs'\n        and all_procedures.source_code = icd10.icd_10_pcs\nleft join tuva.terminology.icd_9_pcs icd9\n    on all_procedures.source_code_type = 'icd-9-pcs'\n        and all_procedures.source_code = icd9.icd_9_pcs\nleft join tuva.terminology.hcpcs_level_2 hcpcs\n    on all_procedures.source_code_type = 'hcpcs'\n        and all_procedures.source_code = hcpcs.hcpcs\nleft join tuva.terminology.snomed_ct snomed_ct\n    on all_procedures.source_code_type = 'snomed-ct'\n        and all_procedures.source_code = snomed_ct.snomed_ct\n\n\n", "relation_name": "tuva.core.procedure"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.293026Z", "completed_at": "2025-02-25T21:26:26.310009Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.315959Z", "completed_at": "2025-02-25T21:26:26.315965Z"}], "thread_id": "Thread-2", "execution_time": 0.023500919342041016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.core__stg_claims_medical_claim", "compiled": true, "compiled_code": "\n\n-- *************************************************\n-- This dbt model creates the medical_claim table\n-- in core. It adds these 4 fields to the input layer\n-- medical claim table:\n--      encounter_id\n--      service_category_1\n--      service_category_2\n-- *************************************************\n\nwith all_encounters as (\n    select   claim_id\n, claim_line_number\n, encounter_id\n, encounter_type\n, encounter_group\n    from tuva.claims_preprocessing.encounters__combined_claim_line_crosswalk\n    where claim_line_attribution_number = 1\n    \n    union all \n\n    select  \n  claim_id\n, claim_line_number\n, encounter_id\n, encounter_type\n, encounter_group\n    from tuva.claims_preprocessing.encounters__orphaned_claims\n)\n\nselect\n    med.claim_id || '-' || med.claim_line_number || '-' || med.data_source as medical_claim_id\n    , cast(med.claim_id as TEXT ) as claim_id\n    , cast(med.claim_line_number as integer ) as claim_line_number\n    , cast(x.encounter_id as TEXT ) as encounter_id\n    , cast(x.encounter_type as TEXT ) as encounter_type\n    , cast(x.encounter_group as TEXT ) as encounter_group\n    , cast(med.claim_type as TEXT ) as claim_type\n    , cast(med.person_id as TEXT ) as person_id\n    , cast(med.member_id as TEXT ) as member_id\n    , cast(med.payer as TEXT ) as payer\n    , med.plan\n    , try_cast( med.claim_start_date as date ) as claim_start_date\n    , try_cast( med.claim_end_date as date ) as claim_end_date\n    , try_cast( med.claim_line_start_date as date ) as claim_line_start_date\n    , try_cast( med.claim_line_end_date as date ) as claim_line_end_date\n    , try_cast( med.admission_date as date ) as admission_date\n    , try_cast( med.discharge_date as date ) as discharge_date\n    , cast(srv_group.service_category_1 as TEXT ) as service_category_1\n    , cast(srv_group.service_category_2 as TEXT ) as service_category_2\n    , cast(srv_group.service_category_3 as TEXT ) as service_category_3\n    , cast(med.admit_source_code as TEXT ) as admit_source_code\n    , cast(med.admit_source_description as TEXT ) as admit_source_description\n    , cast(med.admit_type_code as TEXT ) as admit_type_code\n    , cast(med.admit_type_description as TEXT ) as admit_type_description\n    , cast(med.discharge_disposition_code as TEXT ) as discharge_disposition_code\n    , cast(med.discharge_disposition_description as TEXT ) as discharge_disposition_description\n    , cast(med.place_of_service_code as TEXT ) as place_of_service_code\n    , cast(med.place_of_service_description as TEXT ) as place_of_service_description\n    , cast(med.bill_type_code as TEXT ) as bill_type_code\n    , cast(med.bill_type_description as TEXT ) as bill_type_description\n    , cast(med.drg_code_type as TEXT ) as drg_code_type\n    , cast(med.drg_code as TEXT ) as drg_code\n    , cast(med.drg_description as TEXT ) as drg_description\n    , cast(med.revenue_center_code as TEXT ) as revenue_center_code\n    , cast(med.revenue_center_description as TEXT ) as revenue_center_description\n    , cast(med.service_unit_quantity as numeric(28,6) ) as service_unit_quantity\n    , cast(med.hcpcs_code as TEXT ) as hcpcs_code\n    , cast(med.hcpcs_modifier_1 as TEXT ) as hcpcs_modifier_1\n    , cast(med.hcpcs_modifier_2 as TEXT ) as hcpcs_modifier_2\n    , cast(med.hcpcs_modifier_3 as TEXT ) as hcpcs_modifier_3\n    , cast(med.hcpcs_modifier_4 as TEXT ) as hcpcs_modifier_4\n    , cast(med.hcpcs_modifier_5 as TEXT ) as hcpcs_modifier_5\n    , cast(med.rendering_id as TEXT ) as rendering_id\n    , cast(med.rendering_tin as TEXT ) as rendering_tin\n    , cast(med.rendering_name as TEXT ) as rendering_name\n    , cast(med.billing_id as TEXT ) as billing_id\n    , cast(med.billing_tin as TEXT ) as billing_tin\n    , cast(med.billing_name as TEXT ) as billing_name\n    , cast(med.facility_id as TEXT ) as facility_id\n    , cast(med.facility_name as TEXT ) as facility_name\n    , try_cast( med.paid_date as date ) as paid_date\n    , cast(med.paid_amount as numeric(28,6) ) as paid_amount\n    , cast(med.allowed_amount as numeric(28,6) ) as allowed_amount\n    , cast(med.charge_amount as numeric(28,6) ) as charge_amount\n    , cast(med.coinsurance_amount as numeric(28,6) ) as coinsurance_amount\n    , cast(med.copayment_amount as numeric(28,6) ) as copayment_amount\n    , cast(med.deductible_amount as numeric(28,6) ) as deductible_amount\n    , cast(med.total_cost_amount as numeric(28,6) ) as total_cost_amount\n    , cast(med.in_network_flag as int ) as in_network_flag\n    , cast(\n    case\n        when enroll.claim_id is not null then 1\n            else 0\n    end as int) as enrollment_flag\n    , enroll.member_month_key\n    , cast(med.data_source as TEXT ) as data_source\n    , cast('2025-02-25 21:25:59.177756+00:00' as timestamp ) as tuva_last_run\nfrom tuva.claims_preprocessing.normalized_input_medical_claim as med\ninner join tuva.claims_preprocessing.service_category_grouper as srv_group\n  on med.claim_id = srv_group.claim_id\n  and med.claim_line_number = srv_group.claim_line_number\n  and srv_group.duplicate_row_number = 1\ninner join all_encounters as x\n  on med.claim_id = x.claim_id\n  and med.claim_line_number = x.claim_line_number\nleft join tuva.claims_preprocessing.flag_claims_with_enrollment as enroll\n  on med.claim_id = enroll.claim_id\n  and med.claim_line_number = enroll.claim_line_number\n  and med.person_id = enroll.person_id\n  and med.payer = enroll.payer\n  and med.plan = enroll.plan\n  and med.data_source = enroll.data_source", "relation_name": "tuva.core._stg_claims_medical_claim"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.310229Z", "completed_at": "2025-02-25T21:26:26.319989Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.320465Z", "completed_at": "2025-02-25T21:26:26.320470Z"}], "thread_id": "Thread-1", "execution_time": 0.011673212051391602, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.orphaned_claim__encounter_grain", "compiled": true, "compiled_code": "\n\nwith encounter_date as (\n    select\n        cli.encounter_id\n      , min(stg.start_date) as encounter_start_date\n      , max(stg.start_date) as encounter_end_date\n    from tuva.claims_preprocessing.encounters__stg_medical_claim as stg\n    inner join tuva.claims_preprocessing.encounters__orphaned_claims as cli\n      on stg.claim_id = cli.claim_id\n      and stg.claim_line_number = cli.claim_line_number\n    group by\n        cli.encounter_id\n)\n\n,detail_values as (\n    select stg.*\n    ,cli.encounter_id\n    ,cli.encounter_type\n    ,cli.encounter_group\n    ,d.encounter_start_date \n    ,d.encounter_end_date\n    , row_number() over (partition by cli.encounter_id order by stg.claim_type, stg.start_date) as encounter_row_number --institutional then professional\n    from  tuva.claims_preprocessing.encounters__stg_medical_claim stg\n    inner join tuva.claims_preprocessing.encounters__orphaned_claims cli on stg.claim_id = cli.claim_id  \n    and\n    stg.claim_line_number = cli.claim_line_number\n    inner join encounter_date d on cli.encounter_id = d.encounter_id\n)\n\n, patient as (\n    select \n        patient_data_source_id\n        , birth_date\n        , gender\n        , race\n    from tuva.claims_preprocessing.encounters__stg_eligibility\n    where patient_row_num = 1\n    )\n\n, total_amounts as (\n    select \n    encounter_id\n    , encounter_type\n    , encounter_group\n    , sum(paid_amount) as total_paid_amount\n    , sum(allowed_amount) as total_allowed_amount\n    , sum(charge_amount) as total_charge_amount\n    , count(distinct claim_id) as claim_count\n    , count(distinct(case when claim_type = 'institutional' then claim_id else null end))  as inst_claim_count\n    , count(distinct(case when claim_type = 'professional' then claim_id else null end))  as prof_claim_count\nfrom detail_values\ngroup by encounter_id\n,encounter_type \n,encounter_group\n)\n\n\n,highest_paid_diagnosis as \n(\n  select encounter_id\n  , diagnosis_code_1\n  , diagnosis_code_type\n  , row_number() over (partition by encounter_id order by sum(paid_amount) desc ) as paid_order\n  , sum(paid_amount) as paid_amount\n  from detail_values\n  where diagnosis_code_1 is not null\n  group by diagnosis_code_1\n  , encounter_id\n  , diagnosis_code_type\n)\n\n,highest_paid_facility as \n(\n  select encounter_id\n  , facility_id\n  , row_number() over (partition by encounter_id order by sum(paid_amount) desc ) as paid_order\n  , sum(paid_amount) as paid_amount\n  from detail_values\n  where facility_id is not null\n  group by \n   encounter_id\n  , facility_id\n)\n\n,highest_paid_pos as \n(\n  select encounter_id\n  , place_of_service_code\n  , place_of_service_description\n  , row_number() over (partition by encounter_id order by sum(paid_amount) desc ) as paid_order\n  , sum(paid_amount) as paid_amount\n  from detail_values\n  where place_of_service_code is not null\n  group by \n   encounter_id\n  , place_of_service_code\n  , place_of_service_description\n)\n\n\n\n, service_category_flags as (\n    select distinct\n        d.encounter_id\n       ,max(case when scr.service_category_2 = 'lab' then 1 else 0 end) as lab_flag\n       ,max(case when scr.service_category_2 = 'ambulance' then 1 else 0 end) as ambulance_flag\n       ,max(case when scr.service_category_2 = 'durable medical equipment' then 1 else 0 end) as dme_flag\n       ,max(case when scr.service_category_2 = 'observation' then 1 else 0 end) as observation_flag\n       ,max(case when scr.service_category_2 = 'pharmacy' then 1 \n              else 0 end) as pharmacy_flag\n    from detail_values d\n    left join tuva.claims_preprocessing.service_category_grouper scr on d.claim_id = scr.claim_id \n    and\n    scr.claim_line_number = d.claim_line_number\n    group by d.encounter_id\n)\n\nselect   d.encounter_id\n, d.encounter_start_date\n, d.encounter_end_date\n, d.patient_data_source_id\n,tot.encounter_type\n,tot.encounter_group\n, datediff(\n        day,\n        birth_date,\n        d.encounter_start_date\n        )/365 as admit_age\n, e.gender\n, e.race\n, hp.diagnosis_code_type as primary_diagnosis_code_type\n, hp.diagnosis_code_1 as primary_diagnosis_code\n, coalesce(icd10cm.long_description, icd9cm.long_description) as primary_diagnosis_description\n, hf.facility_id as facility_id\n, b.provider_organization_name as facility_name\n, b.primary_specialty_description as facility_type\n, sc.lab_flag\n, sc.dme_flag\n, sc.ambulance_flag\n, sc.pharmacy_flag\n, pos.place_of_service_code\n, pos.place_of_service_description\n, tot.total_paid_amount\n, tot.total_allowed_amount\n, tot.total_charge_amount\n, tot.claim_count\n, tot.inst_claim_count\n, tot.prof_claim_count\n, d.data_source\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom detail_values d\ninner join total_amounts tot on d.encounter_id = tot.encounter_id\ninner join service_category_flags sc on d.encounter_id = sc.encounter_id\nleft join highest_paid_diagnosis hp on d.encounter_id = hp.encounter_id\nand\nhp.paid_order = 1\nleft join highest_paid_facility hf on d.encounter_id = hf.encounter_id\nand\nhf.paid_order = 1\nleft join highest_paid_pos pos on d.encounter_id = pos.encounter_id\nand\npos.paid_order = 1\nleft join patient e\n  on d.patient_data_source_id = e.patient_data_source_id\nleft join tuva.terminology.provider b\n  on hf.facility_id = b.npi\nleft join tuva.terminology.icd_10_cm icd10cm\n  on hp.diagnosis_code_1 = icd10cm.icd_10_cm\n  and hp.diagnosis_code_type = 'icd-10-cm'\nleft join tuva.terminology.icd_9_cm icd9cm\n  on hp.diagnosis_code_1 = icd9cm.icd_9_cm\n  and hp.diagnosis_code_type = 'icd-9-cm'\nwhere d.encounter_row_number = 1", "relation_name": "tuva.claims_preprocessing.orphaned_claim__encounter_grain"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.433747Z", "completed_at": "2025-02-25T21:26:26.440263Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.440804Z", "completed_at": "2025-02-25T21:26:26.440810Z"}], "thread_id": "Thread-2", "execution_time": 0.011654138565063477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.not_null_core__condition_person_id.7f81399829", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect person_id\nfrom tuva.core.condition\nwhere person_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.437072Z", "completed_at": "2025-02-25T21:26:26.441378Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.445617Z", "completed_at": "2025-02-25T21:26:26.445625Z"}], "thread_id": "Thread-1", "execution_time": 0.012265920639038086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.unique_core__condition_condition_id.ef1067e2f0", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    condition_id as unique_field,\n    count(*) as n_records\n\nfrom tuva.core.condition\nwhere condition_id is not null\ngroup by condition_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.465623Z", "completed_at": "2025-02-25T21:26:26.473423Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.473896Z", "completed_at": "2025-02-25T21:26:26.473901Z"}], "thread_id": "Thread-1", "execution_time": 0.013072967529296875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.not_null_core__procedure_person_id.6727e33118", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect person_id\nfrom tuva.core.procedure\nwhere person_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.469993Z", "completed_at": "2025-02-25T21:26:26.474475Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.477873Z", "completed_at": "2025-02-25T21:26:26.477879Z"}], "thread_id": "Thread-3", "execution_time": 0.012621879577636719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.unique_core__procedure_procedure_id.feb1b6b4d5", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    procedure_id as unique_field,\n    count(*) as n_records\n\nfrom tuva.core.procedure\nwhere procedure_id is not null\ngroup by procedure_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.474905Z", "completed_at": "2025-02-25T21:26:26.479315Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.487062Z", "completed_at": "2025-02-25T21:26:26.487069Z"}], "thread_id": "Thread-2", "execution_time": 0.013521194458007812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.core__medical_claim", "compiled": true, "compiled_code": "\n\nselect * from tuva.core._stg_claims_medical_claim", "relation_name": "tuva.core.medical_claim"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.479506Z", "completed_at": "2025-02-25T21:26:26.494554Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.495100Z", "completed_at": "2025-02-25T21:26:26.495106Z"}], "thread_id": "Thread-1", "execution_time": 0.016870975494384766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.core__stg_claims_location", "compiled": true, "compiled_code": "\n\nwith all_providers_in_claims_dataset as (\nselect distinct facility_id as npi\nfrom tuva.core._stg_claims_medical_claim\n\n\nunion distinct\n\n\nselect distinct rendering_id as npi\nfrom tuva.core._stg_claims_medical_claim\n\n\nunion distinct\n\n\nselect distinct billing_id as npi\nfrom tuva.core._stg_claims_medical_claim\n\n\nunion distinct\n\n\nselect distinct prescribing_provider_id as npi\nfrom tuva.core._stg_claims_pharmacy_claim\n\n\nunion distinct\n\n\nselect distinct dispensing_provider_id as npi\nfrom tuva.core._stg_claims_pharmacy_claim\n),\n\n\nprovider as (\nselect aa.*\nfrom tuva.terminology.provider aa\ninner join all_providers_in_claims_dataset bb\non aa.npi = bb.npi\nwhere lower(aa.entity_type_description) = 'organization'\n)\n\n\n\nselect \n    cast(npi as TEXT ) as location_id\n    , cast(npi as TEXT ) as npi\n    , cast(provider_organization_name as TEXT ) as name\n    , cast(null as TEXT ) as facility_type\n    , cast(parent_organization_name as TEXT ) as parent_organization\n    , cast(practice_address_line_1 as TEXT ) as address\n    , cast(practice_city as TEXT ) as city\n    , cast(practice_state as TEXT ) as state\n    , cast(practice_zip_code as TEXT ) as zip_code\n    , cast(null as float ) as latitude\n    , cast(null as float ) as longitude\n    , cast(null as TEXT ) as data_source\n    , cast( '2025-02-25 21:25:59.177756+00:00' as timestamp ) as tuva_last_run\nfrom provider", "relation_name": "tuva.core._stg_claims_location"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.487569Z", "completed_at": "2025-02-25T21:26:26.495727Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.508850Z", "completed_at": "2025-02-25T21:26:26.508856Z"}], "thread_id": "Thread-3", "execution_time": 0.029813051223754883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.core__stg_claims_practitioner", "compiled": true, "compiled_code": "\n\n-- *************************************************\n-- This dbt model creates the provider table \n-- in core. It includes data about all providers\n-- present in the raw claims dataset.\n-- *************************************************\n\n\nwith all_providers_in_claims_dataset as (\nselect distinct facility_id as npi\nfrom tuva.core._stg_claims_medical_claim\n\n\nunion distinct\n\n\nselect distinct rendering_id as npi\nfrom tuva.core._stg_claims_medical_claim\n\n\nunion distinct\n\n\nselect distinct billing_id as npi\nfrom tuva.core._stg_claims_medical_claim\n\n\nunion distinct\n\n\nselect distinct prescribing_provider_id as npi\nfrom tuva.core._stg_claims_pharmacy_claim\n\n\nunion distinct\n\n\nselect distinct dispensing_provider_id as npi\nfrom tuva.core._stg_claims_pharmacy_claim\n),\n\n\nprovider as (\nselect aa.*\nfrom tuva.terminology.provider aa\ninner join all_providers_in_claims_dataset bb\non aa.npi = bb.npi\nwhere lower(aa.entity_type_description) = 'individual'\n)\n\n\n\nselect \n    cast(npi as TEXT ) as practitioner_id\n    , cast(npi as TEXT ) as npi\n    , cast(provider_first_name as TEXT ) as provider_first_name\n    , cast(provider_last_name as TEXT ) as provider_last_name\n    , cast(parent_organization_name as TEXT ) as practice_affiliation\n    , cast(primary_specialty_description as TEXT ) as specialty\n    , cast(null as TEXT ) as sub_specialty\n    , cast(null as TEXT ) as data_source\n    , cast('2025-02-25 21:25:59.177756+00:00' as timestamp ) as tuva_last_run\nfrom provider", "relation_name": "tuva.core._stg_claims_practitioner"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.510787Z", "completed_at": "2025-02-25T21:26:26.534670Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.534896Z", "completed_at": "2025-02-25T21:26:26.534902Z"}], "thread_id": "Thread-1", "execution_time": 0.025581836700439453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ccsr__long_condition_category", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte__ccsr__stg_core__condition as (\n\n\nselect\n    encounter_id\n    , claim_id\n    , person_id\n    , normalized_code\n    , condition_rank\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.condition\nwhere normalized_code_type = 'icd-10-cm'\n), ccsr__dx_vertical_pivot as (\n    \n    select * from tuva.ccsr.dx_vertical_pivot \n\n)\n\n, condition as (\n    \n    select * from __dbt__cte__ccsr__stg_core__condition\n\n)\n\n, dxccsr_body_systems as (\n\n    select * from tuva.ccsr._value_set_dxccsr_v2023_1_body_systems\n\n)\n\nselect \n      condition.encounter_id\n    , condition.claim_id\n    , condition.person_id\n    , condition.normalized_code\n    , ccsr__dx_vertical_pivot.code_description\n    , condition.condition_rank\n    , ccsr__dx_vertical_pivot.ccsr_parent_category\n    , dxccsr_body_systems.body_system\n    , dxccsr_body_systems.parent_category_description\n    , ccsr__dx_vertical_pivot.ccsr_category\n    , ccsr__dx_vertical_pivot.ccsr_category_description\n    , ccsr__dx_vertical_pivot.ccsr_category_rank\n    , ccsr__dx_vertical_pivot.is_ip_default_category\n    , ccsr__dx_vertical_pivot.is_op_default_category\n    , '2023.1' as dxccsr_version\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom condition\nleft join ccsr__dx_vertical_pivot\n    on condition.normalized_code = ccsr__dx_vertical_pivot.code\nleft join dxccsr_body_systems on ccsr__dx_vertical_pivot.ccsr_parent_category = dxccsr_body_systems.ccsr_parent_category", "relation_name": "tuva.ccsr.long_condition_category"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.518960Z", "completed_at": "2025-02-25T21:26:26.542268Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.548815Z", "completed_at": "2025-02-25T21:26:26.548822Z"}], "thread_id": "Thread-3", "execution_time": 0.03857779502868652, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.hcc_suspecting__int_prep_conditions", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte___stg_condition as (\n\nselect\n      claim_id\n    , person_id\n    , recorded_date\n    , condition_type\n    , lower(normalized_code_type) as code_type\n    , normalized_code as code\n    , data_source\nfrom tuva.core.condition\n), conditions as (\n\n    select\n          person_id\n        , recorded_date\n        , condition_type\n        , code_type\n        , code\n        , data_source\n    from __dbt__cte___stg_condition\n\n)\n\n/*\n    Default mapping guidance: Most map groups terminate with an unconditional\n    rule \u2013 a rule whose predicate is \u201cTRUE\u201d or, equivalently, \u201cOTHERWISE TRUE\u201d.\n    This rule is considered a \u201cdefault\u201d because it should be applied if\n    nothing further is known about the patient\u2019s condition.\n*/\n, seed_snomed_icd_10_map as (\n\n    select\n          referenced_component_id as snomed_code\n        , map_target as icd_10_code\n    from tuva.terminology.snomed_icd_10_map\n    where lower(map_rule) in ('true', 'otherwise true')\n    and map_group = '1'\n\n)\n\n, snomed_conditions as (\n\n    select\n          person_id\n        , recorded_date\n        , condition_type\n        , 'icd-10-cm' as code_type\n        , icd_10_code as code\n        , data_source\n    from conditions\n         inner join seed_snomed_icd_10_map\n         on conditions.code = seed_snomed_icd_10_map.snomed_code\n    where conditions.code_type = 'snomed-ct'\n\n)\n\n, other_conditions as (\n\n    select\n          person_id\n        , recorded_date\n        , condition_type\n        , code_type\n        , code\n        , data_source\n    from conditions\n    where conditions.code_type <> 'snomed-ct'\n\n)\n\n, union_conditions as (\n\n    select * from snomed_conditions\n    union all\n    select * from other_conditions\n\n)\n\n, add_data_types as (\n\n    select\n          cast(person_id as TEXT) as person_id\n        , cast(recorded_date as date) as recorded_date\n        , cast(condition_type as TEXT) as condition_type\n        , cast(code_type as TEXT) as code_type\n        , cast(code as TEXT) as code\n        , cast(data_source as TEXT) as data_source\n    from union_conditions\n\n)\n\nselect\n      person_id\n    , recorded_date\n    , condition_type\n    , code_type\n    , code\n    , data_source\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.hcc_suspecting._int_prep_conditions"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.549883Z", "completed_at": "2025-02-25T21:26:26.554831Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.555049Z", "completed_at": "2025-02-25T21:26:26.555053Z"}], "thread_id": "Thread-3", "execution_time": 0.005658149719238281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.not_null_quality_measures__stg_core__condition_person_id.41bf288421", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nwith __dbt__cte___stg_condition as (\n\nselect\n      person_id\n    , claim_id\n    , encounter_id\n    , recorded_date\n    , source_code_type\n    , source_code\n    , normalized_code_type\n    , normalized_code\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.condition\n) select person_id\nfrom __dbt__cte___stg_condition\nwhere person_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.535953Z", "completed_at": "2025-02-25T21:26:26.562338Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.563048Z", "completed_at": "2025-02-25T21:26:26.563054Z"}], "thread_id": "Thread-1", "execution_time": 0.027592897415161133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.quality_measures__int_cqm438_denominator_criteria3", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte___stg_condition as (\n\nselect\n      person_id\n    , claim_id\n    , encounter_id\n    , recorded_date\n    , source_code_type\n    , source_code\n    , normalized_code_type\n    , normalized_code\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.condition\n), diabetes_codes as (\n\n    select\n          code\n        , code_system\n        , concept_name\n    from tuva.quality_measures._value_set_codes\n    where lower(concept_name) in (\n              'diabetes'\n        )\n\n)\n\n, conditions as (\n\n    select\n          person_id\n        , claim_id\n        , encounter_id\n        , recorded_date\n        , source_code\n        , source_code_type\n        , normalized_code\n        , normalized_code_type\n    from __dbt__cte___stg_condition\n\n)\n\n, diabetes_conditions as (\n\n    select\n          conditions.person_id\n        , conditions.recorded_date as evidence_date\n    from conditions\n    inner join diabetes_codes\n        on coalesce(conditions.normalized_code_type, conditions.source_code_type) = diabetes_codes.code_system\n            and coalesce(conditions.normalized_code, conditions.source_code) = diabetes_codes.code\n\n)\n\n, patients_with_diabetes as (\n\n    select\n        distinct\n          person_id\n        , performance_period_begin\n        , performance_period_end\n        , measure_id\n        , measure_name\n        , measure_version \n    from diabetes_conditions\n    inner join tuva.quality_measures._int_cqm438__performance_period pp\n    on evidence_date <= pp.performance_period_end\n\n)\n\n, add_data_types as (\n\n    select\n          cast(person_id as TEXT) as person_id\n        , cast(performance_period_begin as date) as performance_period_begin\n        , cast(performance_period_end as date) as performance_period_end\n        , cast(measure_id as TEXT) as measure_id\n        , cast(measure_name as TEXT) as measure_name\n        , cast(measure_version as TEXT) as measure_version\n    from patients_with_diabetes\n\n)\n\nselect \n      person_id\n    , performance_period_begin\n    , performance_period_end\n    , measure_id\n    , measure_name\n    , measure_version\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.quality_measures._int_cqm438_denominator_criteria3"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.556055Z", "completed_at": "2025-02-25T21:26:26.571772Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.572034Z", "completed_at": "2025-02-25T21:26:26.572040Z"}], "thread_id": "Thread-3", "execution_time": 0.01646709442138672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.chronic_conditions__tuva_chronic_conditions_long", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte__tuva_chronic_conditions__stg_core__condition as (\n\n\nselect \n      person_id\n    , normalized_code\n    , recorded_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.condition\n), all_conditions as (\nselect \n  person_id,\n  normalized_code,\n  recorded_date\n    from __dbt__cte__tuva_chronic_conditions__stg_core__condition\n),\n\n\nconditions_with_first_and_last_diagnosis_date as (\nselect \n  person_id,\n  normalized_code as icd_10_cm,\n  min(recorded_date) as first_diagnosis_date,\n  max(recorded_date) as last_diagnosis_date\nfrom all_conditions\ngroup by person_id, normalized_code\n\n)\n\n\nselect\n  aa.person_id,\n  bb.concept_name as condition,\n  min(first_diagnosis_date) as first_diagnosis_date,\n  max(last_diagnosis_date) as last_diagnosis_date,\n  '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom conditions_with_first_and_last_diagnosis_date aa\ninner join tuva.clinical_concept_library.value_set_member_relevant_fields bb\non aa.icd_10_cm = bb.code\ngroup by aa.person_id, bb.concept_name", "relation_name": "tuva.chronic_conditions.tuva_chronic_conditions_long"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.564428Z", "completed_at": "2025-02-25T21:26:26.573292Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.574694Z", "completed_at": "2025-02-25T21:26:26.574699Z"}], "thread_id": "Thread-1", "execution_time": 0.010911941528320312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ccsr__long_procedure_category", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte__ccsr__stg_core__procedure as (\n\n\nselect \n      encounter_id\n    , claim_id\n    , person_id\n    , normalized_code\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.procedure\n), procedures as (\n\n    select * from __dbt__cte__ccsr__stg_core__procedure\n\n)\n\n, ccsr__procedure_category_map as (\n\n    select * from tuva.ccsr.procedure_category_map\n\n)\n\nselect distinct\n      procedures.encounter_id\n    , procedures.claim_id\n    , procedures.person_id\n    , procedures.normalized_code\n    , ccsr__procedure_category_map.code_description\n    , ccsr__procedure_category_map.ccsr_parent_category\n    , ccsr__procedure_category_map.ccsr_category\n    , ccsr__procedure_category_map.ccsr_category_description\n    , ccsr__procedure_category_map.clinical_domain\n    , '2023.1' as prccsr_version\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom procedures\nleft join ccsr__procedure_category_map\n    on procedures.normalized_code = ccsr__procedure_category_map.code", "relation_name": "tuva.ccsr.long_procedure_category"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.575871Z", "completed_at": "2025-02-25T21:26:26.627248Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.627534Z", "completed_at": "2025-02-25T21:26:26.627542Z"}], "thread_id": "Thread-3", "execution_time": 0.05320382118225098, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.quality_measures__int_cqm438_denominator_criteria1", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte___stg_condition as (\n\nselect\n      person_id\n    , claim_id\n    , encounter_id\n    , recorded_date\n    , source_code_type\n    , source_code\n    , normalized_code_type\n    , normalized_code\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.condition\n),  __dbt__cte___stg_procedure as (\n\nselect\n      person_id\n    , encounter_id\n    , procedure_date\n    , source_code_type\n    , source_code\n    , normalized_code_type\n    , normalized_code\n    , modifier_1\n    , modifier_2\n    , modifier_3\n    , modifier_4\n    , modifier_5\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.procedure\n), ascvd_codes as (\n\n    select\n          code\n        , code_system\n    from tuva.quality_measures._value_set_codes\n    where lower(concept_name) in (\n              'atherosclerosis and peripheral arterial disease'\n            , 'myocardial infarction'\n            , 'pci'\n            , 'stable and unstable angina'\n            , 'cabg or pci procedure'\n            , 'cabg surgeries'\n            , 'cerebrovascular disease stroke or tia'\n            , 'ischemic heart disease or related diagnoses'\n            , 'carotid intervention'\n        )\n\n)\n\n, conditions as (\n\n    select\n          person_id\n        , claim_id\n        , encounter_id\n        , recorded_date\n        , source_code\n        , source_code_type\n        , normalized_code\n        , normalized_code_type\n    from __dbt__cte___stg_condition\n\n)\n\n, ascvd_conditions as (\n\n    select\n          conditions.person_id\n        , conditions.recorded_date as evidence_date\n    from conditions\n    inner join ascvd_codes\n        on coalesce(conditions.normalized_code_type, conditions.source_code_type) = ascvd_codes.code_system\n            and coalesce(conditions.normalized_code, conditions.source_code) = ascvd_codes.code\n\n)\n\n, procedures as (\n\n    select\n          person_id\n        , procedure_date\n        , coalesce (\n              normalized_code_type\n            , case\n                when lower(source_code_type) = 'cpt' then 'hcpcs'\n                when lower(source_code_type) = 'snomed' then 'snomed-ct'\n                else lower(source_code_type)\n              end\n          ) as code_type\n        , coalesce(\n              normalized_code\n            , source_code\n          ) as code\n    from __dbt__cte___stg_procedure\n\n)\n\n, ascvd_procedures as (\n\n    select\n          procedures.person_id\n        , procedures.procedure_date as evidence_date\n    from procedures\n         inner join ascvd_codes\n             on procedures.code = ascvd_codes.code\n             and procedures.code_type = ascvd_codes.code_system\n\n)\n\n, historical_ascvd as (\n\n    select\n          ascvd_conditions.person_id\n        , ascvd_conditions.evidence_date\n    from ascvd_conditions\n\n    union all\n\n    select\n          ascvd_procedures.person_id\n        , ascvd_procedures.evidence_date\n    from ascvd_procedures\n\n)\n\n, patients_with_ascvd as (\n\n    select\n        distinct\n          historical_ascvd.person_id\n        , pp.performance_period_begin\n        , pp.performance_period_end\n        , pp.measure_id\n        , pp.measure_name\n        , pp.measure_version\n    from historical_ascvd\n    inner join tuva.quality_measures._int_cqm438__performance_period pp\n    on evidence_date <= pp.performance_period_end\n\n)\n\n, add_data_types as (\n\n    select\n          cast(person_id as TEXT) as person_id\n        , cast(performance_period_begin as date) as performance_period_begin\n        , cast(performance_period_end as date) as performance_period_end\n        , cast(measure_id as TEXT) as measure_id\n        , cast(measure_name as TEXT) as measure_name\n        , cast(measure_version as TEXT) as measure_version\n    from patients_with_ascvd\n\n)\n\nselect \n      person_id\n    , performance_period_begin\n    , performance_period_end\n    , measure_id\n    , measure_name\n    , measure_version\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.quality_measures._int_cqm438_denominator_criteria1"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.588932Z", "completed_at": "2025-02-25T21:26:26.628239Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.628815Z", "completed_at": "2025-02-25T21:26:26.628820Z"}], "thread_id": "Thread-1", "execution_time": 0.04056072235107422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.quality_measures__int_cqm438_denominator_criteria2", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte___stg_condition as (\n\nselect\n      person_id\n    , claim_id\n    , encounter_id\n    , recorded_date\n    , source_code_type\n    , source_code\n    , normalized_code_type\n    , normalized_code\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.condition\n),  __dbt__cte___stg_procedure as (\n\nselect\n      person_id\n    , encounter_id\n    , procedure_date\n    , source_code_type\n    , source_code\n    , normalized_code_type\n    , normalized_code\n    , modifier_1\n    , modifier_2\n    , modifier_3\n    , modifier_4\n    , modifier_5\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.procedure\n),  __dbt__cte___stg_lab_result as (\n\n\nselect\n      person_id\n    , result\n    , result_date\n    , collection_date\n    , source_code_type\n    , source_code\n    , normalized_code_type\n    , normalized_code\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.lab_result\n\n\n), cholesterol_codes as (\n\n    select\n          code\n        , code_system\n        , concept_name\n    from tuva.quality_measures._value_set_codes\n    where lower(concept_name) in (\n              'ldl cholesterol'\n            , 'familial hypercholesterolemia'\n        )\n\n)\n\n, conditions as (\n\n    select\n          person_id\n        , claim_id\n        , encounter_id\n        , recorded_date\n        , source_code\n        , source_code_type\n        , normalized_code\n        , normalized_code_type\n    from __dbt__cte___stg_condition\n\n)\n\n, cholesterol_conditions as (\n\n    select\n          conditions.person_id\n        , conditions.recorded_date as evidence_date\n    from conditions\n    inner join cholesterol_codes\n        on coalesce(conditions.normalized_code_type, conditions.source_code_type) = cholesterol_codes.code_system\n            and coalesce(conditions.normalized_code, conditions.source_code) = cholesterol_codes.code\n\n)\n\n, procedures as (\n\n    select\n          person_id\n        , procedure_date\n        , coalesce (\n              normalized_code_type\n            , case\n                when lower(source_code_type) = 'cpt' then 'hcpcs'\n                when lower(source_code_type) = 'snomed' then 'snomed-ct'\n                else lower(source_code_type)\n              end\n          ) as code_type\n        , coalesce(\n              normalized_code\n            , source_code\n          ) as code\n    from __dbt__cte___stg_procedure\n\n)\n\n, cholesterol_procedures as (\n\n    select\n          procedures.person_id\n        , procedures.procedure_date as evidence_date\n    from procedures\n         inner join cholesterol_codes\n             on procedures.code = cholesterol_codes.code\n             and procedures.code_type = cholesterol_codes.code_system\n\n)\n\n, labs as (\n\n    select\n          person_id\n        , result\n        , result_date\n        , collection_date\n        , source_code_type\n        , source_code\n        , normalized_code_type\n        , normalized_code\n    from __dbt__cte___stg_lab_result\n\n)\n\n, cholesterol_tests_with_result as (\n\n    select\n      labs.person_id\n    , labs.result as evidence_value\n    , coalesce(collection_date, result_date) as evidence_date\n    , cholesterol_codes.concept_name\n    , row_number() over(partition by labs.person_id order by\n                          labs.result desc\n                        , result_date desc) as rn\n    from labs\n    inner join cholesterol_codes\n      on coalesce(labs.normalized_code, labs.source_code) = cholesterol_codes.code\n        and coalesce(labs.normalized_code_type, labs.source_code_type) = cholesterol_codes.code_system\n   \n        where regexp_like(result, '^[+-]?([0-9]*[.])?[0-9]+$')\n    \n\n)\n\n, cholesterol_labs as (\n\n    select\n          person_id\n        , evidence_date\n    from cholesterol_tests_with_result\n    where rn= 1\n        and cast(evidence_value as numeric(28,6)) >= 190\n\n)\n\n, all_patients_with_cholesterol as (\n\n    select\n          cholesterol_conditions.person_id\n        , cholesterol_conditions.evidence_date\n    from cholesterol_conditions\n\n    union all\n\n    select\n          cholesterol_procedures.person_id\n        , cholesterol_procedures.evidence_date\n    from cholesterol_procedures\n\n    union all\n\n    select\n          cholesterol_labs.person_id\n        , cholesterol_labs.evidence_date\n    from cholesterol_labs\n\n)\n\n, patients_with_cholesterol as (\n\n    select\n        distinct\n          person_id\n        , performance_period_begin\n        , performance_period_end\n        , measure_id\n        , measure_name\n        , measure_version\n    from all_patients_with_cholesterol\n    inner join tuva.quality_measures._int_cqm438__performance_period pp\n    on evidence_date <= pp.performance_period_end\n\n)\n\n, add_data_types as (\n\n    select\n          cast(person_id as TEXT) as person_id\n        , cast(performance_period_begin as date) as performance_period_begin\n        , cast(performance_period_end as date) as performance_period_end\n        , cast(measure_id as TEXT) as measure_id\n        , cast(measure_name as TEXT) as measure_name\n        , cast(measure_version as TEXT) as measure_version\n    from patients_with_cholesterol\n\n)\n\nselect\n      person_id\n    , performance_period_begin\n    , performance_period_end\n    , measure_id\n    , measure_name\n    , measure_version\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.quality_measures._int_cqm438_denominator_criteria2"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.629714Z", "completed_at": "2025-02-25T21:26:26.641047Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.641301Z", "completed_at": "2025-02-25T21:26:26.641307Z"}], "thread_id": "Thread-3", "execution_time": 0.012849092483520508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.not_null_quality_measures__stg_core__procedure_person_id.d4aee2f83a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nwith __dbt__cte___stg_procedure as (\n\nselect\n      person_id\n    , encounter_id\n    , procedure_date\n    , source_code_type\n    , source_code\n    , normalized_code_type\n    , normalized_code\n    , modifier_1\n    , modifier_2\n    , modifier_3\n    , modifier_4\n    , modifier_5\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.procedure\n) select person_id\nfrom __dbt__cte___stg_procedure\nwhere person_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.634990Z", "completed_at": "2025-02-25T21:26:26.645640Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.645869Z", "completed_at": "2025-02-25T21:26:26.645874Z"}], "thread_id": "Thread-1", "execution_time": 0.011486053466796875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.readmissions__procedure_ccs", "compiled": true, "compiled_code": "\n\nwith __dbt__cte__readmissions__stg_core__procedure as (\n\n\nselect\n  encounter_id\n, normalized_code\n, normalized_code_type\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.procedure\n) -- Here we map every procedure code to its corresponding\n-- CCS procedure category.\n-- This model may list more than one CCS procedure category\n-- per encounter_id because different procedures associated with the\n-- encounter (different rows on the stg_procedure model) may have\n-- different associated CCS procedure categories.\n\n\n\nselect\n    aa.encounter_id,\n    aa.normalized_code as procedure_code,\n    case\n        when bb.icd_10_pcs is null then 0\n\telse 1\n    end as valid_icd_10_pcs_flag,\n    cc.ccs_procedure_category,\n    '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom\n    __dbt__cte__readmissions__stg_core__procedure aa\n    left join tuva.terminology.icd_10_pcs bb\n    on aa.normalized_code = bb.icd_10_pcs\n    left join tuva.readmissions._value_set_icd_10_pcs_to_ccs cc\n    on aa.normalized_code = cc.icd_10_pcs\nwhere aa.normalized_code_type = 'icd-10-pcs'", "relation_name": "tuva.readmissions._int_procedure_ccs"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.651253Z", "completed_at": "2025-02-25T21:26:26.664895Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.665144Z", "completed_at": "2025-02-25T21:26:26.665150Z"}], "thread_id": "Thread-3", "execution_time": 0.0144500732421875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__data_loss", "compiled": true, "compiled_code": "\n\nwith input_medical as (\n  select\n      cast('medical_claim' as TEXT) as table_name\n    , count(distinct person_id) as patient_count\n    , count(distinct claim_id) as claim_count\n    , count(*) as record_count\n    , sum(paid_amount) as paid_amount\n    , sum(allowed_amount) as allowed_amount\n  from tuva.input_layer.medical_claim\n)\n\n, input_pharmacy as (\n  select\n      cast('pharmacy_claim' as TEXT) as table_name\n    , count(distinct person_id) as patient_count\n    , count(distinct claim_id) as claim_count\n    , count(*) as record_count\n    , sum(paid_amount) as paid_amount\n    , sum(allowed_amount) as allowed_amount\n  from tuva.input_layer.pharmacy_claim\n)\n\n,input_eligibility as (\nselect\n    cast('eligibility' as TEXT) as table_name\n  , count(distinct person_id) as patient_count\n  , count(distinct member_id || '-' || enrollment_start_date || '-' || enrollment_end_date || '-' || payer || '-' || plan) as span_count\nfrom tuva.input_layer.eligibility\n)\n\n  , input_member_months as (\n  select\n      cast('eligibility' as TEXT) as table_name\n    , count(*) as member_month_count\n  from tuva.data_quality.data_quality__eligibility_dq_stage e\n)\n\n-- Core layer CTEs\n, core_medical as (\n  select\n     cast( 'medical_claim' as TEXT) as table_name\n    , count(distinct person_id) as patient_count\n    , count(distinct claim_id) as claim_count\n    , count(*) as record_count\n    , sum(paid_amount) as paid_amount\n    , sum(allowed_amount) as allowed_amount\n  from tuva.core.medical_claim\n)\n\n, core_pharmacy as (\n  select\n     cast( 'pharmacy_claim' as TEXT) as table_name\n    , count(distinct person_id) as patient_count\n    , count(distinct claim_id) as claim_count\n    , count(*) as record_count\n    , sum(paid_amount) as paid_amount\n    , sum(allowed_amount) as allowed_amount\n  from tuva.core.pharmacy_claim\n)\n\n, core_eligibility as (\n  select\n    cast('eligibility'  as TEXT)as table_name\n    , count(distinct person_id) as patient_count\n    , count(*) as span_count\n  from tuva.core.eligibility\n)\n\n, core_member_months as (\n  select\n    cast('member_months' as TEXT) as table_name\n    , count(*) as member_month_count\n  from tuva.core.member_months\n)\n\n,final as (\n-- Combining both input and core layers\nselect\n    input.table_name\n  , cast('Total Unique Patients' as TEXT) as metric\n  , input.patient_count as input_layer_value\n  , core.patient_count as core_value\nfrom input_medical as input\ninner join core_medical as core\n  on input.table_name = core.table_name\n\nunion all\n\nselect\n    input.table_name\n  , cast('Total Unique Claims' as TEXT) as metric\n  , input.claim_count as input_layer_value\n  , core.claim_count as core_value\nfrom input_medical as input\ninner join core_medical as core\n  on input.table_name = core.table_name\n\nunion all\n\nselect\n    input.table_name\n  , cast('Total Records' as TEXT) as metric\n  , input.record_count as input_layer_value\n  , core.record_count as core_value\nfrom input_medical as input\ninner join core_medical as core\n  on input.table_name = core.table_name\n\nunion all\n\nselect\n    input.table_name\n  , cast('Total Paid Amount' as TEXT) as metric\n  , input.paid_amount as input_layer_value\n  , core.paid_amount as core_value\nfrom input_medical as input\ninner join core_medical as core\n  on input.table_name = core.table_name\n\nunion all\n\nselect\n    input.table_name\n  , cast('Total Allowed Amount' as TEXT) as metric\n  , input.allowed_amount as input_layer_value\n  , core.allowed_amount as core_value\nfrom input_medical as input\ninner join core_medical as core\n  on input.table_name = core.table_name\n\n-- Pharmacy layer\nunion all\n\nselect\n    input.table_name\n  , cast('Total Unique Patients' as TEXT) as metric\n  , input.patient_count as input_layer_value\n  , core.patient_count as core_value\nfrom input_pharmacy as input\ninner join core_pharmacy as core\n  on input.table_name = core.table_name\n\nunion all\n\nselect\n    input.table_name\n  , cast('Total Unique Claims' as TEXT) as metric\n  , input.claim_count as input_layer_value\n  , core.claim_count as core_value\nfrom input_pharmacy as input\ninner join core_pharmacy as core\n  on input.table_name = core.table_name\n\nunion all\n\nselect\n    input.table_name\n  , cast('Total Records' as TEXT) as metric\n  , input.record_count as input_layer_value\n  , core.record_count as core_value\nfrom input_pharmacy as input\ninner join core_pharmacy as core\n  on input.table_name = core.table_name\n\nunion all\n\nselect\n    input.table_name\n  , cast('Total Paid Amount' as TEXT) as metric\n  , input.paid_amount as input_layer_value\n  , core.paid_amount as core_value\nfrom input_pharmacy as input\ninner join core_pharmacy as core\n  on input.table_name = core.table_name\n\nunion all\n\nselect\n    input.table_name\n  , cast('Total Allowed Amount' as TEXT) as metric\n  , input.allowed_amount as input_layer_value\n  , core.allowed_amount as core_value\nfrom input_pharmacy as input\ninner join core_pharmacy as core\n  on input.table_name = core.table_name\n\n-- Eligibility layer\nunion all\n\nselect\n    input.table_name\n  , cast('Total Unique Patients' as TEXT) as metric\n  , input.patient_count as input_layer_value\n  , core.patient_count as core_value\nfrom input_eligibility as input\ninner join core_eligibility as core\n  on input.table_name = core.table_name\n\n\nunion all\n\nselect\n    input.table_name\n  , cast('Total Unique Eligibility Spans' as TEXT) as metric\n  , input.span_count as input_layer_value\n  , core.span_count as core_value\nfrom input_eligibility as input\ninner join core_eligibility as core\n  on input.table_name = core.table_name\n\nunion all\n\nselect\n    input.table_name\n  , cast('Total Member Months' as TEXT) as metric\n  , input.member_month_count as input_layer_value\n  , core.member_month_count as core_value\nfrom input_member_months as input\ninner join core_member_months as core\n  on input.table_name = core.table_name\n\n)\n\nselect *\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom final", "relation_name": "tuva.data_quality.data_loss"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.661180Z", "completed_at": "2025-02-25T21:26:26.666002Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.666400Z", "completed_at": "2025-02-25T21:26:26.666404Z"}], "thread_id": "Thread-1", "execution_time": 0.005730152130126953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__service_categories_pmpm", "compiled": true, "compiled_code": "\n\nwith member_months as (\n    select\n        cast(count(1) as numeric(28,6)) as member_months \n    from tuva.core.member_months mm\n)\n\n, pmpm as (\n    select\n        cast('service categories pmpm' as TEXT ) as analytics_concept\n        , mc.service_category_2 as analytics_measure\n        , sum(mc.paid_amount) as total_paid\n        , avg(mm.member_months) as member_months\n        , case when avg(mm.member_months) = 0 then null\n               else sum(mc.paid_amount) / avg(mm.member_months)\n          end as data_source_value\n    from tuva.core.medical_claim mc\n    cross join member_months mm\n    group by\n        mc.service_category_2\n)\n\nselect\n    pmpm.*\n    , ref_data.analytics_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom pmpm\nleft join tuva.data_quality._value_set_reference_mart_analytics ref_data\n    on pmpm.analytics_concept = ref_data.analytics_concept\n    and pmpm.analytics_measure = ref_data.analytics_measure", "relation_name": "tuva.data_quality.service_categories_pmpm"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.666750Z", "completed_at": "2025-02-25T21:26:26.674314Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.674530Z", "completed_at": "2025-02-25T21:26:26.674535Z"}], "thread_id": "Thread-3", "execution_time": 0.00883793830871582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__service_category_pmpm_trend", "compiled": true, "compiled_code": "\n\nwith member_months as (\n    select\n        year_month\n      , count(1) as member_months\n    from tuva.core.member_months\n    group by year_month\n)\n\n, service_categories as (\n    select\n        cast(c.year_month_int as TEXT) as year_month\n      , m.service_category_1\n      , m.service_category_2\n      , sum(m.paid_amount) as total_paid\n    from tuva.core.medical_claim as m\n    left join tuva.reference_data.calendar as c\n      on m.claim_start_date = c.full_date\n    group by\n        cast(c.year_month_int as TEXT)\n      , m.service_category_1\n      , m.service_category_2\n)\n\nselect\n    scat.year_month\n  , scat.service_category_1\n  , scat.service_category_2\n  , scat.total_paid\n  , scat.total_paid / mm.member_months as pmpm\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom service_categories as scat\ninner join member_months as mm\n  on scat.year_month = mm.year_month", "relation_name": "tuva.data_quality.service_category_pmpm_trend"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.675613Z", "completed_at": "2025-02-25T21:26:26.687890Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.688113Z", "completed_at": "2025-02-25T21:26:26.688118Z"}], "thread_id": "Thread-3", "execution_time": 0.01305079460144043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.mart_review__stg_medical_claim", "compiled": true, "compiled_code": "\n\nselect mc.*,\ncast(c.year_month_int as TEXT) as year_month\nFROM tuva.core.medical_claim  mc\nleft join tuva.reference_data.calendar c on coalesce(mc.claim_line_start_date,mc.claim_start_date) = c.full_date", "relation_name": "tuva.data_quality.mart_review__stg_medical_claim"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.689791Z", "completed_at": "2025-02-25T21:26:26.695662Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.695882Z", "completed_at": "2025-02-25T21:26:26.695888Z"}], "thread_id": "Thread-3", "execution_time": 0.007192134857177734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.not_null_core__medical_claim_person_id.10967fedc3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect person_id\nfrom tuva.core.medical_claim\nwhere person_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.692963Z", "completed_at": "2025-02-25T21:26:26.696496Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.696933Z", "completed_at": "2025-02-25T21:26:26.696937Z"}], "thread_id": "Thread-1", "execution_time": 0.004508256912231445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.unique_core__medical_claim_medical_claim_id.74a5d63708", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    medical_claim_id as unique_field,\n    count(*) as n_records\n\nfrom tuva.core.medical_claim\nwhere medical_claim_id is not null\ngroup by medical_claim_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.697746Z", "completed_at": "2025-02-25T21:26:26.706696Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.706935Z", "completed_at": "2025-02-25T21:26:26.706941Z"}], "thread_id": "Thread-3", "execution_time": 0.010309219360351562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.core__location", "compiled": true, "compiled_code": "\n\nselect * from tuva.core._stg_claims_location\nunion all\nselect * from tuva.core._stg_clinical_location\n\n", "relation_name": "tuva.core.location"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.702532Z", "completed_at": "2025-02-25T21:26:26.707923Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.708709Z", "completed_at": "2025-02-25T21:26:26.708713Z"}], "thread_id": "Thread-1", "execution_time": 0.006747722625732422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.core__practitioner", "compiled": true, "compiled_code": "\n\nselect * from tuva.core._stg_claims_practitioner\nunion all\nselect * from tuva.core._stg_clinical_practitioner\n\n", "relation_name": "tuva.core.practitioner"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.711592Z", "completed_at": "2025-02-25T21:26:26.722401Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.722638Z", "completed_at": "2025-02-25T21:26:26.722644Z"}], "thread_id": "Thread-3", "execution_time": 0.015032052993774414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ccsr__singular_condition_category", "compiled": true, "compiled_code": "\n\nselect \n      encounter_id\n    , claim_id\n    , person_id\n    , ccsr_category\n    , ccsr_category_description\n    , ccsr_parent_category\n    , parent_category_description\n    , body_system\n    , '2023.1' as dxccsr_version\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ccsr.long_condition_category\nwhere is_ip_default_category = 1\nand condition_rank = 1", "relation_name": "tuva.ccsr.singular_condition_category"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.717890Z", "completed_at": "2025-02-25T21:26:26.723755Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.733566Z", "completed_at": "2025-02-25T21:26:26.733572Z"}], "thread_id": "Thread-1", "execution_time": 0.016239166259765625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.hcc_suspecting__int_all_conditions", "compiled": true, "compiled_code": "\n\nwith conditions as (\n\n    select\n          person_id\n        , recorded_date\n        , condition_type\n        , code_type\n        , code\n        , data_source\n    from tuva.hcc_suspecting._int_prep_conditions\n\n)\n\n, seed_hcc_mapping as (\n\n    select\n          diagnosis_code\n        , cms_hcc_v28 as hcc_code\n    from tuva.hcc_suspecting._value_set_icd_10_cm_mappings\n    where cms_hcc_v28 is not null\n\n)\n\n, seed_hcc_descriptions as (\n\n    select distinct\n          hcc_code\n        , hcc_description\n    from tuva.hcc_suspecting._value_set_hcc_descriptions\n\n)\n\n, joined as (\n\n    select\n          conditions.person_id\n        , conditions.recorded_date\n        , conditions.condition_type\n        , conditions.code\n        , conditions.data_source\n        , seed_hcc_mapping.hcc_code\n        , seed_hcc_descriptions.hcc_description\n    from conditions\n         left join seed_hcc_mapping\n         on conditions.code = seed_hcc_mapping.diagnosis_code\n         left join seed_hcc_descriptions\n         on seed_hcc_mapping.hcc_code = seed_hcc_descriptions.hcc_code\n    where conditions.code_type = 'icd-10-cm'\n\n)\n\n, add_data_types as (\n\n    select\n          cast(person_id as TEXT) as person_id\n        , cast(recorded_date as date) as recorded_date\n        , cast(condition_type as TEXT) as condition_type\n        , cast(code as TEXT) as icd_10_cm_code\n        , cast(hcc_code as TEXT) as hcc_code\n        , cast(hcc_description as TEXT) as hcc_description\n        , cast(data_source as TEXT) as data_source\n    from joined\n\n)\n\nselect\n      person_id\n    , recorded_date\n    , condition_type\n    , icd_10_cm_code\n    , hcc_code\n    , hcc_description\n    , data_source\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.hcc_suspecting._int_all_conditions"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.723948Z", "completed_at": "2025-02-25T21:26:26.738113Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.738334Z", "completed_at": "2025-02-25T21:26:26.738339Z"}], "thread_id": "Thread-3", "execution_time": 0.015089750289916992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.chronic_conditions__tuva_chronic_conditions_wide", "compiled": true, "compiled_code": "\n\nwith patients as (\nselect distinct person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_long\n),\n\nobesity as (\nselect distinct person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_long\nwhere condition = 'Obesity'\n),\n\n\nosteoarthritis as (\nselect distinct person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_long\nwhere condition = 'Osteoarthritis'\n),\n\ncopd as (\nselect distinct person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_long\nwhere condition = 'Chronic Obstructive Pulmonary Disease'\n),\n\nanxiety_disorders as (\nselect distinct person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_long\nwhere condition = 'Anxiety Disorders'\n),\n\nckd as (\nselect distinct person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_long\nwhere condition = 'Chronic Kidney Disease'\n),\n\nt2d as (\nselect distinct person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_long\nwhere condition = 'Type 2 Diabetes Mellitus'\n),\n\ncll as (\nselect distinct person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_long\nwhere condition = 'Chronic Lymphocytic Leukemia'\n),\n\ndysplipidemias as (\nselect distinct person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_long\nwhere condition = 'Dyslipidemias'\n),\n\nhypertension as (\nselect distinct person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_long\nwhere condition = 'Hypertension'\n),\n\natherosclerosis as (\nselect distinct person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_long\nwhere condition = 'Atherosclerosis'\n),\n\ndementia as (\nselect distinct person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_long\nwhere condition = 'Dementia'\n),\n\nrheumatoid_arthritis as (\nselect distinct person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_long\nwhere condition = 'Rheumatoid Arthritis'\n),\n\nceliac as (\nselect distinct person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_long\nwhere condition = 'Celiac Disease'\n),\n\nhip_fracture as (\nselect distinct person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_long\nwhere condition = 'Hip Fracture'\n),\n\nimmunodeficiencies_and_white_blood_cell_disorders as (\nselect distinct person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_long\nwhere condition = 'Specified Immunodeficiencies and White Blood Cell Disorders  (HCC v28 concept #115)'\n),\n\nasthma as (\nselect distinct person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_long\nwhere condition = 'Asthma'\n),\n\nt1d as (\nselect distinct person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_long\nwhere condition = 'Type 1 Diabetes Mellitus'\n),\n\nulcerative_colitis as (\nselect distinct person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_long\nwhere condition = 'Ulcerative colitis'\n),\n\nchrohns as (\nselect distinct person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_long\nwhere condition = 'Crohns Disease'\n),\n\nholicobacter as (\nselect distinct person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_long\nwhere condition = 'Helicobacter pylori Infection'\n),\n\nbipolar as (\nselect distinct person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_long\nwhere condition = 'Bipolar Affective Disorder'\n),\n\nheart_failure as (\nselect distinct person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_long\nwhere condition = 'Heart Failure'\n),\n\ntabacco as (\nselect distinct person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_long\nwhere condition = 'Tobacco Use'\n),\n\nlyme as (\nselect distinct person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_long\nwhere condition = 'Lyme Disease'\n),\n\nbreast_cancer as (\nselect distinct person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_long\nwhere condition = 'Breast Cancer'\n),\n\nosteoporosis as (\nselect distinct person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_long\nwhere condition = 'Osteoporosis'\n),\n\npulmonary_embolism as (\nselect distinct person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_long\nwhere condition = 'Pulmonary Embolism, Thrombotic or Unspecified'\n),\n\nschizophrenia as (\nselect distinct person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_long\nwhere condition = 'Schizophrenia'\n),\n\natrial_fibrillation as (\nselect distinct person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_long\nwhere condition = 'Atrial Fibrillation'\n),\n\ncolorectal_cancer as (\nselect distinct person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_long\nwhere condition = 'Colorectal Cancer'\n),\n\ndepression as (\nselect distinct person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_long\nwhere condition = 'Major Depressive Disorder'\n),\n\ndeep_vein_thrombosis as (\nselect distinct person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_long\nwhere condition = 'Deep Vein Thrombosis of Extremities or Central Veins'\n),\n\nalzheimer as (\nselect distinct person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_long\nwhere condition = 'Alzheimer Disease'\n),\n\nstroke as (\nselect distinct person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_long\nwhere condition = 'Stroke'\n),\n\nmyocardial_infraction as (\nselect distinct person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_long\nwhere condition = 'Myocardial Infarction'\n),\n\nopiod_use_disorder as (\nselect distinct person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_long\nwhere condition = 'Opioid Use Disorder'\n),\n\nlung_cancer as (\nselect distinct person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_long\nwhere condition = 'Lung cancer, primary or unspecified'\n),\n\nherpes as (\nselect distinct person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_long\nwhere condition = 'Herpes Simplex Infection'\n),\n\nrickettsiosis as (\nselect distinct person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_long\nwhere condition = 'Rickettsiosis'\n),\n\nms as (\nselect distinct person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_long\nwhere condition = 'Multiple Sclerosis'\n),\n\nalchohol as (\nselect distinct person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_long\nwhere condition = 'Alcohol Use Disorder'\n),\n\nadhd as (\nselect distinct person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_long\nwhere condition = 'Attention Deficit-Hyperactivity Disorder'\n),\n\nhiv as (\nselect distinct person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_long\nwhere condition = 'HIV/AIDS  (HCC v28 concept #1)'\n),\n\nptsd as (\nselect distinct person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_long\nwhere condition = 'Post-Traumatic Stress Disorder'\n),\n\nlupus as (\nselect distinct person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_long\nwhere condition = 'Systemic Lupus Erythematosus'\n)\n\n\n\n\nselect\n  person_id,\n  case when person_id in (select * from obesity) then 1\n       else 0\n  end as obesity,\n  case when person_id in (select * from osteoarthritis) then 1\n       else 0\n  end as osteoarthritis,\n  case when person_id in (select * from copd) then 1\n       else 0\n  end as copd,\n  case when person_id in (select * from anxiety_disorders) then 1\n       else 0\n  end as anxiety_disorders,\n  case when person_id in (select * from ckd) then 1\n       else 0\n  end as ckd,\n  case when person_id in (select * from t2d) then 1\n       else 0\n  end as t2d,\n  case when person_id in (select * from cll) then 1\n       else 0\n  end as cll,\n  case when person_id in (select * from dysplipidemias) then 1\n       else 0\n  end as dysplipidemias,\n  case when person_id in (select * from hypertension) then 1\n       else 0\n  end as hypertension,\n  case when person_id in (select * from atherosclerosis) then 1\n       else 0\n  end as atherosclerosis,\n  case when person_id in (select * from dementia) then 1\n       else 0\n  end as dementia,\n  case when person_id in (select * from rheumatoid_arthritis) then 1\n       else 0\n  end as rheumatoid_arthritis,\n  case when person_id in (select * from celiac) then 1\n       else 0\n  end as celiac,\n  case when person_id in (select * from hip_fracture) then 1\n       else 0\n  end as hip_fracture,\n  case when person_id in (select * from immunodeficiencies_and_white_blood_cell_disorders) then 1\n       else 0\n  end as immunodeficiencies_and_white_blood_cell_disorders,\n  case when person_id in (select * from asthma) then 1\n       else 0\n  end asthma,\n  case when person_id in (select * from t1d) then 1\n       else 0\n  end as t1d,\n  case when person_id in (select * from ulcerative_colitis) then 1\n       else 0\n  end as ulcerative_colitis,\n  case when person_id in (select * from chrohns) then 1\n       else 0\n  end as chrohns,\n  case when person_id in (select * from holicobacter) then 1\n       else 0\n  end as holicobacter,\n  case when person_id in (select * from bipolar) then 1\n       else 0\n  end as bipolar,\n  case when person_id in (select * from heart_failure) then 1\n       else 0\n  end as heart_failure,\n  case when person_id in (select * from tabacco) then 1\n       else 0\n  end as tabacco,\n  case when person_id in (select * from lyme) then 1\n       else 0\n  end as lyme,\n  case when person_id in (select * from breast_cancer) then 1\n       else 0\n  end as breast_cancer,\n  case when person_id in (select * from osteoporosis) then 1\n       else 0\n  end as osteoporosis,\n  case when person_id in (select * from pulmonary_embolism) then 1\n       else 0\n  end as pulmonary_embolism,\n  case when person_id in (select * from schizophrenia) then 1\n       else 0\n  end as schizophrenia,\n  case when person_id in (select * from atrial_fibrillation) then 1\n       else 0\n  end as atrial_fibrillation,\n  case when person_id in (select * from colorectal_cancer) then 1\n       else 0\n  end as colorectal_cancer,\n  case when person_id in (select * from depression) then 1\n       else 0\n  end as depression,\n  case when person_id in (select * from deep_vein_thrombosis) then 1\n       else 0\n  end as deep_vein_thrombosis,\n  case when person_id in (select * from alzheimer) then 1\n       else 0\n  end as alzheimer,\n  case when person_id in (select * from stroke) then 1\n       else 0\n  end as stroke,\n  case when person_id in (select * from myocardial_infraction) then 1\n       else 0\n  end as myocardial_infraction,\n  case when person_id in (select * from opiod_use_disorder) then 1\n       else 0\n  end as opiod_use_disorder,\n  case when person_id in (select * from lung_cancer) then 1\n       else 0\n  end as lung_cancer,\n  case when person_id in (select * from herpes) then 1\n       else 0\n  end as herpes,\n  case when person_id in (select * from rickettsiosis) then 1\n       else 0\n  end as rickettsiosis,\n  case when person_id in (select * from ms) then 1\n       else 0\n  end as ms,\n  case when person_id in (select * from alchohol) then 1\n       else 0\n  end as alchohol,\n  case when person_id in (select * from adhd) then 1\n       else 0\n  end as adhd,\n  case when person_id in (select * from hiv) then 1\n       else 0\n  end as hiv,\n  case when person_id in (select * from ptsd) then 1\n       else 0\n  end as ptsd,\n  case when person_id in (select * from lupus) then 1\n       else 0\n  end as lupus,\n  '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\n\nfrom patients", "relation_name": "tuva.chronic_conditions.tuva_chronic_conditions_wide"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.734761Z", "completed_at": "2025-02-25T21:26:26.739447Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.743417Z", "completed_at": "2025-02-25T21:26:26.743425Z"}], "thread_id": "Thread-1", "execution_time": 0.009192228317260742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__chronic_conditions_prevalence", "compiled": true, "compiled_code": "\n\nwith condition_counts as (\n    select\n        condition\n        , count(distinct person_id) as patients\n    from tuva.chronic_conditions.tuva_chronic_conditions_long\n    group by condition\n)\n, total_patients as (\n    select \n        count(distinct person_id) as total_distinct_patients\n    from tuva.core.eligibility\n)\n\n, results_first as (\nselect\n    conditions.condition\n    , conditions.patients\n    , CASE \n        WHEN total_patients.total_distinct_patients = 0 THEN NULL\n        ELSE (conditions.patients / total_patients.total_distinct_patients) * 100 \n      END as percent_of_total\n\nfrom condition_counts as conditions\ncross join total_patients\n)\n\n,results_second as (\n    select \n      condition\n    , patients\n    , percent_of_total\n    , ROW_NUMBER() OVER (ORDER BY percent_of_total desc) AS condition_rank\n    from results_first\n)\n\n\nselect\n    ref_data.analytics_concept\n    , coalesce(results.condition, ref_data.analytics_measure) as analytics_measure\n    , coalesce(results.patients,0) as patients\n    , coalesce(results.percent_of_total,0) as data_source_value\n    , ref_data.analytics_value\n    , coalesce(results.condition_rank,0) as value_rank\n    , ref_data.value_rank as medicare_lds_condition_rank\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.data_quality._value_set_reference_mart_analytics  ref_data\nleft join results_second as results on results.condition = ref_data.analytics_measure\nwhere ref_data.analytics_concept = 'chronic conditions top 10'", "relation_name": "tuva.data_quality.chronic_conditions_prevalence"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.739638Z", "completed_at": "2025-02-25T21:26:26.749939Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.750499Z", "completed_at": "2025-02-25T21:26:26.750507Z"}], "thread_id": "Thread-3", "execution_time": 0.011605024337768555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.mart_review__number_of_conditions", "compiled": true, "compiled_code": "\n\nwith xwalk as (\n    select distinct person_id, data_source\n    from tuva.core.patient\n),\ncte as (\n    select l.person_id,\n           x.data_source,\n           count(*) as numofconditions\n    from tuva.chronic_conditions.tuva_chronic_conditions_long l\n    left join xwalk x on l.person_id = x.person_id\n    group by l.person_id, x.data_source\n)\nselect p.person_id,\n       p.data_source,\n        p.person_id || '|' || p.data_source as patient_source_key,\n       coalesce(cte.numofconditions, 0) as numofconditions\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.patient p\nleft join cte on p.person_id = cte.person_id and p.data_source = cte.data_source", "relation_name": "tuva.data_quality.mart_review__number_of_conditions"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.744718Z", "completed_at": "2025-02-25T21:26:26.756407Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.756938Z", "completed_at": "2025-02-25T21:26:26.756943Z"}], "thread_id": "Thread-1", "execution_time": 0.012781143188476562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.mart_review__tuva_chronic_conditions", "compiled": true, "compiled_code": "\n\nwith cte as (\n    select distinct\n        person_id\n    from tuva.chronic_conditions.tuva_chronic_conditions_long\n)\n\n, patientxwalk as (\n    select distinct\n        person_id\n      , data_source\n    from tuva.core.patient\n)\n\n, result as (\n    select\n        l.person_id\n      , p.data_source\n      , l.condition\n    from tuva.chronic_conditions.tuva_chronic_conditions_long as l\n    inner join patientxwalk as p\n      on l.person_id = p.person_id\n\n    union all\n\n    select\n        p.person_id\n      , p.data_source\n      , 'No Chronic Conditions' as condition\n    from tuva.core.patient as p\n    left join cte\n      on p.person_id = cte.person_id\n    where cte.person_id is null\n)\n\nselect *\n   , person_id || '|' || data_source as patient_source_key\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom result", "relation_name": "tuva.data_quality.mart_review__tuva_chronic_conditions"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.751700Z", "completed_at": "2025-02-25T21:26:26.756612Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.757453Z", "completed_at": "2025-02-25T21:26:26.757458Z"}], "thread_id": "Thread-3", "execution_time": 0.0062940120697021484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.dbt_utils_unique_combination_of_columns_chronic_conditions__tuva_chronic_conditions_long_person_id__condition.aa373ab7fc", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        person_id, condition\n    from tuva.chronic_conditions.tuva_chronic_conditions_long\n    group by person_id, condition\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.759557Z", "completed_at": "2025-02-25T21:26:26.803712Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.803943Z", "completed_at": "2025-02-25T21:26:26.803948Z"}], "thread_id": "Thread-1", "execution_time": 0.045385122299194336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.chronic_conditions__cms_chronic_conditions_all", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte__cms_chronic_conditions__stg_core__condition as (\n\n\nselect\n      claim_id\n    , person_id\n    , recorded_date\n    , normalized_code_type\n    , normalized_code\n    , data_source\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.condition\nwhere claim_id is not null\n),  __dbt__cte__cms_chronic_conditions__stg_core__medical_claim as (\n\n\nselect\n      claim_id\n    , person_id\n    , claim_start_date\n    , drg_code_type\n    , drg_code\n    , data_source\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.medical_claim\n),  __dbt__cte__cms_chronic_conditions__stg_core__procedure as (\n\n\nselect\n      claim_id\n    , person_id\n    , procedure_date\n    , normalized_code_type\n    , normalized_code\n    , data_source\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.procedure\nwhere claim_id is not null\n), chronic_conditions as (\n\n    select * from tuva.chronic_conditions._value_set_cms_chronic_conditions_hierarchy\n\n)\n\n, patient_conditions as (\n\n    select\n          person_id\n        , claim_id\n        , recorded_date as start_date\n        , normalized_code_type as code_type\n        , replace(normalized_code,'.','') as code\n        , data_source\n    from __dbt__cte__cms_chronic_conditions__stg_core__condition\n\n)\n\n, patient_ms_drgs as (\n\n    select\n          person_id\n        , claim_id\n        , claim_start_date as start_date\n        , drg_code_type as drg_code_type\n        , drg_code as code\n        , data_source\n    from __dbt__cte__cms_chronic_conditions__stg_core__medical_claim\n    where drg_code_type = 'ms-drg'\n\n)\n\n, patient_procedures as (\n\n    select\n          person_id\n        , claim_id\n        , procedure_date as start_date\n        , normalized_code_type as code_type\n        , replace(normalized_code,'.','') as code\n        , data_source\n    from __dbt__cte__cms_chronic_conditions__stg_core__procedure\n\n)\n\n, inclusions_diagnosis as (\n\n    select\n          patient_conditions.person_id\n        , patient_conditions.claim_id\n        , patient_conditions.start_date\n        , patient_conditions.data_source\n        , chronic_conditions.chronic_condition_type\n        , chronic_conditions.condition_category\n        , chronic_conditions.condition\n    from patient_conditions\n         inner join chronic_conditions\n             on patient_conditions.code = chronic_conditions.code\n    where chronic_conditions.inclusion_type = 'Include'\n    and chronic_conditions.code_system = 'ICD-10-CM'\n    and chronic_conditions.additional_logic = 'None'\n\n)\n\n, inclusions_ms_drg as (\n\n    select\n          patient_ms_drgs.person_id\n        , patient_ms_drgs.claim_id\n        , patient_ms_drgs.start_date\n        , patient_ms_drgs.data_source\n        , chronic_conditions.chronic_condition_type\n        , chronic_conditions.condition_category\n        , chronic_conditions.condition\n    from patient_ms_drgs\n         inner join chronic_conditions\n             on patient_ms_drgs.code = chronic_conditions.code\n    where chronic_conditions.inclusion_type = 'Include'\n    and chronic_conditions.code_system = 'MS-DRG'\n    and chronic_conditions.additional_logic = 'None'\n\n)\n\n, inclusions_procedure as (\n\n    select\n          patient_procedures.person_id\n        , patient_procedures.claim_id\n        , patient_procedures.start_date\n        , patient_procedures.data_source\n        , chronic_conditions.chronic_condition_type\n        , chronic_conditions.condition_category\n        , chronic_conditions.condition\n    from patient_procedures\n         inner join chronic_conditions\n             on patient_procedures.code = chronic_conditions.code\n    where chronic_conditions.inclusion_type = 'Include'\n    and chronic_conditions.code_system in ('ICD-10-PCS', 'HCPCS')\n    and chronic_conditions.additional_logic = 'None'\n\n)\n\n, exclusions_diagnosis as (\n\n    select distinct\n          patient_conditions.claim_id\n        , chronic_conditions.condition\n    from patient_conditions\n         inner join chronic_conditions\n             on patient_conditions.code = chronic_conditions.code\n    where chronic_conditions.inclusion_type = 'Exclude'\n    and chronic_conditions.code_system = 'ICD-10-CM'\n\n)\n\n\n, inclusions_unioned as (\n\n    select * from inclusions_diagnosis\n    union distinct\n    select * from inclusions_procedure\n    union distinct\n    select * from inclusions_ms_drg\n\n)\n\n\nselect distinct\n      cast(inclusions_unioned.person_id as TEXT) as person_id\n    , cast(inclusions_unioned.claim_id as TEXT) as claim_id\n    , cast(inclusions_unioned.start_date as date) as start_date\n    , cast(inclusions_unioned.chronic_condition_type as TEXT) as chronic_condition_type\n    , cast(inclusions_unioned.condition_category as TEXT) as condition_category\n    , cast(inclusions_unioned.condition as TEXT) as condition\n    , cast(inclusions_unioned.data_source as TEXT) as data_source\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom inclusions_unioned\n     left join exclusions_diagnosis\n         on inclusions_unioned.claim_id = exclusions_diagnosis.claim_id\n         and inclusions_unioned.condition = exclusions_diagnosis.condition\nwhere exclusions_diagnosis.claim_id is null", "relation_name": "tuva.chronic_conditions._int_cms_chronic_condition_all"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.777974Z", "completed_at": "2025-02-25T21:26:26.811322Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.812445Z", "completed_at": "2025-02-25T21:26:26.812449Z"}], "thread_id": "Thread-3", "execution_time": 0.05361485481262207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.chronic_conditions__cms_chronic_conditions_hiv_aids", "compiled": true, "compiled_code": "with  __dbt__cte__cms_chronic_conditions__stg_core__condition as (\n\n\nselect\n      claim_id\n    , person_id\n    , recorded_date\n    , normalized_code_type\n    , normalized_code\n    , data_source\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.condition\nwhere claim_id is not null\n),  __dbt__cte__cms_chronic_conditions__stg_core__medical_claim as (\n\n\nselect\n      claim_id\n    , person_id\n    , claim_start_date\n    , drg_code_type\n    , drg_code\n    , data_source\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.medical_claim\n), chronic_conditions as (\n\n    select * from tuva.chronic_conditions._value_set_cms_chronic_conditions_hierarchy\n    where condition = 'Human Immunodeficiency Virus and/or Acquired Immunodeficiency Syndrome (HIV/AIDS)'\n\n)\n\n, patient_conditions as (\n\n    select\n          person_id\n        , claim_id\n        , recorded_date as start_date\n        , normalized_code_type as code_type\n        , replace(normalized_code,'.','') as code\n        , data_source\n    from __dbt__cte__cms_chronic_conditions__stg_core__condition\n\n)\n\n, patient_ms_drgs as (\n\n    select\n          person_id\n        , claim_id\n        , claim_start_date as start_date\n        , drg_code_type as drg_code_type\n        , drg_code as code\n        , data_source\n    from __dbt__cte__cms_chronic_conditions__stg_core__medical_claim\n    where\n        drg_code_type = 'ms-drg'\n\n)\n\n/*\n    Exception logic: a claim with the diagnosis code R75 requires a second\n    qualifying claim that is not R75 (a screening code)\n\n    This CTE excludes encounters with the exception code. Those encounters\n    will be evaluated separately.\n*/\n, inclusions_diagnosis as (\n\n    select\n          patient_conditions.person_id\n        , patient_conditions.claim_id\n        , patient_conditions.start_date\n        , patient_conditions.data_source\n        , chronic_conditions.chronic_condition_type\n        , chronic_conditions.condition_category\n        , chronic_conditions.condition\n    from patient_conditions\n         inner join chronic_conditions\n             on patient_conditions.code = chronic_conditions.code\n    where chronic_conditions.inclusion_type = 'Include'\n    and chronic_conditions.code_system = 'ICD-10-CM'\n    and chronic_conditions.code <> 'R75'\n\n)\n\n, inclusions_ms_drg as (\n\n    select\n          patient_ms_drgs.person_id\n        , patient_ms_drgs.claim_id\n        , patient_ms_drgs.start_date\n        , patient_ms_drgs.data_source\n        , chronic_conditions.chronic_condition_type\n        , chronic_conditions.condition_category\n        , chronic_conditions.condition\n    from patient_ms_drgs\n         inner join chronic_conditions\n             on patient_ms_drgs.code = chronic_conditions.code\n    where chronic_conditions.inclusion_type = 'Include'\n    and chronic_conditions.code_system = 'MS-DRG'\n\n)\n\n/*\n    Exception logic: a claim with the diagnosis code R75 requires a second\n    qualifying claim that is not R75 (a screening code)\n\n    This CTE includes encounters with the exception code only where that\n    patient has another encounter that is not R75.\n*/\n, exception_diagnosis as (\n\n    select\n          patient_conditions.person_id\n        , patient_conditions.claim_id\n        , patient_conditions.start_date\n        , patient_conditions.data_source\n        , chronic_conditions.chronic_condition_type\n        , chronic_conditions.condition_category\n        , chronic_conditions.condition\n    from patient_conditions\n         inner join chronic_conditions\n             on patient_conditions.code = chronic_conditions.code\n         inner join inclusions_diagnosis\n             on patient_conditions.person_id = inclusions_diagnosis.person_id\n    where chronic_conditions.inclusion_type = 'Include'\n    and chronic_conditions.code_system = 'ICD-10-CM'\n    and chronic_conditions.code = 'R75'\n\n)\n\n\n, inclusions_unioned as (\n\n    select * from inclusions_diagnosis\n    union distinct\n    select * from inclusions_ms_drg\n    union distinct\n    select * from exception_diagnosis\n\n)\n\n\nselect distinct\n      cast(inclusions_unioned.person_id as TEXT) as person_id\n    , cast(inclusions_unioned.claim_id as TEXT) as claim_id\n    , cast(inclusions_unioned.start_date as date) as start_date\n    , cast(inclusions_unioned.chronic_condition_type as TEXT) as chronic_condition_type\n    , cast(inclusions_unioned.condition_category as TEXT) as condition_category\n    , cast(inclusions_unioned.condition as TEXT) as condition\n    , cast(inclusions_unioned.data_source as TEXT) as data_source\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom inclusions_unioned", "relation_name": "tuva.chronic_conditions._int_cms_chronic_condition_hiv_aids"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.804998Z", "completed_at": "2025-02-25T21:26:26.825567Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.830706Z", "completed_at": "2025-02-25T21:26:26.830712Z"}], "thread_id": "Thread-1", "execution_time": 0.026216983795166016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.cms_hcc__int_monthly_collection_dates", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte___stg_medical_claim as (\n\nselect\n      claim_id\n    , claim_line_number\n    , claim_type\n    , person_id\n    , claim_start_date\n    , claim_end_date\n    , bill_type_code\n    , hcpcs_code\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.medical_claim\n), collection_date_range as (\n\n    select \n          cast(min(date_trunc('year', claim_end_date)) as date) as start_date\n        , cast(max(claim_end_date) as date) as end_date\n    from __dbt__cte___stg_medical_claim\n\n)\n\nselect distinct\n      cast(date_trunc('year', calendar.last_day_of_month) as date) as collection_start_date\n    , cast(calendar.last_day_of_month as date) as collection_end_date\n    , cast(calendar.year as integer) as collection_year\n    , cast(calendar.year + 1 as integer) as payment_year\nfrom tuva.reference_data.calendar as calendar\ninner join collection_date_range\n    on calendar.first_day_of_month \n        between collection_date_range.start_date and collection_date_range.end_date", "relation_name": "tuva.cms_hcc._int_monthly_collection_dates"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.813685Z", "completed_at": "2025-02-25T21:26:26.835897Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.836137Z", "completed_at": "2025-02-25T21:26:26.836142Z"}], "thread_id": "Thread-3", "execution_time": 0.022962331771850586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.financial_pmpm__patient_spend_with_service_categories", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte__financial_pmpm__stg_medical_claim as (\n\n\n\nSELECT\n    person_id\n    , claim_id\n    , claim_line_number\n    , claim_start_date\n    , claim_end_date\n    , service_category_1\n    , service_category_2\n    , paid_amount\n    , allowed_amount\n    , payer\n    , plan\n    , data_source\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.medical_claim\n),  __dbt__cte__financial_pmpm__stg_pharmacy_claim as (\n\n\n\nSELECT\n    person_id\n    , dispensing_date\n    , paid_date\n    , paid_amount\n    , allowed_amount\n    , payer\n    , plan\n    , data_source\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.pharmacy_claim\n), claims_with_service_categories as (\n  select\n      person_id\n    , payer\n    , plan\n    , service_category_1\n    , service_category_2\n    , coalesce(claim_start_date,claim_end_date) as claim_date\n    , paid_amount\n    , allowed_amount\n    , data_source\n  from __dbt__cte__financial_pmpm__stg_medical_claim\n)\n\n, medical_claims_year_month as (\n  select\n      person_id\n    , payer\n    , plan\n    , service_category_1\n    , service_category_2\n    , date_part('year', claim_date) || \n\n    case when 2 = 0\n        then ''\n    else\n        right(\n            '0' || date_part('month', claim_date),\n            2\n        )\n    end as year_month\n    , paid_amount\n    , allowed_amount\n    , data_source\n  from claims_with_service_categories\n)\n\n, rx_claims as (\n  select\n      person_id\n    , payer\n    , plan\n    , 'pharmacy' as service_category_1\n    , cast(null as TEXT) as service_category_2\n    , coalesce(dispensing_date, paid_date) as claim_date\n    , paid_amount\n    , allowed_amount\n    , data_source\n  from __dbt__cte__financial_pmpm__stg_pharmacy_claim\n)\n\n, rx_claims_year_month as (\n  select\n      person_id\n    , payer\n    , plan\n    , service_category_1\n    , service_category_2\n    , date_part('year', claim_date) || \n\n    case when 2 = 0\n        then ''\n    else\n        right(\n            '0' || date_part('month', claim_date),\n            2\n        )\n    end as year_month\n    , paid_amount\n    , allowed_amount\n    , data_source\n  from rx_claims\n)\n\n, combine_medical_and_rx as (\nselect *\nfrom medical_claims_year_month\n\nunion all\n\nselect *\nfrom rx_claims_year_month\n)\n\nselect\n    person_id\n  , year_month\n  , payer\n  , plan\n  , service_category_1\n  , service_category_2\n  , sum(paid_amount) as total_paid\n  , sum(allowed_amount) as total_allowed\n  , data_source\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\n  from combine_medical_and_rx\ngroup by\n    person_id\n  , year_month\n  , payer\n  , plan\n  , service_category_1\n  , service_category_2\n  , data_source", "relation_name": "tuva.financial_pmpm._int_patient_spend_with_service_categories"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.831994Z", "completed_at": "2025-02-25T21:26:26.836824Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.837254Z", "completed_at": "2025-02-25T21:26:26.837258Z"}], "thread_id": "Thread-1", "execution_time": 0.005776882171630859, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.mart_review__claims_with_enrollment", "compiled": true, "compiled_code": "\n\nwith enrollment_stage as(\nSELECT\n    mc.data_source,\n    mc.year_month,\n    mc.payer,\n    mc.plan,\n    SUM(CASE WHEN mm.person_id IS NOT NULL THEN 1 ELSE 0 END) AS claims_with_enrollment,\n    COUNT(*) AS claims\nFROM tuva.data_quality.mart_review__stg_medical_claim mc\nLEFT JOIN tuva.core.member_months mm\n    ON mc.member_month_key = mm.member_month_key\nGROUP BY mc.data_source\n, mc.year_month\n, mc.payer\n, mc.plan\n)\n\nselect\n    data_source\n    , year_month\n    , payer\n    , plan\n    , claims_with_enrollment\n    , claims\n    , cast(claims_with_enrollment / claims as numeric(28,6) ) AS percentage_claims_with_enrollment\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom enrollment_stage", "relation_name": "tuva.data_quality.mart_review__claims_with_enrollment"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.838049Z", "completed_at": "2025-02-25T21:26:26.855766Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.856018Z", "completed_at": "2025-02-25T21:26:26.856024Z"}], "thread_id": "Thread-3", "execution_time": 0.019086122512817383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.mart_review__members_with_claims", "compiled": true, "compiled_code": "\n\nWITH medical_claim AS (\n    SELECT\n        data_source,\n        person_id,\n        year_month,\n        SUM(paid_amount) AS paid_amount\n    FROM tuva.data_quality.mart_review__stg_medical_claim\n    GROUP BY data_source\n    , person_id\n    , year_month\n)\n\n,pharmacy_claim AS (\n    SELECT\n        data_source,\n        person_id,\n        year_month,\n        SUM(paid_amount) AS paid_amount\n    FROM tuva.data_quality.mart_review__stg_pharmacy_claim\n    GROUP BY data_source\n    , person_id\n    , year_month\n)\n, final as(\nSELECT\n    mm.data_source,\n    mm.year_month,\n    SUM(CASE WHEN mc.person_id IS NOT NULL THEN 1 ELSE 0 END) AS members_with_medical_claims,\n    SUM(CASE WHEN pc.person_id IS NOT NULL THEN 1 ELSE 0 END) AS members_with_pharmacy_claims,\n    SUM(CASE WHEN pc.person_id IS NOT NULL THEN 1\n             WHEN mc.person_id is not null THEN 1 ELSE 0 END) AS members_with_claims,\n    COUNT(*) AS total_member_months\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nFROM tuva.core.member_months mm\nLEFT JOIN medical_claim mc\n    ON mm.person_id = mc.person_id\n    AND mm.data_source = mc.data_source\n    AND mm.year_month = mc.year_month\nLEFT JOIN pharmacy_claim pc\n    ON mm.person_id = pc.person_id\n    AND mm.data_source = pc.data_source\n    AND mm.year_month = pc.year_month\nGROUP BY mm.data_source, mm.year_month\n)\n\nselect\n    data_source\n    , year_month\n    , members_with_medical_claims\n    , members_with_pharmacy_claims\n    , members_with_claims\n    , total_member_months\n    , cast(members_with_claims/ total_member_months as numeric(28,6)) as percent_members_with_claims\n    , cast(members_with_medical_claims/ total_member_months  as numeric(28,6)) as percent_members_with_medical_claims\n    , cast(members_with_pharmacy_claims/ total_member_months as numeric(28,6))  as  percent_members_with_pharmacy_claims\nfrom final", "relation_name": "tuva.data_quality.mart_review__members_with_claims"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.843270Z", "completed_at": "2025-02-25T21:26:26.904280Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.904583Z", "completed_at": "2025-02-25T21:26:26.904590Z"}], "thread_id": "Thread-1", "execution_time": 0.06191682815551758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.quality_measures__int_shared_exclusions_frailty", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte___stg_patient as (\n\nselect\n      person_id\n    , sex\n    , birth_date\n    , death_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.patient\n),  __dbt__cte___stg_condition as (\n\nselect\n      person_id\n    , claim_id\n    , encounter_id\n    , recorded_date\n    , source_code_type\n    , source_code\n    , normalized_code_type\n    , normalized_code\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.condition\n),  __dbt__cte___stg_medical_claim as (\n\n\nselect\n      person_id\n    , claim_id\n    , claim_start_date\n    , claim_end_date\n    , place_of_service_code\n    , hcpcs_code\n    , hcpcs_modifier_1\n    , hcpcs_modifier_2\n    , hcpcs_modifier_3\n    , hcpcs_modifier_4\n    , hcpcs_modifier_5\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.medical_claim\n\n\n),  __dbt__cte___stg_observation as (\n\n\nselect\n      person_id\n    , encounter_id\n    , observation_date\n    , result\n    , source_code_type\n    , source_code\n    , normalized_code_type\n    , normalized_code\n    , normalized_description\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.observation\n\n\n),  __dbt__cte___stg_procedure as (\n\nselect\n      person_id\n    , encounter_id\n    , procedure_date\n    , source_code_type\n    , source_code\n    , normalized_code_type\n    , normalized_code\n    , modifier_1\n    , modifier_2\n    , modifier_3\n    , modifier_4\n    , modifier_5\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.procedure\n), patients as (\n\n    select\n          person_id\n    from __dbt__cte___stg_patient\n\n)\n\n, exclusion_codes as (\n\n    select\n          code\n        , code_system\n        , concept_name\n    from tuva.quality_measures._value_set_codes\n    where lower(concept_name) in (\n          'frailty device'\n        , 'frailty diagnosis'\n        , 'frailty encounter'\n        , 'frailty symptom'\n    )\n\n)\n\n, conditions as (\n\n    select\n          person_id\n        , recorded_date\n        , coalesce (\n              normalized_code_type\n            , case\n                when lower(source_code_type) = 'snomed' then 'snomed-ct'\n                else lower(source_code_type)\n              end\n          ) as code_type\n        , coalesce (\n              normalized_code\n            , source_code\n          ) as code\n    from __dbt__cte___stg_condition\n\n)\n\n, medical_claim as (\n\n    select\n          person_id\n        , claim_start_date\n        , claim_end_date\n        , hcpcs_code\n        , place_of_service_code\n    from __dbt__cte___stg_medical_claim\n\n)\n\n, observations as (\n\n    select\n          person_id\n        , observation_date\n        , coalesce (\n              normalized_code_type\n            , case\n                when lower(source_code_type) = 'cpt' then 'hcpcs'\n                when lower(source_code_type) = 'snomed' then 'snomed-ct'\n                else lower(source_code_type)\n              end\n          ) as code_type\n        , coalesce (\n              normalized_code\n            , source_code\n          ) as code\n    from __dbt__cte___stg_observation\n\n)\n\n, procedures as (\n\n    select\n          person_id\n        , procedure_date\n        , coalesce (\n              normalized_code_type\n            , case\n                when lower(source_code_type) = 'cpt' then 'hcpcs'\n                when lower(source_code_type) = 'snomed' then 'snomed-ct'\n                else lower(source_code_type)\n              end\n          ) as code_type\n        , coalesce (\n              normalized_code\n            , source_code\n          ) as code\n    from __dbt__cte___stg_procedure\n\n)\n\n, condition_exclusions as (\n\n    select\n          conditions.person_id\n        , conditions.recorded_date\n        , exclusion_codes.concept_name\n    from conditions\n         inner join exclusion_codes\n             on conditions.code = exclusion_codes.code\n             and conditions.code_type = exclusion_codes.code_system\n\n)\n\n, med_claim_exclusions as (\n\n    select\n          medical_claim.person_id\n        , medical_claim.claim_start_date\n        , medical_claim.claim_end_date\n        , medical_claim.hcpcs_code\n        , exclusion_codes.concept_name\n    from medical_claim\n         inner join exclusion_codes\n            on medical_claim.hcpcs_code = exclusion_codes.code\n    where exclusion_codes.code_system = 'hcpcs'\n\n)\n\n, observation_exclusions as (\n\n    select\n          observations.person_id\n        , observations.observation_date\n        , exclusion_codes.concept_name\n    from observations\n         inner join exclusion_codes\n             on observations.code = exclusion_codes.code\n             and observations.code_type = exclusion_codes.code_system\n\n)\n\n, procedure_exclusions as (\n\n    select\n          procedures.person_id\n        , procedures.procedure_date\n        , exclusion_codes.concept_name\n    from procedures\n         inner join exclusion_codes\n             on procedures.code = exclusion_codes.code\n             and procedures.code_type = exclusion_codes.code_system\n\n)\n\n, patients_with_frailty as (\n\n    select\n          patients.person_id\n        , condition_exclusions.recorded_date as exclusion_date\n        , condition_exclusions.concept_name as exclusion_reason\n    from patients\n         inner join condition_exclusions\n            on patients.person_id = condition_exclusions.person_id\n\n    union all\n\n    select\n          patients.person_id\n        , coalesce(\n              med_claim_exclusions.claim_start_date\n            , med_claim_exclusions.claim_end_date\n          ) as exclusion_date\n        , med_claim_exclusions.concept_name as exclusion_reason\n    from patients\n         inner join med_claim_exclusions\n            on patients.person_id = med_claim_exclusions.person_id\n\n    union all\n\n    select\n          patients.person_id\n        , observation_exclusions.observation_date as exclusion_date\n        , observation_exclusions.concept_name as exclusion_reason\n    from patients\n         inner join observation_exclusions\n            on patients.person_id = observation_exclusions.person_id\n\n    union all\n\n    select\n          patients.person_id\n        , procedure_exclusions.procedure_date as exclusion_date\n        , procedure_exclusions.concept_name as exclusion_reason\n    from patients\n         inner join procedure_exclusions\n            on patients.person_id = procedure_exclusions.person_id\n\n)\n\nselect\n      person_id\n    , exclusion_date\n    , exclusion_reason\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom patients_with_frailty", "relation_name": "tuva.quality_measures._int_shared_exclusions_frailty"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.868765Z", "completed_at": "2025-02-25T21:26:26.905640Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.906087Z", "completed_at": "2025-02-25T21:26:26.906091Z"}], "thread_id": "Thread-3", "execution_time": 0.03786492347717285, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.quality_measures__int_shared_exclusions_hospice_palliative", "compiled": true, "compiled_code": "\n\n/*\nDENOMINATOR EXCLUSIONS:\nPatient was provided hospice services any time during the measurement period: G9687\n*/\n\n\nwith  __dbt__cte___stg_condition as (\n\nselect\n      person_id\n    , claim_id\n    , encounter_id\n    , recorded_date\n    , source_code_type\n    , source_code\n    , normalized_code_type\n    , normalized_code\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.condition\n),  __dbt__cte___stg_medical_claim as (\n\n\nselect\n      person_id\n    , claim_id\n    , claim_start_date\n    , claim_end_date\n    , place_of_service_code\n    , hcpcs_code\n    , hcpcs_modifier_1\n    , hcpcs_modifier_2\n    , hcpcs_modifier_3\n    , hcpcs_modifier_4\n    , hcpcs_modifier_5\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.medical_claim\n\n\n),  __dbt__cte___stg_observation as (\n\n\nselect\n      person_id\n    , encounter_id\n    , observation_date\n    , result\n    , source_code_type\n    , source_code\n    , normalized_code_type\n    , normalized_code\n    , normalized_description\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.observation\n\n\n),  __dbt__cte___stg_procedure as (\n\nselect\n      person_id\n    , encounter_id\n    , procedure_date\n    , source_code_type\n    , source_code\n    , normalized_code_type\n    , normalized_code\n    , modifier_1\n    , modifier_2\n    , modifier_3\n    , modifier_4\n    , modifier_5\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.procedure\n), exclusion_codes as (\n\n    select\n          code\n        , case code_system\n            when 'SNOMEDCT' then 'snomed-ct'\n            when 'ICD9CM' then 'icd-9-cm'\n            when 'ICD10CM' then 'icd-10-cm'\n            when 'CPT' then 'hcpcs'\n            when 'ICD10PCS' then 'icd-10-pcs'\n          else lower(code_system) end as code_system\n        , concept_name\n    From tuva.quality_measures._value_set_codes\n    where lower(concept_name) in  (\n            'hospice encounter'\n          , 'hospice care ambulatory'\n          , 'hospice diagnosis'\n          , 'palliative care encounter'\n          , 'palliative care diagnosis'\n          , 'palliative care intervention'\n    )\n)\n\n, conditions as (\n\n    select\n          person_id\n        , claim_id\n        , recorded_date\n        , coalesce (\n              normalized_code_type\n            , case\n                when lower(source_code_type) = 'snomed' then 'snomed-ct'\n                else lower(source_code_type)\n              end\n          ) as code_type\n        , coalesce (\n              normalized_code\n            , source_code\n          ) as code\n    from __dbt__cte___stg_condition \n\n)\n\n, medical_claim as (\n\n    select\n          person_id\n        , claim_id\n        , claim_start_date\n        , claim_end_date\n        , hcpcs_code\n        , place_of_service_code\n    from __dbt__cte___stg_medical_claim\n\n)\n\n, observations as (\n\n    select\n          person_id\n        , observation_date\n        , coalesce (\n              normalized_code_type\n            , case\n                when lower(source_code_type) = 'cpt' then 'hcpcs'\n                when lower(source_code_type) = 'snomed' then 'snomed-ct'\n                else lower(source_code_type)\n              end\n          ) as code_type\n        , coalesce (\n              normalized_code\n            , source_code\n          ) as code\n    from __dbt__cte___stg_observation\n\n)\n\n, procedures as (\n\n    select\n          person_id\n        , procedure_date\n        , coalesce (\n              normalized_code_type\n            , case\n                when lower(source_code_type) = 'cpt' then 'hcpcs'\n                when lower(source_code_type) = 'snomed' then 'snomed-ct'\n                else lower(source_code_type)\n              end\n          ) as code_type\n        , coalesce (\n              normalized_code\n            , source_code\n          ) as code\n    from __dbt__cte___stg_procedure\n\n)\n\n, condition_exclusions as (\n\n    select\n          conditions.person_id\n        , conditions.claim_id\n        , conditions.recorded_date\n        , exclusion_codes.concept_name as concept_name\n    from conditions\n         inner join exclusion_codes\n            on conditions.code = exclusion_codes.code\n            and conditions.code_type = exclusion_codes.code_system\n\n)\n\n, med_claim_exclusions as (\n\n    select\n          medical_claim.person_id\n        , medical_claim.claim_id\n        , medical_claim.claim_start_date\n        , medical_claim.claim_end_date\n        , medical_claim.hcpcs_code\n        , exclusion_codes.concept_name as concept_name\n    from medical_claim\n         inner join exclusion_codes\n            on medical_claim.hcpcs_code = exclusion_codes.code\n    where exclusion_codes.code_system = 'hcpcs'\n\n)\n\n, observation_exclusions as (\n\n    select\n          observations.person_id\n        , observations.observation_date\n        , exclusion_codes.concept_name as concept_name\n    from observations\n    inner join exclusion_codes\n        on observations.code = exclusion_codes.code\n        and observations.code_type = exclusion_codes.code_system\n\n)\n\n, procedure_exclusions as (\n\n    select\n          procedures.person_id\n        , procedures.procedure_date\n        , exclusion_codes.concept_name as concept_name\n    from procedures\n         inner join exclusion_codes\n             on procedures.code = exclusion_codes.code\n             and procedures.code_type = exclusion_codes.code_system\n\n)\n\n, patients_with_exclusions as(\n    \n    select person_id\n        , recorded_date as exclusion_date\n        , concept_name as exclusion_reason\n    from condition_exclusions\n\n    union all\n\n    select person_id\n        , coalesce(claim_end_date, claim_start_date) as exclusion_date\n        , concept_name as exclusion_reason\n    from med_claim_exclusions\n\n    union all\n\n    select person_id\n        , observation_date as exclusion_date\n        , concept_name as exclusion_reason\n    from observation_exclusions\n\n    union all\n\n    select person_id\n        , procedure_date as exclusion_date\n        , concept_name as exclusion_reason\n    from procedure_exclusions\n\n)\n\nselect\n      person_id\n    , exclusion_date\n    , exclusion_reason\n    , 'hospice_palliative' as exclusion_type\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom patients_with_exclusions", "relation_name": "tuva.quality_measures._int_shared_exclusions_hospice_palliative"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.906466Z", "completed_at": "2025-02-25T21:26:26.920748Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.921224Z", "completed_at": "2025-02-25T21:26:26.921230Z"}], "thread_id": "Thread-1", "execution_time": 0.015881061553955078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.quality_measures__int_shared_exclusions_institutional_snp", "compiled": true, "compiled_code": "\n\n/*\n    patients in institutional special needs plans (snp)\n    or residing in long term care\n\n    while referencing this model, patients greater or equal than 66 years of age should be taken\n\n    filtering out age from this model has been stripped out as different measures calculate age varingly\n\n    future enhancement: group claims into encounters\n*/\n\nwith  __dbt__cte___stg_patient as (\n\nselect\n      person_id\n    , sex\n    , birth_date\n    , death_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.patient\n),  __dbt__cte___stg_medical_claim as (\n\n\nselect\n      person_id\n    , claim_id\n    , claim_start_date\n    , claim_end_date\n    , place_of_service_code\n    , hcpcs_code\n    , hcpcs_modifier_1\n    , hcpcs_modifier_2\n    , hcpcs_modifier_3\n    , hcpcs_modifier_4\n    , hcpcs_modifier_5\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.medical_claim\n\n\n), patients as (\n\n    select\n          person_id\n    from __dbt__cte___stg_patient\n\n)\n\n, medical_claim as (\n\n    select\n          person_id\n        , claim_start_date\n        , claim_end_date\n        , hcpcs_code\n        , place_of_service_code\n    from __dbt__cte___stg_medical_claim\n\n)\n\n, exclusions as (\n\n    select\n          patients.person_id\n        , coalesce(\n              medical_claim.claim_start_date\n            , medical_claim.claim_end_date\n          ) as exclusion_date\n        , 'institutional or long term care' as exclusion_reason\n    from patients\n         inner join medical_claim\n         on patients.person_id = medical_claim.person_id\n    where place_of_service_code in ('32', '33', '34', '54', '56')\n    and datediff(\n        day,\n        medical_claim.claim_start_date,\n        medical_claim.claim_end_date\n        ) >= 90\n\n)\n\nselect\n      person_id\n    , exclusion_date\n    , exclusion_reason\n    , 'institutional_snp' as exclusion_type\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom exclusions", "relation_name": "tuva.quality_measures._int_shared_exclusions_institutional_snp"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.917933Z", "completed_at": "2025-02-25T21:26:26.922011Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.922441Z", "completed_at": "2025-02-25T21:26:26.922444Z"}], "thread_id": "Thread-3", "execution_time": 0.006470203399658203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.unique_core__location_location_id.dc12ec8d3a", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    location_id as unique_field,\n    count(*) as n_records\n\nfrom tuva.core.location\nwhere location_id is not null\ngroup by location_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.923567Z", "completed_at": "2025-02-25T21:26:26.932311Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.933133Z", "completed_at": "2025-02-25T21:26:26.933163Z"}], "thread_id": "Thread-1", "execution_time": 0.011126995086669922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.mart_review__pharmacy", "compiled": true, "compiled_code": "\n\nselect\n    p.claim_id\n  , p.claim_line_number\n  , p.person_id\n  , p.data_source\n  , p.person_id || '|' || p.data_source as patient_source_key\n  , p.ndc_code\n  , coalesce(n.fda_description, n.rxnorm_description) as ndc_description\n  , p.paid_amount\n  , p.allowed_amount\n  , p.prescribing_provider_id\n  , p.prescribing_provider_name\n  , prac.specialty as prescribing_specialty\n  , p.dispensing_provider_id\n  , p.dispensing_provider_name\n  , p.paid_date\n  , p.dispensing_date\n  , p.days_supply\n  , case \n      when p.days_supply = 0 then null\n      else p.paid_amount / p.days_supply\n    end as cost_per_day\n  , case \n      when p.days_supply = 0 then null\n      else (p.paid_amount / p.days_supply) * 30\n    end as thirty_day_equivalent_cost\n  , case \n      when p.days_supply = 0 then 0\n      when (p.paid_amount / p.days_supply) * 30 >= 950 then 1\n      else 0 \n    end as specialty_tier -- $950 is the threshold set by CMS for CY 2024\n  , n.rxcui\n  , n.rxnorm_description\n  , r.brand_name\n  , r.brand_vs_generic\n  , r.ingredient_name\n  , a.atc_1_name\n  , a.atc_2_name\n  , a.atc_3_name\n  , a.atc_4_name\n  , pe.generic_available_total_opportunity\n  , pe.generic_average_cost_per_unit * p.quantity as generic_cost_at_units\n  , pe.brand_cost_per_unit * p.quantity as brand_paid_amount\n  , pe.generic_available\n  , pe.generic_available_sk\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.pharmacy_claim as p\nleft join tuva.terminology.ndc as n \n  on p.ndc_code = n.ndc\nleft join tuva.terminology.rxnorm_brand_generic as r \n  on n.rxcui = r.product_rxcui\nleft join tuva.terminology.rxnorm_to_atc as a \n  on n.rxcui = a.rxcui\nleft join tuva.core.practitioner as prac \n  on p.prescribing_provider_id = prac.practitioner_id\nleft join tuva.pharmacy.pharmacy_claim_expanded as pe \n  on p.data_source = pe.data_source\n  and p.claim_id = pe.claim_id\n  and p.claim_line_number = pe.claim_line_number", "relation_name": "tuva.data_quality.mart_review__pharmacy"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.928124Z", "completed_at": "2025-02-25T21:26:26.934224Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.934879Z", "completed_at": "2025-02-25T21:26:26.934883Z"}], "thread_id": "Thread-3", "execution_time": 0.007317066192626953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.unique_core__practitioner_practitioner_id.24d565a6b6", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    practitioner_id as unique_field,\n    count(*) as n_records\n\nfrom tuva.core.practitioner\nwhere practitioner_id is not null\ngroup by practitioner_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.935796Z", "completed_at": "2025-02-25T21:26:26.946534Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.946775Z", "completed_at": "2025-02-25T21:26:26.946781Z"}], "thread_id": "Thread-1", "execution_time": 0.012230873107910156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.hcc_suspecting__int_patient_hcc_history", "compiled": true, "compiled_code": "\n\nwith all_conditions as (\n\n    select\n          person_id\n        , data_source\n        , recorded_date\n        , condition_type\n        , icd_10_cm_code\n        , hcc_code\n        , hcc_description\n    from tuva.hcc_suspecting._int_all_conditions\n    where hcc_code is not null\n\n)\n\n, hcc_grouped as (\n\n    select\n          person_id\n        , data_source\n        , hcc_code\n        , hcc_description\n        , min(recorded_date) as first_recorded\n        , max(recorded_date) as last_recorded\n    from all_conditions\n    where hcc_code is not null\n    group by\n          person_id\n        , hcc_code\n        , hcc_description\n        , data_source\n\n)\n\n, hcc_billed as (\n\n    select\n          person_id\n        , data_source\n        , hcc_code\n        , hcc_description\n        , max(recorded_date) as last_billed\n    from all_conditions\n    where hcc_code is not null\n    and lower(condition_type) <> 'problem'\n    group by\n          person_id\n        , hcc_code\n        , hcc_description\n        , data_source\n\n)\n\n, add_flag as (\n\n    select\n          hcc_grouped.person_id\n        , hcc_grouped.data_source\n        , hcc_grouped.hcc_code\n        , hcc_grouped.hcc_description\n        , hcc_grouped.first_recorded\n        , hcc_grouped.last_recorded\n        , hcc_billed.last_billed\n        , case\n            when date_part('year', hcc_billed.last_billed) = date_part('year', convert_timezone('UTC', current_timestamp()))\n            then 1\n            else 0\n          end as current_year_billed\n\n    from hcc_grouped\n         left join hcc_billed\n         on hcc_grouped.person_id = hcc_billed.person_id\n         and hcc_grouped.hcc_code = hcc_billed.hcc_code\n         and hcc_grouped.data_source = hcc_billed.data_source\n\n)\n\n, all_conditions_with_flag as (\n\n    select distinct\n          all_conditions.person_id\n        , all_conditions.data_source\n        , all_conditions.recorded_date\n        , all_conditions.condition_type\n        , all_conditions.icd_10_cm_code\n        , all_conditions.hcc_code\n        , all_conditions.hcc_description\n        , add_flag.first_recorded\n        , add_flag.last_recorded\n        , add_flag.last_billed\n        , add_flag.current_year_billed\n        , cast('Prior coding history' as TEXT) as reason\n        , icd_10_cm_code || case when last_billed is not null then ' last billed on ' || last_billed when last_billed is null and last_recorded is not null then ' last recorded on ' || last_recorded else ' (missing recorded and billing dates) ' end as contributing_factor\n        , coalesce(last_billed, last_recorded) as condition_date\n    from all_conditions\n         left join add_flag\n            on all_conditions.person_id = add_flag.person_id\n            and all_conditions.hcc_code = add_flag.hcc_code\n            and all_conditions.data_source = add_flag.data_source\n\n)\n\n, add_standard_fields as (\n\n    select distinct\n          person_id\n        , data_source\n        , recorded_date\n        , condition_type\n        , icd_10_cm_code\n        , hcc_code\n        , hcc_description\n        , first_recorded\n        , last_recorded\n        , last_billed\n        , current_year_billed\n        , 'Prior coding history' as reason\n        , icd_10_cm_code || case when last_billed is not null then ' last billed on ' || last_billed when last_billed is null and last_recorded is not null then ' last recorded on ' || last_recorded else ' (missing recorded and billing dates) ' end as contributing_factor\n        , coalesce(last_billed, last_recorded) as suspect_date\n    from all_conditions_with_flag\n\n)\n\n, add_data_types as (\n\n    select\n          cast(person_id as TEXT) as person_id\n        , cast(data_source as TEXT) as data_source\n        , cast(recorded_date as date) as recorded_date\n        , cast(condition_type as TEXT) as condition_type\n        , cast(icd_10_cm_code as TEXT) as icd_10_cm_code\n        , cast(hcc_code as TEXT) as hcc_code\n        , cast(hcc_description as TEXT) as hcc_description\n        , cast(first_recorded as date) as first_recorded\n        , cast(last_recorded as date) as last_recorded\n        , cast(last_billed as date) as last_billed\n        \n            , cast(current_year_billed as boolean) as current_year_billed\n        \n        , cast(reason as TEXT) as reason\n        , cast(contributing_factor as TEXT) as contributing_factor\n        , cast(suspect_date as date) as suspect_date\n    from add_standard_fields\n\n)\n\nselect\n      person_id\n    , data_source\n    , recorded_date\n    , condition_type\n    , icd_10_cm_code\n    , hcc_code\n    , hcc_description\n    , first_recorded\n    , last_recorded\n    , last_billed\n    , current_year_billed\n    , reason\n    , contributing_factor\n    , suspect_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.hcc_suspecting._int_patient_hcc_history"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.943751Z", "completed_at": "2025-02-25T21:26:26.947438Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.947932Z", "completed_at": "2025-02-25T21:26:26.947936Z"}], "thread_id": "Thread-3", "execution_time": 0.004760026931762695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.not_null_chronic_conditions__tuva_chronic_conditions_wide_person_id.ddc3902157", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect person_id\nfrom tuva.chronic_conditions.tuva_chronic_conditions_wide\nwhere person_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.948741Z", "completed_at": "2025-02-25T21:26:26.964497Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.971040Z", "completed_at": "2025-02-25T21:26:26.971048Z"}], "thread_id": "Thread-1", "execution_time": 0.023512840270996094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.unique_chronic_conditions__tuva_chronic_conditions_wide_person_id.e237644a97", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    person_id as unique_field,\n    count(*) as n_records\n\nfrom tuva.chronic_conditions.tuva_chronic_conditions_wide\nwhere person_id is not null\ngroup by person_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.972113Z", "completed_at": "2025-02-25T21:26:26.987132Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.987370Z", "completed_at": "2025-02-25T21:26:26.987376Z"}], "thread_id": "Thread-1", "execution_time": 0.015759944915771484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.not_null_chronic_conditions__cms_chronic_conditions_all_claim_id.84015aec48", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect claim_id\nfrom tuva.chronic_conditions._int_cms_chronic_condition_all\nwhere claim_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.951969Z", "completed_at": "2025-02-25T21:26:26.988004Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.988461Z", "completed_at": "2025-02-25T21:26:26.988465Z"}], "thread_id": "Thread-3", "execution_time": 0.03702688217163086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.chronic_conditions__cms_chronic_conditions_oud", "compiled": true, "compiled_code": "with  __dbt__cte__cms_chronic_conditions__stg_core__condition as (\n\n\nselect\n      claim_id\n    , person_id\n    , recorded_date\n    , normalized_code_type\n    , normalized_code\n    , data_source\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.condition\nwhere claim_id is not null\n),  __dbt__cte__cms_chronic_conditions__stg_core__pharmacy_claim as (\n\n\nselect\n      claim_id\n    , person_id\n    , paid_date\n    , ndc_code\n    , data_source\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.pharmacy_claim\n),  __dbt__cte__cms_chronic_conditions__stg_core__procedure as (\n\n\nselect\n      claim_id\n    , person_id\n    , procedure_date\n    , normalized_code_type\n    , normalized_code\n    , data_source\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.procedure\nwhere claim_id is not null\n), chronic_conditions as (\n\n    select * from tuva.chronic_conditions._value_set_cms_chronic_conditions_hierarchy\n    where condition = 'Opioid Use Disorder (OUD)'\n\n)\n\n, patient_conditions as (\n\n    select\n          person_id\n        , claim_id\n        , recorded_date as start_date\n        , normalized_code_type as code_type\n        , replace(normalized_code,'.','') as code\n        , data_source\n    from __dbt__cte__cms_chronic_conditions__stg_core__condition\n\n)\n\n, patient_medications as (\n\n    select\n          person_id\n        , claim_id\n        , paid_date as start_date\n        , replace(ndc_code,'.','') as code\n        , data_source\n    from __dbt__cte__cms_chronic_conditions__stg_core__pharmacy_claim\n\n)\n\n, patient_procedures as (\n\n    select\n          person_id\n        , claim_id\n        , procedure_date as start_date\n        , normalized_code_type as code_type\n        , replace(normalized_code,'.','') as code\n        , data_source\n    from __dbt__cte__cms_chronic_conditions__stg_core__procedure\n\n)\n\n, inclusions_diagnosis as (\n\n    select\n          patient_conditions.person_id\n        , patient_conditions.claim_id\n        , patient_conditions.start_date\n        , patient_conditions.data_source\n        , chronic_conditions.chronic_condition_type\n        , chronic_conditions.condition_category\n        , chronic_conditions.condition\n    from patient_conditions\n         inner join chronic_conditions\n             on patient_conditions.code = chronic_conditions.code\n    where chronic_conditions.inclusion_type = 'Include'\n    and chronic_conditions.code_system = 'ICD-10-CM'\n\n)\n\n, inclusions_procedure as (\n\n    select\n          patient_procedures.person_id\n        , patient_procedures.claim_id\n        , patient_procedures.start_date\n        , patient_procedures.data_source\n        , chronic_conditions.chronic_condition_type\n        , chronic_conditions.condition_category\n        , chronic_conditions.condition\n    from patient_procedures\n         inner join chronic_conditions\n             on patient_procedures.code = chronic_conditions.code\n    where chronic_conditions.inclusion_type = 'Include'\n    and chronic_conditions.code_system in ('ICD-10-PCS', 'HCPCS')\n\n)\n\n/*\n    Exclusion logic: Naltrexone NDCs are excluded if there is evidence of an\n    alcohol or other drug use disorder where opioid DX is not present\n\n    This CTE excludes medication encounters with the exception codes for\n    Naltrexone. Those encounters will be evaluated separately.\n*/\n, inclusions_medication as (\n\n    select\n          patient_medications.person_id\n        , patient_medications.claim_id\n        , patient_medications.start_date\n        , patient_medications.data_source\n        , chronic_conditions.chronic_condition_type\n        , chronic_conditions.condition_category\n        , chronic_conditions.condition\n    from patient_medications\n         inner join chronic_conditions\n             on patient_medications.code = chronic_conditions.code\n    where chronic_conditions.inclusion_type = 'Include'\n    and chronic_conditions.code_system = 'NDC'\n    and chronic_conditions.code not in ('00056001122', '00056001130', '00056001170', '00056007950', '00056008050', '00185003901', '00185003930', '00406009201', '00406009203', '00406117001', '00406117003', '00555090201', '00555090202', '00904703604', '16729008101', '16729008110', '42291063230', '43063059115', '47335032683', '47335032688', '50090286600', '50436010501', '51224020630', '51224020650', '51285027501', '51285027502', '52152010502', '52152010504', '52152010530', '54868557400', '63459030042', '63629104601', '63629104701', '65694010003', '65694010010', '65757030001', '65757030202', '68084029111', '68084029121', '68094085362', '68115068030')\n\n)\n\n/*\n    Exclusion logic: Naltrexone NDCs are excluded if there is evidence of an\n    alcohol or other drug use disorder where opioid DX is not present\n\n    This CTE includes patients with evidence of the chronic conditions Alcohol\n    Use Disorders or Drug Use Disorders.\n*/\n, exclusions_other_chronic_conditions as (\n\n    select distinct person_id\n    from tuva.chronic_conditions._int_cms_chronic_condition_all\n    where condition in (\n          'Alcohol Use Disorders'\n        , 'Drug Use Disorders'\n    )\n\n)\n\n/*\n    Exclusion logic: Naltrexone NDCs are excluded if there is evidence of an\n    alcohol or other drug use disorder where opioid DX is not present\n\n    This CTE creates the exclusion list which consists of patients with\n    medication encounters for Naltrexone having Alcohol Use Disorder or Drug\n    Use Disorder and missing the Opioid Use Disorder diagnosis codes.\n*/\n, exclusions_medication as (\n    select distinct\n          patient_medications.person_id\n    from patient_medications\n         inner join chronic_conditions\n             on patient_medications.code = chronic_conditions.code\n         inner join exclusions_other_chronic_conditions\n             on patient_medications.person_id = exclusions_other_chronic_conditions.person_id\n         left join inclusions_diagnosis\n             on patient_medications.person_id = inclusions_diagnosis.person_id\n    where chronic_conditions.inclusion_type = 'Include'\n    and chronic_conditions.code_system = 'NDC'\n    and chronic_conditions.code in ('00056001122', '00056001130', '00056001170', '00056007950', '00056008050', '00185003901', '00185003930', '00406009201', '00406009203', '00406117001', '00406117003', '00555090201', '00555090202', '00904703604', '16729008101', '16729008110', '42291063230', '43063059115', '47335032683', '47335032688', '50090286600', '50436010501', '51224020630', '51224020650', '51285027501', '51285027502', '52152010502', '52152010504', '52152010530', '54868557400', '63459030042', '63629104601', '63629104701', '65694010003', '65694010010', '65757030001', '65757030202', '68084029111', '68084029121', '68094085362', '68115068030')\n    and inclusions_diagnosis.person_id is null\n\n)\n\n\n, inclusions_unioned as (\n\n    select * from inclusions_diagnosis\n    union distinct\n    select * from inclusions_procedure\n    union distinct\n    select * from inclusions_medication\n\n)\n\n\nselect distinct\n      cast(inclusions_unioned.person_id as TEXT) as person_id\n    , cast(inclusions_unioned.claim_id as TEXT) as claim_id\n    , cast(inclusions_unioned.start_date as date) as start_date\n    , cast(inclusions_unioned.chronic_condition_type as TEXT) as chronic_condition_type\n    , cast(inclusions_unioned.condition_category as TEXT) as condition_category\n    , cast(inclusions_unioned.condition as TEXT) as condition\n    , cast(inclusions_unioned.data_source as TEXT) as data_source\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom inclusions_unioned\n     left join exclusions_medication\n         on inclusions_unioned.person_id = exclusions_medication.person_id\nwhere exclusions_medication.person_id is null", "relation_name": "tuva.chronic_conditions._int_cms_chronic_condition_oud"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.989332Z", "completed_at": "2025-02-25T21:26:26.995383Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.995605Z", "completed_at": "2025-02-25T21:26:26.995610Z"}], "thread_id": "Thread-1", "execution_time": 0.007455110549926758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.not_null_chronic_conditions__cms_chronic_conditions_all_condition.bb780b4840", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect condition\nfrom tuva.chronic_conditions._int_cms_chronic_condition_all\nwhere condition is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.992643Z", "completed_at": "2025-02-25T21:26:26.996206Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:26.996668Z", "completed_at": "2025-02-25T21:26:26.996672Z"}], "thread_id": "Thread-3", "execution_time": 0.004578113555908203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.not_null_chronic_conditions__cms_chronic_conditions_all_person_id.639395081a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect person_id\nfrom tuva.chronic_conditions._int_cms_chronic_condition_all\nwhere person_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.997522Z", "completed_at": "2025-02-25T21:26:27.004591Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.004864Z", "completed_at": "2025-02-25T21:26:27.004871Z"}], "thread_id": "Thread-1", "execution_time": 0.008505105972290039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.accepted_values_chronic_conditions__cms_chronic_conditions_hiv_aids_condition__Human_Immunodeficiency_Virus_and_or_Acquired_Immunodeficiency_Syndrome_HIV_AIDS_.c54d45a2c6", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        condition as value_field,\n        count(*) as n_records\n\n    from tuva.chronic_conditions._int_cms_chronic_condition_hiv_aids\n    group by condition\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Human Immunodeficiency Virus and/or Acquired Immunodeficiency Syndrome (HIV/AIDS)'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.000717Z", "completed_at": "2025-02-25T21:26:27.006301Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.011679Z", "completed_at": "2025-02-25T21:26:27.011686Z"}], "thread_id": "Thread-3", "execution_time": 0.011511087417602539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.not_null_chronic_conditions__cms_chronic_conditions_hiv_aids_claim_id.9baa48027d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect claim_id\nfrom tuva.chronic_conditions._int_cms_chronic_condition_hiv_aids\nwhere claim_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.012367Z", "completed_at": "2025-02-25T21:26:27.020052Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.020289Z", "completed_at": "2025-02-25T21:26:27.020295Z"}], "thread_id": "Thread-1", "execution_time": 0.01428985595703125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.not_null_chronic_conditions__cms_chronic_conditions_hiv_aids_condition.da32954f00", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect condition\nfrom tuva.chronic_conditions._int_cms_chronic_condition_hiv_aids\nwhere condition is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.016486Z", "completed_at": "2025-02-25T21:26:27.046302Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.046833Z", "completed_at": "2025-02-25T21:26:27.046840Z"}], "thread_id": "Thread-3", "execution_time": 0.03095698356628418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.not_null_chronic_conditions__cms_chronic_conditions_hiv_aids_person_id.1539571692", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect person_id\nfrom tuva.chronic_conditions._int_cms_chronic_condition_hiv_aids\nwhere person_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.021315Z", "completed_at": "2025-02-25T21:26:27.048183Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.060876Z", "completed_at": "2025-02-25T21:26:27.060884Z"}], "thread_id": "Thread-1", "execution_time": 0.04004788398742676, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.cms_hcc__int_eligible_conditions", "compiled": true, "compiled_code": "\n/*\nSteps for staging condition data:\n    1) Filter to risk-adjustable claims per claim type for the collection year.\n    2) Gather diagnosis codes from condition for the eligible claims.\n    3) Map and filter diagnosis codes to HCCs\n\nClaims filtering logic:\n - Professional:\n    - CPT/HCPCS in CPT/HCPCS seed file from CMS\n - Inpatient:\n    - Bill type code in (11X, 41X)\n - Outpatient:\n    - Bill type code in (12X, 13X, 43X, 71X, 73X, 76X, 77X, 85X)\n    - CPT/HCPCS in CPT/HCPCS seed file from CMS\n\nJinja is used to set payment year variable.\n - The payment_year var has been set here so it gets compiled.\n - The collection year is one year prior to the payment year.\n*/\n\nwith  __dbt__cte___stg_medical_claim as (\n\nselect\n      claim_id\n    , claim_line_number\n    , claim_type\n    , person_id\n    , claim_start_date\n    , claim_end_date\n    , bill_type_code\n    , hcpcs_code\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.medical_claim\n),  __dbt__cte___stg_condition as (\n\nselect\n      claim_id\n    , person_id\n    , recorded_date\n    , condition_type\n    , normalized_code_type as code_type\n    , normalized_code as code\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.condition\n), medical_claims as (\n\n    select\n          claim_id\n        , claim_line_number\n        , claim_type\n        , person_id\n        , claim_start_date\n        , claim_end_date\n        , bill_type_code\n        , hcpcs_code\n    from __dbt__cte___stg_medical_claim\n\n)\n\n, conditions as (\n\n    select\n          claim_id\n        , person_id\n        , code\n    from __dbt__cte___stg_condition\n    where code_type = 'icd-10-cm'\n\n)\n\n, cpt_hcpcs_list as (\n\n    select\n          payment_year\n        , hcpcs_cpt_code\n    from tuva.cms_hcc._value_set_cpt_hcpcs\n\n)\n\n, professional_claims as (\n\n    select\n          medical_claims.claim_id\n        , medical_claims.claim_line_number\n        , medical_claims.claim_type\n        , medical_claims.person_id\n        , medical_claims.claim_start_date\n        , medical_claims.claim_end_date\n        , medical_claims.bill_type_code\n        , medical_claims.hcpcs_code\n        , dates.payment_year\n        , dates.collection_start_date\n        , dates.collection_end_date\n    from medical_claims\n        inner join cpt_hcpcs_list\n            on medical_claims.hcpcs_code = cpt_hcpcs_list.hcpcs_cpt_code\n        inner join tuva.cms_hcc._int_monthly_collection_dates as dates\n            on claim_end_date between dates.collection_start_date and dates.collection_end_date\n            and cpt_hcpcs_list.payment_year = dates.payment_year\n    where claim_type = 'professional'\n\n)\n\n, inpatient_claims as (\n\n    select\n          medical_claims.claim_id\n        , medical_claims.claim_line_number\n        , medical_claims.claim_type\n        , medical_claims.person_id\n        , medical_claims.claim_start_date\n        , medical_claims.claim_end_date\n        , medical_claims.bill_type_code\n        , medical_claims.hcpcs_code\n        , dates.payment_year\n        , dates.collection_start_date\n        , dates.collection_end_date\n    from medical_claims\n        inner join tuva.cms_hcc._int_monthly_collection_dates as dates\n            on claim_end_date between dates.collection_start_date and dates.collection_end_date\n    where claim_type = 'institutional'\n        and substring(bill_type_code, 1, 2) in ('11','41')\n\n)\n\n, outpatient_claims as (\n\n    select\n          medical_claims.claim_id\n        , medical_claims.claim_line_number\n        , medical_claims.claim_type\n        , medical_claims.person_id\n        , medical_claims.claim_start_date\n        , medical_claims.claim_end_date\n        , medical_claims.bill_type_code\n        , medical_claims.hcpcs_code\n        , dates.payment_year\n        , dates.collection_start_date\n        , dates.collection_end_date\n    from medical_claims\n        inner join cpt_hcpcs_list\n            on medical_claims.hcpcs_code = cpt_hcpcs_list.hcpcs_cpt_code\n        inner join tuva.cms_hcc._int_monthly_collection_dates as dates\n            on claim_end_date between dates.collection_start_date and dates.collection_end_date\n            and cpt_hcpcs_list.payment_year = dates.payment_year\n    where claim_type = 'institutional'\n        and substring(bill_type_code, 1, 2) in ('12','13','43','71','73','76','77','85')\n\n)\n\n, eligible_claims as (\n\n    select * from professional_claims\n    union all\n    select * from inpatient_claims\n    union all\n    select * from outpatient_claims\n\n)\n\n, eligible_conditions as (\n\n    select distinct\n          eligible_claims.claim_id\n        , eligible_claims.person_id\n        , eligible_claims.payment_year\n        , eligible_claims.collection_start_date\n        , eligible_claims.collection_end_date\n        , conditions.code\n    from eligible_claims\n        inner join conditions\n            on eligible_claims.claim_id = conditions.claim_id\n            and eligible_claims.person_id = conditions.person_id\n\n)\n\n, add_data_types as (\n\n    select distinct\n          cast(person_id as TEXT) as person_id\n        , cast(code as TEXT) as condition_code\n        , cast(payment_year as integer) as payment_year\n        , cast(collection_start_date as date) as collection_start_date\n        , cast(collection_end_date as date) as collection_end_date\n    from eligible_conditions\n\n)\n\nselect\n      person_id\n    , condition_code\n    , payment_year\n    , collection_start_date\n    , collection_end_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.cms_hcc._int_eligible_conditions"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.075225Z", "completed_at": "2025-02-25T21:26:27.114283Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.128585Z", "completed_at": "2025-02-25T21:26:27.128594Z"}], "thread_id": "Thread-1", "execution_time": 0.05429887771606445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.financial_pmpm__service_category_1_allowed_pivot", "compiled": true, "compiled_code": "\n\nwith service_cat_1 as (\n  select\n    person_id\n  , year_month\n  , payer\n  , plan\n  , service_category_1\n  , data_source\n  , sum(total_allowed) as total_allowed\n  from tuva.financial_pmpm._int_patient_spend_with_service_categories\n  group by\n    person_id\n  , year_month\n  , payer\n  , plan\n  , service_category_1\n  , data_source\n)\n\nselect\n  person_id\n, year_month\n, payer\n, plan\n, data_source\n, \n  \n    sum(\n      \n      case\n      when service_category_1 = 'inpatient'\n        then total_allowed\n      else 0\n      end\n    )\n    \n      \n        as inpatient_allowed\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_1 = 'outpatient'\n        then total_allowed\n      else 0\n      end\n    )\n    \n      \n        as outpatient_allowed\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_1 = 'office-based'\n        then total_allowed\n      else 0\n      end\n    )\n    \n      \n        as office_based_allowed\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_1 = 'ancillary'\n        then total_allowed\n      else 0\n      end\n    )\n    \n      \n        as ancillary_allowed\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_1 = 'other'\n        then total_allowed\n      else 0\n      end\n    )\n    \n      \n        as other_allowed\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_1 = 'pharmacy'\n        then total_allowed\n      else 0\n      end\n    )\n    \n      \n        as pharmacy_allowed\n      \n    \n    \n  \n\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom service_cat_1\ngroup by\n  person_id\n, year_month\n, payer\n, plan\n, data_source", "relation_name": "tuva.financial_pmpm._int_service_category_1_allowed_pivot"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.048383Z", "completed_at": "2025-02-25T21:26:27.130705Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.131331Z", "completed_at": "2025-02-25T21:26:27.131337Z"}], "thread_id": "Thread-3", "execution_time": 0.08386397361755371, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.cms_hcc__int_members", "compiled": true, "compiled_code": "\n/*\nSteps for transforming eligibility data into member demographics:\n    1) Determine enrollment status using eligibility from the collection year.\n    2) Roll up to latest eligibility record for enrollment statuses.\n    3) Add age groups based on the payment year.\n    4) Determine other statuses.\n\nJinja is used to set payment year variable.\n - The payment_year var has been set here so it gets compiled.\n - CMS guidance: Age is calculated as of Feb 1 of the payment year.\n - The collection year is one year prior to the payment year.\n*/\n\nwith  __dbt__cte___stg_eligibility as (\n\nselect\n      person_id\n    , enrollment_start_date\n    , enrollment_end_date\n    , original_reason_entitlement_code\n    , dual_status_code\n    , medicare_status_code\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.eligibility\n),  __dbt__cte___stg_patient as (\n\nselect\n      person_id\n    , sex\n    , birth_date\n    , death_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.patient\n), stg_eligibility as (\n\n    select\n          elig.person_id\n        , elig.enrollment_start_date\n        , elig.enrollment_end_date\n        , elig.original_reason_entitlement_code\n        , elig.dual_status_code\n        , elig.medicare_status_code\n        , dates.collection_year\n        , dates.payment_year\n        , dates.collection_start_date\n        , dates.collection_end_date\n        , dates.payment_year || '-12-31' as payment_year_end_date\n        , row_number() over(\n            partition by elig.person_id, dates.collection_end_date\n            order by elig.enrollment_end_date desc\n        ) as row_num /* used to dedupe eligibility */\n    from __dbt__cte___stg_eligibility as elig\n    inner join tuva.cms_hcc._int_monthly_collection_dates as dates\n        /* filter to members with eligibility in collection or payment year */\n        on elig.enrollment_start_date <= cast(dates.payment_year || '-12-31' as date)\n        and elig.enrollment_end_date >= dates.collection_start_date\n\n)\n\n, payment_year_age_dates as (\n\n    select distinct\n          payment_year\n        , cast(payment_year || '-02-01' as date) as payment_year_age_date\n    from tuva.cms_hcc._int_monthly_collection_dates\n\n)\n\n, stg_patient as (\n\n    select\n          patient.person_id\n        , patient.sex\n        , patient.birth_date\n        , dates.payment_year\n        , floor(datediff(\n        hour,\n        birth_date,\n        payment_year_age_date\n        ) / 8766.0) as payment_year_age\n        , patient.death_date\n    from __dbt__cte___stg_patient as patient\n    cross join payment_year_age_dates as dates\n\n)\n\n/* create proxy enrollment dates if outside of the collection year */\n, cap_collection_start_end_dates as (\n\n    select\n          person_id\n        , enrollment_start_date\n        , enrollment_end_date\n        , payment_year\n        , collection_start_date\n        , collection_end_date\n        , case\n            when enrollment_start_date < try_cast( collection_start_date as date )\n            then try_cast( collection_start_date as date )\n            else enrollment_start_date\n          end as proxy_enrollment_start_date\n        , case\n            when enrollment_end_date > try_cast( payment_year_end_date as date )\n            then try_cast( payment_year_end_date as date )\n            else enrollment_end_date\n          end as proxy_enrollment_end_date\n    from stg_eligibility\n\n)\n\n, calculate_prior_coverage as (\n\n    select person_id\n        , payment_year\n        , collection_end_date\n        , sum(datediff(\n        month,\n        proxy_enrollment_start_date,\n        proxy_enrollment_end_date\n        ) + 1) as coverage_months  /* include starting month */\n        , min(datediff(\n        month,\n        collection_start_date,\n        collection_end_date\n        ) + 1) as collection_months\n    from cap_collection_start_end_dates\n    group by person_id\n        , payment_year\n        , collection_end_date\n\n)\n\n/*\n   CMS guidance: A \u201cNew Enrollee\u201d status is when a beneficiary has less than\n   12 months of coverage prior to the payment year.\n*/\n, add_enrollment as (\n\n    select\n          person_id\n        , payment_year\n        , collection_end_date\n        , case\n            when coverage_months < collection_months then 'New'\n            else 'Continuing'\n          end as enrollment_status\n    from calculate_prior_coverage\n\n)\n\n, latest_eligibility as (\n\n    select\n          stg_eligibility.person_id\n        , stg_eligibility.payment_year\n        , stg_eligibility.collection_start_date\n        , stg_eligibility.collection_end_date\n        , stg_patient.sex as gender\n        , stg_patient.payment_year_age\n        , stg_eligibility.original_reason_entitlement_code\n        , stg_eligibility.dual_status_code\n        , stg_eligibility.medicare_status_code\n        /* Defaulting to \"New\" enrollment status when missing */\n        , case\n            when add_enrollment.enrollment_status is null then 'New'\n            else add_enrollment.enrollment_status\n          end as enrollment_status\n        \n            , case\n                when add_enrollment.enrollment_status is null then TRUE\n                else FALSE\n              end as enrollment_status_default\n        \n    from stg_eligibility\n        left join add_enrollment\n            on stg_eligibility.person_id = add_enrollment.person_id\n            and stg_eligibility.payment_year = add_enrollment.payment_year\n            and stg_eligibility.collection_end_date = add_enrollment.collection_end_date\n        left join stg_patient\n            on stg_eligibility.person_id = stg_patient.person_id\n            and stg_eligibility.payment_year = stg_patient.payment_year\n    where stg_eligibility.row_num = 1\n\n)\n\n, add_age_group as (\n\n    select\n          person_id\n        , payment_year\n        , collection_start_date\n        , collection_end_date\n        , gender\n        , payment_year_age\n        , original_reason_entitlement_code\n        , dual_status_code\n        , medicare_status_code\n        , enrollment_status\n        , enrollment_status_default\n        , case\n            when enrollment_status = 'Continuing' and payment_year_age between 0 and 34 then '0-34'\n            when enrollment_status = 'Continuing' and payment_year_age between 35 and 44 then '35-44'\n            when enrollment_status = 'Continuing' and payment_year_age between 45 and 54 then '45-54'\n            when enrollment_status = 'Continuing' and payment_year_age between 55 and 59 then '55-59'\n            when enrollment_status = 'Continuing' and payment_year_age between 60 and 64 then '60-64'\n            when enrollment_status = 'Continuing' and payment_year_age between 65 and 69 then '65-69'\n            when enrollment_status = 'Continuing' and payment_year_age between 70 and 74 then '70-74'\n            when enrollment_status = 'Continuing' and payment_year_age between 75 and 79 then '75-79'\n            when enrollment_status = 'Continuing' and payment_year_age between 80 and 84 then '80-84'\n            when enrollment_status = 'Continuing' and payment_year_age between 85 and 89 then '85-89'\n            when enrollment_status = 'Continuing' and payment_year_age between 90 and 94 then '90-94'\n            when enrollment_status = 'Continuing' and payment_year_age >= 95 then '>=95'\n            when enrollment_status = 'New' and payment_year_age between 0 and 34 then '0-34'\n            when enrollment_status = 'New' and payment_year_age between 35 and 44 then '35-44'\n            when enrollment_status = 'New' and payment_year_age between 45 and 54 then '45-54'\n            when enrollment_status = 'New' and payment_year_age between 55 and 59 then '55-59'\n            when enrollment_status = 'New' and payment_year_age between 60 and 64 then '60-64'\n            when enrollment_status = 'New' and payment_year_age = 65 then '65'\n            when enrollment_status = 'New' and payment_year_age = 66 then '66'\n            when enrollment_status = 'New' and payment_year_age = 67 then '67'\n            when enrollment_status = 'New' and payment_year_age = 68 then '68'\n            when enrollment_status = 'New' and payment_year_age = 69 then '69'\n            when enrollment_status = 'New' and payment_year_age between 70 and 74 then '70-74'\n            when enrollment_status = 'New' and payment_year_age between 75 and 79 then '75-79'\n            when enrollment_status = 'New' and payment_year_age between 80 and 84 then '80-84'\n            when enrollment_status = 'New' and payment_year_age between 85 and 89 then '85-89'\n            when enrollment_status = 'New' and payment_year_age between 90 and 94 then '90-94'\n            when enrollment_status = 'New' and payment_year_age >= 95 then '>=95'\n          end as age_group\n    from latest_eligibility\n\n)\n\n, add_status_logic as (\n\n    select\n          person_id\n        , payment_year\n        , collection_start_date\n        , collection_end_date\n        , enrollment_status\n        , case\n            when gender = 'female' then 'Female'\n            when gender = 'male' then 'Male'\n            else null\n          end as gender\n        , age_group\n        , case\n            when dual_status_code in ('01','02','03','04','05','06','08') then 'Yes'\n            else 'No'\n          end as medicaid_status\n        , case\n            when dual_status_code in ('02','04','08') then 'Full'\n            when dual_status_code in ('01','03','05','06') then 'Partial'\n            else 'Non'\n          end as dual_status\n        /*\n           The CMS-HCC model does not have factors for ESRD for these edge-cases,\n           we default to 'Aged'. When OREC is missing, latest Medicare status is\n           used, if available.\n        */\n        , case\n            when original_reason_entitlement_code in ('0','2') then 'Aged'\n            when original_reason_entitlement_code in ('1','3') then 'Disabled'\n            when original_reason_entitlement_code is null and medicare_status_code in ('10','11','31') then 'Aged'\n            when original_reason_entitlement_code is null and medicare_status_code in ('20','21') then 'Disabled'\n            when coalesce(original_reason_entitlement_code,medicare_status_code) is null then 'Aged'\n          end as orec\n        /* Defaulting everyone to non-institutional until logic is added */\n        , cast('No' as TEXT) as institutional_status\n        , enrollment_status_default\n        , case\n            \n                when dual_status_code is null then TRUE\n                else FALSE\n            \n          end as medicaid_dual_status_default\n        /* Setting default true when OREC or Medicare Status is ESRD, or null */\n        , case\n            \n                when original_reason_entitlement_code in ('2') then TRUE\n                when original_reason_entitlement_code is null and medicare_status_code in ('31') then TRUE\n                when coalesce(original_reason_entitlement_code,medicare_status_code) is null then TRUE\n                else FALSE\n            \n          end as orec_default\n        /* Setting default true until institutional logic is added */\n        \n            , TRUE as institutional_status_default\n        \n    from add_age_group\n\n)\n\n, add_data_types as (\n\n    select\n          cast(person_id as TEXT) as person_id\n        , cast(enrollment_status as TEXT) as enrollment_status\n        , cast(gender as TEXT) as gender\n        , cast(age_group as TEXT) as age_group\n        , cast(medicaid_status as TEXT) as medicaid_status\n        , cast(dual_status as TEXT) as dual_status\n        , cast(orec as TEXT) as orec\n        , cast(institutional_status as TEXT) as institutional_status\n        \n            , cast(enrollment_status_default as boolean) as enrollment_status_default\n            , cast(medicaid_dual_status_default as boolean) as medicaid_dual_status_default\n            , cast(orec_default as boolean) as orec_default\n            , cast(institutional_status_default as boolean) as institutional_status_default\n        \n        , cast(payment_year as integer) as payment_year\n        , cast(collection_start_date as date) as collection_start_date\n        , cast(collection_end_date as date) as collection_end_date\n    from add_status_logic\n\n)\n\nselect\n      person_id\n    , enrollment_status\n    , gender\n    , age_group\n    , medicaid_status\n    , dual_status\n    , orec\n    , institutional_status\n    , enrollment_status_default\n    , medicaid_dual_status_default\n    , orec_default\n    , institutional_status_default\n    , payment_year\n    , collection_start_date\n    , collection_end_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.cms_hcc._int_members"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.131966Z", "completed_at": "2025-02-25T21:26:27.148896Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.149170Z", "completed_at": "2025-02-25T21:26:27.149178Z"}], "thread_id": "Thread-1", "execution_time": 0.019184112548828125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.financial_pmpm__service_category_1_paid_pivot", "compiled": true, "compiled_code": "\n\nwith service_cat_1 as (\n  select\n    person_id\n  , year_month\n  , payer\n  , plan\n  , service_category_1\n  , data_source\n  , sum(total_paid) as total_paid\n  from tuva.financial_pmpm._int_patient_spend_with_service_categories\n  group by\n    person_id\n  , year_month\n  , payer\n  , plan\n  , service_category_1\n  , data_source\n)\n\nselect\n  person_id\n, year_month\n, payer\n, plan\n, data_source\n, \n  \n    sum(\n      \n      case\n      when service_category_1 = 'inpatient'\n        then total_paid\n      else 0\n      end\n    )\n    \n      \n        as inpatient_paid\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_1 = 'outpatient'\n        then total_paid\n      else 0\n      end\n    )\n    \n      \n        as outpatient_paid\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_1 = 'office-based'\n        then total_paid\n      else 0\n      end\n    )\n    \n      \n        as office_based_paid\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_1 = 'ancillary'\n        then total_paid\n      else 0\n      end\n    )\n    \n      \n        as ancillary_paid\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_1 = 'other'\n        then total_paid\n      else 0\n      end\n    )\n    \n      \n        as other_paid\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_1 = 'pharmacy'\n        then total_paid\n      else 0\n      end\n    )\n    \n      \n        as pharmacy_paid\n      \n    \n    \n  \n\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom service_cat_1\ngroup by\n  person_id\n, year_month\n, payer\n, plan\n, data_source", "relation_name": "tuva.financial_pmpm._int_service_category_1_paid_pivot"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.139350Z", "completed_at": "2025-02-25T21:26:27.150528Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.160368Z", "completed_at": "2025-02-25T21:26:27.160378Z"}], "thread_id": "Thread-3", "execution_time": 0.021973848342895508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.financial_pmpm__service_category_2_allowed_pivot", "compiled": true, "compiled_code": "\n\nwith service_cat_2 as (\n  select\n    person_id\n  , year_month\n  , payer\n  , plan\n  , service_category_2\n  , data_source\n  , sum(total_allowed) as total_allowed\n  from tuva.financial_pmpm._int_patient_spend_with_service_categories\n  group by\n    person_id\n  , year_month\n  , payer\n  , plan\n  , service_category_2\n  , data_source\n)\n\nselect\n  person_id\n, year_month\n, payer\n, plan\n, data_source\n, \n  \n    sum(\n      \n      case\n      when service_category_2 = 'acute inpatient'\n        then total_allowed\n      else 0\n      end\n    )\n    \n      \n        as acute_inpatient_allowed\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'ambulance'\n        then total_allowed\n      else 0\n      end\n    )\n    \n      \n        as ambulance_allowed\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'ambulatory surgery center'\n        then total_allowed\n      else 0\n      end\n    )\n    \n      \n        as ambulatory_surgery_center_allowed\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'dialysis'\n        then total_allowed\n      else 0\n      end\n    )\n    \n      \n        as dialysis_allowed\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'durable medical equipment'\n        then total_allowed\n      else 0\n      end\n    )\n    \n      \n        as durable_medical_equipment_allowed\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'emergency department'\n        then total_allowed\n      else 0\n      end\n    )\n    \n      \n        as emergency_department_allowed\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'home health'\n        then total_allowed\n      else 0\n      end\n    )\n    \n      \n        as home_health_allowed\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'inpatient hospice'\n        then total_allowed\n      else 0\n      end\n    )\n    \n      \n        as inpatient_hospice_allowed\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'inpatient psychiatric'\n        then total_allowed\n      else 0\n      end\n    )\n    \n      \n        as inpatient_psychiatric_allowed\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'inpatient rehabilitation'\n        then total_allowed\n      else 0\n      end\n    )\n    \n      \n        as inpatient_rehabilitation_allowed\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'lab'\n        then total_allowed\n      else 0\n      end\n    )\n    \n      \n        as lab_allowed\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'observation'\n        then total_allowed\n      else 0\n      end\n    )\n    \n      \n        as observation_allowed\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'office-based other'\n        then total_allowed\n      else 0\n      end\n    )\n    \n      \n        as office_based_other_allowed\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'office-based pt/ot/st'\n        then total_allowed\n      else 0\n      end\n    )\n    \n      \n        as office_based_ptotst_allowed\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'office-based radiology'\n        then total_allowed\n      else 0\n      end\n    )\n    \n      \n        as office_based_radiology_allowed\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'office-based surgery'\n        then total_allowed\n      else 0\n      end\n    )\n    \n      \n        as office_based_surgery_allowed\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'office-based visit'\n        then total_allowed\n      else 0\n      end\n    )\n    \n      \n        as office_based_visit_allowed\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'other'\n        then total_allowed\n      else 0\n      end\n    )\n    \n      \n        as other_allowed\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'outpatient hospice'\n        then total_allowed\n      else 0\n      end\n    )\n    \n      \n        as outpatient_hospice_allowed\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'outpatient hospital or clinic'\n        then total_allowed\n      else 0\n      end\n    )\n    \n      \n        as outpatient_hospital_or_clinic_allowed\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'outpatient pt/ot/st'\n        then total_allowed\n      else 0\n      end\n    )\n    \n      \n        as outpatient_ptotst_allowed\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'outpatient psychiatric'\n        then total_allowed\n      else 0\n      end\n    )\n    \n      \n        as outpatient_psychiatric_allowed\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'outpatient radiology'\n        then total_allowed\n      else 0\n      end\n    )\n    \n      \n        as outpatient_radiology_allowed\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'outpatient rehabilitation'\n        then total_allowed\n      else 0\n      end\n    )\n    \n      \n        as outpatient_rehabilitation_allowed\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'outpatient surgery'\n        then total_allowed\n      else 0\n      end\n    )\n    \n      \n        as outpatient_surgery_allowed\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'pharmacy'\n        then total_allowed\n      else 0\n      end\n    )\n    \n      \n        as pharmacy_allowed\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'skilled nursing'\n        then total_allowed\n      else 0\n      end\n    )\n    \n      \n        as skilled_nursing_allowed\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'telehealth visit'\n        then total_allowed\n      else 0\n      end\n    )\n    \n      \n        as telehealth_visit_allowed\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'urgent care'\n        then total_allowed\n      else 0\n      end\n    )\n    \n      \n        as urgent_care_allowed\n      \n    \n    \n  \n\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom service_cat_2\ngroup by\n  person_id\n, year_month\n, payer\n, plan\n, data_source", "relation_name": "tuva.financial_pmpm._int_service_category_2_allowed_pivot"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.150813Z", "completed_at": "2025-02-25T21:26:27.168326Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.180880Z", "completed_at": "2025-02-25T21:26:27.180892Z"}], "thread_id": "Thread-1", "execution_time": 0.03094196319580078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.financial_pmpm__service_category_2_paid_pivot", "compiled": true, "compiled_code": "\n\nwith service_cat_2 as (\n  select\n    person_id\n  , year_month\n  , payer\n  , plan\n  , service_category_2\n  , data_source\n  , sum(total_paid) as total_paid\n  from tuva.financial_pmpm._int_patient_spend_with_service_categories\n  group by\n    person_id\n  , year_month\n  , payer\n  , plan\n  , service_category_2\n  , data_source\n)\n\nselect\n  person_id\n, year_month\n, payer\n, plan\n, data_source\n, \n  \n    sum(\n      \n      case\n      when service_category_2 = 'acute inpatient'\n        then total_paid\n      else 0\n      end\n    )\n    \n      \n        as acute_inpatient_paid\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'ambulance'\n        then total_paid\n      else 0\n      end\n    )\n    \n      \n        as ambulance_paid\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'ambulatory surgery center'\n        then total_paid\n      else 0\n      end\n    )\n    \n      \n        as ambulatory_surgery_center_paid\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'dialysis'\n        then total_paid\n      else 0\n      end\n    )\n    \n      \n        as dialysis_paid\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'durable medical equipment'\n        then total_paid\n      else 0\n      end\n    )\n    \n      \n        as durable_medical_equipment_paid\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'emergency department'\n        then total_paid\n      else 0\n      end\n    )\n    \n      \n        as emergency_department_paid\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'home health'\n        then total_paid\n      else 0\n      end\n    )\n    \n      \n        as home_health_paid\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'inpatient hospice'\n        then total_paid\n      else 0\n      end\n    )\n    \n      \n        as inpatient_hospice_paid\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'inpatient psychiatric'\n        then total_paid\n      else 0\n      end\n    )\n    \n      \n        as inpatient_psychiatric_paid\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'inpatient rehabilitation'\n        then total_paid\n      else 0\n      end\n    )\n    \n      \n        as inpatient_rehabilitation_paid\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'lab'\n        then total_paid\n      else 0\n      end\n    )\n    \n      \n        as lab_paid\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'observation'\n        then total_paid\n      else 0\n      end\n    )\n    \n      \n        as observation_paid\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'office-based other'\n        then total_paid\n      else 0\n      end\n    )\n    \n      \n        as office_based_other_paid\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'office-based pt/ot/st'\n        then total_paid\n      else 0\n      end\n    )\n    \n      \n        as office_based_ptotst_paid\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'office-based radiology'\n        then total_paid\n      else 0\n      end\n    )\n    \n      \n        as office_based_radiology_paid\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'office-based surgery'\n        then total_paid\n      else 0\n      end\n    )\n    \n      \n        as office_based_surgery_paid\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'office-based visit'\n        then total_paid\n      else 0\n      end\n    )\n    \n      \n        as office_based_visit_paid\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'other'\n        then total_paid\n      else 0\n      end\n    )\n    \n      \n        as other_paid\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'outpatient hospice'\n        then total_paid\n      else 0\n      end\n    )\n    \n      \n        as outpatient_hospice_paid\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'outpatient hospital or clinic'\n        then total_paid\n      else 0\n      end\n    )\n    \n      \n        as outpatient_hospital_or_clinic_paid\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'outpatient pt/ot/st'\n        then total_paid\n      else 0\n      end\n    )\n    \n      \n        as outpatient_ptotst_paid\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'outpatient psychiatric'\n        then total_paid\n      else 0\n      end\n    )\n    \n      \n        as outpatient_psychiatric_paid\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'outpatient radiology'\n        then total_paid\n      else 0\n      end\n    )\n    \n      \n        as outpatient_radiology_paid\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'outpatient rehabilitation'\n        then total_paid\n      else 0\n      end\n    )\n    \n      \n        as outpatient_rehabilitation_paid\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'outpatient surgery'\n        then total_paid\n      else 0\n      end\n    )\n    \n      \n        as outpatient_surgery_paid\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'pharmacy'\n        then total_paid\n      else 0\n      end\n    )\n    \n      \n        as pharmacy_paid\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'skilled nursing'\n        then total_paid\n      else 0\n      end\n    )\n    \n      \n        as skilled_nursing_paid\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'telehealth visit'\n        then total_paid\n      else 0\n      end\n    )\n    \n      \n        as telehealth_visit_paid\n      \n    \n    ,\n  \n    sum(\n      \n      case\n      when service_category_2 = 'urgent care'\n        then total_paid\n      else 0\n      end\n    )\n    \n      \n        as urgent_care_paid\n      \n    \n    \n  \n\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom service_cat_2\ngroup by\n  person_id\n, year_month\n, payer\n, plan\n, data_source", "relation_name": "tuva.financial_pmpm._int_service_category_2_paid_pivot"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.161966Z", "completed_at": "2025-02-25T21:26:27.227981Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.228263Z", "completed_at": "2025-02-25T21:26:27.228271Z"}], "thread_id": "Thread-3", "execution_time": 0.06701016426086426, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.quality_measures__int_shared_exclusions_advanced_illness", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte___stg_condition as (\n\nselect\n      person_id\n    , claim_id\n    , encounter_id\n    , recorded_date\n    , source_code_type\n    , source_code\n    , normalized_code_type\n    , normalized_code\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.condition\n),  __dbt__cte___stg_medical_claim as (\n\n\nselect\n      person_id\n    , claim_id\n    , claim_start_date\n    , claim_end_date\n    , place_of_service_code\n    , hcpcs_code\n    , hcpcs_modifier_1\n    , hcpcs_modifier_2\n    , hcpcs_modifier_3\n    , hcpcs_modifier_4\n    , hcpcs_modifier_5\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.medical_claim\n\n\n),  __dbt__cte___stg_procedure as (\n\nselect\n      person_id\n    , encounter_id\n    , procedure_date\n    , source_code_type\n    , source_code\n    , normalized_code_type\n    , normalized_code\n    , modifier_1\n    , modifier_2\n    , modifier_3\n    , modifier_4\n    , modifier_5\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.procedure\n), patients_with_frailty as (\n\n    select\n          person_id\n        , exclusion_date\n        , exclusion_reason\n    from tuva.quality_measures._int_shared_exclusions_frailty\n\n)\n\n, exclusion_codes as (\n\n    select\n          code\n        , code_system\n        , concept_name\n    from tuva.quality_measures._value_set_codes\n    where lower(concept_name) in (\n          'advanced illness'\n        , 'acute inpatient'\n        , 'encounter inpatient'\n        , 'outpatient'\n        , 'observation'\n        , 'emergency department visit'\n        , 'nonacute inpatient'\n    )\n\n)\n\n, conditions as (\n\n    select\n          person_id\n        , claim_id\n        , recorded_date\n        , coalesce (\n              normalized_code_type\n            , case\n                when lower(source_code_type) = 'snomed' then 'snomed-ct'\n                else lower(source_code_type)\n              end\n          ) as code_type\n        , coalesce (\n              normalized_code\n            , source_code\n          ) as code\n    from __dbt__cte___stg_condition\n\n)\n\n, medical_claim as (\n\n    select\n          person_id\n        , claim_id\n        , claim_start_date\n        , claim_end_date\n        , hcpcs_code\n        , place_of_service_code\n    from __dbt__cte___stg_medical_claim\n\n)\n\n, procedures as (\n\n    select\n          person_id\n        , procedure_date\n        , coalesce (\n              normalized_code_type\n            , case\n                when lower(source_code_type) = 'cpt' then 'hcpcs'\n                when lower(source_code_type) = 'snomed' then 'snomed-ct'\n                else lower(source_code_type)\n              end\n          ) as code_type\n        , coalesce (\n              normalized_code\n            , source_code\n          ) as code\n    from __dbt__cte___stg_procedure\n\n)\n\n, condition_exclusions as (\n\n    select\n          conditions.person_id\n        , conditions.claim_id\n        , conditions.recorded_date\n        , exclusion_codes.concept_name\n    from conditions\n         inner join exclusion_codes\n            on conditions.code = exclusion_codes.code\n            and conditions.code_type = exclusion_codes.code_system\n    where lower(exclusion_codes.concept_name) = 'advanced illness'\n\n)\n\n, med_claim_exclusions as (\n\n    select\n          medical_claim.person_id\n        , medical_claim.claim_id\n        , medical_claim.claim_start_date\n        , medical_claim.claim_end_date\n        , medical_claim.hcpcs_code\n        , exclusion_codes.concept_name\n    from medical_claim\n         inner join exclusion_codes\n            on medical_claim.hcpcs_code = exclusion_codes.code\n    where exclusion_codes.code_system = 'hcpcs'\n\n)\n\n, procedure_exclusions as (\n\n    select\n          procedures.person_id\n        , procedures.procedure_date\n        , exclusion_codes.concept_name\n    from procedures\n         inner join exclusion_codes\n             on procedures.code = exclusion_codes.code\n             and procedures.code_type = exclusion_codes.code_system\n\n)\n\n, acute_inpatient as (\n\n    select distinct\n          patients_with_frailty.person_id\n        , coalesce(\n              med_claim_exclusions.claim_start_date\n            , med_claim_exclusions.claim_end_date\n          ) as exclusion_date\n        , patients_with_frailty.exclusion_reason || ' with ' || med_claim_exclusions.concept_name || ' and ' || condition_exclusions.concept_name as exclusion_reason\n        , med_claim_exclusions.claim_start_date\n        , med_claim_exclusions.claim_end_date\n        , cast(null as date) as procedure_date\n    from patients_with_frailty\n         inner join med_claim_exclusions\n            on patients_with_frailty.person_id = med_claim_exclusions.person_id\n         inner join condition_exclusions\n            on med_claim_exclusions.claim_id = condition_exclusions.claim_id\n    where lower(med_claim_exclusions.concept_name) = 'acute inpatient'\n\n    union all\n\n    select distinct\n          patients_with_frailty.person_id\n        , procedure_exclusions.procedure_date as exclusion_date\n        , patients_with_frailty.exclusion_reason || ' with ' || procedure_exclusions.concept_name || ' and ' || condition_exclusions.concept_name as exclusion_reason\n        , cast(null as date) as claim_start_date\n        , cast(null as date) as claim_end_date\n        , procedure_exclusions.procedure_date\n    from patients_with_frailty\n         inner join procedure_exclusions\n         on patients_with_frailty.person_id = procedure_exclusions.person_id\n         inner join condition_exclusions\n         on procedure_exclusions.person_id = condition_exclusions.person_id\n         and procedure_exclusions.procedure_date = condition_exclusions.recorded_date\n    where lower(procedure_exclusions.concept_name) = 'acute inpatient'\n\n)\n\n, nonacute_outpatient as (\n\n    select distinct\n          patients_with_frailty.person_id\n        , coalesce(\n              med_claim_exclusions.claim_start_date\n            , med_claim_exclusions.claim_end_date\n          ) as exclusion_date\n        , patients_with_frailty.exclusion_reason || ' with ' || med_claim_exclusions.concept_name || ' and ' || condition_exclusions.concept_name as exclusion_reason\n        , med_claim_exclusions.claim_start_date\n        , med_claim_exclusions.claim_end_date\n        , cast(null as date) as procedure_date\n    from patients_with_frailty\n         inner join med_claim_exclusions\n            on patients_with_frailty.person_id = med_claim_exclusions.person_id\n         inner join condition_exclusions\n            on med_claim_exclusions.claim_id = condition_exclusions.claim_id\n    where lower(med_claim_exclusions.concept_name) in (\n              'encounter inpatient'\n            , 'outpatient'\n            , 'observation'\n            , 'emergency department visit'\n            , 'nonacute inpatient'\n        )\n\n    union all\n\n    select distinct\n          patients_with_frailty.person_id\n        , procedure_exclusions.procedure_date as exclusion_date\n        , patients_with_frailty.exclusion_reason || ' with ' || procedure_exclusions.concept_name || ' and ' || condition_exclusions.concept_name as exclusion_reason\n        , cast(null as date) as claim_start_date\n        , cast(null as date) as claim_end_date\n        , procedure_exclusions.procedure_date\n    from patients_with_frailty\n         inner join procedure_exclusions\n         on patients_with_frailty.person_id = procedure_exclusions.person_id\n         inner join condition_exclusions\n         on procedure_exclusions.person_id = condition_exclusions.person_id\n         and procedure_exclusions.procedure_date = condition_exclusions.recorded_date\n    where lower(procedure_exclusions.concept_name) in (\n          'encounter inpatient'\n        , 'outpatient'\n        , 'observation'\n        , 'emergency department visit'\n        , 'nonacute inpatient'\n    )\n\n)\n\n, exclusions_unioned as (\n\n    select\n          acute_inpatient.person_id\n        , acute_inpatient.exclusion_date\n        , acute_inpatient.exclusion_reason\n        , acute_inpatient.claim_start_date\n        , acute_inpatient.claim_end_date\n        , acute_inpatient.procedure_date\n        , 'acute_inpatient' as patient_type\n    from acute_inpatient\n\n    union all\n\n    select\n          nonacute_outpatient.person_id\n        , nonacute_outpatient.exclusion_date\n        , nonacute_outpatient.exclusion_reason\n        , nonacute_outpatient.claim_start_date\n        , nonacute_outpatient.claim_end_date\n        , nonacute_outpatient.procedure_date\n        , 'nonacute_outpatient' as patient_type\n    from nonacute_outpatient\n\n)\n\nselect\n      person_id\n    , exclusion_date\n    , exclusion_reason\n    , 'advanced_illness' as exclusion_type\n    , claim_start_date\n    , claim_end_date\n    , procedure_date\n    , patient_type\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom exclusions_unioned", "relation_name": "tuva.quality_measures._int_shared_exclusions_advanced_illness"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.201331Z", "completed_at": "2025-02-25T21:26:27.228734Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.229245Z", "completed_at": "2025-02-25T21:26:27.229249Z"}], "thread_id": "Thread-1", "execution_time": 0.034974098205566406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.quality_measures__int_shared_exclusions_dementia", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte___stg_medication as (\n\n\nselect\n      person_id\n    , encounter_id\n    , prescribing_date  \n    , dispensing_date\n    , source_code_type\n    , source_code\n    , ndc_code\n    , rxnorm_code\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.medication\n\n\n),  __dbt__cte___stg_pharmacy_claim as (\n\n\nselect\n      person_id\n    , dispensing_date\n    , ndc_code\n    , days_supply\n    , paid_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.pharmacy_claim\n\n\n), patients_with_frailty as (\n\n    select\n          person_id\n        , exclusion_date\n        , exclusion_reason\n    from tuva.quality_measures._int_shared_exclusions_frailty\n\n)\n\n, exclusion_codes as (\n\n    select\n          code\n        , code_system\n        , concept_name\n    from tuva.quality_measures._value_set_codes\n    where lower(concept_name) in (\n        'dementia medications'\n    )\n\n)\n\n, medications as (\n\n    select\n          person_id\n        , dispensing_date\n        , source_code_type\n        , source_code\n        , ndc_code\n        , rxnorm_code\n    from __dbt__cte___stg_medication\n\n)\n\n, pharmacy_claim as (\n\n    select\n          person_id\n        , dispensing_date\n        , ndc_code\n        , paid_date\n    from __dbt__cte___stg_pharmacy_claim\n\n)\n\n, medication_exclusions as (\n\n    select\n          medications.person_id\n        , medications.dispensing_date\n        , exclusion_codes.concept_name\n    from medications\n         inner join exclusion_codes\n            on medications.ndc_code = exclusion_codes.code\n    where exclusion_codes.code_system = 'ndc'\n\n    union all\n\n    select\n          medications.person_id\n        , medications.dispensing_date\n        , exclusion_codes.concept_name\n    from medications\n         inner join exclusion_codes\n            on medications.rxnorm_code = exclusion_codes.code\n    where exclusion_codes.code_system = 'rxnorm'\n\n    union all\n\n    select\n          medications.person_id\n        , medications.dispensing_date\n        , exclusion_codes.concept_name\n    from medications\n         inner join exclusion_codes\n            on medications.source_code = exclusion_codes.code\n            and medications.source_code_type = exclusion_codes.code_system\n\n)\n\n, pharmacy_claim_exclusions as (\n\n    select\n          pharmacy_claim.person_id\n        , pharmacy_claim.dispensing_date\n        , pharmacy_claim.ndc_code\n        , pharmacy_claim.paid_date\n        , exclusion_codes.concept_name\n    from pharmacy_claim\n         inner join exclusion_codes\n            on pharmacy_claim.ndc_code = exclusion_codes.code\n    where exclusion_codes.code_system = 'ndc'\n\n)\n\n, frailty_with_dementia as (\n\n    select\n          patients_with_frailty.person_id\n        , patients_with_frailty.exclusion_date\n        , patients_with_frailty.exclusion_reason || ' with ' || pharmacy_claim_exclusions.concept_name as exclusion_reason\n        , pharmacy_claim_exclusions.dispensing_date\n        , pharmacy_claim_exclusions.paid_date\n    from patients_with_frailty\n         inner join pharmacy_claim_exclusions\n            on patients_with_frailty.person_id = pharmacy_claim_exclusions.person_id\n\n    union all\n\n    select\n          patients_with_frailty.person_id\n        , medication_exclusions.dispensing_date as exclusion_date\n        , patients_with_frailty.exclusion_reason || ' with ' || medication_exclusions.concept_name as exclusion_reason\n        , medication_exclusions.dispensing_date\n        , null as paid_date\n    from patients_with_frailty\n         inner join medication_exclusions\n         on patients_with_frailty.person_id = medication_exclusions.person_id\n\n)\n\nselect\n      person_id\n    , exclusion_date\n    , exclusion_reason\n    , 'dementia' as exclusion_type\n    , dispensing_date\n    , paid_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom frailty_with_dementia", "relation_name": "tuva.quality_measures._int_shared_exclusions_dementia"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.230706Z", "completed_at": "2025-02-25T21:26:27.274374Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.274623Z", "completed_at": "2025-02-25T21:26:27.274630Z"}], "thread_id": "Thread-3", "execution_time": 0.04509425163269043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.quality_measures__int_adh_diabetes_exclusions", "compiled": true, "compiled_code": "with  __dbt__cte___stg_condition as (\n\nselect\n      person_id\n    , claim_id\n    , encounter_id\n    , recorded_date\n    , source_code_type\n    , source_code\n    , normalized_code_type\n    , normalized_code\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.condition\n),  __dbt__cte___stg_pharmacy_claim as (\n\n\nselect\n      person_id\n    , dispensing_date\n    , ndc_code\n    , days_supply\n    , paid_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.pharmacy_claim\n\n\n), denominator as (\n    \n    select\n        person_id\n    from tuva.quality_measures._int_adh_diabetes_denominator\n\n)\n\n, exclusion_codes as (\n\n    select\n        code\n      , code_system\n      , concept_name\n    from tuva.quality_measures._value_set_codes\n    where lower(concept_name) in (\n          'pqa esrd'\n        , 'pqa insulin medications'\n    )\n\n)\n\n, hospice_palliative as (\n\n    select\n          person_id\n        , exclusion_date\n        , exclusion_reason\n    from tuva.quality_measures._int_shared_exclusions_hospice_palliative\n    where exclusion_date between (\n\n  select \n    performance_period_begin\n  from tuva.quality_measures._int_adh_diabetes__performance_period\n\n) and (\n\n  select \n    performance_period_end\n  from tuva.quality_measures._int_adh_diabetes__performance_period\n\n)\n\n)\n\n, valid_hospice as (\n\n    select\n          person_id\n        , exclusion_date\n        , exclusion_reason\n    from hospice_palliative\n    where lower(exclusion_reason) in (\n            'hospice encounter'\n          , 'hospice care ambulatory'\n          , 'hospice diagnosis'\n    )\n\n)\n\n, conditions as (\n\n    select\n          person_id\n        , recorded_date\n        , claim_id\n        , coalesce (\n              normalized_code_type\n            , case\n                when lower(source_code_type) = 'snomed' then 'snomed-ct'\n                else lower(source_code_type)\n              end\n          ) as code_type\n        , coalesce (\n              normalized_code\n            , source_code\n          ) as code\n    from __dbt__cte___stg_condition\n    where recorded_date between (\n\n  select \n    performance_period_begin\n  from tuva.quality_measures._int_adh_diabetes__performance_period\n\n) and (\n\n  select \n    performance_period_end\n  from tuva.quality_measures._int_adh_diabetes__performance_period\n\n)\n\n)\n\n, condition_exclusions as (\n\n      select\n          conditions.person_id\n        , conditions.recorded_date as exclusion_date\n        , exclusion_codes.concept_name as exclusion_reason\n    from conditions\n    inner join exclusion_codes\n      on conditions.code = exclusion_codes.code\n        and conditions.code_type = exclusion_codes.code_system\n\n)\n\n, pharmacy_exclusions as (\n\n    select\n        person_id\n      , dispensing_date as exclusion_date\n      , concept_name as exclusion_reason\n    from __dbt__cte___stg_pharmacy_claim as pharmacy_claims\n    inner join exclusion_codes\n      on pharmacy_claims.ndc_code = exclusion_codes.code\n        and exclusion_codes.code_system = 'ndc'\n\n)\n\n, exclusion_patients as (\n\n    select\n        person_id\n      , exclusion_date\n      , exclusion_reason\n    from valid_hospice\n\n    union all\n\n    select\n        person_id\n      , exclusion_date\n      , exclusion_reason\n    from condition_exclusions\n\n    union all\n\n    select\n        person_id\n      , exclusion_date\n      , exclusion_reason\n    from pharmacy_exclusions\n\n)\n\n, combined_exclusions as (\n\n    select\n        exclusion_patients.person_id\n      , exclusion_patients.exclusion_date\n      , exclusion_patients.exclusion_reason\n    from exclusion_patients\n    inner join denominator\n      on exclusion_patients.person_id = denominator.person_id\n\n)\n\n, add_data_types as (\n\n    select\n        distinct\n          cast(person_id as TEXT) as person_id\n        , cast(exclusion_date as date) as exclusion_date\n        , cast(exclusion_reason as TEXT) as exclusion_reason\n        , cast(1 as integer) as exclusion_flag\n    from combined_exclusions\n\n)\n\nselect\n      person_id\n    , exclusion_date\n    , exclusion_reason\n    , exclusion_flag\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.quality_measures._int_adh_diabetes_exclusions"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.254529Z", "completed_at": "2025-02-25T21:26:27.275327Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.275846Z", "completed_at": "2025-02-25T21:26:27.275849Z"}], "thread_id": "Thread-1", "execution_time": 0.04549288749694824, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.quality_measures__int_adh_statins_exclusions", "compiled": true, "compiled_code": "with  __dbt__cte___stg_condition as (\n\nselect\n      person_id\n    , claim_id\n    , encounter_id\n    , recorded_date\n    , source_code_type\n    , source_code\n    , normalized_code_type\n    , normalized_code\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.condition\n), denominator as (\n\n    select\n          person_id\n    from tuva.quality_measures._int_adh_statins_denominator\n\n)\n\n, hospice_palliative as (\n\n    select\n        person_id\n      , exclusion_date\n      , exclusion_reason\n    from tuva.quality_measures._int_shared_exclusions_hospice_palliative\n    where exclusion_date between (\n  select \n    performance_period_begin\n  from tuva.quality_measures._int_adh_statins__performance_period\n\n) and (\n  select \n    performance_period_end\n  from tuva.quality_measures._int_adh_statins__performance_period\n\n)\n\n)\n\n, valid_hospice as (\n\n    select\n          person_id\n        , exclusion_date\n        , exclusion_reason\n    from hospice_palliative\n    where lower(exclusion_reason) in (\n            'hospice encounter'\n          , 'hospice care ambulatory'\n          , 'hospice diagnosis'\n    )\n\n)\n\n, esrd_codes as (\n\n    select\n            code\n          , code_system\n          , concept_name\n    from tuva.quality_measures._value_set_codes\n    where concept_name in (\n            'PQA ESRD'\n        )\n\n)\n\n, valid_esrd as (\n\n    select\n          condition.person_id\n        , condition.recorded_date as exclusion_date\n        , esrd_codes.concept_name as exclusion_reason\n    from __dbt__cte___stg_condition as condition\n    inner join esrd_codes \n      on coalesce(condition.normalized_code, condition.source_code) = esrd_codes.code \n        and coalesce(condition.normalized_code_type, condition.source_code_type) = esrd_codes.code_system\n    where condition.recorded_date between (\n  select \n    performance_period_begin\n  from tuva.quality_measures._int_adh_statins__performance_period\n\n) and (\n  select \n    performance_period_end\n  from tuva.quality_measures._int_adh_statins__performance_period\n\n)\n\n)\n\n, exclusions as (\n\n    select \n          person_id\n        , exclusion_date\n        , exclusion_reason\n    from valid_hospice\n\n    union all\n\n    select \n          person_id\n        , exclusion_date\n        , exclusion_reason\n    from valid_esrd\n\n)\n\n, measure_exclusions as (\n\n    select \n          exclusions.person_id\n        , exclusion_date\n        , exclusion_reason\n    from exclusions\n    inner join denominator\n      on exclusions.person_id = denominator.person_id\n\n)\n\n, add_data_types as (\n\n    select\n        distinct\n            cast(person_id as TEXT) as person_id\n          , cast(exclusion_date as date) as exclusion_date\n          , cast(exclusion_reason as TEXT) as exclusion_reason\n          , 1 as exclusion_flag\n    from measure_exclusions\n\n)\n\nselect\n      person_id\n    , exclusion_date\n    , exclusion_reason\n    , exclusion_flag\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run \nfrom add_data_types", "relation_name": "tuva.quality_measures._int_adh_statins_exclusions"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.276757Z", "completed_at": "2025-02-25T21:26:27.302770Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.327581Z", "completed_at": "2025-02-25T21:26:27.327589Z"}], "thread_id": "Thread-3", "execution_time": 0.05208778381347656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.quality_measures__int_adhras_exclusions", "compiled": true, "compiled_code": "with  __dbt__cte___stg_condition as (\n\nselect\n      person_id\n    , claim_id\n    , encounter_id\n    , recorded_date\n    , source_code_type\n    , source_code\n    , normalized_code_type\n    , normalized_code\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.condition\n),  __dbt__cte___stg_pharmacy_claim as (\n\n\nselect\n      person_id\n    , dispensing_date\n    , ndc_code\n    , days_supply\n    , paid_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.pharmacy_claim\n\n\n), denominator as (\n\n    select\n          person_id\n    from tuva.quality_measures._int_adhras_denominator\n\n)\n\n, valid_hospice_palliative as (\n\n    select\n        person_id\n      , exclusion_date\n      , exclusion_reason\n    from tuva.quality_measures._int_shared_exclusions_hospice_palliative\n    where exclusion_date between (\n  select \n    performance_period_begin\n  from tuva.quality_measures._int_adhras__performance_period\n\n) and (\n  select \n    performance_period_end\n  from tuva.quality_measures._int_adhras__performance_period\n\n)\n\n)\n\n, codes as (\n\n    select\n            code\n          , code_system\n          , concept_name\n    from tuva.quality_measures._value_set_codes\n    where concept_name in (\n            'PQA ESRD'\n          , 'PQA Sacubitril Valsartan Medications'\n        )\n\n)\n\n, valid_esrd as (\n\n    select\n          condition.person_id\n        , condition.recorded_date as exclusion_date\n        , codes.concept_name as exclusion_reason\n    from __dbt__cte___stg_condition as condition\n    inner join codes \n      on coalesce(condition.normalized_code, condition.source_code) = codes.code \n        and coalesce(condition.normalized_code_type, condition.source_code_type) = codes.code_system\n    where condition.recorded_date between (\n  select \n    performance_period_begin\n  from tuva.quality_measures._int_adhras__performance_period\n\n) and (\n  select \n    performance_period_end\n  from tuva.quality_measures._int_adhras__performance_period\n\n)\n\n)\n\n, sacubitril_pharmacy_claim as (\n\n    select\n          pharmacy_claim.person_id\n        , pharmacy_claim.dispensing_date as exclusion_date\n        , codes.concept_name as exclusion_reason\n    from __dbt__cte___stg_pharmacy_claim as pharmacy_claim\n    inner join codes\n      on pharmacy_claim.ndc_code = codes.code \n    where pharmacy_claim.dispensing_date between (\n  select \n    performance_period_begin\n  from tuva.quality_measures._int_adhras__performance_period\n\n) and (\n  select \n    performance_period_end\n  from tuva.quality_measures._int_adhras__performance_period\n\n)\n\n)\n\n, exclusions as (\n\n    select \n          person_id\n        , exclusion_date\n        , exclusion_reason\n    from valid_hospice_palliative\n\n    union all\n\n    select \n          person_id\n        , exclusion_date\n        , exclusion_reason\n    from valid_esrd\n\n    union all\n\n    select \n          person_id\n        , exclusion_date\n        , exclusion_reason \n    from sacubitril_pharmacy_claim\n\n)\n\n, measure_exclusions as (\n\n    select \n          exclusions.person_id\n        , exclusion_date\n        , exclusion_reason\n    from exclusions\n    inner join denominator\n      on exclusions.person_id = denominator.person_id\n\n)\n\n, add_data_types as (\n\n    select\n        distinct\n            cast(person_id as TEXT) as person_id\n          , cast(exclusion_date as date) as exclusion_date\n          , cast(exclusion_reason as TEXT) as exclusion_reason\n          , 1 as exclusion_flag\n    from measure_exclusions\n\n)\n\nselect\n      person_id\n    , exclusion_date\n    , exclusion_reason\n    , exclusion_flag\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run \nfrom add_data_types", "relation_name": "tuva.quality_measures._int_adhras_exclusions"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.302977Z", "completed_at": "2025-02-25T21:26:27.337353Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.337710Z", "completed_at": "2025-02-25T21:26:27.337717Z"}], "thread_id": "Thread-1", "execution_time": 0.04097104072570801, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.quality_measures__int_supd_exclusions", "compiled": true, "compiled_code": "with  __dbt__cte___stg_condition as (\n\nselect\n      person_id\n    , claim_id\n    , encounter_id\n    , recorded_date\n    , source_code_type\n    , source_code\n    , normalized_code_type\n    , normalized_code\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.condition\n),  __dbt__cte___stg_pharmacy_claim as (\n\n\nselect\n      person_id\n    , dispensing_date\n    , ndc_code\n    , days_supply\n    , paid_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.pharmacy_claim\n\n\n), denominator as (\n    \n    select\n        person_id\n    from tuva.quality_measures._int_supd_denominator\n\n)\n\n, exclusion_codes as (\n\n    select\n        code\n      , code_system\n      , concept_name\n    from tuva.quality_measures._value_set_codes\n    where lower(concept_name) in (\n          'pqa esrd'\n        , 'pqa rhabdomyolysis myopathy'\n        , 'pqa pregnancy'\n        , 'pqa lactation'\n        , 'pqa fertility medications'\n        , 'pqa cirrhosis'\n        , 'pqa pcos'\n        , 'pqa prediabetes'\n    )\n\n)\n\n, hospice_palliative as (\n\n    select\n          person_id\n        , exclusion_date\n        , exclusion_reason\n    from tuva.quality_measures._int_shared_exclusions_hospice_palliative\n    where exclusion_date between (\n\n  select \n    performance_period_begin\n  from tuva.quality_measures._int_supd__performance_period\n\n) and (\n\n  select \n    performance_period_end\n  from tuva.quality_measures._int_supd__performance_period\n\n)\n\n)\n\n, valid_hospice as (\n\n    select\n          person_id\n        , exclusion_date\n        , exclusion_reason\n    from hospice_palliative\n    where lower(exclusion_reason) in (\n            'hospice encounter'\n          , 'hospice care ambulatory'\n          , 'hospice diagnosis'\n    )\n\n)\n\n, conditions as (\n\n    select\n          person_id\n        , recorded_date\n        , claim_id\n        , coalesce (\n              normalized_code_type\n            , case\n                when lower(source_code_type) = 'snomed' then 'snomed-ct'\n                else lower(source_code_type)\n              end\n          ) as code_type\n        , coalesce (\n              normalized_code\n            , source_code\n          ) as code\n    from __dbt__cte___stg_condition\n    where recorded_date between (\n\n  select \n    performance_period_begin\n  from tuva.quality_measures._int_supd__performance_period\n\n) and (\n\n  select \n    performance_period_end\n  from tuva.quality_measures._int_supd__performance_period\n\n)\n\n)\n\n, condition_exclusions as (\n\n      select\n          conditions.person_id\n        , conditions.recorded_date as exclusion_date\n        , exclusion_codes.concept_name as exclusion_reason\n    from conditions\n    inner join exclusion_codes\n      on conditions.code = exclusion_codes.code\n        and conditions.code_type = exclusion_codes.code_system\n\n)\n\n, pharmacy_exclusions as (\n\n    select\n        person_id\n      , dispensing_date as exclusion_date\n      , concept_name as exclusion_reason\n    from __dbt__cte___stg_pharmacy_claim as pharmacy_claims\n    inner join exclusion_codes\n        on exclusion_codes.code_system = 'ndc'\n          and pharmacy_claims.ndc_code = exclusion_codes.code\n\n)\n\n, exclusion_patients as (\n\n    select\n        person_id\n      , exclusion_date\n      , exclusion_reason\n    from valid_hospice\n\n    union all\n\n    select\n        person_id\n      , exclusion_date\n      , exclusion_reason\n    from condition_exclusions\n\n    union all\n\n    select\n        person_id\n      , exclusion_date\n      , exclusion_reason\n    from pharmacy_exclusions\n\n)\n\n, combined_exclusions as (\n\n    select\n        exclusion_patients.person_id\n      , exclusion_patients.exclusion_date\n      , exclusion_patients.exclusion_reason\n    from exclusion_patients\n    inner join denominator\n      on exclusion_patients.person_id = denominator.person_id\n\n)\n\n, add_data_types as (\n\n    select\n        distinct\n          cast(person_id as TEXT) as person_id\n        , cast(exclusion_date as date) as exclusion_date\n        , cast(exclusion_reason as TEXT) as exclusion_reason\n        , cast(1 as integer) as exclusion_flag\n    from combined_exclusions\n\n)\n\nselect\n      person_id\n    , exclusion_date\n    , exclusion_reason\n    , exclusion_flag\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.quality_measures._int_supd_exclusions"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.329104Z", "completed_at": "2025-02-25T21:26:27.338142Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.338985Z", "completed_at": "2025-02-25T21:26:27.338990Z"}], "thread_id": "Thread-3", "execution_time": 0.010401010513305664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.hcc_suspecting__int_comorbidity_suspects", "compiled": true, "compiled_code": "\n\nwith conditions as (\n\n    select\n          person_id\n        , recorded_date\n        , condition_type\n        , code_type\n        , code\n        , data_source\n    from tuva.hcc_suspecting._int_prep_conditions\n\n)\n\n, seed_clinical_concepts as (\n\n    select\n          concept_name\n        , code\n        , code_system\n    from tuva.hcc_suspecting._value_set_clinical_concepts\n\n)\n\n, seed_hcc_descriptions as (\n\n    select distinct\n          hcc_code\n        , hcc_description\n    from tuva.hcc_suspecting._value_set_hcc_descriptions\n\n)\n\n, billed_hccs as (\n\n    select distinct\n          person_id\n        , data_source\n        , hcc_code\n        , current_year_billed\n    from tuva.hcc_suspecting._int_patient_hcc_history\n\n)\n\n/* BEGIN HCC 37 logic */\n, ckd_stage_1_or_2 as (\n\n    select\n          conditions.person_id\n        , conditions.recorded_date\n        , conditions.condition_type\n        , conditions.code_type\n        , conditions.code\n        , conditions.data_source\n        , seed_clinical_concepts.concept_name\n        , row_number() over (\n            partition by\n                  conditions.person_id\n                , conditions.data_source\n            order by\n                  conditions.recorded_date desc\n                , conditions.code desc\n          ) as row_num\n    from conditions\n        inner join seed_clinical_concepts\n            on conditions.code_type = seed_clinical_concepts.code_system\n            and conditions.code = seed_clinical_concepts.code\n    where lower(seed_clinical_concepts.concept_name) in (\n          'chronic kidney disease, stage 1'\n        , 'chronic kidney disease, stage 2'\n    )\n\n)\n\n, ckd_stage_1_or_2_dedupe as (\n\n    select\n          person_id\n        , recorded_date\n        , condition_type\n        , code_type\n        , code\n        , data_source\n        , concept_name\n    from ckd_stage_1_or_2\n    where row_num = 1\n\n)\n\n, diabetes as (\n\n    select\n          conditions.person_id\n        , conditions.recorded_date\n        , conditions.condition_type\n        , conditions.code_type\n        , conditions.code\n        , conditions.data_source\n        , seed_clinical_concepts.concept_name\n        , row_number() over (\n            partition by\n                  conditions.person_id\n                , conditions.data_source\n            order by\n                  conditions.recorded_date desc\n                , conditions.code desc\n          ) as row_num\n    from conditions\n        inner join seed_clinical_concepts\n            on conditions.code_type = seed_clinical_concepts.code_system\n            and conditions.code = seed_clinical_concepts.code\n    where lower(seed_clinical_concepts.concept_name) = 'diabetes'\n)\n\n, diabetes_dedupe as (\n\n    select\n          person_id\n        , recorded_date\n        , condition_type\n        , code_type\n        , code\n        , data_source\n        , concept_name\n    from diabetes\n    where row_num = 1\n\n)\n\n, hcc_37_suspect as (\n\n    select\n          diabetes_dedupe.person_id\n        , diabetes_dedupe.data_source\n        , seed_hcc_descriptions.hcc_code\n        , seed_hcc_descriptions.hcc_description\n        , diabetes_dedupe.concept_name as condition_1_concept_name\n        , diabetes_dedupe.code as condition_1_code\n        , diabetes_dedupe.recorded_date as condition_1_recorded_date\n        , ckd_stage_1_or_2_dedupe.concept_name as condition_2_concept_name\n        , ckd_stage_1_or_2_dedupe.code as condition_2_code\n        , ckd_stage_1_or_2_dedupe.recorded_date as condition_2_recorded_date\n    from diabetes_dedupe\n        inner join ckd_stage_1_or_2_dedupe\n            on diabetes_dedupe.person_id = ckd_stage_1_or_2_dedupe.person_id\n            and diabetes_dedupe.data_source = ckd_stage_1_or_2_dedupe.data_source\n            /* ensure conditions overlap in the same year */\n            and date_part('year', diabetes_dedupe.recorded_date) = date_part('year', ckd_stage_1_or_2_dedupe.recorded_date)\n        inner join seed_hcc_descriptions\n            on hcc_code = '37'\n\n)\n/* END HCC 37 logic */\n\n, unioned as (\n\n    select * from hcc_37_suspect\n\n)\n\n, add_billed_flag as (\n\n    select\n          unioned.person_id\n        , unioned.data_source\n        , unioned.hcc_code\n        , unioned.hcc_description\n        , unioned.condition_1_concept_name\n        , unioned.condition_1_code\n        , unioned.condition_1_recorded_date\n        , unioned.condition_2_concept_name\n        , unioned.condition_2_code\n        , unioned.condition_2_recorded_date\n        , billed_hccs.current_year_billed\n    from unioned\n        left join billed_hccs\n            on unioned.person_id = billed_hccs.person_id\n            and unioned.data_source = billed_hccs.data_source\n            and unioned.hcc_code = billed_hccs.hcc_code\n\n)\n\n, add_standard_fields as (\n\n    select\n          person_id\n        , data_source\n        , hcc_code\n        , hcc_description\n        , condition_1_concept_name\n        , condition_1_code\n        , condition_1_recorded_date\n        , condition_2_concept_name\n        , condition_2_code\n        , condition_2_recorded_date\n        , current_year_billed\n        , cast('Comorbidity suspect' as TEXT) as reason\n        , condition_1_concept_name || ' (' || condition_1_code || ') on ' || condition_1_recorded_date || ') and ' || condition_2_concept_name || ' (' || condition_2_code || ') on ' || condition_2_recorded_date as contributing_factor\n        , condition_1_recorded_date as suspect_date\n    from add_billed_flag\n\n)\n\n\n, add_data_types as (\n\n    select\n          cast(person_id as TEXT) as person_id\n        , cast(data_source as TEXT) as data_source\n        , cast(hcc_code as TEXT) as hcc_code\n        , cast(hcc_description as TEXT) as hcc_description\n        , cast(condition_1_concept_name as TEXT) as condition_1_concept_name\n        , cast(condition_1_code as TEXT) as condition_1_code\n        , cast(condition_1_recorded_date as date) as condition_1_recorded_date\n        , cast(condition_2_concept_name as TEXT) as condition_2_concept_name\n        , cast(condition_2_code as TEXT) as condition_2_code\n        , cast(condition_2_recorded_date as date) as condition_2_recorded_date\n        \n            , cast(current_year_billed as boolean) as current_year_billed\n        \n        , cast(reason as TEXT) as reason\n        , cast(contributing_factor as TEXT) as contributing_factor\n        , cast(suspect_date as date) as suspect_date\n    from add_standard_fields\n\n)\n\nselect\n      person_id\n    , data_source\n    , hcc_code\n    , hcc_description\n    , condition_1_concept_name\n    , condition_1_code\n    , condition_1_recorded_date\n    , condition_2_concept_name\n    , condition_2_code\n    , condition_2_recorded_date\n    , current_year_billed\n    , reason\n    , contributing_factor\n    , suspect_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.hcc_suspecting._int_comorbidity_suspects"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.342243Z", "completed_at": "2025-02-25T21:26:27.358842Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.359153Z", "completed_at": "2025-02-25T21:26:27.359161Z"}], "thread_id": "Thread-1", "execution_time": 0.019343852996826172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.hcc_suspecting__int_lab_suspects", "compiled": true, "compiled_code": "\n\nwith egfr_labs as (\n\n    select\n          person_id\n        , data_source\n        , code_type\n        , code\n        , result_date\n        , result\n    from tuva.hcc_suspecting._int_prep_egfr_labs\n\n)\n\n, seed_hcc_descriptions as (\n\n    select distinct\n          hcc_code\n        , hcc_description\n    from tuva.hcc_suspecting._value_set_hcc_descriptions\n\n)\n\n, billed_hccs as (\n\n    select distinct\n          person_id\n        , data_source\n        , hcc_code\n        , current_year_billed\n    from tuva.hcc_suspecting._int_patient_hcc_history\n\n)\n\n/* BEGIN CKD logic */\n\n/*\n    Find a patient\u2019s two most recent eGFR lab results that are spaced by at\n    least 90 days.\n*/\n, max_lab_date as (\n\n    select\n          person_id\n        , data_source\n        , max(result_date) as max_result_date\n    from egfr_labs\n    group by\n          person_id\n        , data_source\n\n)\n\n, lab_lookback as (\n\n    select\n          egfr_labs.person_id\n        , egfr_labs.data_source\n        , max_lab_date.max_result_date\n        , max(egfr_labs.result_date) as lookback_result_date\n    from egfr_labs\n        left join max_lab_date\n        on egfr_labs.person_id = max_lab_date.person_id\n        and egfr_labs.data_source = max_lab_date.data_source\n    where egfr_labs.result_date <= \n\n    dateadd(\n        day,\n        -90,\n        max_result_date\n        )\n\n\n    group by\n          egfr_labs.person_id\n        , egfr_labs.data_source\n        , max_lab_date.max_result_date\n\n)\n\n/*\n    Take the highest eGFR result that occurred between the date range.\n*/\n, eligible_labs as (\n\n    select\n          egfr_labs.person_id\n        , egfr_labs.data_source\n        , egfr_labs.code_type\n        , egfr_labs.code\n        , egfr_labs.result_date\n        , egfr_labs.result\n        , row_number() over (\n            partition by\n                  egfr_labs.person_id\n                , egfr_labs.data_source\n            order by egfr_labs.result desc\n        ) as row_num\n    from egfr_labs\n        inner join lab_lookback\n        on egfr_labs.person_id = lab_lookback.person_id\n        and egfr_labs.data_source = lab_lookback.data_source\n    where egfr_labs.result_date >= lab_lookback.lookback_result_date\n\n)\n\n/*\n    Assign a patient's kidney disease stage based on the highest eGFR based on\n    the following range:\n\n    CKD 3a: eGFR in the range (45-59)\n    CKD 3b: eGFR in the range (30-44)\n    CKD 4: eGFR in the range (15-29)\n    CKD 5: eGFR in the range (0-14)\n*/\n, ckd_suspects as (\n\n    select\n          person_id\n        , data_source\n        , code_type\n        , code as lab_code\n        , result_date\n        , result\n        , case\n            when result between 0 and 14 then '326'\n            when result between 15 and 29 then '327'\n            when result between 30 and 44 then '328'\n            when result between 45 and 59 then '329'\n          end as hcc_code\n        , 'eGFR (' || code || ') result ' || result || ' on ' || result_date as contributing_factor\n    from eligible_labs\n    where row_num = 1\n\n)\n/* END CKD logic */\n\n, unioned as (\n\n    select * from ckd_suspects\n\n)\n\n, add_billed_flag as (\n\n    select\n          unioned.person_id\n        , unioned.data_source\n        , unioned.result_date\n        , unioned.result\n        , unioned.lab_code\n        , unioned.hcc_code\n        , unioned.contributing_factor\n        , seed_hcc_descriptions.hcc_description\n        , billed_hccs.current_year_billed\n    from unioned\n        inner join seed_hcc_descriptions\n            on unioned.hcc_code = seed_hcc_descriptions.hcc_code\n        left join billed_hccs\n            on unioned.person_id = billed_hccs.person_id\n            and unioned.data_source = billed_hccs.data_source\n            and unioned.hcc_code = billed_hccs.hcc_code\n\n)\n\n, add_standard_fields as (\n\n    select\n          person_id\n        , data_source\n        , result_date\n        , result\n        , lab_code\n        , hcc_code\n        , hcc_description\n        , contributing_factor\n        , current_year_billed\n        , cast('Lab result suspect' as TEXT) as reason\n        , result_date as suspect_date\n    from add_billed_flag\n\n)\n\n, add_data_types as (\n\n    select\n          cast(person_id as TEXT) as person_id\n        , cast(data_source as TEXT) as data_source\n        , cast(result_date as date) as result_date\n        , cast(result as numeric(28,6)) as result\n        , cast(lab_code as TEXT) as lab_code\n        , cast(hcc_code as TEXT) as hcc_code\n        , cast(hcc_description as TEXT) as hcc_description\n        \n            , cast(current_year_billed as boolean) as current_year_billed\n        \n        , cast(reason as TEXT) as reason\n        , cast(contributing_factor as TEXT) as contributing_factor\n        , cast(suspect_date as date) as suspect_date\n    from add_standard_fields\n\n)\n\nselect\n      person_id\n    , data_source\n    , result_date\n    , result\n    , lab_code\n    , hcc_code\n    , hcc_description\n    , current_year_billed\n    , reason\n    , contributing_factor\n    , suspect_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.hcc_suspecting._int_lab_suspects"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.350378Z", "completed_at": "2025-02-25T21:26:27.360357Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.360997Z", "completed_at": "2025-02-25T21:26:27.361002Z"}], "thread_id": "Thread-3", "execution_time": 0.019302845001220703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.hcc_suspecting__int_medication_suspects", "compiled": true, "compiled_code": "\n\nwith all_medications as (\n\n    select\n          person_id\n        , dispensing_date\n        , drug_code\n        , code_system\n        , data_source\n    from tuva.hcc_suspecting._int_all_medications\n\n)\n\n, seed_clinical_concepts as (\n\n    select\n          concept_name\n        , code\n        , code_system\n    from tuva.hcc_suspecting._value_set_clinical_concepts\n\n)\n\n, seed_hcc_descriptions as (\n\n    select distinct\n          hcc_code\n        , hcc_description\n    from tuva.hcc_suspecting._value_set_hcc_descriptions\n\n)\n\n, billed_hccs as (\n\n    select distinct\n          person_id\n        , data_source\n        , hcc_code\n        , current_year_billed\n    from tuva.hcc_suspecting._int_patient_hcc_history\n\n)\n\n/* BEGIN HCC 155 logic (Major Depression, Moderate or Severe, without Psychosis)\n\n   antidepressant medication taken within the past five years\n*/\n, hcc_155_suspect as (\n\n    select\n          all_medications.person_id\n        , all_medications.dispensing_date\n        , all_medications.drug_code\n        , all_medications.code_system\n        , all_medications.data_source\n        , seed_clinical_concepts.concept_name\n        , seed_hcc_descriptions.hcc_code\n        , seed_hcc_descriptions.hcc_description\n    from all_medications\n        inner join seed_clinical_concepts\n            on all_medications.code_system = seed_clinical_concepts.code_system\n            and all_medications.drug_code = seed_clinical_concepts.code\n        inner join seed_hcc_descriptions\n            on hcc_code = '155'\n    where lower(seed_clinical_concepts.concept_name) = 'antidepressant medication'\n    and all_medications.dispensing_date >= \n\n    dateadd(\n        year,\n        -5,\n        convert_timezone('UTC', current_timestamp())\n        )\n\n\n\n)\n/* END HCC 155 logic */\n\n, unioned as (\n\n    select * from hcc_155_suspect\n\n)\n\n, add_billed_flag as (\n\n    select\n          unioned.person_id\n        , unioned.data_source\n        , unioned.hcc_code\n        , unioned.hcc_description\n        , unioned.concept_name\n        , unioned.dispensing_date\n        , unioned.drug_code\n        , billed_hccs.current_year_billed\n    from unioned\n        left join billed_hccs\n            on unioned.person_id = billed_hccs.person_id\n            and unioned.data_source = billed_hccs.data_source\n            and unioned.hcc_code = billed_hccs.hcc_code\n)\n\n, add_standard_fields as (\n\n    select\n          person_id\n        , data_source\n        , hcc_code\n        , hcc_description\n        , dispensing_date\n        , drug_code\n        , current_year_billed\n        , cast('Medication suspect' as TEXT) as reason\n        , concept_name || drug_code || ') dispensed on ' || dispensing_date as contributing_factor\n        , dispensing_date as suspect_date\n    from add_billed_flag\n\n)\n\n, add_data_types as (\n\n    select\n          cast(person_id as TEXT) as person_id\n        , cast(data_source as TEXT) as data_source\n        , cast(hcc_code as TEXT) as hcc_code\n        , cast(hcc_description as TEXT) as hcc_description\n        , cast(dispensing_date as date) as dispensing_date\n        , cast(drug_code as TEXT) as drug_code\n        \n            , cast(current_year_billed as boolean) as current_year_billed\n        \n        , cast(reason as TEXT) as reason\n        , cast(contributing_factor as TEXT) as contributing_factor\n        , cast(suspect_date as date) as suspect_date\n    from add_standard_fields\n\n)\n\nselect\n      person_id\n    , data_source\n    , hcc_code\n    , hcc_description\n    , dispensing_date\n    , drug_code\n    , current_year_billed\n    , reason\n    , contributing_factor\n    , suspect_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.hcc_suspecting._int_medication_suspects"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.392080Z", "completed_at": "2025-02-25T21:26:27.435231Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.448261Z", "completed_at": "2025-02-25T21:26:27.448277Z"}], "thread_id": "Thread-3", "execution_time": 0.06884312629699707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.chronic_conditions__cms_chronic_conditions_long", "compiled": true, "compiled_code": "\n\n\nwith conditions_unioned as (\n\n    select * from tuva.chronic_conditions._int_cms_chronic_condition_all\n    union distinct\n    select * from tuva.chronic_conditions._int_cms_chronic_condition_hiv_aids\n    union distinct\n    select * from tuva.chronic_conditions._int_cms_chronic_condition_oud\n\n)\n\n\nselect\n      person_id\n    , claim_id\n    , start_date\n    , chronic_condition_type\n    , condition_category\n    , condition\n    , data_source\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom conditions_unioned", "relation_name": "tuva.chronic_conditions.cms_chronic_conditions_long"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.361567Z", "completed_at": "2025-02-25T21:26:27.456317Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.456625Z", "completed_at": "2025-02-25T21:26:27.456632Z"}], "thread_id": "Thread-1", "execution_time": 0.09665298461914062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.hcc_suspecting__int_observation_suspects", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte___stg_observation as (\n\n\nselect\n      person_id\n    , observation_date\n    , result\n    , lower(coalesce(normalized_code_type,source_code_type)) as code_type\n    , coalesce(normalized_code,source_code) as code\n    , data_source\nfrom tuva.core.observation\n\n\n), conditions as (\n\n    select\n          person_id\n        , recorded_date\n        , condition_type\n        , code_type\n        , code\n        , data_source\n    from tuva.hcc_suspecting._int_prep_conditions\n\n)\n\n, observations as (\n\n    select\n          person_id\n        , observation_date\n        , result\n        , code_type\n        , code\n        , data_source\n    from __dbt__cte___stg_observation\n\n)\n\n, numeric_observations as (\n\n    select\n          person_id\n        , observation_date\n        \n        , CAST(result AS numeric(28,6)) AS result\n        \n        , code_type\n        , code\n        , data_source\n    from observations\n   \n        where regexp_like(result, '^[+-]?([0-9]*[.])?[0-9]+$')\n    \n\n)\n\n, seed_clinical_concepts as (\n\n    select\n          concept_name\n        , code\n        , code_system\n    from tuva.hcc_suspecting._value_set_clinical_concepts\n\n)\n\n, seed_hcc_descriptions as (\n\n    select distinct\n          hcc_code\n        , hcc_description\n    from tuva.hcc_suspecting._value_set_hcc_descriptions\n\n)\n\n, billed_hccs as (\n\n    select distinct\n          person_id\n        , data_source\n        , hcc_code\n        , current_year_billed\n    from tuva.hcc_suspecting._int_patient_hcc_history\n\n)\n\n, depression_assessment as (\n\n    select\n          numeric_observations.person_id\n        , numeric_observations.observation_date\n        , numeric_observations.result\n        , numeric_observations.code_type\n        , numeric_observations.code\n        , numeric_observations.data_source\n        , seed_clinical_concepts.concept_name\n    from numeric_observations\n        inner join seed_clinical_concepts\n            on numeric_observations.code_type = seed_clinical_concepts.code_system\n            and numeric_observations.code = seed_clinical_concepts.code\n    where lower(seed_clinical_concepts.concept_name) = 'depression assessment (phq-9)'\n\n)\n\n, diabetes as (\n\n     select\n          conditions.person_id\n        , conditions.recorded_date\n        , conditions.condition_type\n        , conditions.code_type\n        , conditions.code\n        , conditions.data_source\n        , seed_clinical_concepts.concept_name\n    from conditions\n        inner join seed_clinical_concepts\n            on conditions.code_type = seed_clinical_concepts.code_system\n            and conditions.code = seed_clinical_concepts.code\n    where lower(seed_clinical_concepts.concept_name) = 'diabetes'\n\n)\n\n, hypertension as (\n\n     select\n          conditions.person_id\n        , conditions.recorded_date\n        , conditions.condition_type\n        , conditions.code_type\n        , conditions.code\n        , conditions.data_source\n        , seed_clinical_concepts.concept_name\n    from conditions\n        inner join seed_clinical_concepts\n            on conditions.code_type = seed_clinical_concepts.code_system\n            and conditions.code = seed_clinical_concepts.code\n    where lower(seed_clinical_concepts.concept_name) = 'essential hypertension'\n\n)\n\n, obstructive_sleep_apnea as (\n\n     select\n          conditions.person_id\n        , conditions.recorded_date\n        , conditions.condition_type\n        , conditions.code_type\n        , conditions.code\n        , conditions.data_source\n        , seed_clinical_concepts.concept_name\n    from conditions\n        inner join seed_clinical_concepts\n            on conditions.code_type = seed_clinical_concepts.code_system\n            and conditions.code = seed_clinical_concepts.code\n    where lower(seed_clinical_concepts.concept_name) = 'obstructive sleep apnea'\n\n)\n\n/* BEGIN HCC 48 logic (Morbid Obesity) */\n, bmi_over_30_with_osa as (\n\n    select\n          numeric_observations.person_id\n        , numeric_observations.data_source\n        , numeric_observations.observation_date\n        , numeric_observations.result as observation_result\n        , obstructive_sleep_apnea.code as condition_code\n        , obstructive_sleep_apnea.recorded_date as condition_date\n        , obstructive_sleep_apnea.concept_name as condition_concept_name\n        , seed_hcc_descriptions.hcc_code\n        , seed_hcc_descriptions.hcc_description\n    from numeric_observations\n        inner join seed_clinical_concepts\n            on numeric_observations.code_type = seed_clinical_concepts.code_system\n            and numeric_observations.code = seed_clinical_concepts.code\n        inner join obstructive_sleep_apnea\n            on numeric_observations.person_id = obstructive_sleep_apnea.person_id\n            /* ensure bmi and condition overlaps in the same year */\n            and date_part('year', numeric_observations.observation_date) = date_part('year', obstructive_sleep_apnea.recorded_date)\n        inner join seed_hcc_descriptions\n            on hcc_code = '48'\n    where lower(seed_clinical_concepts.concept_name) = 'bmi'\n    and result >= 30\n\n)\n\n, bmi_over_35_with_diabetes as (\n\n    select\n          numeric_observations.person_id\n        , numeric_observations.data_source\n        , numeric_observations.observation_date\n        , numeric_observations.result as observation_result\n        , diabetes.code as condition_code\n        , diabetes.recorded_date as condition_date\n        , diabetes.concept_name as condition_concept_name\n        , seed_hcc_descriptions.hcc_code\n        , seed_hcc_descriptions.hcc_description\n    from numeric_observations\n        inner join seed_clinical_concepts\n            on numeric_observations.code_type = seed_clinical_concepts.code_system\n            and numeric_observations.code = seed_clinical_concepts.code\n        inner join diabetes\n            on numeric_observations.person_id = diabetes.person_id\n            /* ensure bmi and condition overlaps in the same year */\n            and date_part('year', numeric_observations.observation_date) = date_part('year', diabetes.recorded_date)\n        inner join seed_hcc_descriptions\n            on hcc_code = '48'\n    where lower(seed_clinical_concepts.concept_name) = 'bmi'\n    and result >= 35\n\n)\n\n, bmi_over_35_with_hypertension as (\n\n    select\n          numeric_observations.person_id\n        , numeric_observations.data_source\n        , numeric_observations.observation_date\n        , numeric_observations.result as observation_result\n        , hypertension.code as condition_code\n        , hypertension.recorded_date as condition_date\n        , hypertension.concept_name as condition_concept_name\n        , seed_hcc_descriptions.hcc_code\n        , seed_hcc_descriptions.hcc_description\n    from numeric_observations\n        inner join seed_clinical_concepts\n            on numeric_observations.code_type = seed_clinical_concepts.code_system\n            and numeric_observations.code = seed_clinical_concepts.code\n        inner join hypertension\n            on numeric_observations.person_id = hypertension.person_id\n            /* ensure bmi and condition overlaps in the same year */\n            and date_part('year', numeric_observations.observation_date) = date_part('year', hypertension.recorded_date)\n        inner join seed_hcc_descriptions\n            on hcc_code = '48'\n    where lower(seed_clinical_concepts.concept_name) = 'bmi'\n    and result >= 35\n\n)\n\n, bmi_over_40 as (\n\n    select\n          numeric_observations.person_id\n        , numeric_observations.data_source\n        , numeric_observations.observation_date\n        , numeric_observations.result as observation_result\n        , cast(null as TEXT) as condition_code\n        , cast(null as date) as condition_date\n        , cast(null as TEXT) as condition_concept_name\n        , seed_hcc_descriptions.hcc_code\n        , seed_hcc_descriptions.hcc_description\n    from numeric_observations\n        inner join seed_clinical_concepts\n            on numeric_observations.code_type = seed_clinical_concepts.code_system\n            and numeric_observations.code = seed_clinical_concepts.code\n        inner join seed_hcc_descriptions\n            on hcc_code = '48'\n    where lower(seed_clinical_concepts.concept_name) = 'bmi'\n    and result >= 40\n\n)\n\n, hcc_48_unioned as (\n\n    select * from bmi_over_30_with_osa\n    union all\n    select * from bmi_over_35_with_diabetes\n    union all\n    select * from bmi_over_35_with_hypertension\n    union all\n    select * from bmi_over_40\n\n)\n\n, hcc_48_suspect as (\n\n    select\n          person_id\n        , data_source\n        , observation_date\n        , observation_result\n        , condition_code\n        , condition_date\n        , condition_concept_name\n        , hcc_code\n        , hcc_description\n        , 'BMI result ' || observation_result || case when condition_code is null then ''  else ' with ' || condition_concept_name || '(' || condition_code || ' on ' || condition_date || ')' end as contributing_factor\n    from hcc_48_unioned\n\n)\n/* END HCC 48 logic */\n\n/* BEGIN HCC 155 logic (Major Depression, Moderate or Severe, without Psychosis)\n\n   to determine a positive PHQ-9 assessment, we look at the past 3 screenings\n   for a patient and take the highest result\n*/\n, eligible_depression_assessments as (\n\n    select\n          depression_assessment.person_id\n        , depression_assessment.observation_date\n        , depression_assessment.result\n        , depression_assessment.code_type\n        , depression_assessment.code\n        , depression_assessment.data_source\n        , depression_assessment.concept_name\n        , row_number() over (\n            partition by\n                  depression_assessment.person_id\n                , depression_assessment.data_source\n            order by\n                case when depression_assessment.observation_date is null then 1 else 0 end,\n                depression_assessment.observation_date desc\n        ) assessment_order\n    from depression_assessment\n\n)\n\n, depression_assessments_ordered as (\n\n    select\n          person_id\n        , observation_date\n        , code_type\n        , code\n        , data_source\n        , concept_name\n        , result\n        , row_number() over (\n            partition by\n                  person_id\n                , data_source\n            --order by result desc nulls last\n            order by\n                case when result is null then 1 else 0 end,\n                result desc\n        ) as result_order --order the last three assessments by result value\n    from eligible_depression_assessments\n    where assessment_order <= 3\n\n)\n\n, hcc_155_suspect as (\n\n    select\n          depression_assessments_ordered.person_id\n        , depression_assessments_ordered.data_source\n        , depression_assessments_ordered.observation_date\n        , depression_assessments_ordered.result as observation_result\n        , cast(null as TEXT) as condition_code\n        , cast(null as date) as condition_date\n        , depression_assessments_ordered.concept_name as condition_concept_name\n        , seed_hcc_descriptions.hcc_code\n        , seed_hcc_descriptions.hcc_description\n        , 'PHQ-9 result ' || depression_assessments_ordered.result || ' on ' || depression_assessments_ordered.observation_date as contributing_factor\n    from depression_assessments_ordered\n        inner join seed_hcc_descriptions\n            on hcc_code = '155'\n    where result_order = 1\n    and result >= 15\n\n)\n\n/* END HCC 155 logic */\n\n, unioned as (\n\n    select * from hcc_48_suspect\n    union all\n    select * from hcc_155_suspect\n\n)\n\n, add_billed_flag as (\n\n    select\n          unioned.person_id\n        , unioned.data_source\n        , unioned.observation_date\n        , unioned.observation_result\n        , unioned.condition_code\n        , unioned.condition_date\n        , unioned.condition_concept_name\n        , unioned.hcc_code\n        , unioned.hcc_description\n        , unioned.contributing_factor\n        , billed_hccs.current_year_billed\n    from unioned\n        left join billed_hccs\n            on unioned.person_id = billed_hccs.person_id\n            and unioned.data_source = billed_hccs.data_source\n            and unioned.hcc_code = billed_hccs.hcc_code\n\n)\n\n, add_standard_fields as (\n\n    select\n          person_id\n        , data_source\n        , observation_date\n        , observation_result\n        , condition_code\n        , condition_date\n        , condition_concept_name\n        , hcc_code\n        , hcc_description\n        , contributing_factor\n        , current_year_billed\n        , cast('Observation suspect' as TEXT) as reason\n        , observation_date as suspect_date\n    from add_billed_flag\n\n)\n\n, add_data_types as (\n\n    select\n          cast(person_id as TEXT) as person_id\n        , cast(data_source as TEXT) as data_source\n        , cast(observation_date as date) as observation_date\n        , cast(observation_result as TEXT) as observation_result\n        , cast(condition_code as TEXT) as condition_code\n        , cast(condition_date as date) as condition_date\n        , cast(condition_concept_name as TEXT) as condition_concept_name\n        , cast(hcc_code as TEXT) as hcc_code\n        , cast(hcc_description as TEXT) as hcc_description\n        \n            , cast(current_year_billed as boolean) as current_year_billed\n        \n        , cast(reason as TEXT) as reason\n        , cast(contributing_factor as TEXT) as contributing_factor\n        , cast(suspect_date as date) as suspect_date\n    from add_standard_fields\n\n)\n\nselect\n      person_id\n    , data_source\n    , observation_date\n    , observation_result\n    , condition_code\n    , condition_date\n    , condition_concept_name\n    , hcc_code\n    , hcc_description\n    , current_year_billed\n    , reason\n    , contributing_factor\n    , suspect_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.hcc_suspecting._int_observation_suspects"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.452846Z", "completed_at": "2025-02-25T21:26:27.462233Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.462617Z", "completed_at": "2025-02-25T21:26:27.462625Z"}], "thread_id": "Thread-3", "execution_time": 0.01046895980834961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.accepted_values_chronic_conditions__cms_chronic_conditions_oud_condition__Opioid_Use_Disorder_OUD_.f44489eec5", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        condition as value_field,\n        count(*) as n_records\n\n    from tuva.chronic_conditions._int_cms_chronic_condition_oud\n    group by condition\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Opioid Use Disorder (OUD)'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.457954Z", "completed_at": "2025-02-25T21:26:27.463930Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.467443Z", "completed_at": "2025-02-25T21:26:27.467450Z"}], "thread_id": "Thread-1", "execution_time": 0.010083913803100586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.not_null_chronic_conditions__cms_chronic_conditions_oud_claim_id.7ee5fe28fe", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect claim_id\nfrom tuva.chronic_conditions._int_cms_chronic_condition_oud\nwhere claim_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.464131Z", "completed_at": "2025-02-25T21:26:27.473139Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.473498Z", "completed_at": "2025-02-25T21:26:27.473506Z"}], "thread_id": "Thread-3", "execution_time": 0.010164022445678711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.not_null_chronic_conditions__cms_chronic_conditions_oud_condition.6800b245ea", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect condition\nfrom tuva.chronic_conditions._int_cms_chronic_condition_oud\nwhere condition is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.468787Z", "completed_at": "2025-02-25T21:26:27.474544Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.475006Z", "completed_at": "2025-02-25T21:26:27.475010Z"}], "thread_id": "Thread-1", "execution_time": 0.006762981414794922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.not_null_chronic_conditions__cms_chronic_conditions_oud_person_id.e3541cf516", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect person_id\nfrom tuva.chronic_conditions._int_cms_chronic_condition_oud\nwhere person_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.475413Z", "completed_at": "2025-02-25T21:26:27.487594Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.491149Z", "completed_at": "2025-02-25T21:26:27.491159Z"}], "thread_id": "Thread-3", "execution_time": 0.0169370174407959, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.cms_hcc__int_hcc_mapping", "compiled": true, "compiled_code": "\n/*\nSteps for staging the medical claim data:\n    1) Filter to risk-adjustable claims per claim type for the collection year.\n    2) Gather diagnosis codes from Condition for the eligible claims.\n    3) Map and filter diagnosis codes to HCCs for each CMS model version\n    4) Union results from each CMS model version\n       (note: some payment years may not have results for v28)\n*/\n\nwith conditions as (\n\n    select\n          person_id\n        , condition_code\n        , payment_year\n        , collection_start_date\n        , collection_end_date\n    from tuva.cms_hcc._int_eligible_conditions\n\n)\n\n, seed_hcc_mapping as (\n\n    select\n          payment_year\n        , diagnosis_code\n        , cms_hcc_v24\n        , cms_hcc_v24_flag\n        , cms_hcc_v28\n        , cms_hcc_v28_flag\n    from tuva.cms_hcc._value_set_icd_10_cm_mappings\n\n)\n\n/* casting hcc_code to avoid formatting changes during union */\n, v24_mapped as (\n\n    select distinct\n          conditions.person_id\n        , conditions.condition_code\n        , conditions.payment_year\n        , conditions.collection_start_date\n        , conditions.collection_end_date\n        , 'CMS-HCC-V24' as model_version\n        , cast(seed_hcc_mapping.cms_hcc_v24 as TEXT) as hcc_code\n    from conditions\n        inner join seed_hcc_mapping\n            on conditions.condition_code = seed_hcc_mapping.diagnosis_code\n            and conditions.payment_year = seed_hcc_mapping.payment_year\n    where cms_hcc_v24_flag = 'Yes'\n\n)\n\n, v28_mapped as (\n\n    select distinct\n          conditions.person_id\n        , conditions.condition_code\n        , conditions.payment_year\n        , conditions.collection_start_date\n        , conditions.collection_end_date\n        , 'CMS-HCC-V28' as model_version\n        , cast(seed_hcc_mapping.cms_hcc_v28 as TEXT) as hcc_code\n    from conditions\n        inner join seed_hcc_mapping\n            on conditions.condition_code = seed_hcc_mapping.diagnosis_code\n            and conditions.payment_year = seed_hcc_mapping.payment_year\n    where cms_hcc_v28_flag = 'Yes'\n\n)\n\n, unioned as (\n\n    select * from v24_mapped\n    union all\n    select * from v28_mapped\n\n)\n\n, add_data_types as (\n\n    select\n          cast(person_id as TEXT) as person_id\n        , cast(condition_code as TEXT) as condition_code\n        , cast(hcc_code as TEXT) as hcc_code\n        , cast(model_version as TEXT) as model_version\n        , cast(payment_year as integer) as payment_year\n        , cast(collection_start_date as date) as collection_start_date\n        , cast(collection_end_date as date) as collection_end_date\n    from unioned\n\n)\n\nselect\n      person_id\n    , condition_code\n    , hcc_code\n    , model_version\n    , payment_year\n    , collection_start_date\n    , collection_end_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.cms_hcc._int_hcc_mapping"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.488058Z", "completed_at": "2025-02-25T21:26:27.493243Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.495153Z", "completed_at": "2025-02-25T21:26:27.495160Z"}], "thread_id": "Thread-1", "execution_time": 0.013598918914794922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.not_null_cms_hcc__int_eligible_conditions_condition_code.e811a078bc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect condition_code\nfrom tuva.cms_hcc._int_eligible_conditions\nwhere condition_code is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.496730Z", "completed_at": "2025-02-25T21:26:27.509612Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.509988Z", "completed_at": "2025-02-25T21:26:27.509997Z"}], "thread_id": "Thread-3", "execution_time": 0.015263795852661133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.cms_hcc__int_demographic_factors", "compiled": true, "compiled_code": "\n\nwith members as (\n\n    select\n          person_id\n        , enrollment_status\n        , gender\n        , age_group\n        , medicaid_status\n        , dual_status\n        , orec\n        , institutional_status\n        , enrollment_status_default\n        , medicaid_dual_status_default\n        , orec_default\n        , institutional_status_default\n        , payment_year\n        , collection_start_date\n        , collection_end_date\n    from tuva.cms_hcc._int_members\n\n)\n\n, seed_demographic_factors as (\n\n    select\n          model_version\n        , factor_type\n        , enrollment_status\n        , gender\n        , age_group\n        , medicaid_status\n        , dual_status\n        , orec\n        , institutional_status\n        , coefficient\n    from tuva.cms_hcc._value_set_demographic_factors\n    where plan_segment is null /* data not available */\n\n)\n\n, v24_new_enrollees as (\n\n    select\n          members.person_id\n        , members.enrollment_status\n        , members.gender\n        , members.age_group\n        , members.medicaid_status\n        , members.dual_status\n        , members.orec\n        , members.institutional_status\n        , members.enrollment_status_default\n        , members.medicaid_dual_status_default\n        , members.orec_default\n        , members.institutional_status_default\n        , members.payment_year\n        , members.collection_start_date\n        , members.collection_end_date\n        , seed_demographic_factors.model_version\n        , seed_demographic_factors.factor_type\n        , seed_demographic_factors.coefficient\n    from members\n        inner join seed_demographic_factors\n            on members.enrollment_status = seed_demographic_factors.enrollment_status\n            and members.gender = seed_demographic_factors.gender\n            and members.age_group = seed_demographic_factors.age_group\n            and members.medicaid_status = seed_demographic_factors.medicaid_status\n            and members.orec = seed_demographic_factors.orec\n    where members.enrollment_status = 'New'\n        and seed_demographic_factors.model_version = 'CMS-HCC-V24'\n\n)\n\n, v24_continuining_enrollees as (\n\n    select\n          members.person_id\n        , members.enrollment_status\n        , members.gender\n        , members.age_group\n        , members.medicaid_status\n        , members.dual_status\n        , members.orec\n        , members.institutional_status\n        , members.enrollment_status_default\n        , members.medicaid_dual_status_default\n        , members.orec_default\n        , members.institutional_status_default\n        , members.payment_year\n        , members.collection_start_date\n        , members.collection_end_date\n        , seed_demographic_factors.model_version\n        , seed_demographic_factors.factor_type\n        , seed_demographic_factors.coefficient\n    from members\n        inner join seed_demographic_factors\n            on members.enrollment_status = seed_demographic_factors.enrollment_status\n            and members.gender = seed_demographic_factors.gender\n            and members.age_group = seed_demographic_factors.age_group\n            and members.medicaid_status = seed_demographic_factors.medicaid_status\n            and members.dual_status = seed_demographic_factors.dual_status\n            and members.orec = seed_demographic_factors.orec\n            and members.institutional_status = seed_demographic_factors.institutional_status\n    where members.enrollment_status = 'Continuing'\n        and seed_demographic_factors.model_version = 'CMS-HCC-V24'\n\n)\n\n, v28_new_enrollees as (\n\n    select\n          members.person_id\n        , members.enrollment_status\n        , members.gender\n        , members.age_group\n        , members.medicaid_status\n        , members.dual_status\n        , members.orec\n        , members.institutional_status\n        , members.enrollment_status_default\n        , members.medicaid_dual_status_default\n        , members.orec_default\n        , members.institutional_status_default\n        , members.payment_year\n        , members.collection_start_date\n        , members.collection_end_date\n        , seed_demographic_factors.model_version\n        , seed_demographic_factors.factor_type\n        , seed_demographic_factors.coefficient\n    from members\n        inner join seed_demographic_factors\n            on members.enrollment_status = seed_demographic_factors.enrollment_status\n            and members.gender = seed_demographic_factors.gender\n            and members.age_group = seed_demographic_factors.age_group\n            and members.medicaid_status = seed_demographic_factors.medicaid_status\n            and members.orec = seed_demographic_factors.orec\n    where members.enrollment_status = 'New'\n        and seed_demographic_factors.model_version = 'CMS-HCC-V28'\n\n)\n\n, v28_continuining_enrollees as (\n\n    select\n          members.person_id\n        , members.enrollment_status\n        , members.gender\n        , members.age_group\n        , members.medicaid_status\n        , members.dual_status\n        , members.orec\n        , members.institutional_status\n        , members.enrollment_status_default\n        , members.medicaid_dual_status_default\n        , members.orec_default\n        , members.institutional_status_default\n        , members.payment_year\n        , members.collection_start_date\n        , members.collection_end_date\n        , seed_demographic_factors.model_version\n        , seed_demographic_factors.factor_type\n        , seed_demographic_factors.coefficient\n    from members\n        inner join seed_demographic_factors\n            on members.enrollment_status = seed_demographic_factors.enrollment_status\n            and members.gender = seed_demographic_factors.gender\n            and members.age_group = seed_demographic_factors.age_group\n            and members.medicaid_status = seed_demographic_factors.medicaid_status\n            and members.dual_status = seed_demographic_factors.dual_status\n            and members.orec = seed_demographic_factors.orec\n            and members.institutional_status = seed_demographic_factors.institutional_status\n    where members.enrollment_status = 'Continuing'\n        and seed_demographic_factors.model_version = 'CMS-HCC-V28'\n\n)\n\n, unioned as (\n\n    select * from v24_new_enrollees\n    union all\n    select * from v24_continuining_enrollees\n    union all\n    select * from v28_new_enrollees\n    union all\n    select * from v28_continuining_enrollees\n\n)\n\n, add_data_types as (\n\n    select\n          cast(person_id as TEXT) as person_id\n        , cast(enrollment_status as TEXT) as enrollment_status\n        , cast(gender as TEXT) as gender\n        , cast(age_group as TEXT) as age_group\n        , cast(medicaid_status as TEXT) as medicaid_status\n        , cast(dual_status as TEXT) as dual_status\n        , cast(orec as TEXT) as orec\n        , cast(institutional_status as TEXT) as institutional_status\n        \n            , cast(enrollment_status_default as boolean) as enrollment_status_default\n            , cast(medicaid_dual_status_default as boolean) as medicaid_dual_status_default\n            , cast(orec_default as boolean) as orec_default\n            , cast(institutional_status_default as boolean) as institutional_status_default\n        \n        , round(cast(coefficient as numeric(28,6)),3) as coefficient\n        , cast(factor_type as TEXT) as factor_type\n        , cast(model_version as TEXT) as model_version\n        , cast(payment_year as integer) as payment_year\n        , cast(collection_start_date as date) as collection_start_date\n        , cast(collection_end_date as date) as collection_end_date\n    from unioned\n\n)\n\nselect\n      person_id\n    , enrollment_status\n    , gender\n    , age_group\n    , medicaid_status\n    , dual_status\n    , orec\n    , institutional_status\n    , enrollment_status_default\n    , medicaid_dual_status_default\n    , orec_default\n    , institutional_status_default\n    , coefficient\n    , factor_type\n    , model_version\n    , payment_year\n    , collection_start_date\n    , collection_end_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.cms_hcc._int_demographic_factors"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.504812Z", "completed_at": "2025-02-25T21:26:27.510969Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.512239Z", "completed_at": "2025-02-25T21:26:27.512247Z"}], "thread_id": "Thread-1", "execution_time": 0.008957147598266602, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.dbt_utils_unique_combination_of_columns_cms_hcc__int_members_person_id__collection_end_date.10c6ca651a", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        person_id, collection_end_date\n    from tuva.cms_hcc._int_members\n    group by person_id, collection_end_date\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.514464Z", "completed_at": "2025-02-25T21:26:27.525052Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.525344Z", "completed_at": "2025-02-25T21:26:27.525353Z"}], "thread_id": "Thread-3", "execution_time": 0.014117956161499023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.not_null_cms_hcc__int_members_person_id.30ff66ae9a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect person_id\nfrom tuva.cms_hcc._int_members\nwhere person_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.518658Z", "completed_at": "2025-02-25T21:26:27.526170Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.526757Z", "completed_at": "2025-02-25T21:26:27.526762Z"}], "thread_id": "Thread-1", "execution_time": 0.008803844451904297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.financial_pmpm__pmpm_prep", "compiled": true, "compiled_code": "\n\nwith combine as (\n  select\n      a.person_id\n    , a.year_month\n    , a.payer\n    , a.plan\n    , a.data_source\n    , a.payer_attributed_provider\n    , a.payer_attributed_provider_practice\n    , a.payer_attributed_provider_organization\n    , a.payer_attributed_provider_lob\n    , a.custom_attributed_provider\n    , a.custom_attributed_provider_practice\n    , a.custom_attributed_provider_organization\n    , a.custom_attributed_provider_lob\n\n    -- service cat 1 paid\n    , coalesce(b.inpatient_paid, 0) as inpatient_paid\n    , coalesce(b.outpatient_paid, 0) as outpatient_paid\n    , coalesce(b.office_based_paid, 0) as office_based_paid\n    , coalesce(b.ancillary_paid, 0) as ancillary_paid\n    , coalesce(b.other_paid, 0) as other_paid\n    , coalesce(b.pharmacy_paid, 0) as pharmacy_paid\n\n    -- service cat 2 paid\n    , coalesce(c.acute_inpatient_paid, 0) as acute_inpatient_paid\n    , coalesce(c.ambulance_paid, 0) as ambulance_paid\n    , coalesce(c.ambulatory_surgery_center_paid, 0) as ambulatory_surgery_center_paid\n    , coalesce(c.dialysis_paid, 0) as dialysis_paid\n    , coalesce(c.durable_medical_equipment_paid, 0) as durable_medical_equipment_paid\n    , coalesce(c.emergency_department_paid, 0) as emergency_department_paid\n    , coalesce(c.home_health_paid, 0) as home_health_paid\n    , coalesce(c.inpatient_hospice_paid, 0) as inpatient_hospice_paid\n    , coalesce(c.inpatient_psychiatric_paid, 0) as inpatient_psychiatric_paid\n    , coalesce(c.inpatient_rehabilitation_paid, 0) as inpatient_rehabilitation_paid\n    , coalesce(c.lab_paid, 0) as lab_paid\n    , coalesce(c.observation_paid, 0) as observation_paid\n    , coalesce(c.office_based_other_paid, 0) as office_based_other_paid\n    , coalesce(c.office_based_ptotst_paid, 0) as office_based_pt_ot_st_paid\n    , coalesce(c.office_based_radiology_paid, 0) as office_based_radiology_paid\n    , coalesce(c.office_based_surgery_paid, 0) as office_based_surgery_paid\n    , coalesce(c.office_based_visit_paid, 0) as office_based_visit_paid\n    , coalesce(c.other_paid, 0) as other_paid_2\n    , coalesce(c.outpatient_hospice_paid, 0) as outpatient_hospice_paid\n    , coalesce(c.outpatient_hospital_or_clinic_paid, 0) as outpatient_hospital_or_clinic_paid\n    , coalesce(c.outpatient_ptotst_paid, 0) as outpatient_pt_ot_st_paid\n    , coalesce(c.outpatient_psychiatric_paid, 0) as outpatient_psychiatric_paid\n    , coalesce(c.outpatient_radiology_paid, 0) as outpatient_radiology_paid\n    , coalesce(c.outpatient_rehabilitation_paid, 0) as outpatient_rehabilitation_paid\n    , coalesce(c.outpatient_surgery_paid, 0) as outpatient_surgery_paid\n    , coalesce(c.pharmacy_paid, 0) as pharmacy_paid_2\n    , coalesce(c.skilled_nursing_paid, 0) as skilled_nursing_paid\n    , coalesce(c.telehealth_visit_paid, 0) as telehealth_visit_paid\n    , coalesce(c.urgent_care_paid, 0) as urgent_care_paid\n\n    -- service cat 1 allowed\n    , coalesce(d.inpatient_allowed, 0) as inpatient_allowed\n    , coalesce(d.outpatient_allowed, 0) as outpatient_allowed\n    , coalesce(d.office_based_allowed, 0) as office_based_allowed\n    , coalesce(d.ancillary_allowed, 0) as ancillary_allowed\n    , coalesce(d.other_allowed, 0) as other_allowed\n    , coalesce(d.pharmacy_allowed, 0) as pharmacy_allowed\n\n    -- service cat 2 allowed\n    , coalesce(e.acute_inpatient_allowed, 0) as acute_inpatient_allowed\n    , coalesce(e.ambulance_allowed, 0) as ambulance_allowed\n    , coalesce(e.ambulatory_surgery_center_allowed, 0) as ambulatory_surgery_center_allowed\n    , coalesce(e.dialysis_allowed, 0) as dialysis_allowed\n    , coalesce(e.durable_medical_equipment_allowed, 0) as durable_medical_equipment_allowed\n    , coalesce(e.emergency_department_allowed, 0) as emergency_department_allowed\n    , coalesce(e.home_health_allowed, 0) as home_health_allowed\n    , coalesce(e.inpatient_hospice_allowed, 0) as inpatient_hospice_allowed\n    , coalesce(e.inpatient_psychiatric_allowed, 0) as inpatient_psychiatric_allowed\n    , coalesce(e.inpatient_rehabilitation_allowed, 0) as inpatient_rehabilitation_allowed\n    , coalesce(e.lab_allowed, 0) as lab_allowed\n    , coalesce(e.observation_allowed, 0) as observation_allowed\n    , coalesce(e.office_based_other_allowed, 0) as office_based_other_allowed\n    , coalesce(e.office_based_ptotst_allowed, 0) as office_based_pt_ot_st_allowed\n    , coalesce(e.office_based_radiology_allowed, 0) as office_based_radiology_allowed\n    , coalesce(e.office_based_surgery_allowed, 0) as office_based_surgery_allowed\n    , coalesce(e.office_based_visit_allowed, 0) as office_based_visit_allowed\n    , coalesce(e.other_allowed, 0) as other_allowed_2\n    , coalesce(e.outpatient_hospice_allowed, 0) as outpatient_hospice_allowed\n    , coalesce(e.outpatient_hospital_or_clinic_allowed, 0) as outpatient_hospital_or_clinic_allowed\n    , coalesce(e.outpatient_ptotst_allowed, 0) as outpatient_pt_ot_st_allowed\n    , coalesce(e.outpatient_psychiatric_allowed, 0) as outpatient_psychiatric_allowed\n    , coalesce(e.outpatient_radiology_allowed, 0) as outpatient_radiology_allowed\n    , coalesce(e.outpatient_rehabilitation_allowed, 0) as outpatient_rehabilitation_allowed\n    , coalesce(e.outpatient_surgery_allowed, 0) as outpatient_surgery_allowed\n    , coalesce(e.pharmacy_allowed, 0) as pharmacy_allowed_2\n    , coalesce(e.skilled_nursing_allowed, 0) as skilled_nursing_allowed\n    , coalesce(e.telehealth_visit_allowed, 0) as telehealth_visit_allowed\n    , coalesce(e.urgent_care_allowed, 0) as urgent_care_allowed\n\n  from tuva.core.member_months as a\n  left join tuva.financial_pmpm._int_service_category_1_paid_pivot as b\n    on a.person_id = b.person_id\n    and a.year_month = b.year_month\n    and a.payer = b.payer\n    and a.plan = b.plan\n  left join tuva.financial_pmpm._int_service_category_2_paid_pivot as c\n    on a.person_id = c.person_id\n    and a.year_month = c.year_month\n    and a.payer = c.payer\n    and a.plan = c.plan\n  left join tuva.financial_pmpm._int_service_category_1_allowed_pivot as d\n    on a.person_id = d.person_id\n    and a.year_month = d.year_month\n    and a.payer = d.payer\n    and a.plan = d.plan\n  left join tuva.financial_pmpm._int_service_category_2_allowed_pivot as e\n    on a.person_id = e.person_id\n    and a.year_month = e.year_month\n    and a.payer = e.payer\n    and a.plan = e.plan\n)\n\nselect\n    *\n  , inpatient_paid + outpatient_paid + office_based_paid + ancillary_paid + other_paid + pharmacy_paid as total_paid\n  , inpatient_paid + outpatient_paid + office_based_paid + ancillary_paid + other_paid as medical_paid\n  , inpatient_allowed + outpatient_allowed + office_based_allowed + ancillary_allowed + other_allowed + pharmacy_allowed as total_allowed\n  , inpatient_allowed + outpatient_allowed + office_based_allowed + ancillary_allowed + other_allowed as medical_allowed\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom combine", "relation_name": "tuva.financial_pmpm.pmpm_prep"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.527768Z", "completed_at": "2025-02-25T21:26:27.540110Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.540407Z", "completed_at": "2025-02-25T21:26:27.540417Z"}], "thread_id": "Thread-3", "execution_time": 0.014055967330932617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.quality_measures__int_adh_diabetes_long", "compiled": true, "compiled_code": "\n\nwith denominator as (\n\n    select\n          person_id\n        , performance_period_begin\n        , performance_period_end\n        , measure_id\n        , measure_name\n        , measure_version\n        , denominator_flag\n    from tuva.quality_measures._int_adh_diabetes_denominator\n\n)\n\n, numerator as (\n\n    select\n          person_id\n        , evidence_date\n        , evidence_value\n    from tuva.quality_measures._int_adh_diabetes_numerator\n\n)\n\n, exclusions as (\n\n    select\n          person_id\n        , exclusion_date\n        , exclusion_reason\n    from tuva.quality_measures._int_adh_diabetes_exclusions\n\n)\n\n, measure_flags as (\n\n    select\n          denominator.person_id\n        , case\n            when denominator.person_id is not null\n            then 1\n            else null\n          end as denominator_flag\n        , case\n            when numerator.person_id is not null and denominator.person_id is not null\n            then 1\n            when denominator.person_id is not null\n            then 0\n            else null\n          end as numerator_flag\n        , case\n            when exclusions.person_id is not null and denominator.person_id is not null\n            then 1\n            when denominator.person_id is not null\n            then 0\n            else null\n          end as exclusion_flag\n        , numerator.evidence_date\n        , numerator.evidence_value\n        , exclusions.exclusion_date\n        , exclusions.exclusion_reason\n        , denominator.performance_period_begin\n        , denominator.performance_period_end\n        , denominator.measure_id\n        , denominator.measure_name\n        , denominator.measure_version\n        , (row_number() over(\n            partition by\n                  denominator.person_id\n                , denominator.performance_period_begin\n                , denominator.performance_period_end\n                , denominator.measure_id\n                , denominator.measure_name\n              order by\n                  case when numerator.evidence_date is null then 1 else 0 end,\n                  numerator.evidence_date desc\n                , case when exclusions.exclusion_date is null then 1 else 0 end,\n                  exclusions.exclusion_date desc\n          )) as rn\n    from denominator\n        left join numerator\n            on denominator.person_id = numerator.person_id\n        left join exclusions\n            on denominator.person_id = exclusions.person_id\n\n)\n\n/*\n    Deduplicate measure rows by latest evidence date or exclusion date\n*/\n, deduped as (\n\n    select\n          person_id\n        , denominator_flag\n        , numerator_flag\n        , exclusion_flag\n        , evidence_date\n        , evidence_value\n        , exclusion_date\n        , exclusion_reason\n        , performance_period_begin\n        , performance_period_end\n        , measure_id\n        , measure_name\n        , measure_version\n    from measure_flags\n    where rn = 1\n\n)\n\n, add_data_types as (\n\n    select\n          cast(person_id as TEXT) as person_id\n        , cast(denominator_flag as integer) as denominator_flag\n        , cast(numerator_flag as integer) as numerator_flag\n        , cast(exclusion_flag as integer) as exclusion_flag\n        , cast(evidence_date as date) as evidence_date\n        , cast(evidence_value as TEXT) as evidence_value\n        , cast(exclusion_date as date) as exclusion_date\n        , cast(exclusion_reason as TEXT) as exclusion_reason\n        , cast(performance_period_begin as date) as performance_period_begin\n        , cast(performance_period_end as date) as performance_period_end\n        , cast(measure_id as TEXT) as measure_id\n        , cast(measure_name as TEXT) as measure_name\n        , cast(measure_version as TEXT) as measure_version\n    from deduped\n\n)\n\nselect\n      person_id\n    , denominator_flag\n    , numerator_flag\n    , exclusion_flag\n    , evidence_date\n    , evidence_value\n    , exclusion_date\n    , exclusion_reason\n    , performance_period_begin\n    , performance_period_end\n    , measure_id\n    , measure_name\n    , measure_version\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.quality_measures._int_adh_diabetes_long"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.534434Z", "completed_at": "2025-02-25T21:26:27.541136Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.541768Z", "completed_at": "2025-02-25T21:26:27.541773Z"}], "thread_id": "Thread-1", "execution_time": 0.00806283950805664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.quality_measures__int_adh_statins_long", "compiled": true, "compiled_code": "\n\nwith denominator as (\n\n    select\n          person_id\n        , performance_period_begin\n        , performance_period_end\n        , measure_id\n        , measure_name\n        , measure_version\n        , denominator_flag\n    from tuva.quality_measures._int_adh_statins_denominator\n\n)\n\n, numerator as (\n\n    select\n          person_id\n        , evidence_date\n        , evidence_value\n    from tuva.quality_measures._int_adh_statins_numerator\n\n)\n\n, exclusions as (\n\n    select\n          person_id\n        , exclusion_date\n        , exclusion_reason\n    from tuva.quality_measures._int_adh_statins_exclusions\n\n)\n\n, measure_flags as (\n\n    select\n          denominator.person_id\n        , case\n            when denominator.person_id is not null\n            then 1\n            else null\n          end as denominator_flag\n        , case\n            when numerator.person_id is not null and denominator.person_id is not null\n            then 1\n            when denominator.person_id is not null\n            then 0\n            else null\n          end as numerator_flag\n        , case\n            when exclusions.person_id is not null and denominator.person_id is not null\n            then 1\n            when denominator.person_id is not null\n            then 0\n            else null\n          end as exclusion_flag\n        , numerator.evidence_date\n        , numerator.evidence_value\n        , exclusions.exclusion_date\n        , exclusions.exclusion_reason\n        , denominator.performance_period_begin\n        , denominator.performance_period_end\n        , denominator.measure_id\n        , denominator.measure_name\n        , denominator.measure_version\n        , (row_number() over(\n            partition by\n                  denominator.person_id\n                , denominator.performance_period_begin\n                , denominator.performance_period_end\n                , denominator.measure_id\n                , denominator.measure_name\n              order by\n                  case when numerator.evidence_date is null then 1 else 0 end,\n                  numerator.evidence_date desc\n                , case when exclusions.exclusion_date is null then 1 else 0 end,\n                  exclusions.exclusion_date desc\n          )) as rn\n    from denominator\n        left join numerator\n            on denominator.person_id = numerator.person_id\n        left join exclusions\n            on denominator.person_id = exclusions.person_id\n\n)\n\n, deduped as (\n\n    select\n          person_id\n        , denominator_flag\n        , numerator_flag\n        , exclusion_flag\n        , evidence_date\n        , evidence_value\n        , exclusion_date\n        , exclusion_reason\n        , performance_period_begin\n        , performance_period_end\n        , measure_id\n        , measure_name\n        , measure_version\n    from measure_flags\n    where rn = 1\n\n)\n\n, add_data_types as (\n\n    select\n          cast(person_id as TEXT) as person_id\n        , cast(denominator_flag as integer) as denominator_flag\n        , cast(numerator_flag as integer) as numerator_flag\n        , cast(exclusion_flag as integer) as exclusion_flag\n        , cast(evidence_date as date) as evidence_date\n        , cast(evidence_value as TEXT) as evidence_value\n        , cast(exclusion_date as date) as exclusion_date\n        , cast(exclusion_reason as TEXT) as exclusion_reason\n        , cast(performance_period_begin as date) as performance_period_begin\n        , cast(performance_period_end as date) as performance_period_end\n        , cast(measure_id as TEXT) as measure_id\n        , cast(measure_name as TEXT) as measure_name\n        , cast(measure_version as TEXT) as measure_version\n    from deduped\n\n)\n\nselect\n      person_id\n    , denominator_flag\n    , numerator_flag\n    , exclusion_flag\n    , evidence_date\n    , evidence_value\n    , exclusion_date\n    , exclusion_reason\n    , performance_period_begin\n    , performance_period_end\n    , measure_id\n    , measure_name\n    , measure_version\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.quality_measures._int_adh_statins_long"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.542721Z", "completed_at": "2025-02-25T21:26:27.556146Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.556416Z", "completed_at": "2025-02-25T21:26:27.556424Z"}], "thread_id": "Thread-3", "execution_time": 0.015094995498657227, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.quality_measures__int_adhras_long", "compiled": true, "compiled_code": "\n\nwith denominator as (\n\n    select\n          person_id\n        , performance_period_begin\n        , performance_period_end\n        , measure_id\n        , measure_name\n        , measure_version\n        , denominator_flag\n    from tuva.quality_measures._int_adhras_denominator\n\n)\n\n, numerator as (\n\n    select\n          person_id\n        , evidence_date\n        , evidence_value\n    from tuva.quality_measures._int_adhras_numerator\n\n)\n\n, exclusions as (\n\n    select\n          person_id\n        , exclusion_date\n        , exclusion_reason\n    from tuva.quality_measures._int_adhras_exclusions\n\n)\n\n, measure_flags as (\n\n    select\n          denominator.person_id\n        , case\n            when denominator.person_id is not null\n            then 1\n            else null\n          end as denominator_flag\n        , case\n            when numerator.person_id is not null and denominator.person_id is not null\n            then 1\n            when denominator.person_id is not null\n            then 0\n            else null\n          end as numerator_flag\n        , case\n            when exclusions.person_id is not null and denominator.person_id is not null\n            then 1\n            when denominator.person_id is not null\n            then 0\n            else null\n          end as exclusion_flag\n        , numerator.evidence_date\n        , numerator.evidence_value\n        , exclusions.exclusion_date\n        , exclusions.exclusion_reason\n        , denominator.performance_period_begin\n        , denominator.performance_period_end\n        , denominator.measure_id\n        , denominator.measure_name\n        , denominator.measure_version\n        , (row_number() over(\n            partition by\n                  denominator.person_id\n                , denominator.performance_period_begin\n                , denominator.performance_period_end\n                , denominator.measure_id\n                , denominator.measure_name\n              order by\n                  case when numerator.evidence_date is null then 1 else 0 end,\n                  numerator.evidence_date desc\n                , case when exclusions.exclusion_date is null then 1 else 0 end,\n                  exclusions.exclusion_date desc\n          )) as rn\n    from denominator\n        left join numerator\n            on denominator.person_id = numerator.person_id\n        left join exclusions\n            on denominator.person_id = exclusions.person_id\n\n)\n\n, deduped as (\n\n    select\n          person_id\n        , denominator_flag\n        , numerator_flag\n        , exclusion_flag\n        , evidence_date\n        , evidence_value\n        , exclusion_date\n        , exclusion_reason\n        , performance_period_begin\n        , performance_period_end\n        , measure_id\n        , measure_name\n        , measure_version\n    from measure_flags\n    where rn = 1\n\n)\n\n, add_data_types as (\n\n    select\n          cast(person_id as TEXT) as person_id\n        , cast(denominator_flag as integer) as denominator_flag\n        , cast(numerator_flag as integer) as numerator_flag\n        , cast(exclusion_flag as integer) as exclusion_flag\n        , cast(evidence_date as date) as evidence_date\n        , cast(evidence_value as TEXT) as evidence_value\n        , cast(exclusion_date as date) as exclusion_date\n        , cast(exclusion_reason as TEXT) as exclusion_reason\n        , cast(performance_period_begin as date) as performance_period_begin\n        , cast(performance_period_end as date) as performance_period_end\n        , cast(measure_id as TEXT) as measure_id\n        , cast(measure_name as TEXT) as measure_name\n        , cast(measure_version as TEXT) as measure_version\n    from deduped\n\n)\n\nselect\n      person_id\n    , denominator_flag\n    , numerator_flag\n    , exclusion_flag\n    , evidence_date\n    , evidence_value\n    , exclusion_date\n    , exclusion_reason\n    , performance_period_begin\n    , performance_period_end\n    , measure_id\n    , measure_name\n    , measure_version\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.quality_measures._int_adhras_long"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.550349Z", "completed_at": "2025-02-25T21:26:27.557380Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.557906Z", "completed_at": "2025-02-25T21:26:27.557910Z"}], "thread_id": "Thread-1", "execution_time": 0.008257865905761719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.quality_measures__int_supd_long", "compiled": true, "compiled_code": "\n\nwith denominator as (\n\n    select\n          person_id\n        , performance_period_begin\n        , performance_period_end\n        , measure_id\n        , measure_name\n        , measure_version\n    from tuva.quality_measures._int_supd_denominator\n\n)\n\n, numerator as (\n\n    select\n          person_id\n        , evidence_date\n        , evidence_value\n    from tuva.quality_measures._int_supd_numerator\n\n)\n\n, exclusions as (\n\n    select\n          person_id\n        , exclusion_date\n        , exclusion_reason\n    from tuva.quality_measures._int_supd_exclusions\n\n)\n\n, measure_flags as (\n\n    select\n          denominator.person_id\n        , case\n            when denominator.person_id is not null\n            then 1\n            else null\n          end as denominator_flag\n        , case\n            when numerator.person_id is not null and denominator.person_id is not null\n            then 1\n            when denominator.person_id is not null\n            then 0\n            else null\n          end as numerator_flag\n        , case\n            when exclusions.person_id is not null and denominator.person_id is not null\n            then 1\n            when denominator.person_id is not null\n            then 0\n            else null\n          end as exclusion_flag\n        , numerator.evidence_date\n        , numerator.evidence_value\n        , exclusions.exclusion_date\n        , exclusions.exclusion_reason\n        , denominator.performance_period_begin\n        , denominator.performance_period_end\n        , denominator.measure_id\n        , denominator.measure_name\n        , denominator.measure_version\n        , (row_number() over(\n            partition by\n                  denominator.person_id\n                , denominator.performance_period_begin\n                , denominator.performance_period_end\n                , denominator.measure_id\n                , denominator.measure_name\n              order by\n                  case when numerator.evidence_date is null then 1 else 0 end,\n                  numerator.evidence_date desc\n                , case when exclusions.exclusion_date is null then 1 else 0 end,\n                  exclusions.exclusion_date desc\n          )) as rn\n    from denominator\n        left join numerator\n            on denominator.person_id = numerator.person_id\n        left join exclusions\n            on denominator.person_id = exclusions.person_id\n\n)\n\n/*\n    Deduplicate measure rows by latest evidence date or exclusion date\n*/\n, deduped as (\n\n    select\n          person_id\n        , denominator_flag\n        , numerator_flag\n        , exclusion_flag\n        , evidence_date\n        , evidence_value\n        , exclusion_date\n        , exclusion_reason\n        , performance_period_begin\n        , performance_period_end\n        , measure_id\n        , measure_name\n        , measure_version\n    from measure_flags\n    where rn = 1\n\n)\n\n, add_data_types as (\n\n    select\n          cast(person_id as TEXT) as person_id\n        , cast(denominator_flag as integer) as denominator_flag\n        , cast(numerator_flag as integer) as numerator_flag\n        , cast(exclusion_flag as integer) as exclusion_flag\n        , cast(evidence_date as date) as evidence_date\n        , cast(evidence_value as TEXT) as evidence_value\n        , cast(exclusion_date as date) as exclusion_date\n        , cast(exclusion_reason as TEXT) as exclusion_reason\n        , cast(performance_period_begin as date) as performance_period_begin\n        , cast(performance_period_end as date) as performance_period_end\n        , cast(measure_id as TEXT) as measure_id\n        , cast(measure_name as TEXT) as measure_name\n        , cast(measure_version as TEXT) as measure_version\n    from deduped\n\n)\n\nselect\n      person_id\n    , denominator_flag\n    , numerator_flag\n    , exclusion_flag\n    , evidence_date\n    , evidence_value\n    , exclusion_date\n    , exclusion_reason\n    , performance_period_begin\n    , performance_period_end\n    , measure_id\n    , measure_name\n    , measure_version\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.quality_measures._int_supd_long"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.567213Z", "completed_at": "2025-02-25T21:26:27.572680Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.573062Z", "completed_at": "2025-02-25T21:26:27.573070Z"}], "thread_id": "Thread-1", "execution_time": 0.007030963897705078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__chronic_conditions_none", "compiled": true, "compiled_code": "\n\nwith chronic_conditions as \n(\n    select distinct person_id \n    from tuva.chronic_conditions.cms_chronic_conditions_long\n)\n\n,results as (\n    select \n        cast('Percent of patients without chronic conditions' as TEXT) as data_quality_check\n        , sum(case when cccw.person_id is null then 1 else 0 end) / count(distinct e.person_id) * 100 as result_count\n    from tuva.core.patient e\n    left join chronic_conditions cccw \n        on e.person_id = cccw.person_id\n)\n\nselect\n    results.data_quality_check\n    , results.result_count\n    , ref_data.analytics_value as medicare_lds_reference\n    , 0 as normally_zero \n    , cast('2025-02-25 21:25:59.177756+00:00' as TEXT) as tuva_last_run\n    \nfrom results\nleft join tuva.data_quality._value_set_reference_mart_analytics as ref_data \n    on results.data_quality_check = ref_data.analytics_measure", "relation_name": "tuva.data_quality.chronic_conditions_none"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.574570Z", "completed_at": "2025-02-25T21:26:27.580021Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.580328Z", "completed_at": "2025-02-25T21:26:27.580335Z"}], "thread_id": "Thread-1", "execution_time": 0.006499052047729492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.dbt_utils_unique_combination_of_columns_chronic_conditions__cms_chronic_conditions_long_person_id__claim_id__start_date__condition.dc93e14296", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        person_id, claim_id, start_date, condition\n    from tuva.chronic_conditions.cms_chronic_conditions_long\n    group by person_id, claim_id, start_date, condition\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.581695Z", "completed_at": "2025-02-25T21:26:27.585741Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.586018Z", "completed_at": "2025-02-25T21:26:27.586027Z"}], "thread_id": "Thread-1", "execution_time": 0.0049211978912353516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.not_null_chronic_conditions__cms_chronic_conditions_long_claim_id.74242d2abc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect claim_id\nfrom tuva.chronic_conditions.cms_chronic_conditions_long\nwhere claim_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.587522Z", "completed_at": "2025-02-25T21:26:27.591088Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.591327Z", "completed_at": "2025-02-25T21:26:27.591335Z"}], "thread_id": "Thread-1", "execution_time": 0.0044329166412353516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.not_null_chronic_conditions__cms_chronic_conditions_long_condition.e794460ae3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect condition\nfrom tuva.chronic_conditions.cms_chronic_conditions_long\nwhere condition is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.592633Z", "completed_at": "2025-02-25T21:26:27.596254Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.596543Z", "completed_at": "2025-02-25T21:26:27.596550Z"}], "thread_id": "Thread-1", "execution_time": 0.004510164260864258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.not_null_chronic_conditions__cms_chronic_conditions_long_person_id.8e6796eb20", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect person_id\nfrom tuva.chronic_conditions.cms_chronic_conditions_long\nwhere person_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.597901Z", "completed_at": "2025-02-25T21:26:27.605049Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.605322Z", "completed_at": "2025-02-25T21:26:27.605330Z"}], "thread_id": "Thread-1", "execution_time": 0.008149147033691406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.hcc_suspecting__list", "compiled": true, "compiled_code": "\n\nwith hcc_history_suspects as (\n\n    select distinct\n          person_id\n        , data_source\n        , hcc_code\n        , hcc_description\n        , reason\n        , contributing_factor\n        , suspect_date\n    from tuva.hcc_suspecting._int_patient_hcc_history\n    \n        where (current_year_billed = false\n            or current_year_billed is null)\n    \n\n)\n\n, comorbidity_suspects as (\n\n    select distinct\n          person_id\n        , data_source\n        , hcc_code\n        , hcc_description\n        , reason\n        , contributing_factor\n        , suspect_date\n    from tuva.hcc_suspecting._int_comorbidity_suspects\n    \n        where (current_year_billed = false\n            or current_year_billed is null)\n    \n\n)\n\n, observation_suspects as (\n\n    select distinct\n          person_id\n        , data_source\n        , hcc_code\n        , hcc_description\n        , reason\n        , contributing_factor\n        , suspect_date\n    from tuva.hcc_suspecting._int_observation_suspects\n    \n        where (current_year_billed = false\n            or current_year_billed is null)\n    \n\n)\n\n, lab_suspects as (\n\n    select distinct\n          person_id\n        , data_source\n        , hcc_code\n        , hcc_description\n        , reason\n        , contributing_factor\n        , suspect_date\n    from tuva.hcc_suspecting._int_lab_suspects\n    \n        where (current_year_billed = false\n            or current_year_billed is null)\n    \n\n)\n\n, medication_suspects as (\n\n    select distinct\n          person_id\n        , data_source\n        , hcc_code\n        , hcc_description\n        , reason\n        , contributing_factor\n        , suspect_date\n    from tuva.hcc_suspecting._int_medication_suspects\n    \n        where (current_year_billed = false\n            or current_year_billed is null)\n    \n\n)\n\n, unioned as (\n\n    select * from hcc_history_suspects\n    union all\n    select * from comorbidity_suspects\n    union all\n    select * from observation_suspects\n    union all\n    select * from lab_suspects\n    union all\n    select * from medication_suspects\n\n)\n\n, add_data_types as (\n\n    select\n          cast(person_id as TEXT) as person_id\n        , cast(data_source as TEXT) as data_source\n        , cast(hcc_code as TEXT) as hcc_code\n        , cast(hcc_description as TEXT) as hcc_description\n        , cast(reason as TEXT) as reason\n        , cast(contributing_factor as TEXT) as contributing_factor\n        , cast(suspect_date as date) as suspect_date\n    from unioned\n\n)\n\nselect\n      person_id\n    , data_source\n    , hcc_code\n    , hcc_description\n    , reason\n    , contributing_factor\n    , suspect_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.hcc_suspecting.list"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.606723Z", "completed_at": "2025-02-25T21:26:27.613198Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.613433Z", "completed_at": "2025-02-25T21:26:27.613440Z"}], "thread_id": "Thread-1", "execution_time": 0.007318735122680664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.cms_hcc__int_hcc_hierarchy", "compiled": true, "compiled_code": "\n/*\n    Staging HCCs that will be used in disease factor calculations.\n    Final output for each CMS model version includes:\n        - hccs without a hierarchy\n        - lower-level hccs with hierarchy where top-level hcc is missing\n        - top-level hccs from hierarchy\n*/\n\nwith hcc_mapping as (\n\n    select distinct\n          person_id\n        , hcc_code\n        , model_version\n        , payment_year\n        , collection_start_date\n        , collection_end_date\n    from tuva.cms_hcc._int_hcc_mapping\n\n)\n\n, seed_hcc_hierarchy as (\n\n    select\n          model_version\n        , hcc_code\n        , description\n        , hccs_to_exclude\n    from tuva.cms_hcc._value_set_disease_hierarchy\n\n)\n\n/*\n    selecting hccs that do not have a hierarchy\n    all codes in this cte are included in final output\n*/\n, hccs_without_hierarchy as (\n\n    select distinct\n          hcc_mapping.person_id\n        , hcc_mapping.model_version\n        , hcc_mapping.payment_year\n        , hcc_mapping.collection_start_date\n        , hcc_mapping.collection_end_date\n        , hcc_mapping.hcc_code\n    from hcc_mapping\n        left join seed_hcc_hierarchy as hcc_top_level\n            on hcc_mapping.hcc_code = hcc_top_level.hcc_code\n            and hcc_mapping.model_version = hcc_top_level.model_version\n        left join seed_hcc_hierarchy as hcc_exclusions\n            on hcc_mapping.hcc_code = hcc_exclusions.hccs_to_exclude\n            and hcc_mapping.model_version = hcc_exclusions.model_version\n    where hcc_top_level.hcc_code is null\n        and hcc_exclusions.hccs_to_exclude is null\n\n)\n\n/*\n    selecting hccs that have a hierarchy to be evaluated in the next cte\n*/\n, hccs_with_hierarchy as (\n\n    select\n          hcc_mapping.person_id\n        , hcc_mapping.model_version\n        , hcc_mapping.payment_year\n        , hcc_mapping.collection_start_date\n        , hcc_mapping.collection_end_date\n        , hcc_mapping.hcc_code\n        , seed_hcc_hierarchy.hcc_code as top_level_hcc\n    from hcc_mapping\n        inner join seed_hcc_hierarchy\n            on hcc_mapping.hcc_code = seed_hcc_hierarchy.hccs_to_exclude\n            and hcc_mapping.model_version = seed_hcc_hierarchy.model_version\n\n)\n\n/*\n    applying hcc hierarchy and grouping by patient and hcc\n    to account for multiple hcc combinations\n    minimum HCC is included following CMS's severity logic\n*/\n, hierarchy_applied as (\n\n    select\n          hccs_with_hierarchy.person_id\n        , hccs_with_hierarchy.model_version\n        , hccs_with_hierarchy.payment_year\n        , hccs_with_hierarchy.collection_start_date\n        , hccs_with_hierarchy.collection_end_date\n        , hccs_with_hierarchy.hcc_code\n        , min(hcc_mapping.hcc_code) as top_level_hcc\n    from hccs_with_hierarchy\n        left join hcc_mapping\n            on hcc_mapping.person_id = hccs_with_hierarchy.person_id\n            and hcc_mapping.hcc_code = hccs_with_hierarchy.top_level_hcc\n            and hcc_mapping.model_version = hccs_with_hierarchy.model_version\n            and hcc_mapping.payment_year = hccs_with_hierarchy.payment_year\n            and hcc_mapping.collection_end_date = hccs_with_hierarchy.collection_end_date\n    group by\n          hccs_with_hierarchy.person_id\n        , hccs_with_hierarchy.model_version\n        , hccs_with_hierarchy.payment_year\n        , hccs_with_hierarchy.collection_start_date\n        , hccs_with_hierarchy.collection_end_date\n        , hccs_with_hierarchy.hcc_code\n\n)\n\n/*\n    selecting lower-level hccs in hierarchy\n    all codes in this cte are included in final output\n*/\n, lower_level_inclusions as (\n\n    select distinct\n          person_id\n        , model_version\n        , payment_year\n        , collection_start_date\n        , collection_end_date\n        , case\n            when top_level_hcc is not null then top_level_hcc\n            else hcc_code\n          end as hcc_code\n    from hierarchy_applied\n\n)\n\n/*\n    selecting top-level hccs not in previous steps\n    all codes in this cte are included in final output\n*/\n, top_level_inclusions as (\n\n    select distinct\n          hcc_mapping.person_id\n        , hcc_mapping.model_version\n        , hcc_mapping.payment_year\n        , hcc_mapping.collection_start_date\n        , hcc_mapping.collection_end_date\n        , hcc_mapping.hcc_code\n    from hcc_mapping\n        inner join seed_hcc_hierarchy\n            on hcc_mapping.hcc_code = seed_hcc_hierarchy.hcc_code\n            and hcc_mapping.model_version = seed_hcc_hierarchy.model_version\n        left join lower_level_inclusions\n            on hcc_mapping.person_id = lower_level_inclusions.person_id\n            and hcc_mapping.hcc_code = lower_level_inclusions.hcc_code\n            and hcc_mapping.model_version = lower_level_inclusions.model_version\n            and hcc_mapping.payment_year = lower_level_inclusions.payment_year\n            and hcc_mapping.collection_end_date = lower_level_inclusions.collection_end_date\n        left join hierarchy_applied\n            on hcc_mapping.person_id = hierarchy_applied.person_id\n            and hcc_mapping.hcc_code = hierarchy_applied.hcc_code\n            and hcc_mapping.model_version = hierarchy_applied.model_version\n            and hcc_mapping.payment_year = hierarchy_applied.payment_year\n            and hcc_mapping.collection_end_date = hierarchy_applied.collection_end_date\n    where lower_level_inclusions.hcc_code is null\n        and hierarchy_applied.top_level_hcc is null\n\n)\n\n, unioned as (\n\n    select * from hccs_without_hierarchy\n    union all\n    select * from lower_level_inclusions\n    union all\n    select * from top_level_inclusions\n\n)\n\n, add_data_types as (\n\n    select\n          cast(person_id as TEXT) as person_id\n        , cast(model_version as TEXT) as model_version\n        , cast(payment_year as integer) as payment_year\n        , cast(collection_start_date as date) as collection_start_date\n        , cast(collection_end_date as date) as collection_end_date\n        , cast(hcc_code as TEXT) as hcc_code\n    from unioned\n\n)\n\nselect\n      person_id\n    , model_version\n    , payment_year\n    , collection_start_date\n    , collection_end_date\n    , hcc_code\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.cms_hcc._int_hcc_hierarchy"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.614755Z", "completed_at": "2025-02-25T21:26:27.620099Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.620340Z", "completed_at": "2025-02-25T21:26:27.620348Z"}], "thread_id": "Thread-1", "execution_time": 0.006269931793212891, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.cms_hcc__int_enrollment_interaction_factors", "compiled": true, "compiled_code": "\n\nwith demographics as (\n\n    select\n          person_id\n        , enrollment_status\n        , gender\n        , age_group\n        , medicaid_status\n        , dual_status\n        , orec\n        , institutional_status\n        , model_version\n        , payment_year\n        , collection_start_date\n        , collection_end_date\n    from tuva.cms_hcc._int_demographic_factors\n\n)\n\n, seed_interaction_factors as (\n\n    select\n          model_version\n        , factor_type\n        , gender\n        , enrollment_status\n        , medicaid_status\n        , dual_status\n        , institutional_status\n        , description\n        , coefficient\n    from tuva.cms_hcc._value_set_enrollment_interaction_factors\n\n)\n\n/*\n    Originally disabled interactions for non-institutional members >= 65\n*/\n, non_institutional_interactions as (\n\n    select\n          demographics.person_id\n        , demographics.model_version\n        , demographics.payment_year\n        , demographics.collection_start_date\n        , demographics.collection_end_date\n        , seed_interaction_factors.factor_type\n        , seed_interaction_factors.description\n        , seed_interaction_factors.coefficient\n    from demographics\n        inner join seed_interaction_factors\n            on demographics.gender = seed_interaction_factors.gender\n            and demographics.enrollment_status = seed_interaction_factors.enrollment_status\n            and demographics.medicaid_status = seed_interaction_factors.medicaid_status\n            and demographics.dual_status = seed_interaction_factors.dual_status\n            and demographics.institutional_status = seed_interaction_factors.institutional_status\n            and demographics.model_version = seed_interaction_factors.model_version\n    where demographics.institutional_status = 'No'\n        and demographics.orec = 'Disabled'\n        and demographics.age_group in (\n              '65-69'\n            , '70-74'\n            , '75-79'\n            , '80-84'\n            , '85-89'\n            , '90-94'\n            , '>=95'\n        )\n\n)\n\n/*\n    Medicaid interactions for institutional members\n*/\n, institutional_interactions as (\n\n    select\n          demographics.person_id\n        , demographics.model_version\n        , demographics.payment_year\n        , demographics.collection_start_date\n        , demographics.collection_end_date\n        , seed_interaction_factors.factor_type\n        , seed_interaction_factors.description\n        , seed_interaction_factors.coefficient\n    from demographics\n        inner join seed_interaction_factors\n            on demographics.enrollment_status = seed_interaction_factors.enrollment_status\n            and demographics.institutional_status = seed_interaction_factors.institutional_status\n            and demographics.model_version = seed_interaction_factors.model_version\n    where demographics.institutional_status = 'Yes'\n        and demographics.medicaid_status = 'Yes'\n\n)\n\n, unioned as (\n\n    select * from non_institutional_interactions\n    union all\n    select * from institutional_interactions\n\n)\n\n, add_data_types as (\n\n    select\n          cast(person_id as TEXT) as person_id\n        , cast(description as TEXT) as description\n        , round(cast(coefficient as numeric(28,6)),3) as coefficient\n        , cast(factor_type as TEXT) as factor_type\n        , cast(model_version as TEXT) as model_version\n        , cast(payment_year as integer) as payment_year\n        , cast(collection_start_date as date) as collection_start_date\n        , cast(collection_end_date as date) as collection_end_date\n    from unioned\n\n)\n\nselect\n      person_id\n    , description\n    , coefficient\n    , factor_type\n    , model_version\n    , payment_year\n    , collection_start_date\n    , collection_end_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.cms_hcc._int_enrollment_interaction_factors"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.621589Z", "completed_at": "2025-02-25T21:26:27.631523Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.631959Z", "completed_at": "2025-02-25T21:26:27.631967Z"}], "thread_id": "Thread-1", "execution_time": 0.010988950729370117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.dbt_utils_unique_combination_of_columns_cms_hcc__int_demographic_factors_person_id__model_version__collection_end_date.da0ac9674b", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        person_id, model_version, collection_end_date\n    from tuva.cms_hcc._int_demographic_factors\n    group by person_id, model_version, collection_end_date\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.633377Z", "completed_at": "2025-02-25T21:26:27.639266Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.639534Z", "completed_at": "2025-02-25T21:26:27.639542Z"}], "thread_id": "Thread-1", "execution_time": 0.006904125213623047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__financial_pmpm", "compiled": true, "compiled_code": "\n\nwith cte as (\nselect distinct cast(year_month_int as TEXT ) as year_month\n,year as year_number\nfrom tuva.reference_data.calendar\n)\n\nselect  count(*) as member_months\n,sum(total_paid) / cast(count(*) as numeric(28,6)) as total_pmpm\n,c.year_number as year_number\nfrom tuva.financial_pmpm.pmpm_prep p \nleft join cte c on p.year_month = c.year_month \ngroup by c.year_number", "relation_name": "tuva.data_quality.data_quality_financial_pmpm"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.641217Z", "completed_at": "2025-02-25T21:26:27.647210Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.647518Z", "completed_at": "2025-02-25T21:26:27.647526Z"}], "thread_id": "Thread-1", "execution_time": 0.007203102111816406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.financial_pmpm__pmpm_payer", "compiled": true, "compiled_code": "\n\nselect\n    year_month\n  , payer\n  , data_source\n  , count(1) as member_months\n  , sum(total_paid) / count(1) as total_paid\n  , sum(medical_paid) / count(1) as medical_paid\n  , sum(inpatient_paid) / count(1) as inpatient_paid\n  , sum(outpatient_paid) / count(1) as outpatient_paid\n  , sum(office_based_paid) / count(1) as office_based_paid\n  , sum(ancillary_paid) / count(1) as ancillary_paid\n  , sum(other_paid) / count(1) as other_paid\n  , sum(pharmacy_paid) / count(1) as pharmacy_paid\n  , sum(acute_inpatient_paid) / count(1) as acute_inpatient_paid\n  , sum(ambulance_paid) / count(1) as ambulance_paid\n  , sum(ambulatory_surgery_center_paid) / count(1) as ambulatory_surgery_center_paid\n  , sum(dialysis_paid) / count(1) as dialysis_paid\n  , sum(durable_medical_equipment_paid) / count(1) as durable_medical_equipment_paid\n  , sum(emergency_department_paid) / count(1) as emergency_department_paid\n  , sum(home_health_paid) / count(1) as home_health_paid\n  , sum(inpatient_hospice_paid) / count(1) as inpatient_hospice_paid\n  , sum(inpatient_psychiatric_paid) / count(1) as inpatient_psychiatric_paid\n  , sum(inpatient_rehabilitation_paid) / count(1) as inpatient_rehabilitation_paid\n  , sum(lab_paid) / count(1) as lab_paid\n  , sum(observation_paid) / count(1) as observation_paid\n  , sum(office_based_other_paid) / count(1) as office_based_other_paid\n  , sum(office_based_pt_ot_st_paid) / count(1) as office_based_pt_ot_st_paid\n  , sum(office_based_radiology_paid) / count(1) as office_based_radiology_paid\n  , sum(office_based_surgery_paid) / count(1) as office_based_surgery_paid\n  , sum(office_based_visit_paid) / count(1) as office_based_visit_paid\n  , sum(outpatient_hospital_or_clinic_paid) / count(1) as outpatient_hospital_or_clinic_paid\n  , sum(outpatient_pt_ot_st_paid) / count(1) as outpatient_pt_ot_st_paid\n  , sum(outpatient_psychiatric_paid) / count(1) as outpatient_psychiatric_paid\n  , sum(outpatient_radiology_paid) / count(1) as outpatient_radiology_paid\n  , sum(outpatient_rehabilitation_paid) / count(1) as outpatient_rehabilitation_paid\n  , sum(outpatient_surgery_paid) / count(1) as outpatient_surgery_paid\n  , sum(skilled_nursing_paid) / count(1) as skilled_nursing_paid\n  , sum(telehealth_visit_paid) / count(1) as telehealth_visit_paid\n  , sum(urgent_care_paid) / count(1) as urgent_care_paid\n  , sum(total_allowed) / count(1) as total_allowed\n  , sum(medical_allowed) / count(1) as medical_allowed\n  , sum(inpatient_allowed) / count(1) as inpatient_allowed\n  , sum(outpatient_allowed) / count(1) as outpatient_allowed\n  , sum(office_based_allowed) / count(1) as office_based_allowed\n  , sum(ancillary_allowed) / count(1) as ancillary_allowed\n  , sum(other_allowed) / count(1) as other_allowed\n  , sum(pharmacy_allowed) / count(1) as pharmacy_allowed\n  , sum(acute_inpatient_allowed) / count(1) as acute_inpatient_allowed\n  , sum(ambulance_allowed) / count(1) as ambulance_allowed\n  , sum(ambulatory_surgery_center_allowed) / count(1) as ambulatory_surgery_center_allowed\n  , sum(dialysis_allowed) / count(1) as dialysis_allowed\n  , sum(durable_medical_equipment_allowed) / count(1) as durable_medical_equipment_allowed\n  , sum(emergency_department_allowed) / count(1) as emergency_department_allowed\n  , sum(home_health_allowed) / count(1) as home_health_allowed\n  , sum(inpatient_hospice_allowed) / count(1) as inpatient_hospice_allowed\n  , sum(inpatient_psychiatric_allowed) / count(1) as inpatient_psychiatric_allowed\n  , sum(inpatient_rehabilitation_allowed) / count(1) as inpatient_rehabilitation_allowed\n  , sum(lab_allowed) / count(1) as lab_allowed\n  , sum(observation_allowed) / count(1) as observation_allowed\n  , sum(office_based_other_allowed) / count(1) as office_based_other_allowed\n  , sum(office_based_pt_ot_st_allowed) / count(1) as office_based_pt_ot_st_allowed\n  , sum(office_based_radiology_allowed) / count(1) as office_based_radiology_allowed\n  , sum(office_based_surgery_allowed) / count(1) as office_based_surgery_allowed\n  , sum(office_based_visit_allowed) / count(1) as office_based_visit_allowed\n  , sum(outpatient_hospital_or_clinic_allowed) / count(1) as outpatient_hospital_or_clinic_allowed\n  , sum(outpatient_pt_ot_st_allowed) / count(1) as outpatient_pt_ot_st_allowed\n  , sum(outpatient_psychiatric_allowed) / count(1) as outpatient_psychiatric_allowed\n  , sum(outpatient_radiology_allowed) / count(1) as outpatient_radiology_allowed\n  , sum(outpatient_rehabilitation_allowed) / count(1) as outpatient_rehabilitation_allowed\n  , sum(outpatient_surgery_allowed) / count(1) as outpatient_surgery_allowed\n  , sum(skilled_nursing_allowed) / count(1) as skilled_nursing_allowed\n  , sum(telehealth_visit_allowed) / count(1) as telehealth_visit_allowed\n  , sum(urgent_care_allowed) / count(1) as urgent_care_allowed\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.financial_pmpm.pmpm_prep a\ngroup by\n  year_month\n, payer\n, data_source", "relation_name": "tuva.financial_pmpm.pmpm_payer"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.649094Z", "completed_at": "2025-02-25T21:26:27.654053Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.654309Z", "completed_at": "2025-02-25T21:26:27.654318Z"}], "thread_id": "Thread-1", "execution_time": 0.00612187385559082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.financial_pmpm__pmpm_payer_plan", "compiled": true, "compiled_code": "\n\nselect\n    year_month\n  , payer\n  , plan\n  , data_source\n  , count(1) as member_months\n  , sum(total_paid) / count(1) as total_paid\n  , sum(medical_paid) / count(1) as medical_paid\n  , sum(inpatient_paid) / count(1) as inpatient_paid\n  , sum(outpatient_paid) / count(1) as outpatient_paid\n  , sum(office_based_paid) / count(1) as office_based_paid\n  , sum(ancillary_paid) / count(1) as ancillary_paid\n  , sum(other_paid) / count(1) as other_paid\n  , sum(pharmacy_paid) / count(1) as pharmacy_paid\n  , sum(acute_inpatient_paid) / count(1) as acute_inpatient_paid\n  , sum(ambulance_paid) / count(1) as ambulance_paid\n  , sum(ambulatory_surgery_center_paid) / count(1) as ambulatory_surgery_center_paid\n  , sum(dialysis_paid) / count(1) as dialysis_paid\n  , sum(durable_medical_equipment_paid) / count(1) as durable_medical_equipment_paid\n  , sum(emergency_department_paid) / count(1) as emergency_department_paid\n  , sum(home_health_paid) / count(1) as home_health_paid\n  , sum(inpatient_hospice_paid) / count(1) as inpatient_hospice_paid\n  , sum(inpatient_psychiatric_paid) / count(1) as inpatient_psychiatric_paid\n  , sum(inpatient_rehabilitation_paid) / count(1) as inpatient_rehabilitation_paid\n  , sum(lab_paid) / count(1) as lab_paid\n  , sum(observation_paid) / count(1) as observation_paid\n  , sum(office_based_other_paid) / count(1) as office_based_other_paid\n  , sum(office_based_pt_ot_st_paid) / count(1) as office_based_pt_ot_st_paid\n  , sum(office_based_radiology_paid) / count(1) as office_based_radiology_paid\n  , sum(office_based_surgery_paid) / count(1) as office_based_surgery_paid\n  , sum(office_based_visit_paid) / count(1) as office_based_visit_paid\n  , sum(outpatient_hospital_or_clinic_paid) / count(1) as outpatient_hospital_or_clinic_paid\n  , sum(outpatient_pt_ot_st_paid) / count(1) as outpatient_pt_ot_st_paid\n  , sum(outpatient_psychiatric_paid) / count(1) as outpatient_psychiatric_paid\n  , sum(outpatient_radiology_paid) / count(1) as outpatient_radiology_paid\n  , sum(outpatient_rehabilitation_paid) / count(1) as outpatient_rehabilitation_paid\n  , sum(outpatient_surgery_paid) / count(1) as outpatient_surgery_paid\n  , sum(skilled_nursing_paid) / count(1) as skilled_nursing_paid\n  , sum(telehealth_visit_paid) / count(1) as telehealth_visit_paid\n  , sum(urgent_care_paid) / count(1) as urgent_care_paid\n  , sum(total_allowed) / count(1) as total_allowed\n  , sum(medical_allowed) / count(1) as medical_allowed\n  , sum(inpatient_allowed) / count(1) as inpatient_allowed\n  , sum(outpatient_allowed) / count(1) as outpatient_allowed\n  , sum(office_based_allowed) / count(1) as office_based_allowed\n  , sum(ancillary_allowed) / count(1) as ancillary_allowed\n  , sum(other_allowed) / count(1) as other_allowed\n  , sum(pharmacy_allowed) / count(1) as pharmacy_allowed\n  , sum(acute_inpatient_allowed) / count(1) as acute_inpatient_allowed\n  , sum(ambulance_allowed) / count(1) as ambulance_allowed\n  , sum(ambulatory_surgery_center_allowed) / count(1) as ambulatory_surgery_center_allowed\n  , sum(dialysis_allowed) / count(1) as dialysis_allowed\n  , sum(durable_medical_equipment_allowed) / count(1) as durable_medical_equipment_allowed\n  , sum(emergency_department_allowed) / count(1) as emergency_department_allowed\n  , sum(home_health_allowed) / count(1) as home_health_allowed\n  , sum(inpatient_hospice_allowed) / count(1) as inpatient_hospice_allowed\n  , sum(inpatient_psychiatric_allowed) / count(1) as inpatient_psychiatric_allowed\n  , sum(inpatient_rehabilitation_allowed) / count(1) as inpatient_rehabilitation_allowed\n  , sum(lab_allowed) / count(1) as lab_allowed\n  , sum(observation_allowed) / count(1) as observation_allowed\n  , sum(office_based_other_allowed) / count(1) as office_based_other_allowed\n  , sum(office_based_pt_ot_st_allowed) / count(1) as office_based_pt_ot_st_allowed\n  , sum(office_based_radiology_allowed) / count(1) as office_based_radiology_allowed\n  , sum(office_based_surgery_allowed) / count(1) as office_based_surgery_allowed\n  , sum(office_based_visit_allowed) / count(1) as office_based_visit_allowed\n  , sum(outpatient_hospital_or_clinic_allowed) / count(1) as outpatient_hospital_or_clinic_allowed\n  , sum(outpatient_pt_ot_st_allowed) / count(1) as outpatient_pt_ot_st_allowed\n  , sum(outpatient_psychiatric_allowed) / count(1) as outpatient_psychiatric_allowed\n  , sum(outpatient_radiology_allowed) / count(1) as outpatient_radiology_allowed\n  , sum(outpatient_rehabilitation_allowed) / count(1) as outpatient_rehabilitation_allowed\n  , sum(outpatient_surgery_allowed) / count(1) as outpatient_surgery_allowed\n  , sum(skilled_nursing_allowed) / count(1) as skilled_nursing_allowed\n  , sum(telehealth_visit_allowed) / count(1) as telehealth_visit_allowed\n  , sum(urgent_care_allowed) / count(1) as urgent_care_allowed\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.financial_pmpm.pmpm_prep a\ngroup by\n    year_month\n  , payer\n  , plan\n  , data_source", "relation_name": "tuva.financial_pmpm.pmpm_payer_plan"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.655755Z", "completed_at": "2025-02-25T21:26:27.659510Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.659751Z", "completed_at": "2025-02-25T21:26:27.659758Z"}], "thread_id": "Thread-1", "execution_time": 0.0047149658203125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.mart_review__member_months", "compiled": true, "compiled_code": "\n\nSELECT m.*,\n    COALESCE(p.total_paid, 0) AS total_paid,\n    COALESCE(p.medical_paid, 0) AS medical_paid,\n    COALESCE(p.pharmacy_paid, 0) AS pharmacy_paid,\n    m.person_id || '|' || m.data_source AS patient_data_source_key\nFROM tuva.core.member_months m\nLEFT JOIN tuva.financial_pmpm.pmpm_prep p ON m.person_id = p.person_id\n    AND m.data_source = p.data_source\n    AND m.year_month = p.year_month\n    AND m.payer = p.payer\n    AND m.plan = p.plan", "relation_name": "tuva.data_quality.mart_review__member_months"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.660913Z", "completed_at": "2025-02-25T21:26:27.664986Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.665230Z", "completed_at": "2025-02-25T21:26:27.665235Z"}], "thread_id": "Thread-1", "execution_time": 0.004866123199462891, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.dbt_utils_unique_combination_of_columns_financial_pmpm__pmpm_prep_person_id__year_month___quote_column_plan_.04bf3438ec", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        person_id, year_month, plan\n    from tuva.financial_pmpm.pmpm_prep\n    group by person_id, year_month, plan\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.666314Z", "completed_at": "2025-02-25T21:26:27.671252Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.671486Z", "completed_at": "2025-02-25T21:26:27.671491Z"}], "thread_id": "Thread-1", "execution_time": 0.005677938461303711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.hcc_suspecting__list_rollup", "compiled": true, "compiled_code": "\n\nwith list as (\n\n    select\n          person_id\n        , data_source\n        , hcc_code\n        , hcc_description\n        , reason\n        , contributing_factor\n        , suspect_date\n        , row_number() over (\n            partition by\n                  person_id\n                , hcc_code\n            order by suspect_date desc\n          ) as row_num\n    from tuva.hcc_suspecting.list\n\n)\n\n, list_dedupe as (\n\n    select\n          person_id\n        , hcc_code\n        , hcc_description\n        , reason\n        , contributing_factor\n        , suspect_date as latest_suspect_date\n    from list\n    where row_num = 1\n\n)\n\n, add_data_types as (\n\n    select\n          cast(person_id as TEXT) as person_id\n        , cast(hcc_code as TEXT) as hcc_code\n        , cast(hcc_description as TEXT) as hcc_description\n        , cast(reason as TEXT) as reason\n        , cast(contributing_factor as TEXT) as contributing_factor\n        , cast(latest_suspect_date as date) as latest_suspect_date\n    from list_dedupe\n\n)\n\nselect\n      person_id\n    , hcc_code\n    , hcc_description\n    , reason\n    , contributing_factor\n    , latest_suspect_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.hcc_suspecting.list_rollup"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.672581Z", "completed_at": "2025-02-25T21:26:27.773698Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.774359Z", "completed_at": "2025-02-25T21:26:27.774368Z"}], "thread_id": "Thread-1", "execution_time": 0.10230112075805664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.hcc_suspecting__summary", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte___stg_patient as (\n\nselect\n      person_id\n    , sex\n    , birth_date\n    , death_date\nfrom tuva.core.patient\n), patients as (\n\n    select\n          person_id\n        , sex\n        , birth_date\n        \n            , floor(datediff(\n        hour,\n        birth_date,\n        current_date\n        ) / 8766.0) as age\n        \n    from __dbt__cte___stg_patient\n    where death_date is null\n\n)\n\n, suspecting_list as (\n\n      select\n          person_id\n        , count(*) as gaps\n    from tuva.hcc_suspecting.list\n    group by person_id\n\n)\n\n, joined as (\n\n    select\n          patients.person_id\n        , patients.sex\n        , patients.birth_date\n        , patients.age\n        , suspecting_list.gaps\n    from patients\n         inner join suspecting_list\n         on patients.person_id = suspecting_list.person_id\n\n)\n\n, add_data_types as (\n\n    select\n          cast(person_id as TEXT) as person_id\n        , cast(sex as TEXT) as patient_sex\n        , cast(birth_date as date) as patient_birth_date\n        , cast(age as integer) as patient_age\n        , cast(gaps as integer) as suspecting_gaps\n    from joined\n\n)\n\nselect\n      person_id\n    , patient_sex\n    , patient_birth_date\n    , patient_age\n    , suspecting_gaps\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.hcc_suspecting.summary"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.778581Z", "completed_at": "2025-02-25T21:26:27.783807Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.784031Z", "completed_at": "2025-02-25T21:26:27.784037Z"}], "thread_id": "Thread-1", "execution_time": 0.006588935852050781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.cms_hcc__int_disabled_interaction_factors", "compiled": true, "compiled_code": "\n\nwith demographics as (\n\n    select\n          person_id\n        , enrollment_status\n        , institutional_status\n        , model_version\n        , payment_year\n        , collection_start_date\n        , collection_end_date\n    from tuva.cms_hcc._int_demographic_factors\n\n)\n\n, hcc_hierarchy as (\n\n    select\n          person_id\n        , hcc_code\n        , model_version\n        , payment_year\n        , collection_start_date\n        , collection_end_date\n    from tuva.cms_hcc._int_hcc_hierarchy\n\n)\n\n, seed_interaction_factors as (\n\n    select\n          model_version\n        , factor_type\n        , enrollment_status\n        , institutional_status\n        , short_name\n        , description\n        , hcc_code\n        , coefficient\n    from tuva.cms_hcc._value_set_disabled_interaction_factors\n\n)\n\n, demographics_with_hccs as (\n\n    select\n          demographics.person_id\n        , demographics.enrollment_status\n        , demographics.institutional_status\n        , demographics.model_version\n        , demographics.payment_year\n        , demographics.collection_start_date\n        , demographics.collection_end_date\n        , hcc_hierarchy.hcc_code\n    from demographics\n        inner join hcc_hierarchy\n            on demographics.person_id = hcc_hierarchy.person_id\n            and demographics.model_version = hcc_hierarchy.model_version\n            and demographics.payment_year = hcc_hierarchy.payment_year\n            and demographics.collection_end_date = hcc_hierarchy.collection_end_date\n\n)\n\n, interactions as (\n\n    select\n          demographics_with_hccs.person_id\n        , demographics_with_hccs.model_version\n        , demographics_with_hccs.payment_year\n        , demographics_with_hccs.collection_start_date\n        , demographics_with_hccs.collection_end_date\n        , seed_interaction_factors.factor_type\n        , seed_interaction_factors.description\n        , seed_interaction_factors.coefficient\n    from demographics_with_hccs\n        inner join seed_interaction_factors\n            on demographics_with_hccs.enrollment_status = seed_interaction_factors.enrollment_status\n            and demographics_with_hccs.institutional_status = seed_interaction_factors.institutional_status\n            and demographics_with_hccs.hcc_code = seed_interaction_factors.hcc_code\n            and demographics_with_hccs.model_version = seed_interaction_factors.model_version\n\n)\n\n, add_data_types as (\n\nselect\n      cast(person_id as TEXT) as person_id\n    , cast(description as TEXT) as description\n    , round(cast(coefficient as numeric(28,6)),3) as coefficient\n    , cast(factor_type as TEXT) as factor_type\n    , cast(model_version as TEXT) as model_version\n    , cast(payment_year as integer) as payment_year\n    , cast(collection_start_date as date) as collection_start_date\n    , cast(collection_end_date as date) as collection_end_date\nfrom interactions\n\n)\n\nselect\n      person_id\n    , description\n    , coefficient\n    , factor_type\n    , model_version\n    , payment_year\n    , collection_start_date\n    , collection_end_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.cms_hcc._int_disabled_interaction_factors"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.785083Z", "completed_at": "2025-02-25T21:26:27.790351Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.790614Z", "completed_at": "2025-02-25T21:26:27.790619Z"}], "thread_id": "Thread-1", "execution_time": 0.006067752838134766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.cms_hcc__int_disease_factors", "compiled": true, "compiled_code": "\n\nwith demographics as (\n\n    select\n          person_id\n        , enrollment_status\n        , gender\n        , age_group\n        , medicaid_status\n        , dual_status\n        , orec\n        , institutional_status\n        , model_version\n        , payment_year\n        , collection_start_date\n        , collection_end_date\n    from tuva.cms_hcc._int_demographic_factors\n\n)\n\n, hcc_hierarchy as (\n\n    select\n          person_id\n        , hcc_code\n        , model_version\n        , payment_year\n        , collection_start_date\n        , collection_end_date\n    from tuva.cms_hcc._int_hcc_hierarchy\n\n)\n\n, seed_disease_factors as (\n\n    select\n          model_version\n        , factor_type\n        , enrollment_status\n        , medicaid_status\n        , dual_status\n        , orec\n        , institutional_status\n        , hcc_code\n        , description\n        , coefficient\n    from tuva.cms_hcc._value_set_disease_factors\n\n)\n\n, demographics_with_hccs as (\n\n    select\n          demographics.person_id\n        , demographics.enrollment_status\n        , demographics.gender\n        , demographics.age_group\n        , demographics.medicaid_status\n        , demographics.dual_status\n        , demographics.orec\n        , demographics.institutional_status\n        , demographics.model_version\n        , demographics.payment_year\n        , demographics.collection_start_date\n        , demographics.collection_end_date\n        , hcc_hierarchy.hcc_code\n    from demographics\n        inner join hcc_hierarchy\n            on demographics.person_id = hcc_hierarchy.person_id\n            and demographics.model_version = hcc_hierarchy.model_version\n            and demographics.payment_year = hcc_hierarchy.payment_year\n            and demographics.collection_end_date = hcc_hierarchy.collection_end_date\n\n)\n\n, disease_factors as (\n\n    select\n          demographics_with_hccs.person_id\n        , demographics_with_hccs.hcc_code\n        , demographics_with_hccs.model_version\n        , demographics_with_hccs.payment_year\n        , demographics_with_hccs.collection_start_date\n        , demographics_with_hccs.collection_end_date\n        , seed_disease_factors.factor_type\n        , seed_disease_factors.description\n        , seed_disease_factors.coefficient\n    from demographics_with_hccs\n        inner join seed_disease_factors\n            on demographics_with_hccs.enrollment_status = seed_disease_factors.enrollment_status\n            and demographics_with_hccs.medicaid_status = seed_disease_factors.medicaid_status\n            and demographics_with_hccs.dual_status = seed_disease_factors.dual_status\n            and demographics_with_hccs.orec = seed_disease_factors.orec\n            and demographics_with_hccs.institutional_status = seed_disease_factors.institutional_status\n            and demographics_with_hccs.hcc_code = seed_disease_factors.hcc_code\n            and demographics_with_hccs.model_version = seed_disease_factors.model_version\n\n)\n\n, add_data_types as (\n\n    select\n          cast(person_id as TEXT) as person_id\n        , cast(hcc_code as TEXT) as hcc_code\n        , cast(description as TEXT) as hcc_description\n        , round(cast(coefficient as numeric(28,6)),3) as coefficient\n        , cast(factor_type as TEXT) as factor_type\n        , cast(model_version as TEXT) as model_version\n        , cast(payment_year as integer) as payment_year\n        , cast(collection_start_date as date) as collection_start_date\n        , cast(collection_end_date as date) as collection_end_date\n    from disease_factors\n\n)\n\nselect\n      person_id\n    , hcc_code\n    , hcc_description\n    , coefficient\n    , factor_type\n    , model_version\n    , payment_year\n    , collection_start_date\n    , collection_end_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.cms_hcc._int_disease_factors"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.791654Z", "completed_at": "2025-02-25T21:26:27.797831Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.798052Z", "completed_at": "2025-02-25T21:26:27.798057Z"}], "thread_id": "Thread-1", "execution_time": 0.006882905960083008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.cms_hcc__int_disease_interaction_factors", "compiled": true, "compiled_code": "\n\nwith demographics as (\n\n    select\n          person_id\n        , enrollment_status\n        , gender\n        , age_group\n        , medicaid_status\n        , dual_status\n        , orec\n        , institutional_status\n        , model_version\n        , payment_year\n        , collection_start_date\n        , collection_end_date\n    from tuva.cms_hcc._int_demographic_factors\n\n)\n\n, hcc_hierarchy as (\n\n    select\n          person_id\n        , hcc_code\n        , model_version\n        , payment_year\n        , collection_start_date\n        , collection_end_date\n    from tuva.cms_hcc._int_hcc_hierarchy\n\n)\n\n, seed_interaction_factors as (\n\n    select\n          model_version\n        , factor_type\n        , enrollment_status\n        , medicaid_status\n        , dual_status\n        , orec\n        , institutional_status\n        , short_name\n        , description\n        , hcc_code_1\n        , hcc_code_2\n        , coefficient\n    from tuva.cms_hcc._value_set_disease_interaction_factors\n\n)\n\n, demographics_with_hccs as (\n\n    select\n          demographics.person_id\n        , demographics.enrollment_status\n        , demographics.medicaid_status\n        , demographics.dual_status\n        , demographics.orec\n        , demographics.institutional_status\n        , demographics.model_version\n        , demographics.payment_year\n        , demographics.collection_start_date\n        , demographics.collection_end_date\n        , hcc_hierarchy.hcc_code\n    from demographics\n        inner join hcc_hierarchy\n            on demographics.person_id = hcc_hierarchy.person_id\n            and demographics.model_version = hcc_hierarchy.model_version\n            and demographics.payment_year = hcc_hierarchy.payment_year\n            and demographics.collection_end_date = hcc_hierarchy.collection_end_date\n\n)\n\n, demographics_with_interactions as (\n\n    select\n          demographics_with_hccs.person_id\n        , demographics_with_hccs.model_version\n        , demographics_with_hccs.payment_year\n        , demographics_with_hccs.collection_start_date\n        , demographics_with_hccs.collection_end_date\n        , interactions_code_1.factor_type\n        , interactions_code_1.description\n        , interactions_code_1.hcc_code_1\n        , interactions_code_1.hcc_code_2\n        , interactions_code_1.coefficient\n    from demographics_with_hccs\n        inner join seed_interaction_factors as interactions_code_1\n            on demographics_with_hccs.enrollment_status = interactions_code_1.enrollment_status\n            and demographics_with_hccs.medicaid_status = interactions_code_1.medicaid_status\n            and demographics_with_hccs.dual_status = interactions_code_1.dual_status\n            and demographics_with_hccs.orec = interactions_code_1.orec\n            and demographics_with_hccs.institutional_status = interactions_code_1.institutional_status\n            and demographics_with_hccs.hcc_code = interactions_code_1.hcc_code_1\n            and demographics_with_hccs.model_version = interactions_code_1.model_version\n\n)\n\n, disease_interactions as (\n\n    select\n          demographics_with_interactions.person_id\n        , demographics_with_interactions.factor_type\n        , demographics_with_interactions.hcc_code_1\n        , demographics_with_interactions.hcc_code_2\n        , demographics_with_interactions.description\n        , demographics_with_interactions.coefficient\n        , demographics_with_interactions.model_version\n        , demographics_with_interactions.payment_year\n        , demographics_with_interactions.collection_start_date\n        , demographics_with_interactions.collection_end_date\n    from demographics_with_interactions\n        inner join demographics_with_hccs as interactions_code_2\n            on demographics_with_interactions.person_id = interactions_code_2.person_id\n            and demographics_with_interactions.hcc_code_2 = interactions_code_2.hcc_code\n            and demographics_with_interactions.model_version = interactions_code_2.model_version\n            and demographics_with_interactions.payment_year = interactions_code_2.payment_year\n            and demographics_with_interactions.collection_end_date = interactions_code_2.collection_end_date\n)\n\n, add_data_types as (\n\n    select\n          cast(person_id as TEXT) as person_id\n        , cast(hcc_code_1 as TEXT) as hcc_code_1\n        , cast(hcc_code_2 as TEXT) as hcc_code_2\n        , cast(description as TEXT) as description\n        , round(cast(coefficient as numeric(28,6)),3) as coefficient\n        , cast(factor_type as TEXT) as factor_type\n        , cast(model_version as TEXT) as model_version\n        , cast(payment_year as integer) as payment_year\n        , cast(collection_start_date as date) as collection_start_date\n        , cast(collection_end_date as date) as collection_end_date\n    from disease_interactions\n\n)\n\nselect\n      person_id\n    , hcc_code_1\n    , hcc_code_2\n    , description\n    , coefficient\n    , factor_type\n    , model_version\n    , payment_year\n    , collection_start_date\n    , collection_end_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.cms_hcc._int_disease_interaction_factors"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.799128Z", "completed_at": "2025-02-25T21:26:27.804683Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.804922Z", "completed_at": "2025-02-25T21:26:27.804929Z"}], "thread_id": "Thread-1", "execution_time": 0.0063169002532958984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.cms_hcc__int_hcc_count_factors", "compiled": true, "compiled_code": "\n\nwith demographics as (\n\n    select\n          person_id\n        , enrollment_status\n        , medicaid_status\n        , dual_status\n        , orec\n        , institutional_status\n        , model_version\n        , payment_year\n        , collection_start_date\n        , collection_end_date\n    from tuva.cms_hcc._int_demographic_factors\n\n)\n\n, seed_payment_hcc_count_factors as (\n\n    select\n          model_version\n        , factor_type\n        , enrollment_status\n        , medicaid_status\n        , dual_status\n        , orec\n        , institutional_status\n        , payment_hcc_count\n        , description\n        , coefficient\n    from tuva.cms_hcc._value_set_payment_hcc_count_factors\n\n)\n\n, hcc_hierarchy as (\n\n    select\n          person_id\n        , hcc_code\n        , model_version\n        , payment_year\n        , collection_start_date\n        , collection_end_date\n    from tuva.cms_hcc._int_hcc_hierarchy\n\n)\n\n, demographics_with_hcc_counts as (\n\n    select\n          demographics.person_id\n        , demographics.enrollment_status\n        , demographics.medicaid_status\n        , demographics.dual_status\n        , demographics.orec\n        , demographics.institutional_status\n        , demographics.model_version\n        , demographics.payment_year\n        , demographics.collection_start_date\n        , demographics.collection_end_date\n        , count(hcc_hierarchy.hcc_code) as hcc_count\n    from demographics\n        inner join hcc_hierarchy\n            on demographics.person_id = hcc_hierarchy.person_id\n            and demographics.model_version = hcc_hierarchy.model_version\n            and demographics.payment_year = hcc_hierarchy.payment_year\n            and demographics.collection_end_date = hcc_hierarchy.collection_end_date\n    group by\n          demographics.person_id\n        , demographics.enrollment_status\n        , demographics.medicaid_status\n        , demographics.dual_status\n        , demographics.orec\n        , demographics.institutional_status\n        , demographics.model_version\n        , demographics.payment_year\n        , demographics.collection_start_date\n        , demographics.collection_end_date\n\n)\n\n, hcc_counts_normalized as (\n\n    select\n          person_id\n        , enrollment_status\n        , medicaid_status\n        , dual_status\n        , orec\n        , institutional_status\n        , model_version\n        , payment_year\n        , collection_start_date\n        , collection_end_date\n        , case\n            when hcc_count >= 10 then '>=10'\n            else cast(hcc_count as TEXT)\n          end as hcc_count_string\n    from demographics_with_hcc_counts\n\n)\n\n, hcc_counts as (\n\n    select\n          hcc_counts_normalized.person_id\n        , hcc_counts_normalized.model_version\n        , hcc_counts_normalized.payment_year\n        , hcc_counts_normalized.collection_start_date\n        , hcc_counts_normalized.collection_end_date\n        , seed_payment_hcc_count_factors.factor_type\n        , seed_payment_hcc_count_factors.description\n        , seed_payment_hcc_count_factors.coefficient\n    from hcc_counts_normalized\n        inner join seed_payment_hcc_count_factors\n            on hcc_counts_normalized.enrollment_status = seed_payment_hcc_count_factors.enrollment_status\n            and hcc_counts_normalized.medicaid_status = seed_payment_hcc_count_factors.medicaid_status\n            and hcc_counts_normalized.dual_status = seed_payment_hcc_count_factors.dual_status\n            and hcc_counts_normalized.orec = seed_payment_hcc_count_factors.orec\n            and hcc_counts_normalized.institutional_status = seed_payment_hcc_count_factors.institutional_status\n            and hcc_counts_normalized.hcc_count_string = seed_payment_hcc_count_factors.payment_hcc_count\n            and hcc_counts_normalized.model_version = seed_payment_hcc_count_factors.model_version\n\n)\n\n, add_data_types as (\n\n    select\n          cast(person_id as TEXT) as person_id\n        , cast(description as TEXT) as description\n        , round(cast(coefficient as numeric(28,6)),3) as coefficient\n        , cast(factor_type as TEXT) as factor_type\n        , cast(model_version as TEXT) as model_version\n        , cast(payment_year as integer) as payment_year\n        , cast(collection_start_date as date) as collection_start_date\n        , cast(collection_end_date as date) as collection_end_date\n    from hcc_counts\n\n)\n\nselect\n      person_id\n    , description\n    , coefficient\n    , factor_type\n    , model_version\n    , payment_year\n    , collection_start_date\n    , collection_end_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.cms_hcc._int_hcc_count_factors"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.806182Z", "completed_at": "2025-02-25T21:26:27.809662Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.809890Z", "completed_at": "2025-02-25T21:26:27.809896Z"}], "thread_id": "Thread-1", "execution_time": 0.004369974136352539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.mart_review__pmpm", "compiled": true, "compiled_code": "\n\n\nSELECT *,\n       total_paid * member_months AS total_paid_absolute,\n       medical_paid * member_months AS medical_paid_absolute,\n       pharmacy_paid * member_months AS pharmacy_paid_absolute,\n       inpatient_paid * member_months AS inpatient_paid_absolute,\n       outpatient_paid * member_months AS outpatient_paid_absolute,\n       office_based_paid * member_months AS office_based_paid_absolute,\n       ancillary_paid * member_months AS ancillary_paid_absolute,\n       other_paid * member_months AS other_paid_absolute,\n        data_source || '|' || year_month as data_source_month_key\nFROM tuva.financial_pmpm.pmpm_payer", "relation_name": "tuva.data_quality.mart_review__pmpm"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.811141Z", "completed_at": "2025-02-25T21:26:27.818487Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.818728Z", "completed_at": "2025-02-25T21:26:27.818735Z"}], "thread_id": "Thread-1", "execution_time": 0.008163928985595703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.cms_hcc__patient_risk_factors_monthly", "compiled": true, "compiled_code": "\nwith demographic_factors as (\n\n    select\n          person_id\n        /* concatenate demographic risk factors */\n\n    , gender || ', ' || age_group || ' Years' || ', ' || enrollment_status || ' Enrollee' || ', ' || CASE   WHEN medicaid_status = 'Yes' THEN 'Medicaid'   ELSE 'Non-Medicaid' END || ', ' || dual_status || ' Dual' || ', ' || orec || ', ' || CASE   WHEN institutional_status = 'Yes' THEN 'Institutional'   ELSE 'Non-Institutional' END as description\n\n        , coefficient\n        , factor_type\n        , model_version\n        , payment_year\n        , collection_start_date\n        , collection_end_date\n    from tuva.cms_hcc._int_demographic_factors\n\n)\n\n, demographic_defaults as (\n\n    select\n          person_id\n        , model_version\n        , enrollment_status_default\n        , medicaid_dual_status_default\n        , orec_default\n        , institutional_status_default\n        , payment_year\n        , collection_start_date\n        , collection_end_date\n    from tuva.cms_hcc._int_demographic_factors\n\n)\n\n, disease_factors as (\n\n    select\n          person_id\n        , hcc_description || ' (HCC ' || hcc_code || ')' as description\n        , coefficient\n        , factor_type\n        , model_version\n        , payment_year\n        , collection_start_date\n        , collection_end_date\n    from tuva.cms_hcc._int_disease_factors\n\n)\n\n, enrollment_interactions as (\n\n    select\n          person_id\n        , description\n        , coefficient\n        , factor_type\n        , model_version\n        , payment_year\n        , collection_start_date\n        , collection_end_date\n    from tuva.cms_hcc._int_enrollment_interaction_factors\n\n)\n\n, disabled_interactions as (\n\n    select\n          person_id\n        , description\n        , coefficient\n        , factor_type\n        , model_version\n        , payment_year\n        , collection_start_date\n        , collection_end_date\n    from tuva.cms_hcc._int_disabled_interaction_factors\n\n)\n\n, disease_interactions as (\n\n    select\n          person_id\n        , description\n        , coefficient\n        , factor_type\n        , model_version\n        , payment_year\n        , collection_start_date\n        , collection_end_date\n    from tuva.cms_hcc._int_disease_interaction_factors\n\n)\n\n, hcc_counts as (\n\n    select\n          person_id\n        , description\n        , coefficient\n        , factor_type\n        , model_version\n        , payment_year\n        , collection_start_date\n        , collection_end_date\n    from tuva.cms_hcc._int_hcc_count_factors\n\n)\n\n, unioned as (\n\n    select * from demographic_factors\n    union all\n    select * from disease_factors\n    union all\n    select * from enrollment_interactions\n    union all\n    select * from disabled_interactions\n    union all\n    select * from disease_interactions\n    union all\n    select * from hcc_counts\n\n)\n\n, add_defaults as (\n\n    select\n          unioned.person_id\n        , demographic_defaults.enrollment_status_default\n        , demographic_defaults.medicaid_dual_status_default\n        , demographic_defaults.orec_default\n        , demographic_defaults.institutional_status_default\n        , unioned.description as risk_factor_description\n        , unioned.coefficient\n        , unioned.factor_type\n        , unioned.model_version\n        , unioned.payment_year\n        , unioned.collection_start_date\n        , unioned.collection_end_date\n    from unioned\n        left join demographic_defaults\n            on unioned.person_id = demographic_defaults.person_id\n            and unioned.model_version = demographic_defaults.model_version\n            and unioned.payment_year = demographic_defaults.payment_year\n            and unioned.collection_end_date = demographic_defaults.collection_end_date\n\n)\n\n, add_data_types as (\n\n    select\n          cast(person_id as TEXT) as person_id\n        \n            , cast(enrollment_status_default as boolean) as enrollment_status_default\n            , cast(medicaid_dual_status_default as boolean) as medicaid_dual_status_default\n            , cast(orec_default as boolean) as orec_default\n            , cast(institutional_status_default as boolean) as institutional_status_default\n        \n        , cast(factor_type as TEXT) as factor_type\n        , cast(risk_factor_description as TEXT) as risk_factor_description\n        , round(cast(coefficient as numeric(28,6)),3) as coefficient\n        , cast(model_version as TEXT) as model_version\n        , cast(payment_year as integer) as payment_year\n        , cast(collection_start_date as date) as collection_start_date\n        , cast(collection_end_date as date) as collection_end_date\n    from add_defaults\n\n)\n\nselect\n      person_id\n    , enrollment_status_default\n    , medicaid_dual_status_default\n    , orec_default\n    , institutional_status_default\n    , factor_type\n    , risk_factor_description\n    , coefficient\n    , model_version\n    , payment_year\n    , collection_start_date\n    , collection_end_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.cms_hcc.patient_risk_factors_monthly"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.820003Z", "completed_at": "2025-02-25T21:26:27.823961Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.824186Z", "completed_at": "2025-02-25T21:26:27.824193Z"}], "thread_id": "Thread-1", "execution_time": 0.004742145538330078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.cms_hcc__patient_risk_factors", "compiled": true, "compiled_code": "\n\nselect\n      person_id\n    , enrollment_status_default\n    , medicaid_dual_status_default\n    , orec_default\n    , institutional_status_default\n    , factor_type\n    , risk_factor_description\n    , coefficient\n    , model_version\n    , payment_year\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.cms_hcc.patient_risk_factors_monthly", "relation_name": "tuva.cms_hcc.patient_risk_factors"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.825444Z", "completed_at": "2025-02-25T21:26:27.865484Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.865715Z", "completed_at": "2025-02-25T21:26:27.865721Z"}], "thread_id": "Thread-1", "execution_time": 0.04093790054321289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.cms_hcc__patient_risk_scores_monthly", "compiled": true, "compiled_code": "\nwith  __dbt__cte___stg_member_months as (\n\nselect\n      person_id\n    , year_month\n    , payer\n    , plan\n    , data_source\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.member_months\n), seed_adjustment_rates as (\n\n    select\n          model_version\n        , payment_year\n        , normalization_factor\n        , ma_coding_pattern_adjustment\n    from tuva.cms_hcc._value_set_adjustment_rates\n\n)\n\n, risk_factors as (\n\n    select\n          person_id\n        , coefficient\n        , model_version\n        , payment_year\n        , collection_start_date\n        , collection_end_date\n    from tuva.cms_hcc.patient_risk_factors_monthly\n\n)\n\n, member_months as (\n\n    select\n        person_id\n        , cast(\n  substr(year_month, 1, 4)\n as integer) as eligible_year\n        , COUNT(1) as member_months\n    from  __dbt__cte___stg_member_months\n    group by\n        person_id\n        , cast(\n  substr(year_month, 1, 4)\n as integer)\n)\n\n, raw_score as (\n\n    select\n          person_id\n        , sum(coefficient) as risk_score\n        , model_version\n        , payment_year\n        , collection_start_date\n        , collection_end_date\n    from risk_factors\n    group by\n          person_id\n        , model_version\n        , payment_year\n        , collection_start_date\n        , collection_end_date\n\n)\n\n/*\n    CMS Guidance for the transition from v24 to v28:\n\n    PY2024 risk scores will be blended using 67% of the risk score calculated\n    from v24 and 33% from v28.\n\n    PY2025 risk scores will be blended using 33% of the risk score calculated\n    from v24 and 67% from v28.\n\n    PY2026 risk scores will be 100% from v28.\n\n    Prior payment years will still be calculated from v24 only.\n*/\n, transition_scores as (\n\n    select\n          person_id\n        , risk_score\n        , case\n            when payment_year <= 2023 and model_version = 'CMS-HCC-V24' then risk_score\n            when payment_year = 2024 and model_version = 'CMS-HCC-V24' then risk_score * 0.67\n            when payment_year = 2025 and model_version = 'CMS-HCC-V24' then risk_score * 0.33\n            when payment_year >= 2026 and model_version = 'CMS-HCC-V24' then 0\n            end as v24_risk_score\n        , case\n            when payment_year <= 2023 and model_version = 'CMS-HCC-V28' then 0\n            when payment_year = 2024 and model_version = 'CMS-HCC-V28' then risk_score * 0.33\n            when payment_year = 2025 and model_version = 'CMS-HCC-V28' then risk_score * 0.67\n            when payment_year >= 2026 and model_version = 'CMS-HCC-V28' then risk_score\n            end as v28_risk_score\n        , model_version\n        , payment_year\n        , collection_start_date\n        , collection_end_date\n    from raw_score\n\n)\n\n/*\n    Grouping by patient to create a single row per patient.\n*/\n, transition_scores_grouped as (\n\n    select\n          person_id\n        , max(v24_risk_score) as v24_risk_score\n        , max(v28_risk_score) as v28_risk_score\n        , payment_year\n        , collection_start_date\n        , collection_end_date\n    from transition_scores\n    group by\n          person_id\n        , payment_year\n        , collection_start_date\n        , collection_end_date\n\n)\n\n, blended as (\n\n    select\n          person_id\n        , v24_risk_score\n        , v28_risk_score\n        , v24_risk_score + v28_risk_score as blended_risk_score\n        , payment_year\n        , collection_start_date\n        , collection_end_date\n    from transition_scores_grouped\n\n)\n\n, normalized as (\n\n    select\n          blended.person_id\n        , blended.v24_risk_score\n        , blended.v28_risk_score\n        , blended.blended_risk_score\n        , blended.blended_risk_score / seed_adjustment_rates.normalization_factor as normalized_risk_score\n        , blended.payment_year\n        , blended.collection_start_date\n        , blended.collection_end_date\n    from blended\n        left join seed_adjustment_rates\n            on blended.payment_year = seed_adjustment_rates.payment_year\n\n)\n\n, payment as (\n\n    select\n          normalized.person_id\n        , normalized.v24_risk_score\n        , normalized.v28_risk_score\n        , normalized.blended_risk_score\n        , normalized.normalized_risk_score\n        , normalized.normalized_risk_score * (1 - seed_adjustment_rates.ma_coding_pattern_adjustment) as payment_risk_score\n        , normalized.payment_year\n        , normalized.collection_start_date\n        , normalized.collection_end_date\n    from normalized\n        left join seed_adjustment_rates\n            on normalized.payment_year = seed_adjustment_rates.payment_year\n\n)\n\n, weighted_score as (\n\n    select\n        payment.person_id\n        , payment.v24_risk_score\n        , payment.v28_risk_score\n        , payment.blended_risk_score\n        , payment.normalized_risk_score\n        , payment.payment_risk_score\n        , member_months.member_months\n        , payment.payment_risk_score * member_months.member_months as payment_risk_score_weighted_by_months\n        , payment.payment_year\n        , payment.collection_start_date\n        , payment.collection_end_date\n    from payment\n    left join member_months\n            on payment.person_id = member_months.person_id\n            and payment.payment_year = member_months.eligible_year\n)\n\n, add_data_types as (\n\n    select\n          cast(person_id as TEXT) as person_id\n        , round(cast(v24_risk_score as numeric(28,6)),3) as v24_risk_score\n        , round(cast(v28_risk_score as numeric(28,6)),3) as v28_risk_score\n        , round(cast(blended_risk_score as numeric(28,6)),3) as blended_risk_score\n        , round(cast(normalized_risk_score as numeric(28,6)),3) as normalized_risk_score\n        , round(cast(payment_risk_score as numeric(28,6)),3) as payment_risk_score\n        , round(cast(payment_risk_score_weighted_by_months as numeric(28,6)),3) as payment_risk_score_weighted_by_months\n        , cast(member_months as integer) as member_months\n        , cast(payment_year as integer) as payment_year\n        , cast(collection_start_date as date) as collection_start_date\n        , cast(collection_end_date as date) as collection_end_date\n    from weighted_score\n\n)\n\nselect\n      person_id\n    , v24_risk_score\n    , v28_risk_score\n    , blended_risk_score\n    , normalized_risk_score\n    , payment_risk_score\n    , payment_risk_score_weighted_by_months\n    , member_months\n    , payment_year\n    , collection_start_date\n    , collection_end_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.cms_hcc.patient_risk_scores_monthly"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.866881Z", "completed_at": "2025-02-25T21:26:27.871306Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.871519Z", "completed_at": "2025-02-25T21:26:27.871524Z"}], "thread_id": "Thread-1", "execution_time": 0.005182981491088867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__cms_hcc", "compiled": true, "compiled_code": "\n\nwith cte as (\nselect max(case when factor_type = 'Demographic' then 1 else 0 end) demographic_factor\n,max(case when factor_type = 'Disease' then 1 else 0 end) as disease_factor\nfrom tuva.cms_hcc.patient_risk_factors\n)\n\nselect 'missing cms-hcc demographic factor' as data_quality_check\n,case when demographic_factor = 0 then 1 else 0 end as result_count\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom cte \n\nunion all\n\nselect 'missing cms-hcc disease factor' as data_quality_check\n,case when disease_factor = 0 then 1 else 0 end as result_count\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom cte", "relation_name": "tuva.data_quality.data_quality_cms_hcc"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.872555Z", "completed_at": "2025-02-25T21:26:27.875366Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.875577Z", "completed_at": "2025-02-25T21:26:27.875581Z"}], "thread_id": "Thread-1", "execution_time": 0.003494739532470703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.mart_review__patient_risk_factors", "compiled": true, "compiled_code": "\n\nselect *\n,dense_rank() over (order by person_id, model_version, payment_year ) as patient_risk_sk\nfrom tuva.cms_hcc.patient_risk_factors p", "relation_name": "tuva.data_quality.mart_review__patient_risk_factors"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.876934Z", "completed_at": "2025-02-25T21:26:27.882259Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.882479Z", "completed_at": "2025-02-25T21:26:27.882484Z"}], "thread_id": "Thread-1", "execution_time": 0.0062139034271240234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.cms_hcc__patient_risk_scores", "compiled": true, "compiled_code": "\n\nselect\n      person_id\n    , v24_risk_score\n    , v28_risk_score\n    , blended_risk_score\n    , normalized_risk_score\n    , payment_risk_score\n    , payment_risk_score_weighted_by_months\n    , member_months\n    , payment_year\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.cms_hcc.patient_risk_scores_monthly\nwhere collection_end_date = (\n        select max(collection_end_date)\n        from tuva.cms_hcc.patient_risk_scores_monthly\n        where payment_year = 2025\n    )", "relation_name": "tuva.cms_hcc.patient_risk_scores"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.883726Z", "completed_at": "2025-02-25T21:26:27.887111Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.887341Z", "completed_at": "2025-02-25T21:26:27.887346Z"}], "thread_id": "Thread-1", "execution_time": 0.004210948944091797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.dbt_utils_unique_combination_of_columns_cms_hcc__patient_risk_scores_monthly_person_id__payment_year__collection_end_date.47c094f8d0", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        person_id, payment_year, collection_end_date\n    from tuva.cms_hcc.patient_risk_scores_monthly\n    group by person_id, payment_year, collection_end_date\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.888383Z", "completed_at": "2025-02-25T21:26:27.891699Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.891907Z", "completed_at": "2025-02-25T21:26:27.891912Z"}], "thread_id": "Thread-1", "execution_time": 0.003999948501586914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.mart_review__patient_risk", "compiled": true, "compiled_code": "\n\n\nWITH cte AS (\n    SELECT \n        payment_year,\n        person_id,\n        model_version,\n        patient_risk_sk,\n        SUM(coefficient) AS risk_score\n    FROM tuva.data_quality.mart_review__patient_risk_factors\n    GROUP BY payment_year,\n             person_id,\n             model_version,\n             patient_risk_sk\n)\n\nSELECT \n    CASE \n        WHEN risk_score <= 0.5 THEN '.5'\n        WHEN risk_score BETWEEN 0.5 AND 1.0 THEN '1'\n        WHEN risk_score BETWEEN 1.0 AND 1.5 THEN '1.5'\n        WHEN risk_score BETWEEN 1.5 AND 2.0 THEN '2'\n        WHEN risk_score BETWEEN 2.0 AND 2.5 THEN '2.5'\n        WHEN risk_score BETWEEN 2.5 AND 3.0 THEN '3'\n        WHEN risk_score BETWEEN 3.0 AND 3.5 THEN '3.5'\n        WHEN risk_score BETWEEN 3.5 AND 4.0 THEN '4'\n        WHEN risk_score BETWEEN 4.0 AND 4.5 THEN '4.5'\n        WHEN risk_score BETWEEN 4.5 AND 5.0 THEN '5'\n        WHEN risk_score > 5.0 THEN '5+'\n        ELSE null \n        END AS risk_score_bucket,\n        payment_year,\n        person_id,\n        model_version,\n        patient_risk_sk,\n        risk_score\n        , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nFROM cte", "relation_name": "tuva.data_quality.mart_review__patient_risk"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.892920Z", "completed_at": "2025-02-25T21:26:27.896829Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.897049Z", "completed_at": "2025-02-25T21:26:27.897054Z"}], "thread_id": "Thread-1", "execution_time": 0.004603147506713867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__cms_hcc_reference", "compiled": true, "compiled_code": "\n\nwith cte as (\nselect avg(normalized_risk_score) data_source_value\n,cast('normalized risk score' as TEXT) as analytics_measure\n,cast('cms-hcc' as TEXT) as analytics_concept\nfrom tuva.cms_hcc.patient_risk_scores\n)\n\nselect \n m.analytics_concept as analytics_concept\n,m.analytics_measure as analytics_measure\n,cte.data_source_value\n,m.analytics_value\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.data_quality._value_set_reference_mart_analytics m \nleft join cte on cte.analytics_measure = m.analytics_measure\nand\nm.analytics_concept = cte.analytics_concept\nwhere m.analytics_concept = 'cms-hcc'\nand\nm.analytics_measure = 'normalized risk score'", "relation_name": "tuva.data_quality.data_quality_cms_hcc_reference"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.898093Z", "completed_at": "2025-02-25T21:26:27.900852Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.901066Z", "completed_at": "2025-02-25T21:26:27.901071Z"}], "thread_id": "Thread-1", "execution_time": 0.003465890884399414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.mart_review__patient_risk_scores", "compiled": true, "compiled_code": "\n\n\nselect *\nfrom tuva.cms_hcc.patient_risk_scores p", "relation_name": "tuva.data_quality.mart_review__patient_risk_scores"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.902106Z", "completed_at": "2025-02-25T21:26:27.906424Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:27.906647Z", "completed_at": "2025-02-25T21:26:27.906653Z"}], "thread_id": "Thread-1", "execution_time": 0.005033969879150391, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.unique_cms_hcc__patient_risk_scores_person_id.01eafaa958", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    person_id as unique_field,\n    count(*) as n_records\n\nfrom tuva.cms_hcc.patient_risk_scores\nwhere person_id is not null\ngroup by person_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:27.558293Z", "completed_at": "2025-02-25T21:26:28.421066Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:28.421369Z", "completed_at": "2025-02-25T21:26:28.421378Z"}], "thread_id": "Thread-3", "execution_time": 1.0359108448028564, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.chronic_conditions__cms_chronic_conditions_wide", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte__cms_chronic_conditions__stg_core__patient as (\n\n\nselect \n    person_id\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.patient\n), chronic_conditions as (\n\n    select distinct\n          condition\n        , condition_column_name\n    from tuva.chronic_conditions._value_set_cms_chronic_conditions_hierarchy\n\n)\n\n, conditions as (\n\n    select\n          chronic_conditions_unioned.person_id\n        , chronic_conditions.condition_column_name\n        , 1 as condition_count\n    from tuva.chronic_conditions.cms_chronic_conditions_long as chronic_conditions_unioned\n         inner join chronic_conditions as chronic_conditions\n             on chronic_conditions_unioned.condition = chronic_conditions.condition\n\n)\n\nselect\n      p.person_id\n    , \n  \n    max(\n      \n      case\n      when condition_column_name = 'acute_myocardial_infarction'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as acute_myocardial_infarction\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'adhd_conduct_disorders_and_hyperkinetic_syndrome'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as adhd_conduct_disorders_and_hyperkinetic_syndrome\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'alcohol_use_disorders'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as alcohol_use_disorders\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'alzheimers_disease'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as alzheimers_disease\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'anemia'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as anemia\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'anxiety_disorders'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as anxiety_disorders\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'asthma'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as asthma\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'atrial_fibrillation_and_flutter'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as atrial_fibrillation_and_flutter\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'autism_spectrum_disorders'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as autism_spectrum_disorders\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'benign_prostatic_hyperplasia'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as benign_prostatic_hyperplasia\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'bipolar_disorder'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as bipolar_disorder\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'cancer_breast'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as cancer_breast\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'cancer_colorectal'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as cancer_colorectal\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'cancer_endometrial'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as cancer_endometrial\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'cancer_lung'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as cancer_lung\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'cancer_prostate'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as cancer_prostate\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'cancer_urologic_kidney_renal_pelvis_and_ureter'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as cancer_urologic_kidney_renal_pelvis_and_ureter\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'cataract'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as cataract\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'cerebral_palsy'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as cerebral_palsy\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'chronic_kidney_disease'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as chronic_kidney_disease\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'chronic_obstructive_pulmonary_disease'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as chronic_obstructive_pulmonary_disease\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'cystic_fibrosis_and_other_metabolic_developmental_disorders'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as cystic_fibrosis_and_other_metabolic_developmental_disorders\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'depression_bipolar_or_other_depressive_mood_disorders'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as depression_bipolar_or_other_depressive_mood_disorders\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'depressive_disorders'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as depressive_disorders\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'diabetes'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as diabetes\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'drug_use_disorders'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as drug_use_disorders\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'epilepsy'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as epilepsy\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'fibromyalgia_and_chronic_pain_and_fatigue'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as fibromyalgia_and_chronic_pain_and_fatigue\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'glaucoma'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as glaucoma\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'heart_failure_and_non_ischemic_heart_disease'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as heart_failure_and_non_ischemic_heart_disease\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'hepatitis_a'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as hepatitis_a\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'hepatitis_b_acute_or_unspecified'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as hepatitis_b_acute_or_unspecified\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'hepatitis_b_chronic'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as hepatitis_b_chronic\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'hepatitis_c_acute'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as hepatitis_c_acute\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'hepatitis_c_chronic'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as hepatitis_c_chronic\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'hepatitis_c_unspecified'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as hepatitis_c_unspecified\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'hepatitis_d'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as hepatitis_d\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'hepatitis_e'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as hepatitis_e\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'hip_pelvic_fracture'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as hip_pelvic_fracture\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'human_immunodeficiency_virus_and_or_acquired_immunodeficiency_syndrome_hiv_aids'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as human_immunodeficiency_virus_and_or_acquired_immunodeficiency_syndrome_hiv_aids\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'hyperlipidemia'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as hyperlipidemia\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'hypertension'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as hypertension\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'hypothyroidism'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as hypothyroidism\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'intellectual_disabilities_and_related_conditions'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as intellectual_disabilities_and_related_conditions\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'ischemic_heart_disease'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as ischemic_heart_disease\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'learning_disabilities'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as learning_disabilities\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'leukemias_and_lymphomas'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as leukemias_and_lymphomas\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'liver_disease_cirrhosis_and_other_liver_conditions_except_viral_hepatitis'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as liver_disease_cirrhosis_and_other_liver_conditions_except_viral_hepatitis\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'migraine_and_chronic_headache'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as migraine_and_chronic_headache\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'mobility_impairments'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as mobility_impairments\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'multiple_sclerosis_and_transverse_myelitis'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as multiple_sclerosis_and_transverse_myelitis\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'muscular_dystrophy'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as muscular_dystrophy\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'non_alzheimers_dementia'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as non_alzheimers_dementia\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'obesity'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as obesity\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'opioid_use_disorder_oud'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as opioid_use_disorder_oud\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'osteoporosis_with_or_without_pathological_fracture'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as osteoporosis_with_or_without_pathological_fracture\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'other_developmental_delays'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as other_developmental_delays\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'parkinsons_disease_and_secondary_parkinsonism'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as parkinsons_disease_and_secondary_parkinsonism\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'peripheral_vascular_disease_pvd'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as peripheral_vascular_disease_pvd\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'personality_disorders'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as personality_disorders\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'pneumonia_all_cause'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as pneumonia_all_cause\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'post_traumatic_stress_disorder_ptsd'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as post_traumatic_stress_disorder_ptsd\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'pressure_and_chronic_ulcers'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as pressure_and_chronic_ulcers\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'rheumatoid_arthritis_osteoarthritis'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as rheumatoid_arthritis_osteoarthritis\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'schizophrenia'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as schizophrenia\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'schizophrenia_and_other_psychotic_disorders'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as schizophrenia_and_other_psychotic_disorders\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'sensory_blindness_and_visual_impairment'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as sensory_blindness_and_visual_impairment\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'sensory_deafness_and_hearing_impairment'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as sensory_deafness_and_hearing_impairment\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'sickle_cell_disease'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as sickle_cell_disease\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'spina_bifida_and_other_congenital_anomalies_of_the_nervous_system'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as spina_bifida_and_other_congenital_anomalies_of_the_nervous_system\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'spinal_cord_injury'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as spinal_cord_injury\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'stroke_transient_ischemic_attack'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as stroke_transient_ischemic_attack\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'tobacco_use'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as tobacco_use\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'traumatic_brain_injury_and_nonpsychotic_mental_disorders_due_to_brain_damage'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as traumatic_brain_injury_and_nonpsychotic_mental_disorders_due_to_brain_damage\n      \n    \n    ,\n  \n    max(\n      \n      case\n      when condition_column_name = 'viral_hepatitis_general'\n        then 1\n      else 0\n      end\n    )\n    \n      \n        as viral_hepatitis_general\n      \n    \n    \n  \n\n      , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom __dbt__cte__cms_chronic_conditions__stg_core__patient p\n     left join conditions\n        on p.person_id = conditions.person_id\ngroup by\n    p.person_id", "relation_name": "tuva.chronic_conditions.cms_chronic_conditions_wide"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:28.596005Z", "completed_at": "2025-02-25T21:26:28.605741Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:28.606320Z", "completed_at": "2025-02-25T21:26:28.606327Z"}], "thread_id": "Thread-1", "execution_time": 0.01174306869506836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.not_null_chronic_conditions__cms_chronic_conditions_wide_person_id.dc7adcca6d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect person_id\nfrom tuva.chronic_conditions.cms_chronic_conditions_wide\nwhere person_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:28.600327Z", "completed_at": "2025-02-25T21:26:28.606067Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:28.606833Z", "completed_at": "2025-02-25T21:26:28.606838Z"}], "thread_id": "Thread-3", "execution_time": 0.011848926544189453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.unique_chronic_conditions__cms_chronic_conditions_wide_person_id.2ad66674ce", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    person_id as unique_field,\n    count(*) as n_records\n\nfrom tuva.chronic_conditions.cms_chronic_conditions_wide\nwhere person_id is not null\ngroup by person_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:14.994789Z", "completed_at": "2025-02-25T21:26:30.506280Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:30.506794Z", "completed_at": "2025-02-25T21:26:30.506806Z"}], "thread_id": "Thread-4", "execution_time": 15.769548892974854, "adapter_response": {}, "message": null, "failures": null, "unique_id": "operation.the_tuva_project.the_tuva_project-on-run-end-0", "compiled": true, "compiled_code": "\n\n    \n\n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n        \n        \n        \n        \n    \n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:26.496222Z", "completed_at": "2025-02-25T21:26:31.216991Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:31.217286Z", "completed_at": "2025-02-25T21:26:31.217295Z"}], "thread_id": "Thread-2", "execution_time": 4.882389068603516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.core__stg_claims_encounter", "compiled": true, "compiled_code": "\n\n-- *************************************************\n-- This dbt model creates the encounter table in core using dbt_utils.union_relations.\n-- *************************************************\n\n\n\nWITH base AS (\n  \n\n        (\n            select\n                cast('tuva.claims_preprocessing.acute_inpatient__encounter_grain' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"ENCOUNTER_ID\" as NUMBER(18,0)) as \"ENCOUNTER_ID\" ,\n                    cast(\"ENCOUNTER_START_DATE\" as DATE) as \"ENCOUNTER_START_DATE\" ,\n                    cast(\"ENCOUNTER_END_DATE\" as DATE) as \"ENCOUNTER_END_DATE\" ,\n                    cast(\"PATIENT_DATA_SOURCE_ID\" as NUMBER(18,0)) as \"PATIENT_DATA_SOURCE_ID\" ,\n                    cast(\"ENCOUNTER_TYPE\" as character varying(29)) as \"ENCOUNTER_TYPE\" ,\n                    cast(\"ENCOUNTER_GROUP\" as character varying(12)) as \"ENCOUNTER_GROUP\" ,\n                    cast(\"ADMIT_AGE\" as NUMBER(15,6)) as \"ADMIT_AGE\" ,\n                    cast(\"GENDER\" as character varying(16777216)) as \"GENDER\" ,\n                    cast(\"RACE\" as character varying(16777216)) as \"RACE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE_TYPE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE_TYPE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_DESCRIPTION\" as character varying(256)) as \"PRIMARY_DIAGNOSIS_DESCRIPTION\" ,\n                    cast(\"FACILITY_ID\" as character varying(16777216)) as \"FACILITY_ID\" ,\n                    cast(\"OBSERVATION_FLAG\" as NUMBER(1,0)) as \"OBSERVATION_FLAG\" ,\n                    cast(\"ED_FLAG\" as NUMBER(1,0)) as \"ED_FLAG\" ,\n                    cast(\"LAB_FLAG\" as NUMBER(1,0)) as \"LAB_FLAG\" ,\n                    cast(\"DME_FLAG\" as NUMBER(1,0)) as \"DME_FLAG\" ,\n                    cast(\"AMBULANCE_FLAG\" as NUMBER(1,0)) as \"AMBULANCE_FLAG\" ,\n                    cast(\"PHARMACY_FLAG\" as NUMBER(1,0)) as \"PHARMACY_FLAG\" ,\n                    cast(\"FACILITY_NAME\" as character varying(95)) as \"FACILITY_NAME\" ,\n                    cast(\"FACILITY_TYPE\" as character varying(173)) as \"FACILITY_TYPE\" ,\n                    cast(\"DELIVERY_FLAG\" as NUMBER(1,0)) as \"DELIVERY_FLAG\" ,\n                    cast(\"DELIVERY_TYPE\" as character varying(16777216)) as \"DELIVERY_TYPE\" ,\n                    cast(\"NEWBORN_FLAG\" as NUMBER(1,0)) as \"NEWBORN_FLAG\" ,\n                    cast(\"NICU_FLAG\" as NUMBER(1,0)) as \"NICU_FLAG\" ,\n                    cast(\"DRG_CODE_TYPE\" as character varying(16777216)) as \"DRG_CODE_TYPE\" ,\n                    cast(\"DRG_CODE\" as character varying(16777216)) as \"DRG_CODE\" ,\n                    cast(\"DRG_DESCRIPTION\" as character varying(256)) as \"DRG_DESCRIPTION\" ,\n                    cast(\"MEDICAL_SURGICAL\" as character varying(256)) as \"MEDICAL_SURGICAL\" ,\n                    cast(\"ADMIT_SOURCE_CODE\" as character varying(16777216)) as \"ADMIT_SOURCE_CODE\" ,\n                    cast(\"ADMIT_SOURCE_DESCRIPTION\" as character varying(256)) as \"ADMIT_SOURCE_DESCRIPTION\" ,\n                    cast(\"ADMIT_TYPE_CODE\" as character varying(16777216)) as \"ADMIT_TYPE_CODE\" ,\n                    cast(\"ADMIT_TYPE_DESCRIPTION\" as character varying(256)) as \"ADMIT_TYPE_DESCRIPTION\" ,\n                    cast(\"DISCHARGE_DISPOSITION_CODE\" as character varying(16777216)) as \"DISCHARGE_DISPOSITION_CODE\" ,\n                    cast(\"DISCHARGE_DISPOSITION_DESCRIPTION\" as character varying(256)) as \"DISCHARGE_DISPOSITION_DESCRIPTION\" ,\n                    cast(\"TOTAL_PAID_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_PAID_AMOUNT\" ,\n                    cast(\"TOTAL_ALLOWED_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_ALLOWED_AMOUNT\" ,\n                    cast(\"TOTAL_CHARGE_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_CHARGE_AMOUNT\" ,\n                    cast(\"CLAIM_COUNT\" as NUMBER(18,0)) as \"CLAIM_COUNT\" ,\n                    cast(\"INST_CLAIM_COUNT\" as NUMBER(18,0)) as \"INST_CLAIM_COUNT\" ,\n                    cast(\"PROF_CLAIM_COUNT\" as NUMBER(18,0)) as \"PROF_CLAIM_COUNT\" ,\n                    cast(\"LENGTH_OF_STAY\" as NUMBER(9,0)) as \"LENGTH_OF_STAY\" ,\n                    cast(\"MORTALITY_FLAG\" as NUMBER(1,0)) as \"MORTALITY_FLAG\" ,\n                    cast(\"DATA_SOURCE\" as character varying(16777216)) as \"DATA_SOURCE\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as character varying(16777216)) as \"BILLING_ID\" ,\n                    cast(null as character varying(191)) as \"PROVIDER_NAME\" ,\n                    cast(null as character varying(173)) as \"PROVIDER_SPECIALTY\" ,\n                    cast(null as character varying(16777216)) as \"HCPCS_CODE\" ,\n                    cast(null as character varying(3)) as \"CCS_CATEGORY\" ,\n                    cast(null as character varying(256)) as \"CCS_CATEGORY_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"PLACE_OF_SERVICE_CODE\" ,\n                    cast(null as character varying(256)) as \"PLACE_OF_SERVICE_DESCRIPTION\" \n\n            from tuva.claims_preprocessing.acute_inpatient__encounter_grain\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing.emergency_department__encounter_grain' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"ENCOUNTER_ID\" as NUMBER(18,0)) as \"ENCOUNTER_ID\" ,\n                    cast(\"ENCOUNTER_START_DATE\" as DATE) as \"ENCOUNTER_START_DATE\" ,\n                    cast(\"ENCOUNTER_END_DATE\" as DATE) as \"ENCOUNTER_END_DATE\" ,\n                    cast(\"PATIENT_DATA_SOURCE_ID\" as NUMBER(18,0)) as \"PATIENT_DATA_SOURCE_ID\" ,\n                    cast(\"ENCOUNTER_TYPE\" as character varying(29)) as \"ENCOUNTER_TYPE\" ,\n                    cast(\"ENCOUNTER_GROUP\" as character varying(12)) as \"ENCOUNTER_GROUP\" ,\n                    cast(\"ADMIT_AGE\" as NUMBER(15,6)) as \"ADMIT_AGE\" ,\n                    cast(\"GENDER\" as character varying(16777216)) as \"GENDER\" ,\n                    cast(\"RACE\" as character varying(16777216)) as \"RACE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE_TYPE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE_TYPE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_DESCRIPTION\" as character varying(256)) as \"PRIMARY_DIAGNOSIS_DESCRIPTION\" ,\n                    cast(\"FACILITY_ID\" as character varying(16777216)) as \"FACILITY_ID\" ,\n                    cast(\"OBSERVATION_FLAG\" as NUMBER(1,0)) as \"OBSERVATION_FLAG\" ,\n                    cast(null as NUMBER(1,0)) as \"ED_FLAG\" ,\n                    cast(\"LAB_FLAG\" as NUMBER(1,0)) as \"LAB_FLAG\" ,\n                    cast(\"DME_FLAG\" as NUMBER(1,0)) as \"DME_FLAG\" ,\n                    cast(\"AMBULANCE_FLAG\" as NUMBER(1,0)) as \"AMBULANCE_FLAG\" ,\n                    cast(\"PHARMACY_FLAG\" as NUMBER(1,0)) as \"PHARMACY_FLAG\" ,\n                    cast(\"FACILITY_NAME\" as character varying(95)) as \"FACILITY_NAME\" ,\n                    cast(\"FACILITY_TYPE\" as character varying(173)) as \"FACILITY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"DELIVERY_FLAG\" ,\n                    cast(null as character varying(16777216)) as \"DELIVERY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"NEWBORN_FLAG\" ,\n                    cast(null as NUMBER(1,0)) as \"NICU_FLAG\" ,\n                    cast(\"DRG_CODE_TYPE\" as character varying(16777216)) as \"DRG_CODE_TYPE\" ,\n                    cast(\"DRG_CODE\" as character varying(16777216)) as \"DRG_CODE\" ,\n                    cast(\"DRG_DESCRIPTION\" as character varying(256)) as \"DRG_DESCRIPTION\" ,\n                    cast(\"MEDICAL_SURGICAL\" as character varying(256)) as \"MEDICAL_SURGICAL\" ,\n                    cast(\"ADMIT_SOURCE_CODE\" as character varying(16777216)) as \"ADMIT_SOURCE_CODE\" ,\n                    cast(\"ADMIT_SOURCE_DESCRIPTION\" as character varying(256)) as \"ADMIT_SOURCE_DESCRIPTION\" ,\n                    cast(\"ADMIT_TYPE_CODE\" as character varying(16777216)) as \"ADMIT_TYPE_CODE\" ,\n                    cast(\"ADMIT_TYPE_DESCRIPTION\" as character varying(256)) as \"ADMIT_TYPE_DESCRIPTION\" ,\n                    cast(\"DISCHARGE_DISPOSITION_CODE\" as character varying(16777216)) as \"DISCHARGE_DISPOSITION_CODE\" ,\n                    cast(\"DISCHARGE_DISPOSITION_DESCRIPTION\" as character varying(256)) as \"DISCHARGE_DISPOSITION_DESCRIPTION\" ,\n                    cast(\"TOTAL_PAID_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_PAID_AMOUNT\" ,\n                    cast(\"TOTAL_ALLOWED_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_ALLOWED_AMOUNT\" ,\n                    cast(\"TOTAL_CHARGE_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_CHARGE_AMOUNT\" ,\n                    cast(\"CLAIM_COUNT\" as NUMBER(18,0)) as \"CLAIM_COUNT\" ,\n                    cast(\"INST_CLAIM_COUNT\" as NUMBER(18,0)) as \"INST_CLAIM_COUNT\" ,\n                    cast(\"PROF_CLAIM_COUNT\" as NUMBER(18,0)) as \"PROF_CLAIM_COUNT\" ,\n                    cast(\"LENGTH_OF_STAY\" as NUMBER(9,0)) as \"LENGTH_OF_STAY\" ,\n                    cast(\"MORTALITY_FLAG\" as NUMBER(1,0)) as \"MORTALITY_FLAG\" ,\n                    cast(\"DATA_SOURCE\" as character varying(16777216)) as \"DATA_SOURCE\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as character varying(16777216)) as \"BILLING_ID\" ,\n                    cast(null as character varying(191)) as \"PROVIDER_NAME\" ,\n                    cast(null as character varying(173)) as \"PROVIDER_SPECIALTY\" ,\n                    cast(null as character varying(16777216)) as \"HCPCS_CODE\" ,\n                    cast(null as character varying(3)) as \"CCS_CATEGORY\" ,\n                    cast(null as character varying(256)) as \"CCS_CATEGORY_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"PLACE_OF_SERVICE_CODE\" ,\n                    cast(null as character varying(256)) as \"PLACE_OF_SERVICE_DESCRIPTION\" \n\n            from tuva.claims_preprocessing.emergency_department__encounter_grain\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing.inpatient_hospice__encounter_grain' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"ENCOUNTER_ID\" as NUMBER(18,0)) as \"ENCOUNTER_ID\" ,\n                    cast(\"ENCOUNTER_START_DATE\" as DATE) as \"ENCOUNTER_START_DATE\" ,\n                    cast(\"ENCOUNTER_END_DATE\" as DATE) as \"ENCOUNTER_END_DATE\" ,\n                    cast(\"PATIENT_DATA_SOURCE_ID\" as NUMBER(18,0)) as \"PATIENT_DATA_SOURCE_ID\" ,\n                    cast(\"ENCOUNTER_TYPE\" as character varying(29)) as \"ENCOUNTER_TYPE\" ,\n                    cast(\"ENCOUNTER_GROUP\" as character varying(12)) as \"ENCOUNTER_GROUP\" ,\n                    cast(\"ADMIT_AGE\" as NUMBER(15,6)) as \"ADMIT_AGE\" ,\n                    cast(\"GENDER\" as character varying(16777216)) as \"GENDER\" ,\n                    cast(\"RACE\" as character varying(16777216)) as \"RACE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE_TYPE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE_TYPE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_DESCRIPTION\" as character varying(256)) as \"PRIMARY_DIAGNOSIS_DESCRIPTION\" ,\n                    cast(\"FACILITY_ID\" as character varying(16777216)) as \"FACILITY_ID\" ,\n                    cast(\"OBSERVATION_FLAG\" as NUMBER(1,0)) as \"OBSERVATION_FLAG\" ,\n                    cast(\"ED_FLAG\" as NUMBER(1,0)) as \"ED_FLAG\" ,\n                    cast(\"LAB_FLAG\" as NUMBER(1,0)) as \"LAB_FLAG\" ,\n                    cast(\"DME_FLAG\" as NUMBER(1,0)) as \"DME_FLAG\" ,\n                    cast(\"AMBULANCE_FLAG\" as NUMBER(1,0)) as \"AMBULANCE_FLAG\" ,\n                    cast(\"PHARMACY_FLAG\" as NUMBER(1,0)) as \"PHARMACY_FLAG\" ,\n                    cast(\"FACILITY_NAME\" as character varying(95)) as \"FACILITY_NAME\" ,\n                    cast(\"FACILITY_TYPE\" as character varying(173)) as \"FACILITY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"DELIVERY_FLAG\" ,\n                    cast(null as character varying(16777216)) as \"DELIVERY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"NEWBORN_FLAG\" ,\n                    cast(null as NUMBER(1,0)) as \"NICU_FLAG\" ,\n                    cast(\"DRG_CODE_TYPE\" as character varying(16777216)) as \"DRG_CODE_TYPE\" ,\n                    cast(\"DRG_CODE\" as character varying(16777216)) as \"DRG_CODE\" ,\n                    cast(\"DRG_DESCRIPTION\" as character varying(256)) as \"DRG_DESCRIPTION\" ,\n                    cast(\"MEDICAL_SURGICAL\" as character varying(256)) as \"MEDICAL_SURGICAL\" ,\n                    cast(\"ADMIT_SOURCE_CODE\" as character varying(16777216)) as \"ADMIT_SOURCE_CODE\" ,\n                    cast(\"ADMIT_SOURCE_DESCRIPTION\" as character varying(256)) as \"ADMIT_SOURCE_DESCRIPTION\" ,\n                    cast(\"ADMIT_TYPE_CODE\" as character varying(16777216)) as \"ADMIT_TYPE_CODE\" ,\n                    cast(\"ADMIT_TYPE_DESCRIPTION\" as character varying(256)) as \"ADMIT_TYPE_DESCRIPTION\" ,\n                    cast(\"DISCHARGE_DISPOSITION_CODE\" as character varying(16777216)) as \"DISCHARGE_DISPOSITION_CODE\" ,\n                    cast(\"DISCHARGE_DISPOSITION_DESCRIPTION\" as character varying(256)) as \"DISCHARGE_DISPOSITION_DESCRIPTION\" ,\n                    cast(\"TOTAL_PAID_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_PAID_AMOUNT\" ,\n                    cast(\"TOTAL_ALLOWED_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_ALLOWED_AMOUNT\" ,\n                    cast(\"TOTAL_CHARGE_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_CHARGE_AMOUNT\" ,\n                    cast(\"CLAIM_COUNT\" as NUMBER(18,0)) as \"CLAIM_COUNT\" ,\n                    cast(\"INST_CLAIM_COUNT\" as NUMBER(18,0)) as \"INST_CLAIM_COUNT\" ,\n                    cast(\"PROF_CLAIM_COUNT\" as NUMBER(18,0)) as \"PROF_CLAIM_COUNT\" ,\n                    cast(\"LENGTH_OF_STAY\" as NUMBER(9,0)) as \"LENGTH_OF_STAY\" ,\n                    cast(\"MORTALITY_FLAG\" as NUMBER(1,0)) as \"MORTALITY_FLAG\" ,\n                    cast(\"DATA_SOURCE\" as character varying(16777216)) as \"DATA_SOURCE\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as character varying(16777216)) as \"BILLING_ID\" ,\n                    cast(null as character varying(191)) as \"PROVIDER_NAME\" ,\n                    cast(null as character varying(173)) as \"PROVIDER_SPECIALTY\" ,\n                    cast(null as character varying(16777216)) as \"HCPCS_CODE\" ,\n                    cast(null as character varying(3)) as \"CCS_CATEGORY\" ,\n                    cast(null as character varying(256)) as \"CCS_CATEGORY_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"PLACE_OF_SERVICE_CODE\" ,\n                    cast(null as character varying(256)) as \"PLACE_OF_SERVICE_DESCRIPTION\" \n\n            from tuva.claims_preprocessing.inpatient_hospice__encounter_grain\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing.inpatient_psych__encounter_grain' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"ENCOUNTER_ID\" as NUMBER(18,0)) as \"ENCOUNTER_ID\" ,\n                    cast(\"ENCOUNTER_START_DATE\" as DATE) as \"ENCOUNTER_START_DATE\" ,\n                    cast(\"ENCOUNTER_END_DATE\" as DATE) as \"ENCOUNTER_END_DATE\" ,\n                    cast(\"PATIENT_DATA_SOURCE_ID\" as NUMBER(18,0)) as \"PATIENT_DATA_SOURCE_ID\" ,\n                    cast(\"ENCOUNTER_TYPE\" as character varying(29)) as \"ENCOUNTER_TYPE\" ,\n                    cast(\"ENCOUNTER_GROUP\" as character varying(12)) as \"ENCOUNTER_GROUP\" ,\n                    cast(\"ADMIT_AGE\" as NUMBER(15,6)) as \"ADMIT_AGE\" ,\n                    cast(\"GENDER\" as character varying(16777216)) as \"GENDER\" ,\n                    cast(\"RACE\" as character varying(16777216)) as \"RACE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE_TYPE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE_TYPE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_DESCRIPTION\" as character varying(256)) as \"PRIMARY_DIAGNOSIS_DESCRIPTION\" ,\n                    cast(\"FACILITY_ID\" as character varying(16777216)) as \"FACILITY_ID\" ,\n                    cast(\"OBSERVATION_FLAG\" as NUMBER(1,0)) as \"OBSERVATION_FLAG\" ,\n                    cast(\"ED_FLAG\" as NUMBER(1,0)) as \"ED_FLAG\" ,\n                    cast(\"LAB_FLAG\" as NUMBER(1,0)) as \"LAB_FLAG\" ,\n                    cast(\"DME_FLAG\" as NUMBER(1,0)) as \"DME_FLAG\" ,\n                    cast(\"AMBULANCE_FLAG\" as NUMBER(1,0)) as \"AMBULANCE_FLAG\" ,\n                    cast(\"PHARMACY_FLAG\" as NUMBER(1,0)) as \"PHARMACY_FLAG\" ,\n                    cast(\"FACILITY_NAME\" as character varying(95)) as \"FACILITY_NAME\" ,\n                    cast(\"FACILITY_TYPE\" as character varying(173)) as \"FACILITY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"DELIVERY_FLAG\" ,\n                    cast(null as character varying(16777216)) as \"DELIVERY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"NEWBORN_FLAG\" ,\n                    cast(null as NUMBER(1,0)) as \"NICU_FLAG\" ,\n                    cast(\"DRG_CODE_TYPE\" as character varying(16777216)) as \"DRG_CODE_TYPE\" ,\n                    cast(\"DRG_CODE\" as character varying(16777216)) as \"DRG_CODE\" ,\n                    cast(\"DRG_DESCRIPTION\" as character varying(256)) as \"DRG_DESCRIPTION\" ,\n                    cast(\"MEDICAL_SURGICAL\" as character varying(256)) as \"MEDICAL_SURGICAL\" ,\n                    cast(\"ADMIT_SOURCE_CODE\" as character varying(16777216)) as \"ADMIT_SOURCE_CODE\" ,\n                    cast(\"ADMIT_SOURCE_DESCRIPTION\" as character varying(256)) as \"ADMIT_SOURCE_DESCRIPTION\" ,\n                    cast(\"ADMIT_TYPE_CODE\" as character varying(16777216)) as \"ADMIT_TYPE_CODE\" ,\n                    cast(\"ADMIT_TYPE_DESCRIPTION\" as character varying(256)) as \"ADMIT_TYPE_DESCRIPTION\" ,\n                    cast(\"DISCHARGE_DISPOSITION_CODE\" as character varying(16777216)) as \"DISCHARGE_DISPOSITION_CODE\" ,\n                    cast(\"DISCHARGE_DISPOSITION_DESCRIPTION\" as character varying(256)) as \"DISCHARGE_DISPOSITION_DESCRIPTION\" ,\n                    cast(\"TOTAL_PAID_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_PAID_AMOUNT\" ,\n                    cast(\"TOTAL_ALLOWED_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_ALLOWED_AMOUNT\" ,\n                    cast(\"TOTAL_CHARGE_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_CHARGE_AMOUNT\" ,\n                    cast(\"CLAIM_COUNT\" as NUMBER(18,0)) as \"CLAIM_COUNT\" ,\n                    cast(\"INST_CLAIM_COUNT\" as NUMBER(18,0)) as \"INST_CLAIM_COUNT\" ,\n                    cast(\"PROF_CLAIM_COUNT\" as NUMBER(18,0)) as \"PROF_CLAIM_COUNT\" ,\n                    cast(\"LENGTH_OF_STAY\" as NUMBER(9,0)) as \"LENGTH_OF_STAY\" ,\n                    cast(\"MORTALITY_FLAG\" as NUMBER(1,0)) as \"MORTALITY_FLAG\" ,\n                    cast(\"DATA_SOURCE\" as character varying(16777216)) as \"DATA_SOURCE\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as character varying(16777216)) as \"BILLING_ID\" ,\n                    cast(null as character varying(191)) as \"PROVIDER_NAME\" ,\n                    cast(null as character varying(173)) as \"PROVIDER_SPECIALTY\" ,\n                    cast(null as character varying(16777216)) as \"HCPCS_CODE\" ,\n                    cast(null as character varying(3)) as \"CCS_CATEGORY\" ,\n                    cast(null as character varying(256)) as \"CCS_CATEGORY_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"PLACE_OF_SERVICE_CODE\" ,\n                    cast(null as character varying(256)) as \"PLACE_OF_SERVICE_DESCRIPTION\" \n\n            from tuva.claims_preprocessing.inpatient_psych__encounter_grain\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing.inpatient_rehab__encounter_grain' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"ENCOUNTER_ID\" as NUMBER(18,0)) as \"ENCOUNTER_ID\" ,\n                    cast(\"ENCOUNTER_START_DATE\" as DATE) as \"ENCOUNTER_START_DATE\" ,\n                    cast(\"ENCOUNTER_END_DATE\" as DATE) as \"ENCOUNTER_END_DATE\" ,\n                    cast(\"PATIENT_DATA_SOURCE_ID\" as NUMBER(18,0)) as \"PATIENT_DATA_SOURCE_ID\" ,\n                    cast(\"ENCOUNTER_TYPE\" as character varying(29)) as \"ENCOUNTER_TYPE\" ,\n                    cast(\"ENCOUNTER_GROUP\" as character varying(12)) as \"ENCOUNTER_GROUP\" ,\n                    cast(\"ADMIT_AGE\" as NUMBER(15,6)) as \"ADMIT_AGE\" ,\n                    cast(\"GENDER\" as character varying(16777216)) as \"GENDER\" ,\n                    cast(\"RACE\" as character varying(16777216)) as \"RACE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE_TYPE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE_TYPE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_DESCRIPTION\" as character varying(256)) as \"PRIMARY_DIAGNOSIS_DESCRIPTION\" ,\n                    cast(\"FACILITY_ID\" as character varying(16777216)) as \"FACILITY_ID\" ,\n                    cast(\"OBSERVATION_FLAG\" as NUMBER(1,0)) as \"OBSERVATION_FLAG\" ,\n                    cast(\"ED_FLAG\" as NUMBER(1,0)) as \"ED_FLAG\" ,\n                    cast(\"LAB_FLAG\" as NUMBER(1,0)) as \"LAB_FLAG\" ,\n                    cast(\"DME_FLAG\" as NUMBER(1,0)) as \"DME_FLAG\" ,\n                    cast(\"AMBULANCE_FLAG\" as NUMBER(1,0)) as \"AMBULANCE_FLAG\" ,\n                    cast(\"PHARMACY_FLAG\" as NUMBER(1,0)) as \"PHARMACY_FLAG\" ,\n                    cast(\"FACILITY_NAME\" as character varying(95)) as \"FACILITY_NAME\" ,\n                    cast(\"FACILITY_TYPE\" as character varying(173)) as \"FACILITY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"DELIVERY_FLAG\" ,\n                    cast(null as character varying(16777216)) as \"DELIVERY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"NEWBORN_FLAG\" ,\n                    cast(null as NUMBER(1,0)) as \"NICU_FLAG\" ,\n                    cast(\"DRG_CODE_TYPE\" as character varying(16777216)) as \"DRG_CODE_TYPE\" ,\n                    cast(\"DRG_CODE\" as character varying(16777216)) as \"DRG_CODE\" ,\n                    cast(\"DRG_DESCRIPTION\" as character varying(256)) as \"DRG_DESCRIPTION\" ,\n                    cast(\"MEDICAL_SURGICAL\" as character varying(256)) as \"MEDICAL_SURGICAL\" ,\n                    cast(\"ADMIT_SOURCE_CODE\" as character varying(16777216)) as \"ADMIT_SOURCE_CODE\" ,\n                    cast(\"ADMIT_SOURCE_DESCRIPTION\" as character varying(256)) as \"ADMIT_SOURCE_DESCRIPTION\" ,\n                    cast(\"ADMIT_TYPE_CODE\" as character varying(16777216)) as \"ADMIT_TYPE_CODE\" ,\n                    cast(\"ADMIT_TYPE_DESCRIPTION\" as character varying(256)) as \"ADMIT_TYPE_DESCRIPTION\" ,\n                    cast(\"DISCHARGE_DISPOSITION_CODE\" as character varying(16777216)) as \"DISCHARGE_DISPOSITION_CODE\" ,\n                    cast(\"DISCHARGE_DISPOSITION_DESCRIPTION\" as character varying(256)) as \"DISCHARGE_DISPOSITION_DESCRIPTION\" ,\n                    cast(\"TOTAL_PAID_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_PAID_AMOUNT\" ,\n                    cast(\"TOTAL_ALLOWED_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_ALLOWED_AMOUNT\" ,\n                    cast(\"TOTAL_CHARGE_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_CHARGE_AMOUNT\" ,\n                    cast(\"CLAIM_COUNT\" as NUMBER(18,0)) as \"CLAIM_COUNT\" ,\n                    cast(\"INST_CLAIM_COUNT\" as NUMBER(18,0)) as \"INST_CLAIM_COUNT\" ,\n                    cast(\"PROF_CLAIM_COUNT\" as NUMBER(18,0)) as \"PROF_CLAIM_COUNT\" ,\n                    cast(\"LENGTH_OF_STAY\" as NUMBER(9,0)) as \"LENGTH_OF_STAY\" ,\n                    cast(\"MORTALITY_FLAG\" as NUMBER(1,0)) as \"MORTALITY_FLAG\" ,\n                    cast(\"DATA_SOURCE\" as character varying(16777216)) as \"DATA_SOURCE\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as character varying(16777216)) as \"BILLING_ID\" ,\n                    cast(null as character varying(191)) as \"PROVIDER_NAME\" ,\n                    cast(null as character varying(173)) as \"PROVIDER_SPECIALTY\" ,\n                    cast(null as character varying(16777216)) as \"HCPCS_CODE\" ,\n                    cast(null as character varying(3)) as \"CCS_CATEGORY\" ,\n                    cast(null as character varying(256)) as \"CCS_CATEGORY_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"PLACE_OF_SERVICE_CODE\" ,\n                    cast(null as character varying(256)) as \"PLACE_OF_SERVICE_DESCRIPTION\" \n\n            from tuva.claims_preprocessing.inpatient_rehab__encounter_grain\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing.inpatient_snf__encounter_grain' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"ENCOUNTER_ID\" as NUMBER(18,0)) as \"ENCOUNTER_ID\" ,\n                    cast(\"ENCOUNTER_START_DATE\" as DATE) as \"ENCOUNTER_START_DATE\" ,\n                    cast(\"ENCOUNTER_END_DATE\" as DATE) as \"ENCOUNTER_END_DATE\" ,\n                    cast(\"PATIENT_DATA_SOURCE_ID\" as NUMBER(18,0)) as \"PATIENT_DATA_SOURCE_ID\" ,\n                    cast(\"ENCOUNTER_TYPE\" as character varying(29)) as \"ENCOUNTER_TYPE\" ,\n                    cast(\"ENCOUNTER_GROUP\" as character varying(12)) as \"ENCOUNTER_GROUP\" ,\n                    cast(\"ADMIT_AGE\" as NUMBER(15,6)) as \"ADMIT_AGE\" ,\n                    cast(\"GENDER\" as character varying(16777216)) as \"GENDER\" ,\n                    cast(\"RACE\" as character varying(16777216)) as \"RACE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE_TYPE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE_TYPE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_DESCRIPTION\" as character varying(256)) as \"PRIMARY_DIAGNOSIS_DESCRIPTION\" ,\n                    cast(\"FACILITY_ID\" as character varying(16777216)) as \"FACILITY_ID\" ,\n                    cast(\"OBSERVATION_FLAG\" as NUMBER(1,0)) as \"OBSERVATION_FLAG\" ,\n                    cast(\"ED_FLAG\" as NUMBER(1,0)) as \"ED_FLAG\" ,\n                    cast(\"LAB_FLAG\" as NUMBER(1,0)) as \"LAB_FLAG\" ,\n                    cast(\"DME_FLAG\" as NUMBER(1,0)) as \"DME_FLAG\" ,\n                    cast(\"AMBULANCE_FLAG\" as NUMBER(1,0)) as \"AMBULANCE_FLAG\" ,\n                    cast(\"PHARMACY_FLAG\" as NUMBER(1,0)) as \"PHARMACY_FLAG\" ,\n                    cast(\"FACILITY_NAME\" as character varying(95)) as \"FACILITY_NAME\" ,\n                    cast(\"FACILITY_TYPE\" as character varying(173)) as \"FACILITY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"DELIVERY_FLAG\" ,\n                    cast(null as character varying(16777216)) as \"DELIVERY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"NEWBORN_FLAG\" ,\n                    cast(null as NUMBER(1,0)) as \"NICU_FLAG\" ,\n                    cast(\"DRG_CODE_TYPE\" as character varying(16777216)) as \"DRG_CODE_TYPE\" ,\n                    cast(\"DRG_CODE\" as character varying(16777216)) as \"DRG_CODE\" ,\n                    cast(\"DRG_DESCRIPTION\" as character varying(256)) as \"DRG_DESCRIPTION\" ,\n                    cast(\"MEDICAL_SURGICAL\" as character varying(256)) as \"MEDICAL_SURGICAL\" ,\n                    cast(\"ADMIT_SOURCE_CODE\" as character varying(16777216)) as \"ADMIT_SOURCE_CODE\" ,\n                    cast(\"ADMIT_SOURCE_DESCRIPTION\" as character varying(256)) as \"ADMIT_SOURCE_DESCRIPTION\" ,\n                    cast(\"ADMIT_TYPE_CODE\" as character varying(16777216)) as \"ADMIT_TYPE_CODE\" ,\n                    cast(\"ADMIT_TYPE_DESCRIPTION\" as character varying(256)) as \"ADMIT_TYPE_DESCRIPTION\" ,\n                    cast(\"DISCHARGE_DISPOSITION_CODE\" as character varying(16777216)) as \"DISCHARGE_DISPOSITION_CODE\" ,\n                    cast(\"DISCHARGE_DISPOSITION_DESCRIPTION\" as character varying(256)) as \"DISCHARGE_DISPOSITION_DESCRIPTION\" ,\n                    cast(\"TOTAL_PAID_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_PAID_AMOUNT\" ,\n                    cast(\"TOTAL_ALLOWED_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_ALLOWED_AMOUNT\" ,\n                    cast(\"TOTAL_CHARGE_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_CHARGE_AMOUNT\" ,\n                    cast(\"CLAIM_COUNT\" as NUMBER(18,0)) as \"CLAIM_COUNT\" ,\n                    cast(\"INST_CLAIM_COUNT\" as NUMBER(18,0)) as \"INST_CLAIM_COUNT\" ,\n                    cast(\"PROF_CLAIM_COUNT\" as NUMBER(18,0)) as \"PROF_CLAIM_COUNT\" ,\n                    cast(\"LENGTH_OF_STAY\" as NUMBER(9,0)) as \"LENGTH_OF_STAY\" ,\n                    cast(\"MORTALITY_FLAG\" as NUMBER(1,0)) as \"MORTALITY_FLAG\" ,\n                    cast(\"DATA_SOURCE\" as character varying(16777216)) as \"DATA_SOURCE\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as character varying(16777216)) as \"BILLING_ID\" ,\n                    cast(null as character varying(191)) as \"PROVIDER_NAME\" ,\n                    cast(null as character varying(173)) as \"PROVIDER_SPECIALTY\" ,\n                    cast(null as character varying(16777216)) as \"HCPCS_CODE\" ,\n                    cast(null as character varying(3)) as \"CCS_CATEGORY\" ,\n                    cast(null as character varying(256)) as \"CCS_CATEGORY_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"PLACE_OF_SERVICE_CODE\" ,\n                    cast(null as character varying(256)) as \"PLACE_OF_SERVICE_DESCRIPTION\" \n\n            from tuva.claims_preprocessing.inpatient_snf__encounter_grain\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing.inpatient_substance_use__encounter_grain' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"ENCOUNTER_ID\" as NUMBER(18,0)) as \"ENCOUNTER_ID\" ,\n                    cast(\"ENCOUNTER_START_DATE\" as DATE) as \"ENCOUNTER_START_DATE\" ,\n                    cast(\"ENCOUNTER_END_DATE\" as DATE) as \"ENCOUNTER_END_DATE\" ,\n                    cast(\"PATIENT_DATA_SOURCE_ID\" as NUMBER(18,0)) as \"PATIENT_DATA_SOURCE_ID\" ,\n                    cast(\"ENCOUNTER_TYPE\" as character varying(29)) as \"ENCOUNTER_TYPE\" ,\n                    cast(\"ENCOUNTER_GROUP\" as character varying(12)) as \"ENCOUNTER_GROUP\" ,\n                    cast(\"ADMIT_AGE\" as NUMBER(15,6)) as \"ADMIT_AGE\" ,\n                    cast(\"GENDER\" as character varying(16777216)) as \"GENDER\" ,\n                    cast(\"RACE\" as character varying(16777216)) as \"RACE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE_TYPE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE_TYPE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_DESCRIPTION\" as character varying(256)) as \"PRIMARY_DIAGNOSIS_DESCRIPTION\" ,\n                    cast(\"FACILITY_ID\" as character varying(16777216)) as \"FACILITY_ID\" ,\n                    cast(\"OBSERVATION_FLAG\" as NUMBER(1,0)) as \"OBSERVATION_FLAG\" ,\n                    cast(\"ED_FLAG\" as NUMBER(1,0)) as \"ED_FLAG\" ,\n                    cast(\"LAB_FLAG\" as NUMBER(1,0)) as \"LAB_FLAG\" ,\n                    cast(\"DME_FLAG\" as NUMBER(1,0)) as \"DME_FLAG\" ,\n                    cast(\"AMBULANCE_FLAG\" as NUMBER(1,0)) as \"AMBULANCE_FLAG\" ,\n                    cast(\"PHARMACY_FLAG\" as NUMBER(1,0)) as \"PHARMACY_FLAG\" ,\n                    cast(\"FACILITY_NAME\" as character varying(95)) as \"FACILITY_NAME\" ,\n                    cast(\"FACILITY_TYPE\" as character varying(173)) as \"FACILITY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"DELIVERY_FLAG\" ,\n                    cast(null as character varying(16777216)) as \"DELIVERY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"NEWBORN_FLAG\" ,\n                    cast(null as NUMBER(1,0)) as \"NICU_FLAG\" ,\n                    cast(\"DRG_CODE_TYPE\" as character varying(16777216)) as \"DRG_CODE_TYPE\" ,\n                    cast(\"DRG_CODE\" as character varying(16777216)) as \"DRG_CODE\" ,\n                    cast(\"DRG_DESCRIPTION\" as character varying(256)) as \"DRG_DESCRIPTION\" ,\n                    cast(\"MEDICAL_SURGICAL\" as character varying(256)) as \"MEDICAL_SURGICAL\" ,\n                    cast(\"ADMIT_SOURCE_CODE\" as character varying(16777216)) as \"ADMIT_SOURCE_CODE\" ,\n                    cast(\"ADMIT_SOURCE_DESCRIPTION\" as character varying(256)) as \"ADMIT_SOURCE_DESCRIPTION\" ,\n                    cast(\"ADMIT_TYPE_CODE\" as character varying(16777216)) as \"ADMIT_TYPE_CODE\" ,\n                    cast(\"ADMIT_TYPE_DESCRIPTION\" as character varying(256)) as \"ADMIT_TYPE_DESCRIPTION\" ,\n                    cast(\"DISCHARGE_DISPOSITION_CODE\" as character varying(16777216)) as \"DISCHARGE_DISPOSITION_CODE\" ,\n                    cast(\"DISCHARGE_DISPOSITION_DESCRIPTION\" as character varying(256)) as \"DISCHARGE_DISPOSITION_DESCRIPTION\" ,\n                    cast(\"TOTAL_PAID_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_PAID_AMOUNT\" ,\n                    cast(\"TOTAL_ALLOWED_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_ALLOWED_AMOUNT\" ,\n                    cast(\"TOTAL_CHARGE_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_CHARGE_AMOUNT\" ,\n                    cast(\"CLAIM_COUNT\" as NUMBER(18,0)) as \"CLAIM_COUNT\" ,\n                    cast(\"INST_CLAIM_COUNT\" as NUMBER(18,0)) as \"INST_CLAIM_COUNT\" ,\n                    cast(\"PROF_CLAIM_COUNT\" as NUMBER(18,0)) as \"PROF_CLAIM_COUNT\" ,\n                    cast(\"LENGTH_OF_STAY\" as NUMBER(9,0)) as \"LENGTH_OF_STAY\" ,\n                    cast(\"MORTALITY_FLAG\" as NUMBER(1,0)) as \"MORTALITY_FLAG\" ,\n                    cast(\"DATA_SOURCE\" as character varying(16777216)) as \"DATA_SOURCE\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as character varying(16777216)) as \"BILLING_ID\" ,\n                    cast(null as character varying(191)) as \"PROVIDER_NAME\" ,\n                    cast(null as character varying(173)) as \"PROVIDER_SPECIALTY\" ,\n                    cast(null as character varying(16777216)) as \"HCPCS_CODE\" ,\n                    cast(null as character varying(3)) as \"CCS_CATEGORY\" ,\n                    cast(null as character varying(256)) as \"CCS_CATEGORY_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"PLACE_OF_SERVICE_CODE\" ,\n                    cast(null as character varying(256)) as \"PLACE_OF_SERVICE_DESCRIPTION\" \n\n            from tuva.claims_preprocessing.inpatient_substance_use__encounter_grain\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing.urgent_care__encounter_grain' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"ENCOUNTER_ID\" as NUMBER(18,0)) as \"ENCOUNTER_ID\" ,\n                    cast(\"ENCOUNTER_START_DATE\" as DATE) as \"ENCOUNTER_START_DATE\" ,\n                    cast(null as DATE) as \"ENCOUNTER_END_DATE\" ,\n                    cast(\"PATIENT_DATA_SOURCE_ID\" as NUMBER(18,0)) as \"PATIENT_DATA_SOURCE_ID\" ,\n                    cast(\"ENCOUNTER_TYPE\" as character varying(29)) as \"ENCOUNTER_TYPE\" ,\n                    cast(\"ENCOUNTER_GROUP\" as character varying(12)) as \"ENCOUNTER_GROUP\" ,\n                    cast(\"ADMIT_AGE\" as NUMBER(15,6)) as \"ADMIT_AGE\" ,\n                    cast(\"GENDER\" as character varying(16777216)) as \"GENDER\" ,\n                    cast(\"RACE\" as character varying(16777216)) as \"RACE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE_TYPE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE_TYPE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_DESCRIPTION\" as character varying(256)) as \"PRIMARY_DIAGNOSIS_DESCRIPTION\" ,\n                    cast(\"FACILITY_ID\" as character varying(16777216)) as \"FACILITY_ID\" ,\n                    cast(\"OBSERVATION_FLAG\" as NUMBER(1,0)) as \"OBSERVATION_FLAG\" ,\n                    cast(null as NUMBER(1,0)) as \"ED_FLAG\" ,\n                    cast(\"LAB_FLAG\" as NUMBER(1,0)) as \"LAB_FLAG\" ,\n                    cast(\"DME_FLAG\" as NUMBER(1,0)) as \"DME_FLAG\" ,\n                    cast(\"AMBULANCE_FLAG\" as NUMBER(1,0)) as \"AMBULANCE_FLAG\" ,\n                    cast(\"PHARMACY_FLAG\" as NUMBER(1,0)) as \"PHARMACY_FLAG\" ,\n                    cast(\"FACILITY_NAME\" as character varying(95)) as \"FACILITY_NAME\" ,\n                    cast(\"FACILITY_TYPE\" as character varying(173)) as \"FACILITY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"DELIVERY_FLAG\" ,\n                    cast(null as character varying(16777216)) as \"DELIVERY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"NEWBORN_FLAG\" ,\n                    cast(null as NUMBER(1,0)) as \"NICU_FLAG\" ,\n                    cast(null as character varying(16777216)) as \"DRG_CODE_TYPE\" ,\n                    cast(null as character varying(16777216)) as \"DRG_CODE\" ,\n                    cast(null as character varying(256)) as \"DRG_DESCRIPTION\" ,\n                    cast(null as character varying(256)) as \"MEDICAL_SURGICAL\" ,\n                    cast(null as character varying(16777216)) as \"ADMIT_SOURCE_CODE\" ,\n                    cast(null as character varying(256)) as \"ADMIT_SOURCE_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"ADMIT_TYPE_CODE\" ,\n                    cast(null as character varying(256)) as \"ADMIT_TYPE_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"DISCHARGE_DISPOSITION_CODE\" ,\n                    cast(null as character varying(256)) as \"DISCHARGE_DISPOSITION_DESCRIPTION\" ,\n                    cast(\"TOTAL_PAID_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_PAID_AMOUNT\" ,\n                    cast(\"TOTAL_ALLOWED_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_ALLOWED_AMOUNT\" ,\n                    cast(\"TOTAL_CHARGE_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_CHARGE_AMOUNT\" ,\n                    cast(\"CLAIM_COUNT\" as NUMBER(18,0)) as \"CLAIM_COUNT\" ,\n                    cast(\"INST_CLAIM_COUNT\" as NUMBER(18,0)) as \"INST_CLAIM_COUNT\" ,\n                    cast(\"PROF_CLAIM_COUNT\" as NUMBER(18,0)) as \"PROF_CLAIM_COUNT\" ,\n                    cast(null as NUMBER(9,0)) as \"LENGTH_OF_STAY\" ,\n                    cast(null as NUMBER(1,0)) as \"MORTALITY_FLAG\" ,\n                    cast(\"DATA_SOURCE\" as character varying(16777216)) as \"DATA_SOURCE\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as character varying(16777216)) as \"BILLING_ID\" ,\n                    cast(null as character varying(191)) as \"PROVIDER_NAME\" ,\n                    cast(null as character varying(173)) as \"PROVIDER_SPECIALTY\" ,\n                    cast(null as character varying(16777216)) as \"HCPCS_CODE\" ,\n                    cast(null as character varying(3)) as \"CCS_CATEGORY\" ,\n                    cast(null as character varying(256)) as \"CCS_CATEGORY_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"PLACE_OF_SERVICE_CODE\" ,\n                    cast(null as character varying(256)) as \"PLACE_OF_SERVICE_DESCRIPTION\" \n\n            from tuva.claims_preprocessing.urgent_care__encounter_grain\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing.office_visit__encounter_grain' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"ENCOUNTER_ID\" as NUMBER(18,0)) as \"ENCOUNTER_ID\" ,\n                    cast(\"ENCOUNTER_START_DATE\" as DATE) as \"ENCOUNTER_START_DATE\" ,\n                    cast(null as DATE) as \"ENCOUNTER_END_DATE\" ,\n                    cast(\"PATIENT_DATA_SOURCE_ID\" as NUMBER(18,0)) as \"PATIENT_DATA_SOURCE_ID\" ,\n                    cast(\"ENCOUNTER_TYPE\" as character varying(29)) as \"ENCOUNTER_TYPE\" ,\n                    cast(\"ENCOUNTER_GROUP\" as character varying(12)) as \"ENCOUNTER_GROUP\" ,\n                    cast(\"ADMIT_AGE\" as NUMBER(15,6)) as \"ADMIT_AGE\" ,\n                    cast(\"GENDER\" as character varying(16777216)) as \"GENDER\" ,\n                    cast(\"RACE\" as character varying(16777216)) as \"RACE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE_TYPE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE_TYPE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_DESCRIPTION\" as character varying(256)) as \"PRIMARY_DIAGNOSIS_DESCRIPTION\" ,\n                    cast(\"FACILITY_ID\" as character varying(16777216)) as \"FACILITY_ID\" ,\n                    cast(null as NUMBER(1,0)) as \"OBSERVATION_FLAG\" ,\n                    cast(null as NUMBER(1,0)) as \"ED_FLAG\" ,\n                    cast(\"LAB_FLAG\" as NUMBER(1,0)) as \"LAB_FLAG\" ,\n                    cast(\"DME_FLAG\" as NUMBER(1,0)) as \"DME_FLAG\" ,\n                    cast(\"AMBULANCE_FLAG\" as NUMBER(1,0)) as \"AMBULANCE_FLAG\" ,\n                    cast(\"PHARMACY_FLAG\" as NUMBER(1,0)) as \"PHARMACY_FLAG\" ,\n                    cast(\"FACILITY_NAME\" as character varying(95)) as \"FACILITY_NAME\" ,\n                    cast(null as character varying(173)) as \"FACILITY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"DELIVERY_FLAG\" ,\n                    cast(null as character varying(16777216)) as \"DELIVERY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"NEWBORN_FLAG\" ,\n                    cast(null as NUMBER(1,0)) as \"NICU_FLAG\" ,\n                    cast(null as character varying(16777216)) as \"DRG_CODE_TYPE\" ,\n                    cast(null as character varying(16777216)) as \"DRG_CODE\" ,\n                    cast(null as character varying(256)) as \"DRG_DESCRIPTION\" ,\n                    cast(null as character varying(256)) as \"MEDICAL_SURGICAL\" ,\n                    cast(null as character varying(16777216)) as \"ADMIT_SOURCE_CODE\" ,\n                    cast(null as character varying(256)) as \"ADMIT_SOURCE_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"ADMIT_TYPE_CODE\" ,\n                    cast(null as character varying(256)) as \"ADMIT_TYPE_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"DISCHARGE_DISPOSITION_CODE\" ,\n                    cast(null as character varying(256)) as \"DISCHARGE_DISPOSITION_DESCRIPTION\" ,\n                    cast(\"TOTAL_PAID_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_PAID_AMOUNT\" ,\n                    cast(\"TOTAL_ALLOWED_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_ALLOWED_AMOUNT\" ,\n                    cast(\"TOTAL_CHARGE_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_CHARGE_AMOUNT\" ,\n                    cast(\"CLAIM_COUNT\" as NUMBER(18,0)) as \"CLAIM_COUNT\" ,\n                    cast(\"INST_CLAIM_COUNT\" as NUMBER(18,0)) as \"INST_CLAIM_COUNT\" ,\n                    cast(\"PROF_CLAIM_COUNT\" as NUMBER(18,0)) as \"PROF_CLAIM_COUNT\" ,\n                    cast(null as NUMBER(9,0)) as \"LENGTH_OF_STAY\" ,\n                    cast(null as NUMBER(1,0)) as \"MORTALITY_FLAG\" ,\n                    cast(\"DATA_SOURCE\" as character varying(16777216)) as \"DATA_SOURCE\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(\"BILLING_ID\" as character varying(16777216)) as \"BILLING_ID\" ,\n                    cast(\"PROVIDER_NAME\" as character varying(191)) as \"PROVIDER_NAME\" ,\n                    cast(\"PROVIDER_SPECIALTY\" as character varying(173)) as \"PROVIDER_SPECIALTY\" ,\n                    cast(\"HCPCS_CODE\" as character varying(16777216)) as \"HCPCS_CODE\" ,\n                    cast(\"CCS_CATEGORY\" as character varying(3)) as \"CCS_CATEGORY\" ,\n                    cast(\"CCS_CATEGORY_DESCRIPTION\" as character varying(256)) as \"CCS_CATEGORY_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"PLACE_OF_SERVICE_CODE\" ,\n                    cast(null as character varying(256)) as \"PLACE_OF_SERVICE_DESCRIPTION\" \n\n            from tuva.claims_preprocessing.office_visit__encounter_grain\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing.outpatient_hospice__encounter_grain' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"ENCOUNTER_ID\" as NUMBER(18,0)) as \"ENCOUNTER_ID\" ,\n                    cast(\"ENCOUNTER_START_DATE\" as DATE) as \"ENCOUNTER_START_DATE\" ,\n                    cast(null as DATE) as \"ENCOUNTER_END_DATE\" ,\n                    cast(\"PATIENT_DATA_SOURCE_ID\" as NUMBER(18,0)) as \"PATIENT_DATA_SOURCE_ID\" ,\n                    cast(\"ENCOUNTER_TYPE\" as character varying(29)) as \"ENCOUNTER_TYPE\" ,\n                    cast(\"ENCOUNTER_GROUP\" as character varying(12)) as \"ENCOUNTER_GROUP\" ,\n                    cast(\"ADMIT_AGE\" as NUMBER(15,6)) as \"ADMIT_AGE\" ,\n                    cast(\"GENDER\" as character varying(16777216)) as \"GENDER\" ,\n                    cast(\"RACE\" as character varying(16777216)) as \"RACE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE_TYPE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE_TYPE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_DESCRIPTION\" as character varying(256)) as \"PRIMARY_DIAGNOSIS_DESCRIPTION\" ,\n                    cast(\"FACILITY_ID\" as character varying(16777216)) as \"FACILITY_ID\" ,\n                    cast(\"OBSERVATION_FLAG\" as NUMBER(1,0)) as \"OBSERVATION_FLAG\" ,\n                    cast(null as NUMBER(1,0)) as \"ED_FLAG\" ,\n                    cast(\"LAB_FLAG\" as NUMBER(1,0)) as \"LAB_FLAG\" ,\n                    cast(\"DME_FLAG\" as NUMBER(1,0)) as \"DME_FLAG\" ,\n                    cast(\"AMBULANCE_FLAG\" as NUMBER(1,0)) as \"AMBULANCE_FLAG\" ,\n                    cast(\"PHARMACY_FLAG\" as NUMBER(1,0)) as \"PHARMACY_FLAG\" ,\n                    cast(\"FACILITY_NAME\" as character varying(95)) as \"FACILITY_NAME\" ,\n                    cast(\"FACILITY_TYPE\" as character varying(173)) as \"FACILITY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"DELIVERY_FLAG\" ,\n                    cast(null as character varying(16777216)) as \"DELIVERY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"NEWBORN_FLAG\" ,\n                    cast(null as NUMBER(1,0)) as \"NICU_FLAG\" ,\n                    cast(null as character varying(16777216)) as \"DRG_CODE_TYPE\" ,\n                    cast(null as character varying(16777216)) as \"DRG_CODE\" ,\n                    cast(null as character varying(256)) as \"DRG_DESCRIPTION\" ,\n                    cast(null as character varying(256)) as \"MEDICAL_SURGICAL\" ,\n                    cast(null as character varying(16777216)) as \"ADMIT_SOURCE_CODE\" ,\n                    cast(null as character varying(256)) as \"ADMIT_SOURCE_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"ADMIT_TYPE_CODE\" ,\n                    cast(null as character varying(256)) as \"ADMIT_TYPE_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"DISCHARGE_DISPOSITION_CODE\" ,\n                    cast(null as character varying(256)) as \"DISCHARGE_DISPOSITION_DESCRIPTION\" ,\n                    cast(\"TOTAL_PAID_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_PAID_AMOUNT\" ,\n                    cast(\"TOTAL_ALLOWED_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_ALLOWED_AMOUNT\" ,\n                    cast(\"TOTAL_CHARGE_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_CHARGE_AMOUNT\" ,\n                    cast(\"CLAIM_COUNT\" as NUMBER(18,0)) as \"CLAIM_COUNT\" ,\n                    cast(\"INST_CLAIM_COUNT\" as NUMBER(18,0)) as \"INST_CLAIM_COUNT\" ,\n                    cast(\"PROF_CLAIM_COUNT\" as NUMBER(18,0)) as \"PROF_CLAIM_COUNT\" ,\n                    cast(null as NUMBER(9,0)) as \"LENGTH_OF_STAY\" ,\n                    cast(null as NUMBER(1,0)) as \"MORTALITY_FLAG\" ,\n                    cast(\"DATA_SOURCE\" as character varying(16777216)) as \"DATA_SOURCE\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as character varying(16777216)) as \"BILLING_ID\" ,\n                    cast(null as character varying(191)) as \"PROVIDER_NAME\" ,\n                    cast(null as character varying(173)) as \"PROVIDER_SPECIALTY\" ,\n                    cast(null as character varying(16777216)) as \"HCPCS_CODE\" ,\n                    cast(null as character varying(3)) as \"CCS_CATEGORY\" ,\n                    cast(null as character varying(256)) as \"CCS_CATEGORY_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"PLACE_OF_SERVICE_CODE\" ,\n                    cast(null as character varying(256)) as \"PLACE_OF_SERVICE_DESCRIPTION\" \n\n            from tuva.claims_preprocessing.outpatient_hospice__encounter_grain\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing.outpatient_hospital_or_clinic__encounter_grain' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"ENCOUNTER_ID\" as NUMBER(18,0)) as \"ENCOUNTER_ID\" ,\n                    cast(\"ENCOUNTER_START_DATE\" as DATE) as \"ENCOUNTER_START_DATE\" ,\n                    cast(null as DATE) as \"ENCOUNTER_END_DATE\" ,\n                    cast(\"PATIENT_DATA_SOURCE_ID\" as NUMBER(18,0)) as \"PATIENT_DATA_SOURCE_ID\" ,\n                    cast(\"ENCOUNTER_TYPE\" as character varying(29)) as \"ENCOUNTER_TYPE\" ,\n                    cast(\"ENCOUNTER_GROUP\" as character varying(12)) as \"ENCOUNTER_GROUP\" ,\n                    cast(\"ADMIT_AGE\" as NUMBER(15,6)) as \"ADMIT_AGE\" ,\n                    cast(\"GENDER\" as character varying(16777216)) as \"GENDER\" ,\n                    cast(\"RACE\" as character varying(16777216)) as \"RACE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE_TYPE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE_TYPE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_DESCRIPTION\" as character varying(256)) as \"PRIMARY_DIAGNOSIS_DESCRIPTION\" ,\n                    cast(\"FACILITY_ID\" as character varying(16777216)) as \"FACILITY_ID\" ,\n                    cast(\"OBSERVATION_FLAG\" as NUMBER(1,0)) as \"OBSERVATION_FLAG\" ,\n                    cast(null as NUMBER(1,0)) as \"ED_FLAG\" ,\n                    cast(\"LAB_FLAG\" as NUMBER(1,0)) as \"LAB_FLAG\" ,\n                    cast(\"DME_FLAG\" as NUMBER(1,0)) as \"DME_FLAG\" ,\n                    cast(\"AMBULANCE_FLAG\" as NUMBER(1,0)) as \"AMBULANCE_FLAG\" ,\n                    cast(\"PHARMACY_FLAG\" as NUMBER(1,0)) as \"PHARMACY_FLAG\" ,\n                    cast(\"FACILITY_NAME\" as character varying(95)) as \"FACILITY_NAME\" ,\n                    cast(\"FACILITY_TYPE\" as character varying(173)) as \"FACILITY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"DELIVERY_FLAG\" ,\n                    cast(null as character varying(16777216)) as \"DELIVERY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"NEWBORN_FLAG\" ,\n                    cast(null as NUMBER(1,0)) as \"NICU_FLAG\" ,\n                    cast(null as character varying(16777216)) as \"DRG_CODE_TYPE\" ,\n                    cast(null as character varying(16777216)) as \"DRG_CODE\" ,\n                    cast(null as character varying(256)) as \"DRG_DESCRIPTION\" ,\n                    cast(null as character varying(256)) as \"MEDICAL_SURGICAL\" ,\n                    cast(null as character varying(16777216)) as \"ADMIT_SOURCE_CODE\" ,\n                    cast(null as character varying(256)) as \"ADMIT_SOURCE_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"ADMIT_TYPE_CODE\" ,\n                    cast(null as character varying(256)) as \"ADMIT_TYPE_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"DISCHARGE_DISPOSITION_CODE\" ,\n                    cast(null as character varying(256)) as \"DISCHARGE_DISPOSITION_DESCRIPTION\" ,\n                    cast(\"TOTAL_PAID_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_PAID_AMOUNT\" ,\n                    cast(\"TOTAL_ALLOWED_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_ALLOWED_AMOUNT\" ,\n                    cast(\"TOTAL_CHARGE_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_CHARGE_AMOUNT\" ,\n                    cast(\"CLAIM_COUNT\" as NUMBER(18,0)) as \"CLAIM_COUNT\" ,\n                    cast(\"INST_CLAIM_COUNT\" as NUMBER(18,0)) as \"INST_CLAIM_COUNT\" ,\n                    cast(\"PROF_CLAIM_COUNT\" as NUMBER(18,0)) as \"PROF_CLAIM_COUNT\" ,\n                    cast(null as NUMBER(9,0)) as \"LENGTH_OF_STAY\" ,\n                    cast(null as NUMBER(1,0)) as \"MORTALITY_FLAG\" ,\n                    cast(\"DATA_SOURCE\" as character varying(16777216)) as \"DATA_SOURCE\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as character varying(16777216)) as \"BILLING_ID\" ,\n                    cast(null as character varying(191)) as \"PROVIDER_NAME\" ,\n                    cast(null as character varying(173)) as \"PROVIDER_SPECIALTY\" ,\n                    cast(null as character varying(16777216)) as \"HCPCS_CODE\" ,\n                    cast(null as character varying(3)) as \"CCS_CATEGORY\" ,\n                    cast(null as character varying(256)) as \"CCS_CATEGORY_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"PLACE_OF_SERVICE_CODE\" ,\n                    cast(null as character varying(256)) as \"PLACE_OF_SERVICE_DESCRIPTION\" \n\n            from tuva.claims_preprocessing.outpatient_hospital_or_clinic__encounter_grain\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing.outpatient_injections__encounter_grain' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"ENCOUNTER_ID\" as NUMBER(18,0)) as \"ENCOUNTER_ID\" ,\n                    cast(\"ENCOUNTER_START_DATE\" as DATE) as \"ENCOUNTER_START_DATE\" ,\n                    cast(null as DATE) as \"ENCOUNTER_END_DATE\" ,\n                    cast(\"PATIENT_DATA_SOURCE_ID\" as NUMBER(18,0)) as \"PATIENT_DATA_SOURCE_ID\" ,\n                    cast(\"ENCOUNTER_TYPE\" as character varying(29)) as \"ENCOUNTER_TYPE\" ,\n                    cast(\"ENCOUNTER_GROUP\" as character varying(12)) as \"ENCOUNTER_GROUP\" ,\n                    cast(\"ADMIT_AGE\" as NUMBER(15,6)) as \"ADMIT_AGE\" ,\n                    cast(\"GENDER\" as character varying(16777216)) as \"GENDER\" ,\n                    cast(\"RACE\" as character varying(16777216)) as \"RACE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE_TYPE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE_TYPE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_DESCRIPTION\" as character varying(256)) as \"PRIMARY_DIAGNOSIS_DESCRIPTION\" ,\n                    cast(\"FACILITY_ID\" as character varying(16777216)) as \"FACILITY_ID\" ,\n                    cast(\"OBSERVATION_FLAG\" as NUMBER(1,0)) as \"OBSERVATION_FLAG\" ,\n                    cast(null as NUMBER(1,0)) as \"ED_FLAG\" ,\n                    cast(\"LAB_FLAG\" as NUMBER(1,0)) as \"LAB_FLAG\" ,\n                    cast(\"DME_FLAG\" as NUMBER(1,0)) as \"DME_FLAG\" ,\n                    cast(\"AMBULANCE_FLAG\" as NUMBER(1,0)) as \"AMBULANCE_FLAG\" ,\n                    cast(\"PHARMACY_FLAG\" as NUMBER(1,0)) as \"PHARMACY_FLAG\" ,\n                    cast(\"FACILITY_NAME\" as character varying(95)) as \"FACILITY_NAME\" ,\n                    cast(\"FACILITY_TYPE\" as character varying(173)) as \"FACILITY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"DELIVERY_FLAG\" ,\n                    cast(null as character varying(16777216)) as \"DELIVERY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"NEWBORN_FLAG\" ,\n                    cast(null as NUMBER(1,0)) as \"NICU_FLAG\" ,\n                    cast(null as character varying(16777216)) as \"DRG_CODE_TYPE\" ,\n                    cast(null as character varying(16777216)) as \"DRG_CODE\" ,\n                    cast(null as character varying(256)) as \"DRG_DESCRIPTION\" ,\n                    cast(null as character varying(256)) as \"MEDICAL_SURGICAL\" ,\n                    cast(null as character varying(16777216)) as \"ADMIT_SOURCE_CODE\" ,\n                    cast(null as character varying(256)) as \"ADMIT_SOURCE_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"ADMIT_TYPE_CODE\" ,\n                    cast(null as character varying(256)) as \"ADMIT_TYPE_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"DISCHARGE_DISPOSITION_CODE\" ,\n                    cast(null as character varying(256)) as \"DISCHARGE_DISPOSITION_DESCRIPTION\" ,\n                    cast(\"TOTAL_PAID_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_PAID_AMOUNT\" ,\n                    cast(\"TOTAL_ALLOWED_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_ALLOWED_AMOUNT\" ,\n                    cast(\"TOTAL_CHARGE_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_CHARGE_AMOUNT\" ,\n                    cast(\"CLAIM_COUNT\" as NUMBER(18,0)) as \"CLAIM_COUNT\" ,\n                    cast(\"INST_CLAIM_COUNT\" as NUMBER(18,0)) as \"INST_CLAIM_COUNT\" ,\n                    cast(\"PROF_CLAIM_COUNT\" as NUMBER(18,0)) as \"PROF_CLAIM_COUNT\" ,\n                    cast(null as NUMBER(9,0)) as \"LENGTH_OF_STAY\" ,\n                    cast(null as NUMBER(1,0)) as \"MORTALITY_FLAG\" ,\n                    cast(\"DATA_SOURCE\" as character varying(16777216)) as \"DATA_SOURCE\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as character varying(16777216)) as \"BILLING_ID\" ,\n                    cast(null as character varying(191)) as \"PROVIDER_NAME\" ,\n                    cast(null as character varying(173)) as \"PROVIDER_SPECIALTY\" ,\n                    cast(\"HCPCS_CODE\" as character varying(16777216)) as \"HCPCS_CODE\" ,\n                    cast(null as character varying(3)) as \"CCS_CATEGORY\" ,\n                    cast(null as character varying(256)) as \"CCS_CATEGORY_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"PLACE_OF_SERVICE_CODE\" ,\n                    cast(null as character varying(256)) as \"PLACE_OF_SERVICE_DESCRIPTION\" \n\n            from tuva.claims_preprocessing.outpatient_injections__encounter_grain\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing.outpatient_psych__encounter_grain' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"ENCOUNTER_ID\" as NUMBER(18,0)) as \"ENCOUNTER_ID\" ,\n                    cast(\"ENCOUNTER_START_DATE\" as DATE) as \"ENCOUNTER_START_DATE\" ,\n                    cast(null as DATE) as \"ENCOUNTER_END_DATE\" ,\n                    cast(\"PATIENT_DATA_SOURCE_ID\" as NUMBER(18,0)) as \"PATIENT_DATA_SOURCE_ID\" ,\n                    cast(\"ENCOUNTER_TYPE\" as character varying(29)) as \"ENCOUNTER_TYPE\" ,\n                    cast(\"ENCOUNTER_GROUP\" as character varying(12)) as \"ENCOUNTER_GROUP\" ,\n                    cast(\"ADMIT_AGE\" as NUMBER(15,6)) as \"ADMIT_AGE\" ,\n                    cast(\"GENDER\" as character varying(16777216)) as \"GENDER\" ,\n                    cast(\"RACE\" as character varying(16777216)) as \"RACE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE_TYPE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE_TYPE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_DESCRIPTION\" as character varying(256)) as \"PRIMARY_DIAGNOSIS_DESCRIPTION\" ,\n                    cast(\"FACILITY_ID\" as character varying(16777216)) as \"FACILITY_ID\" ,\n                    cast(\"OBSERVATION_FLAG\" as NUMBER(1,0)) as \"OBSERVATION_FLAG\" ,\n                    cast(null as NUMBER(1,0)) as \"ED_FLAG\" ,\n                    cast(\"LAB_FLAG\" as NUMBER(1,0)) as \"LAB_FLAG\" ,\n                    cast(\"DME_FLAG\" as NUMBER(1,0)) as \"DME_FLAG\" ,\n                    cast(\"AMBULANCE_FLAG\" as NUMBER(1,0)) as \"AMBULANCE_FLAG\" ,\n                    cast(\"PHARMACY_FLAG\" as NUMBER(1,0)) as \"PHARMACY_FLAG\" ,\n                    cast(\"FACILITY_NAME\" as character varying(95)) as \"FACILITY_NAME\" ,\n                    cast(\"FACILITY_TYPE\" as character varying(173)) as \"FACILITY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"DELIVERY_FLAG\" ,\n                    cast(null as character varying(16777216)) as \"DELIVERY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"NEWBORN_FLAG\" ,\n                    cast(null as NUMBER(1,0)) as \"NICU_FLAG\" ,\n                    cast(null as character varying(16777216)) as \"DRG_CODE_TYPE\" ,\n                    cast(null as character varying(16777216)) as \"DRG_CODE\" ,\n                    cast(null as character varying(256)) as \"DRG_DESCRIPTION\" ,\n                    cast(null as character varying(256)) as \"MEDICAL_SURGICAL\" ,\n                    cast(null as character varying(16777216)) as \"ADMIT_SOURCE_CODE\" ,\n                    cast(null as character varying(256)) as \"ADMIT_SOURCE_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"ADMIT_TYPE_CODE\" ,\n                    cast(null as character varying(256)) as \"ADMIT_TYPE_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"DISCHARGE_DISPOSITION_CODE\" ,\n                    cast(null as character varying(256)) as \"DISCHARGE_DISPOSITION_DESCRIPTION\" ,\n                    cast(\"TOTAL_PAID_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_PAID_AMOUNT\" ,\n                    cast(\"TOTAL_ALLOWED_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_ALLOWED_AMOUNT\" ,\n                    cast(\"TOTAL_CHARGE_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_CHARGE_AMOUNT\" ,\n                    cast(\"CLAIM_COUNT\" as NUMBER(18,0)) as \"CLAIM_COUNT\" ,\n                    cast(\"INST_CLAIM_COUNT\" as NUMBER(18,0)) as \"INST_CLAIM_COUNT\" ,\n                    cast(\"PROF_CLAIM_COUNT\" as NUMBER(18,0)) as \"PROF_CLAIM_COUNT\" ,\n                    cast(null as NUMBER(9,0)) as \"LENGTH_OF_STAY\" ,\n                    cast(null as NUMBER(1,0)) as \"MORTALITY_FLAG\" ,\n                    cast(\"DATA_SOURCE\" as character varying(16777216)) as \"DATA_SOURCE\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as character varying(16777216)) as \"BILLING_ID\" ,\n                    cast(null as character varying(191)) as \"PROVIDER_NAME\" ,\n                    cast(null as character varying(173)) as \"PROVIDER_SPECIALTY\" ,\n                    cast(null as character varying(16777216)) as \"HCPCS_CODE\" ,\n                    cast(null as character varying(3)) as \"CCS_CATEGORY\" ,\n                    cast(null as character varying(256)) as \"CCS_CATEGORY_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"PLACE_OF_SERVICE_CODE\" ,\n                    cast(null as character varying(256)) as \"PLACE_OF_SERVICE_DESCRIPTION\" \n\n            from tuva.claims_preprocessing.outpatient_psych__encounter_grain\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing.outpatient_ptotst__encounter_grain' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"ENCOUNTER_ID\" as NUMBER(18,0)) as \"ENCOUNTER_ID\" ,\n                    cast(\"ENCOUNTER_START_DATE\" as DATE) as \"ENCOUNTER_START_DATE\" ,\n                    cast(null as DATE) as \"ENCOUNTER_END_DATE\" ,\n                    cast(\"PATIENT_DATA_SOURCE_ID\" as NUMBER(18,0)) as \"PATIENT_DATA_SOURCE_ID\" ,\n                    cast(\"ENCOUNTER_TYPE\" as character varying(29)) as \"ENCOUNTER_TYPE\" ,\n                    cast(\"ENCOUNTER_GROUP\" as character varying(12)) as \"ENCOUNTER_GROUP\" ,\n                    cast(\"ADMIT_AGE\" as NUMBER(15,6)) as \"ADMIT_AGE\" ,\n                    cast(\"GENDER\" as character varying(16777216)) as \"GENDER\" ,\n                    cast(\"RACE\" as character varying(16777216)) as \"RACE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE_TYPE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE_TYPE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_DESCRIPTION\" as character varying(256)) as \"PRIMARY_DIAGNOSIS_DESCRIPTION\" ,\n                    cast(\"FACILITY_ID\" as character varying(16777216)) as \"FACILITY_ID\" ,\n                    cast(\"OBSERVATION_FLAG\" as NUMBER(1,0)) as \"OBSERVATION_FLAG\" ,\n                    cast(null as NUMBER(1,0)) as \"ED_FLAG\" ,\n                    cast(\"LAB_FLAG\" as NUMBER(1,0)) as \"LAB_FLAG\" ,\n                    cast(\"DME_FLAG\" as NUMBER(1,0)) as \"DME_FLAG\" ,\n                    cast(\"AMBULANCE_FLAG\" as NUMBER(1,0)) as \"AMBULANCE_FLAG\" ,\n                    cast(\"PHARMACY_FLAG\" as NUMBER(1,0)) as \"PHARMACY_FLAG\" ,\n                    cast(\"FACILITY_NAME\" as character varying(95)) as \"FACILITY_NAME\" ,\n                    cast(\"FACILITY_TYPE\" as character varying(173)) as \"FACILITY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"DELIVERY_FLAG\" ,\n                    cast(null as character varying(16777216)) as \"DELIVERY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"NEWBORN_FLAG\" ,\n                    cast(null as NUMBER(1,0)) as \"NICU_FLAG\" ,\n                    cast(null as character varying(16777216)) as \"DRG_CODE_TYPE\" ,\n                    cast(null as character varying(16777216)) as \"DRG_CODE\" ,\n                    cast(null as character varying(256)) as \"DRG_DESCRIPTION\" ,\n                    cast(null as character varying(256)) as \"MEDICAL_SURGICAL\" ,\n                    cast(null as character varying(16777216)) as \"ADMIT_SOURCE_CODE\" ,\n                    cast(null as character varying(256)) as \"ADMIT_SOURCE_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"ADMIT_TYPE_CODE\" ,\n                    cast(null as character varying(256)) as \"ADMIT_TYPE_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"DISCHARGE_DISPOSITION_CODE\" ,\n                    cast(null as character varying(256)) as \"DISCHARGE_DISPOSITION_DESCRIPTION\" ,\n                    cast(\"TOTAL_PAID_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_PAID_AMOUNT\" ,\n                    cast(\"TOTAL_ALLOWED_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_ALLOWED_AMOUNT\" ,\n                    cast(\"TOTAL_CHARGE_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_CHARGE_AMOUNT\" ,\n                    cast(\"CLAIM_COUNT\" as NUMBER(18,0)) as \"CLAIM_COUNT\" ,\n                    cast(\"INST_CLAIM_COUNT\" as NUMBER(18,0)) as \"INST_CLAIM_COUNT\" ,\n                    cast(\"PROF_CLAIM_COUNT\" as NUMBER(18,0)) as \"PROF_CLAIM_COUNT\" ,\n                    cast(null as NUMBER(9,0)) as \"LENGTH_OF_STAY\" ,\n                    cast(null as NUMBER(1,0)) as \"MORTALITY_FLAG\" ,\n                    cast(\"DATA_SOURCE\" as character varying(16777216)) as \"DATA_SOURCE\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as character varying(16777216)) as \"BILLING_ID\" ,\n                    cast(null as character varying(191)) as \"PROVIDER_NAME\" ,\n                    cast(null as character varying(173)) as \"PROVIDER_SPECIALTY\" ,\n                    cast(null as character varying(16777216)) as \"HCPCS_CODE\" ,\n                    cast(null as character varying(3)) as \"CCS_CATEGORY\" ,\n                    cast(null as character varying(256)) as \"CCS_CATEGORY_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"PLACE_OF_SERVICE_CODE\" ,\n                    cast(null as character varying(256)) as \"PLACE_OF_SERVICE_DESCRIPTION\" \n\n            from tuva.claims_preprocessing.outpatient_ptotst__encounter_grain\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing.outpatient_surgery__encounter_grain' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"ENCOUNTER_ID\" as NUMBER(18,0)) as \"ENCOUNTER_ID\" ,\n                    cast(\"ENCOUNTER_START_DATE\" as DATE) as \"ENCOUNTER_START_DATE\" ,\n                    cast(null as DATE) as \"ENCOUNTER_END_DATE\" ,\n                    cast(\"PATIENT_DATA_SOURCE_ID\" as NUMBER(18,0)) as \"PATIENT_DATA_SOURCE_ID\" ,\n                    cast(\"ENCOUNTER_TYPE\" as character varying(29)) as \"ENCOUNTER_TYPE\" ,\n                    cast(\"ENCOUNTER_GROUP\" as character varying(12)) as \"ENCOUNTER_GROUP\" ,\n                    cast(\"ADMIT_AGE\" as NUMBER(15,6)) as \"ADMIT_AGE\" ,\n                    cast(\"GENDER\" as character varying(16777216)) as \"GENDER\" ,\n                    cast(\"RACE\" as character varying(16777216)) as \"RACE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE_TYPE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE_TYPE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_DESCRIPTION\" as character varying(256)) as \"PRIMARY_DIAGNOSIS_DESCRIPTION\" ,\n                    cast(\"FACILITY_ID\" as character varying(16777216)) as \"FACILITY_ID\" ,\n                    cast(\"OBSERVATION_FLAG\" as NUMBER(1,0)) as \"OBSERVATION_FLAG\" ,\n                    cast(null as NUMBER(1,0)) as \"ED_FLAG\" ,\n                    cast(\"LAB_FLAG\" as NUMBER(1,0)) as \"LAB_FLAG\" ,\n                    cast(\"DME_FLAG\" as NUMBER(1,0)) as \"DME_FLAG\" ,\n                    cast(\"AMBULANCE_FLAG\" as NUMBER(1,0)) as \"AMBULANCE_FLAG\" ,\n                    cast(\"PHARMACY_FLAG\" as NUMBER(1,0)) as \"PHARMACY_FLAG\" ,\n                    cast(\"FACILITY_NAME\" as character varying(95)) as \"FACILITY_NAME\" ,\n                    cast(\"FACILITY_TYPE\" as character varying(173)) as \"FACILITY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"DELIVERY_FLAG\" ,\n                    cast(null as character varying(16777216)) as \"DELIVERY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"NEWBORN_FLAG\" ,\n                    cast(null as NUMBER(1,0)) as \"NICU_FLAG\" ,\n                    cast(null as character varying(16777216)) as \"DRG_CODE_TYPE\" ,\n                    cast(null as character varying(16777216)) as \"DRG_CODE\" ,\n                    cast(null as character varying(256)) as \"DRG_DESCRIPTION\" ,\n                    cast(null as character varying(256)) as \"MEDICAL_SURGICAL\" ,\n                    cast(null as character varying(16777216)) as \"ADMIT_SOURCE_CODE\" ,\n                    cast(null as character varying(256)) as \"ADMIT_SOURCE_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"ADMIT_TYPE_CODE\" ,\n                    cast(null as character varying(256)) as \"ADMIT_TYPE_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"DISCHARGE_DISPOSITION_CODE\" ,\n                    cast(null as character varying(256)) as \"DISCHARGE_DISPOSITION_DESCRIPTION\" ,\n                    cast(\"TOTAL_PAID_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_PAID_AMOUNT\" ,\n                    cast(\"TOTAL_ALLOWED_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_ALLOWED_AMOUNT\" ,\n                    cast(\"TOTAL_CHARGE_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_CHARGE_AMOUNT\" ,\n                    cast(\"CLAIM_COUNT\" as NUMBER(18,0)) as \"CLAIM_COUNT\" ,\n                    cast(\"INST_CLAIM_COUNT\" as NUMBER(18,0)) as \"INST_CLAIM_COUNT\" ,\n                    cast(\"PROF_CLAIM_COUNT\" as NUMBER(18,0)) as \"PROF_CLAIM_COUNT\" ,\n                    cast(null as NUMBER(9,0)) as \"LENGTH_OF_STAY\" ,\n                    cast(null as NUMBER(1,0)) as \"MORTALITY_FLAG\" ,\n                    cast(\"DATA_SOURCE\" as character varying(16777216)) as \"DATA_SOURCE\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as character varying(16777216)) as \"BILLING_ID\" ,\n                    cast(null as character varying(191)) as \"PROVIDER_NAME\" ,\n                    cast(null as character varying(173)) as \"PROVIDER_SPECIALTY\" ,\n                    cast(null as character varying(16777216)) as \"HCPCS_CODE\" ,\n                    cast(null as character varying(3)) as \"CCS_CATEGORY\" ,\n                    cast(null as character varying(256)) as \"CCS_CATEGORY_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"PLACE_OF_SERVICE_CODE\" ,\n                    cast(null as character varying(256)) as \"PLACE_OF_SERVICE_DESCRIPTION\" \n\n            from tuva.claims_preprocessing.outpatient_surgery__encounter_grain\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing.outpatient_radiology__encounter_grain' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"ENCOUNTER_ID\" as NUMBER(18,0)) as \"ENCOUNTER_ID\" ,\n                    cast(\"ENCOUNTER_START_DATE\" as DATE) as \"ENCOUNTER_START_DATE\" ,\n                    cast(null as DATE) as \"ENCOUNTER_END_DATE\" ,\n                    cast(\"PATIENT_DATA_SOURCE_ID\" as NUMBER(18,0)) as \"PATIENT_DATA_SOURCE_ID\" ,\n                    cast(\"ENCOUNTER_TYPE\" as character varying(29)) as \"ENCOUNTER_TYPE\" ,\n                    cast(\"ENCOUNTER_GROUP\" as character varying(12)) as \"ENCOUNTER_GROUP\" ,\n                    cast(\"ADMIT_AGE\" as NUMBER(15,6)) as \"ADMIT_AGE\" ,\n                    cast(\"GENDER\" as character varying(16777216)) as \"GENDER\" ,\n                    cast(\"RACE\" as character varying(16777216)) as \"RACE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE_TYPE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE_TYPE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_DESCRIPTION\" as character varying(256)) as \"PRIMARY_DIAGNOSIS_DESCRIPTION\" ,\n                    cast(\"FACILITY_ID\" as character varying(16777216)) as \"FACILITY_ID\" ,\n                    cast(\"OBSERVATION_FLAG\" as NUMBER(1,0)) as \"OBSERVATION_FLAG\" ,\n                    cast(null as NUMBER(1,0)) as \"ED_FLAG\" ,\n                    cast(\"LAB_FLAG\" as NUMBER(1,0)) as \"LAB_FLAG\" ,\n                    cast(\"DME_FLAG\" as NUMBER(1,0)) as \"DME_FLAG\" ,\n                    cast(\"AMBULANCE_FLAG\" as NUMBER(1,0)) as \"AMBULANCE_FLAG\" ,\n                    cast(\"PHARMACY_FLAG\" as NUMBER(1,0)) as \"PHARMACY_FLAG\" ,\n                    cast(\"FACILITY_NAME\" as character varying(95)) as \"FACILITY_NAME\" ,\n                    cast(\"FACILITY_TYPE\" as character varying(173)) as \"FACILITY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"DELIVERY_FLAG\" ,\n                    cast(null as character varying(16777216)) as \"DELIVERY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"NEWBORN_FLAG\" ,\n                    cast(null as NUMBER(1,0)) as \"NICU_FLAG\" ,\n                    cast(null as character varying(16777216)) as \"DRG_CODE_TYPE\" ,\n                    cast(null as character varying(16777216)) as \"DRG_CODE\" ,\n                    cast(null as character varying(256)) as \"DRG_DESCRIPTION\" ,\n                    cast(null as character varying(256)) as \"MEDICAL_SURGICAL\" ,\n                    cast(null as character varying(16777216)) as \"ADMIT_SOURCE_CODE\" ,\n                    cast(null as character varying(256)) as \"ADMIT_SOURCE_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"ADMIT_TYPE_CODE\" ,\n                    cast(null as character varying(256)) as \"ADMIT_TYPE_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"DISCHARGE_DISPOSITION_CODE\" ,\n                    cast(null as character varying(256)) as \"DISCHARGE_DISPOSITION_DESCRIPTION\" ,\n                    cast(\"TOTAL_PAID_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_PAID_AMOUNT\" ,\n                    cast(\"TOTAL_ALLOWED_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_ALLOWED_AMOUNT\" ,\n                    cast(\"TOTAL_CHARGE_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_CHARGE_AMOUNT\" ,\n                    cast(\"CLAIM_COUNT\" as NUMBER(18,0)) as \"CLAIM_COUNT\" ,\n                    cast(\"INST_CLAIM_COUNT\" as NUMBER(18,0)) as \"INST_CLAIM_COUNT\" ,\n                    cast(\"PROF_CLAIM_COUNT\" as NUMBER(18,0)) as \"PROF_CLAIM_COUNT\" ,\n                    cast(null as NUMBER(9,0)) as \"LENGTH_OF_STAY\" ,\n                    cast(null as NUMBER(1,0)) as \"MORTALITY_FLAG\" ,\n                    cast(\"DATA_SOURCE\" as character varying(16777216)) as \"DATA_SOURCE\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as character varying(16777216)) as \"BILLING_ID\" ,\n                    cast(null as character varying(191)) as \"PROVIDER_NAME\" ,\n                    cast(null as character varying(173)) as \"PROVIDER_SPECIALTY\" ,\n                    cast(\"HCPCS_CODE\" as character varying(16777216)) as \"HCPCS_CODE\" ,\n                    cast(null as character varying(3)) as \"CCS_CATEGORY\" ,\n                    cast(null as character varying(256)) as \"CCS_CATEGORY_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"PLACE_OF_SERVICE_CODE\" ,\n                    cast(null as character varying(256)) as \"PLACE_OF_SERVICE_DESCRIPTION\" \n\n            from tuva.claims_preprocessing.outpatient_radiology__encounter_grain\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing.outpatient_rehab__encounter_grain' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"ENCOUNTER_ID\" as NUMBER(18,0)) as \"ENCOUNTER_ID\" ,\n                    cast(\"ENCOUNTER_START_DATE\" as DATE) as \"ENCOUNTER_START_DATE\" ,\n                    cast(null as DATE) as \"ENCOUNTER_END_DATE\" ,\n                    cast(\"PATIENT_DATA_SOURCE_ID\" as NUMBER(18,0)) as \"PATIENT_DATA_SOURCE_ID\" ,\n                    cast(\"ENCOUNTER_TYPE\" as character varying(29)) as \"ENCOUNTER_TYPE\" ,\n                    cast(\"ENCOUNTER_GROUP\" as character varying(12)) as \"ENCOUNTER_GROUP\" ,\n                    cast(\"ADMIT_AGE\" as NUMBER(15,6)) as \"ADMIT_AGE\" ,\n                    cast(\"GENDER\" as character varying(16777216)) as \"GENDER\" ,\n                    cast(\"RACE\" as character varying(16777216)) as \"RACE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE_TYPE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE_TYPE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_DESCRIPTION\" as character varying(256)) as \"PRIMARY_DIAGNOSIS_DESCRIPTION\" ,\n                    cast(\"FACILITY_ID\" as character varying(16777216)) as \"FACILITY_ID\" ,\n                    cast(\"OBSERVATION_FLAG\" as NUMBER(1,0)) as \"OBSERVATION_FLAG\" ,\n                    cast(null as NUMBER(1,0)) as \"ED_FLAG\" ,\n                    cast(\"LAB_FLAG\" as NUMBER(1,0)) as \"LAB_FLAG\" ,\n                    cast(\"DME_FLAG\" as NUMBER(1,0)) as \"DME_FLAG\" ,\n                    cast(\"AMBULANCE_FLAG\" as NUMBER(1,0)) as \"AMBULANCE_FLAG\" ,\n                    cast(\"PHARMACY_FLAG\" as NUMBER(1,0)) as \"PHARMACY_FLAG\" ,\n                    cast(\"FACILITY_NAME\" as character varying(95)) as \"FACILITY_NAME\" ,\n                    cast(\"FACILITY_TYPE\" as character varying(173)) as \"FACILITY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"DELIVERY_FLAG\" ,\n                    cast(null as character varying(16777216)) as \"DELIVERY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"NEWBORN_FLAG\" ,\n                    cast(null as NUMBER(1,0)) as \"NICU_FLAG\" ,\n                    cast(null as character varying(16777216)) as \"DRG_CODE_TYPE\" ,\n                    cast(null as character varying(16777216)) as \"DRG_CODE\" ,\n                    cast(null as character varying(256)) as \"DRG_DESCRIPTION\" ,\n                    cast(null as character varying(256)) as \"MEDICAL_SURGICAL\" ,\n                    cast(null as character varying(16777216)) as \"ADMIT_SOURCE_CODE\" ,\n                    cast(null as character varying(256)) as \"ADMIT_SOURCE_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"ADMIT_TYPE_CODE\" ,\n                    cast(null as character varying(256)) as \"ADMIT_TYPE_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"DISCHARGE_DISPOSITION_CODE\" ,\n                    cast(null as character varying(256)) as \"DISCHARGE_DISPOSITION_DESCRIPTION\" ,\n                    cast(\"TOTAL_PAID_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_PAID_AMOUNT\" ,\n                    cast(\"TOTAL_ALLOWED_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_ALLOWED_AMOUNT\" ,\n                    cast(\"TOTAL_CHARGE_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_CHARGE_AMOUNT\" ,\n                    cast(\"CLAIM_COUNT\" as NUMBER(18,0)) as \"CLAIM_COUNT\" ,\n                    cast(\"INST_CLAIM_COUNT\" as NUMBER(18,0)) as \"INST_CLAIM_COUNT\" ,\n                    cast(\"PROF_CLAIM_COUNT\" as NUMBER(18,0)) as \"PROF_CLAIM_COUNT\" ,\n                    cast(null as NUMBER(9,0)) as \"LENGTH_OF_STAY\" ,\n                    cast(null as NUMBER(1,0)) as \"MORTALITY_FLAG\" ,\n                    cast(\"DATA_SOURCE\" as character varying(16777216)) as \"DATA_SOURCE\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as character varying(16777216)) as \"BILLING_ID\" ,\n                    cast(null as character varying(191)) as \"PROVIDER_NAME\" ,\n                    cast(null as character varying(173)) as \"PROVIDER_SPECIALTY\" ,\n                    cast(null as character varying(16777216)) as \"HCPCS_CODE\" ,\n                    cast(null as character varying(3)) as \"CCS_CATEGORY\" ,\n                    cast(null as character varying(256)) as \"CCS_CATEGORY_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"PLACE_OF_SERVICE_CODE\" ,\n                    cast(null as character varying(256)) as \"PLACE_OF_SERVICE_DESCRIPTION\" \n\n            from tuva.claims_preprocessing.outpatient_rehab__encounter_grain\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing.outpatient_substance_use__encounter_grain' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"ENCOUNTER_ID\" as NUMBER(18,0)) as \"ENCOUNTER_ID\" ,\n                    cast(\"ENCOUNTER_START_DATE\" as DATE) as \"ENCOUNTER_START_DATE\" ,\n                    cast(null as DATE) as \"ENCOUNTER_END_DATE\" ,\n                    cast(\"PATIENT_DATA_SOURCE_ID\" as NUMBER(18,0)) as \"PATIENT_DATA_SOURCE_ID\" ,\n                    cast(\"ENCOUNTER_TYPE\" as character varying(29)) as \"ENCOUNTER_TYPE\" ,\n                    cast(\"ENCOUNTER_GROUP\" as character varying(12)) as \"ENCOUNTER_GROUP\" ,\n                    cast(\"ADMIT_AGE\" as NUMBER(15,6)) as \"ADMIT_AGE\" ,\n                    cast(\"GENDER\" as character varying(16777216)) as \"GENDER\" ,\n                    cast(\"RACE\" as character varying(16777216)) as \"RACE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE_TYPE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE_TYPE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_DESCRIPTION\" as character varying(256)) as \"PRIMARY_DIAGNOSIS_DESCRIPTION\" ,\n                    cast(\"FACILITY_ID\" as character varying(16777216)) as \"FACILITY_ID\" ,\n                    cast(\"OBSERVATION_FLAG\" as NUMBER(1,0)) as \"OBSERVATION_FLAG\" ,\n                    cast(null as NUMBER(1,0)) as \"ED_FLAG\" ,\n                    cast(\"LAB_FLAG\" as NUMBER(1,0)) as \"LAB_FLAG\" ,\n                    cast(\"DME_FLAG\" as NUMBER(1,0)) as \"DME_FLAG\" ,\n                    cast(\"AMBULANCE_FLAG\" as NUMBER(1,0)) as \"AMBULANCE_FLAG\" ,\n                    cast(\"PHARMACY_FLAG\" as NUMBER(1,0)) as \"PHARMACY_FLAG\" ,\n                    cast(\"FACILITY_NAME\" as character varying(95)) as \"FACILITY_NAME\" ,\n                    cast(\"FACILITY_TYPE\" as character varying(173)) as \"FACILITY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"DELIVERY_FLAG\" ,\n                    cast(null as character varying(16777216)) as \"DELIVERY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"NEWBORN_FLAG\" ,\n                    cast(null as NUMBER(1,0)) as \"NICU_FLAG\" ,\n                    cast(null as character varying(16777216)) as \"DRG_CODE_TYPE\" ,\n                    cast(null as character varying(16777216)) as \"DRG_CODE\" ,\n                    cast(null as character varying(256)) as \"DRG_DESCRIPTION\" ,\n                    cast(null as character varying(256)) as \"MEDICAL_SURGICAL\" ,\n                    cast(null as character varying(16777216)) as \"ADMIT_SOURCE_CODE\" ,\n                    cast(null as character varying(256)) as \"ADMIT_SOURCE_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"ADMIT_TYPE_CODE\" ,\n                    cast(null as character varying(256)) as \"ADMIT_TYPE_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"DISCHARGE_DISPOSITION_CODE\" ,\n                    cast(null as character varying(256)) as \"DISCHARGE_DISPOSITION_DESCRIPTION\" ,\n                    cast(\"TOTAL_PAID_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_PAID_AMOUNT\" ,\n                    cast(\"TOTAL_ALLOWED_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_ALLOWED_AMOUNT\" ,\n                    cast(\"TOTAL_CHARGE_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_CHARGE_AMOUNT\" ,\n                    cast(\"CLAIM_COUNT\" as NUMBER(18,0)) as \"CLAIM_COUNT\" ,\n                    cast(\"INST_CLAIM_COUNT\" as NUMBER(18,0)) as \"INST_CLAIM_COUNT\" ,\n                    cast(\"PROF_CLAIM_COUNT\" as NUMBER(18,0)) as \"PROF_CLAIM_COUNT\" ,\n                    cast(null as NUMBER(9,0)) as \"LENGTH_OF_STAY\" ,\n                    cast(null as NUMBER(1,0)) as \"MORTALITY_FLAG\" ,\n                    cast(\"DATA_SOURCE\" as character varying(16777216)) as \"DATA_SOURCE\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as character varying(16777216)) as \"BILLING_ID\" ,\n                    cast(null as character varying(191)) as \"PROVIDER_NAME\" ,\n                    cast(null as character varying(173)) as \"PROVIDER_SPECIALTY\" ,\n                    cast(null as character varying(16777216)) as \"HCPCS_CODE\" ,\n                    cast(null as character varying(3)) as \"CCS_CATEGORY\" ,\n                    cast(null as character varying(256)) as \"CCS_CATEGORY_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"PLACE_OF_SERVICE_CODE\" ,\n                    cast(null as character varying(256)) as \"PLACE_OF_SERVICE_DESCRIPTION\" \n\n            from tuva.claims_preprocessing.outpatient_substance_use__encounter_grain\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing.home_health__encounter_grain' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"ENCOUNTER_ID\" as NUMBER(18,0)) as \"ENCOUNTER_ID\" ,\n                    cast(\"ENCOUNTER_START_DATE\" as DATE) as \"ENCOUNTER_START_DATE\" ,\n                    cast(null as DATE) as \"ENCOUNTER_END_DATE\" ,\n                    cast(\"PATIENT_DATA_SOURCE_ID\" as NUMBER(18,0)) as \"PATIENT_DATA_SOURCE_ID\" ,\n                    cast(\"ENCOUNTER_TYPE\" as character varying(29)) as \"ENCOUNTER_TYPE\" ,\n                    cast(\"ENCOUNTER_GROUP\" as character varying(12)) as \"ENCOUNTER_GROUP\" ,\n                    cast(\"ADMIT_AGE\" as NUMBER(15,6)) as \"ADMIT_AGE\" ,\n                    cast(\"GENDER\" as character varying(16777216)) as \"GENDER\" ,\n                    cast(\"RACE\" as character varying(16777216)) as \"RACE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE_TYPE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE_TYPE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_DESCRIPTION\" as character varying(256)) as \"PRIMARY_DIAGNOSIS_DESCRIPTION\" ,\n                    cast(\"FACILITY_ID\" as character varying(16777216)) as \"FACILITY_ID\" ,\n                    cast(null as NUMBER(1,0)) as \"OBSERVATION_FLAG\" ,\n                    cast(null as NUMBER(1,0)) as \"ED_FLAG\" ,\n                    cast(\"LAB_FLAG\" as NUMBER(1,0)) as \"LAB_FLAG\" ,\n                    cast(\"DME_FLAG\" as NUMBER(1,0)) as \"DME_FLAG\" ,\n                    cast(\"AMBULANCE_FLAG\" as NUMBER(1,0)) as \"AMBULANCE_FLAG\" ,\n                    cast(\"PHARMACY_FLAG\" as NUMBER(1,0)) as \"PHARMACY_FLAG\" ,\n                    cast(\"FACILITY_NAME\" as character varying(95)) as \"FACILITY_NAME\" ,\n                    cast(\"FACILITY_TYPE\" as character varying(173)) as \"FACILITY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"DELIVERY_FLAG\" ,\n                    cast(null as character varying(16777216)) as \"DELIVERY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"NEWBORN_FLAG\" ,\n                    cast(null as NUMBER(1,0)) as \"NICU_FLAG\" ,\n                    cast(null as character varying(16777216)) as \"DRG_CODE_TYPE\" ,\n                    cast(null as character varying(16777216)) as \"DRG_CODE\" ,\n                    cast(null as character varying(256)) as \"DRG_DESCRIPTION\" ,\n                    cast(null as character varying(256)) as \"MEDICAL_SURGICAL\" ,\n                    cast(null as character varying(16777216)) as \"ADMIT_SOURCE_CODE\" ,\n                    cast(null as character varying(256)) as \"ADMIT_SOURCE_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"ADMIT_TYPE_CODE\" ,\n                    cast(null as character varying(256)) as \"ADMIT_TYPE_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"DISCHARGE_DISPOSITION_CODE\" ,\n                    cast(null as character varying(256)) as \"DISCHARGE_DISPOSITION_DESCRIPTION\" ,\n                    cast(\"TOTAL_PAID_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_PAID_AMOUNT\" ,\n                    cast(\"TOTAL_ALLOWED_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_ALLOWED_AMOUNT\" ,\n                    cast(\"TOTAL_CHARGE_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_CHARGE_AMOUNT\" ,\n                    cast(\"CLAIM_COUNT\" as NUMBER(18,0)) as \"CLAIM_COUNT\" ,\n                    cast(\"INST_CLAIM_COUNT\" as NUMBER(18,0)) as \"INST_CLAIM_COUNT\" ,\n                    cast(\"PROF_CLAIM_COUNT\" as NUMBER(18,0)) as \"PROF_CLAIM_COUNT\" ,\n                    cast(null as NUMBER(9,0)) as \"LENGTH_OF_STAY\" ,\n                    cast(null as NUMBER(1,0)) as \"MORTALITY_FLAG\" ,\n                    cast(\"DATA_SOURCE\" as character varying(16777216)) as \"DATA_SOURCE\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as character varying(16777216)) as \"BILLING_ID\" ,\n                    cast(null as character varying(191)) as \"PROVIDER_NAME\" ,\n                    cast(null as character varying(173)) as \"PROVIDER_SPECIALTY\" ,\n                    cast(null as character varying(16777216)) as \"HCPCS_CODE\" ,\n                    cast(null as character varying(3)) as \"CCS_CATEGORY\" ,\n                    cast(null as character varying(256)) as \"CCS_CATEGORY_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"PLACE_OF_SERVICE_CODE\" ,\n                    cast(null as character varying(256)) as \"PLACE_OF_SERVICE_DESCRIPTION\" \n\n            from tuva.claims_preprocessing.home_health__encounter_grain\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing.dialysis__encounter_grain' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"ENCOUNTER_ID\" as NUMBER(18,0)) as \"ENCOUNTER_ID\" ,\n                    cast(\"ENCOUNTER_START_DATE\" as DATE) as \"ENCOUNTER_START_DATE\" ,\n                    cast(null as DATE) as \"ENCOUNTER_END_DATE\" ,\n                    cast(\"PATIENT_DATA_SOURCE_ID\" as NUMBER(18,0)) as \"PATIENT_DATA_SOURCE_ID\" ,\n                    cast(\"ENCOUNTER_TYPE\" as character varying(29)) as \"ENCOUNTER_TYPE\" ,\n                    cast(\"ENCOUNTER_GROUP\" as character varying(12)) as \"ENCOUNTER_GROUP\" ,\n                    cast(\"ADMIT_AGE\" as NUMBER(15,6)) as \"ADMIT_AGE\" ,\n                    cast(\"GENDER\" as character varying(16777216)) as \"GENDER\" ,\n                    cast(\"RACE\" as character varying(16777216)) as \"RACE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE_TYPE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE_TYPE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_DESCRIPTION\" as character varying(256)) as \"PRIMARY_DIAGNOSIS_DESCRIPTION\" ,\n                    cast(\"FACILITY_ID\" as character varying(16777216)) as \"FACILITY_ID\" ,\n                    cast(null as NUMBER(1,0)) as \"OBSERVATION_FLAG\" ,\n                    cast(null as NUMBER(1,0)) as \"ED_FLAG\" ,\n                    cast(\"LAB_FLAG\" as NUMBER(1,0)) as \"LAB_FLAG\" ,\n                    cast(\"DME_FLAG\" as NUMBER(1,0)) as \"DME_FLAG\" ,\n                    cast(\"AMBULANCE_FLAG\" as NUMBER(1,0)) as \"AMBULANCE_FLAG\" ,\n                    cast(\"PHARMACY_FLAG\" as NUMBER(1,0)) as \"PHARMACY_FLAG\" ,\n                    cast(\"FACILITY_NAME\" as character varying(95)) as \"FACILITY_NAME\" ,\n                    cast(\"FACILITY_TYPE\" as character varying(173)) as \"FACILITY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"DELIVERY_FLAG\" ,\n                    cast(null as character varying(16777216)) as \"DELIVERY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"NEWBORN_FLAG\" ,\n                    cast(null as NUMBER(1,0)) as \"NICU_FLAG\" ,\n                    cast(null as character varying(16777216)) as \"DRG_CODE_TYPE\" ,\n                    cast(null as character varying(16777216)) as \"DRG_CODE\" ,\n                    cast(null as character varying(256)) as \"DRG_DESCRIPTION\" ,\n                    cast(null as character varying(256)) as \"MEDICAL_SURGICAL\" ,\n                    cast(null as character varying(16777216)) as \"ADMIT_SOURCE_CODE\" ,\n                    cast(null as character varying(256)) as \"ADMIT_SOURCE_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"ADMIT_TYPE_CODE\" ,\n                    cast(null as character varying(256)) as \"ADMIT_TYPE_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"DISCHARGE_DISPOSITION_CODE\" ,\n                    cast(null as character varying(256)) as \"DISCHARGE_DISPOSITION_DESCRIPTION\" ,\n                    cast(\"TOTAL_PAID_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_PAID_AMOUNT\" ,\n                    cast(\"TOTAL_ALLOWED_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_ALLOWED_AMOUNT\" ,\n                    cast(\"TOTAL_CHARGE_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_CHARGE_AMOUNT\" ,\n                    cast(\"CLAIM_COUNT\" as NUMBER(18,0)) as \"CLAIM_COUNT\" ,\n                    cast(\"INST_CLAIM_COUNT\" as NUMBER(18,0)) as \"INST_CLAIM_COUNT\" ,\n                    cast(\"PROF_CLAIM_COUNT\" as NUMBER(18,0)) as \"PROF_CLAIM_COUNT\" ,\n                    cast(null as NUMBER(9,0)) as \"LENGTH_OF_STAY\" ,\n                    cast(null as NUMBER(1,0)) as \"MORTALITY_FLAG\" ,\n                    cast(\"DATA_SOURCE\" as character varying(16777216)) as \"DATA_SOURCE\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as character varying(16777216)) as \"BILLING_ID\" ,\n                    cast(null as character varying(191)) as \"PROVIDER_NAME\" ,\n                    cast(null as character varying(173)) as \"PROVIDER_SPECIALTY\" ,\n                    cast(null as character varying(16777216)) as \"HCPCS_CODE\" ,\n                    cast(null as character varying(3)) as \"CCS_CATEGORY\" ,\n                    cast(null as character varying(256)) as \"CCS_CATEGORY_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"PLACE_OF_SERVICE_CODE\" ,\n                    cast(null as character varying(256)) as \"PLACE_OF_SERVICE_DESCRIPTION\" \n\n            from tuva.claims_preprocessing.dialysis__encounter_grain\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing.asc__encounter_grain' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"ENCOUNTER_ID\" as NUMBER(18,0)) as \"ENCOUNTER_ID\" ,\n                    cast(\"ENCOUNTER_START_DATE\" as DATE) as \"ENCOUNTER_START_DATE\" ,\n                    cast(\"ENCOUNTER_END_DATE\" as DATE) as \"ENCOUNTER_END_DATE\" ,\n                    cast(\"PATIENT_DATA_SOURCE_ID\" as NUMBER(18,0)) as \"PATIENT_DATA_SOURCE_ID\" ,\n                    cast(\"ENCOUNTER_TYPE\" as character varying(29)) as \"ENCOUNTER_TYPE\" ,\n                    cast(\"ENCOUNTER_GROUP\" as character varying(12)) as \"ENCOUNTER_GROUP\" ,\n                    cast(\"ADMIT_AGE\" as NUMBER(15,6)) as \"ADMIT_AGE\" ,\n                    cast(\"GENDER\" as character varying(16777216)) as \"GENDER\" ,\n                    cast(\"RACE\" as character varying(16777216)) as \"RACE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE_TYPE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE_TYPE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_DESCRIPTION\" as character varying(256)) as \"PRIMARY_DIAGNOSIS_DESCRIPTION\" ,\n                    cast(\"FACILITY_ID\" as character varying(16777216)) as \"FACILITY_ID\" ,\n                    cast(null as NUMBER(1,0)) as \"OBSERVATION_FLAG\" ,\n                    cast(null as NUMBER(1,0)) as \"ED_FLAG\" ,\n                    cast(\"LAB_FLAG\" as NUMBER(1,0)) as \"LAB_FLAG\" ,\n                    cast(\"DME_FLAG\" as NUMBER(1,0)) as \"DME_FLAG\" ,\n                    cast(\"AMBULANCE_FLAG\" as NUMBER(1,0)) as \"AMBULANCE_FLAG\" ,\n                    cast(\"PHARMACY_FLAG\" as NUMBER(1,0)) as \"PHARMACY_FLAG\" ,\n                    cast(\"FACILITY_NAME\" as character varying(95)) as \"FACILITY_NAME\" ,\n                    cast(\"FACILITY_TYPE\" as character varying(173)) as \"FACILITY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"DELIVERY_FLAG\" ,\n                    cast(null as character varying(16777216)) as \"DELIVERY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"NEWBORN_FLAG\" ,\n                    cast(null as NUMBER(1,0)) as \"NICU_FLAG\" ,\n                    cast(null as character varying(16777216)) as \"DRG_CODE_TYPE\" ,\n                    cast(null as character varying(16777216)) as \"DRG_CODE\" ,\n                    cast(null as character varying(256)) as \"DRG_DESCRIPTION\" ,\n                    cast(null as character varying(256)) as \"MEDICAL_SURGICAL\" ,\n                    cast(null as character varying(16777216)) as \"ADMIT_SOURCE_CODE\" ,\n                    cast(null as character varying(256)) as \"ADMIT_SOURCE_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"ADMIT_TYPE_CODE\" ,\n                    cast(null as character varying(256)) as \"ADMIT_TYPE_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"DISCHARGE_DISPOSITION_CODE\" ,\n                    cast(null as character varying(256)) as \"DISCHARGE_DISPOSITION_DESCRIPTION\" ,\n                    cast(\"TOTAL_PAID_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_PAID_AMOUNT\" ,\n                    cast(\"TOTAL_ALLOWED_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_ALLOWED_AMOUNT\" ,\n                    cast(\"TOTAL_CHARGE_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_CHARGE_AMOUNT\" ,\n                    cast(\"CLAIM_COUNT\" as NUMBER(18,0)) as \"CLAIM_COUNT\" ,\n                    cast(\"INST_CLAIM_COUNT\" as NUMBER(18,0)) as \"INST_CLAIM_COUNT\" ,\n                    cast(\"PROF_CLAIM_COUNT\" as NUMBER(18,0)) as \"PROF_CLAIM_COUNT\" ,\n                    cast(\"LENGTH_OF_STAY\" as NUMBER(9,0)) as \"LENGTH_OF_STAY\" ,\n                    cast(null as NUMBER(1,0)) as \"MORTALITY_FLAG\" ,\n                    cast(\"DATA_SOURCE\" as character varying(16777216)) as \"DATA_SOURCE\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as character varying(16777216)) as \"BILLING_ID\" ,\n                    cast(null as character varying(191)) as \"PROVIDER_NAME\" ,\n                    cast(null as character varying(173)) as \"PROVIDER_SPECIALTY\" ,\n                    cast(\"HCPCS_CODE\" as character varying(16777216)) as \"HCPCS_CODE\" ,\n                    cast(null as character varying(3)) as \"CCS_CATEGORY\" ,\n                    cast(null as character varying(256)) as \"CCS_CATEGORY_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"PLACE_OF_SERVICE_CODE\" ,\n                    cast(null as character varying(256)) as \"PLACE_OF_SERVICE_DESCRIPTION\" \n\n            from tuva.claims_preprocessing.asc__encounter_grain\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing.ambulance__encounter_grain' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"ENCOUNTER_ID\" as NUMBER(18,0)) as \"ENCOUNTER_ID\" ,\n                    cast(\"ENCOUNTER_START_DATE\" as DATE) as \"ENCOUNTER_START_DATE\" ,\n                    cast(null as DATE) as \"ENCOUNTER_END_DATE\" ,\n                    cast(\"PATIENT_DATA_SOURCE_ID\" as NUMBER(18,0)) as \"PATIENT_DATA_SOURCE_ID\" ,\n                    cast(\"ENCOUNTER_TYPE\" as character varying(29)) as \"ENCOUNTER_TYPE\" ,\n                    cast(\"ENCOUNTER_GROUP\" as character varying(12)) as \"ENCOUNTER_GROUP\" ,\n                    cast(\"ADMIT_AGE\" as NUMBER(15,6)) as \"ADMIT_AGE\" ,\n                    cast(\"GENDER\" as character varying(16777216)) as \"GENDER\" ,\n                    cast(\"RACE\" as character varying(16777216)) as \"RACE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE_TYPE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE_TYPE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_DESCRIPTION\" as character varying(256)) as \"PRIMARY_DIAGNOSIS_DESCRIPTION\" ,\n                    cast(\"FACILITY_ID\" as character varying(16777216)) as \"FACILITY_ID\" ,\n                    cast(null as NUMBER(1,0)) as \"OBSERVATION_FLAG\" ,\n                    cast(null as NUMBER(1,0)) as \"ED_FLAG\" ,\n                    cast(\"LAB_FLAG\" as NUMBER(1,0)) as \"LAB_FLAG\" ,\n                    cast(\"DME_FLAG\" as NUMBER(1,0)) as \"DME_FLAG\" ,\n                    cast(\"AMBULANCE_FLAG\" as NUMBER(1,0)) as \"AMBULANCE_FLAG\" ,\n                    cast(\"PHARMACY_FLAG\" as NUMBER(1,0)) as \"PHARMACY_FLAG\" ,\n                    cast(\"FACILITY_NAME\" as character varying(95)) as \"FACILITY_NAME\" ,\n                    cast(\"FACILITY_TYPE\" as character varying(173)) as \"FACILITY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"DELIVERY_FLAG\" ,\n                    cast(null as character varying(16777216)) as \"DELIVERY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"NEWBORN_FLAG\" ,\n                    cast(null as NUMBER(1,0)) as \"NICU_FLAG\" ,\n                    cast(null as character varying(16777216)) as \"DRG_CODE_TYPE\" ,\n                    cast(null as character varying(16777216)) as \"DRG_CODE\" ,\n                    cast(null as character varying(256)) as \"DRG_DESCRIPTION\" ,\n                    cast(null as character varying(256)) as \"MEDICAL_SURGICAL\" ,\n                    cast(null as character varying(16777216)) as \"ADMIT_SOURCE_CODE\" ,\n                    cast(null as character varying(256)) as \"ADMIT_SOURCE_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"ADMIT_TYPE_CODE\" ,\n                    cast(null as character varying(256)) as \"ADMIT_TYPE_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"DISCHARGE_DISPOSITION_CODE\" ,\n                    cast(null as character varying(256)) as \"DISCHARGE_DISPOSITION_DESCRIPTION\" ,\n                    cast(\"TOTAL_PAID_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_PAID_AMOUNT\" ,\n                    cast(\"TOTAL_ALLOWED_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_ALLOWED_AMOUNT\" ,\n                    cast(\"TOTAL_CHARGE_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_CHARGE_AMOUNT\" ,\n                    cast(\"CLAIM_COUNT\" as NUMBER(18,0)) as \"CLAIM_COUNT\" ,\n                    cast(\"INST_CLAIM_COUNT\" as NUMBER(18,0)) as \"INST_CLAIM_COUNT\" ,\n                    cast(\"PROF_CLAIM_COUNT\" as NUMBER(18,0)) as \"PROF_CLAIM_COUNT\" ,\n                    cast(null as NUMBER(9,0)) as \"LENGTH_OF_STAY\" ,\n                    cast(null as NUMBER(1,0)) as \"MORTALITY_FLAG\" ,\n                    cast(\"DATA_SOURCE\" as character varying(16777216)) as \"DATA_SOURCE\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as character varying(16777216)) as \"BILLING_ID\" ,\n                    cast(null as character varying(191)) as \"PROVIDER_NAME\" ,\n                    cast(null as character varying(173)) as \"PROVIDER_SPECIALTY\" ,\n                    cast(null as character varying(16777216)) as \"HCPCS_CODE\" ,\n                    cast(null as character varying(3)) as \"CCS_CATEGORY\" ,\n                    cast(null as character varying(256)) as \"CCS_CATEGORY_DESCRIPTION\" ,\n                    cast(\"PLACE_OF_SERVICE_CODE\" as character varying(16777216)) as \"PLACE_OF_SERVICE_CODE\" ,\n                    cast(\"PLACE_OF_SERVICE_DESCRIPTION\" as character varying(256)) as \"PLACE_OF_SERVICE_DESCRIPTION\" \n\n            from tuva.claims_preprocessing.ambulance__encounter_grain\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing.dme__encounter_grain' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"ENCOUNTER_ID\" as NUMBER(18,0)) as \"ENCOUNTER_ID\" ,\n                    cast(\"ENCOUNTER_START_DATE\" as DATE) as \"ENCOUNTER_START_DATE\" ,\n                    cast(null as DATE) as \"ENCOUNTER_END_DATE\" ,\n                    cast(\"PATIENT_DATA_SOURCE_ID\" as NUMBER(18,0)) as \"PATIENT_DATA_SOURCE_ID\" ,\n                    cast(\"ENCOUNTER_TYPE\" as character varying(29)) as \"ENCOUNTER_TYPE\" ,\n                    cast(\"ENCOUNTER_GROUP\" as character varying(12)) as \"ENCOUNTER_GROUP\" ,\n                    cast(\"ADMIT_AGE\" as NUMBER(15,6)) as \"ADMIT_AGE\" ,\n                    cast(\"GENDER\" as character varying(16777216)) as \"GENDER\" ,\n                    cast(\"RACE\" as character varying(16777216)) as \"RACE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE_TYPE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE_TYPE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_DESCRIPTION\" as character varying(256)) as \"PRIMARY_DIAGNOSIS_DESCRIPTION\" ,\n                    cast(\"FACILITY_ID\" as character varying(16777216)) as \"FACILITY_ID\" ,\n                    cast(null as NUMBER(1,0)) as \"OBSERVATION_FLAG\" ,\n                    cast(null as NUMBER(1,0)) as \"ED_FLAG\" ,\n                    cast(\"LAB_FLAG\" as NUMBER(1,0)) as \"LAB_FLAG\" ,\n                    cast(\"DME_FLAG\" as NUMBER(1,0)) as \"DME_FLAG\" ,\n                    cast(\"AMBULANCE_FLAG\" as NUMBER(1,0)) as \"AMBULANCE_FLAG\" ,\n                    cast(\"PHARMACY_FLAG\" as NUMBER(1,0)) as \"PHARMACY_FLAG\" ,\n                    cast(\"FACILITY_NAME\" as character varying(95)) as \"FACILITY_NAME\" ,\n                    cast(\"FACILITY_TYPE\" as character varying(173)) as \"FACILITY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"DELIVERY_FLAG\" ,\n                    cast(null as character varying(16777216)) as \"DELIVERY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"NEWBORN_FLAG\" ,\n                    cast(null as NUMBER(1,0)) as \"NICU_FLAG\" ,\n                    cast(null as character varying(16777216)) as \"DRG_CODE_TYPE\" ,\n                    cast(null as character varying(16777216)) as \"DRG_CODE\" ,\n                    cast(null as character varying(256)) as \"DRG_DESCRIPTION\" ,\n                    cast(null as character varying(256)) as \"MEDICAL_SURGICAL\" ,\n                    cast(null as character varying(16777216)) as \"ADMIT_SOURCE_CODE\" ,\n                    cast(null as character varying(256)) as \"ADMIT_SOURCE_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"ADMIT_TYPE_CODE\" ,\n                    cast(null as character varying(256)) as \"ADMIT_TYPE_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"DISCHARGE_DISPOSITION_CODE\" ,\n                    cast(null as character varying(256)) as \"DISCHARGE_DISPOSITION_DESCRIPTION\" ,\n                    cast(\"TOTAL_PAID_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_PAID_AMOUNT\" ,\n                    cast(\"TOTAL_ALLOWED_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_ALLOWED_AMOUNT\" ,\n                    cast(\"TOTAL_CHARGE_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_CHARGE_AMOUNT\" ,\n                    cast(\"CLAIM_COUNT\" as NUMBER(18,0)) as \"CLAIM_COUNT\" ,\n                    cast(\"INST_CLAIM_COUNT\" as NUMBER(18,0)) as \"INST_CLAIM_COUNT\" ,\n                    cast(\"PROF_CLAIM_COUNT\" as NUMBER(18,0)) as \"PROF_CLAIM_COUNT\" ,\n                    cast(null as NUMBER(9,0)) as \"LENGTH_OF_STAY\" ,\n                    cast(null as NUMBER(1,0)) as \"MORTALITY_FLAG\" ,\n                    cast(\"DATA_SOURCE\" as character varying(16777216)) as \"DATA_SOURCE\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as character varying(16777216)) as \"BILLING_ID\" ,\n                    cast(null as character varying(191)) as \"PROVIDER_NAME\" ,\n                    cast(null as character varying(173)) as \"PROVIDER_SPECIALTY\" ,\n                    cast(null as character varying(16777216)) as \"HCPCS_CODE\" ,\n                    cast(null as character varying(3)) as \"CCS_CATEGORY\" ,\n                    cast(null as character varying(256)) as \"CCS_CATEGORY_DESCRIPTION\" ,\n                    cast(\"PLACE_OF_SERVICE_CODE\" as character varying(16777216)) as \"PLACE_OF_SERVICE_CODE\" ,\n                    cast(\"PLACE_OF_SERVICE_DESCRIPTION\" as character varying(256)) as \"PLACE_OF_SERVICE_DESCRIPTION\" \n\n            from tuva.claims_preprocessing.dme__encounter_grain\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing.lab__encounter_grain' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"ENCOUNTER_ID\" as NUMBER(18,0)) as \"ENCOUNTER_ID\" ,\n                    cast(\"ENCOUNTER_START_DATE\" as DATE) as \"ENCOUNTER_START_DATE\" ,\n                    cast(null as DATE) as \"ENCOUNTER_END_DATE\" ,\n                    cast(\"PATIENT_DATA_SOURCE_ID\" as NUMBER(18,0)) as \"PATIENT_DATA_SOURCE_ID\" ,\n                    cast(\"ENCOUNTER_TYPE\" as character varying(29)) as \"ENCOUNTER_TYPE\" ,\n                    cast(\"ENCOUNTER_GROUP\" as character varying(12)) as \"ENCOUNTER_GROUP\" ,\n                    cast(\"ADMIT_AGE\" as NUMBER(15,6)) as \"ADMIT_AGE\" ,\n                    cast(\"GENDER\" as character varying(16777216)) as \"GENDER\" ,\n                    cast(\"RACE\" as character varying(16777216)) as \"RACE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE_TYPE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE_TYPE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_DESCRIPTION\" as character varying(256)) as \"PRIMARY_DIAGNOSIS_DESCRIPTION\" ,\n                    cast(\"FACILITY_ID\" as character varying(16777216)) as \"FACILITY_ID\" ,\n                    cast(null as NUMBER(1,0)) as \"OBSERVATION_FLAG\" ,\n                    cast(null as NUMBER(1,0)) as \"ED_FLAG\" ,\n                    cast(\"LAB_FLAG\" as NUMBER(1,0)) as \"LAB_FLAG\" ,\n                    cast(\"DME_FLAG\" as NUMBER(1,0)) as \"DME_FLAG\" ,\n                    cast(\"AMBULANCE_FLAG\" as NUMBER(1,0)) as \"AMBULANCE_FLAG\" ,\n                    cast(\"PHARMACY_FLAG\" as NUMBER(1,0)) as \"PHARMACY_FLAG\" ,\n                    cast(\"FACILITY_NAME\" as character varying(95)) as \"FACILITY_NAME\" ,\n                    cast(\"FACILITY_TYPE\" as character varying(173)) as \"FACILITY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"DELIVERY_FLAG\" ,\n                    cast(null as character varying(16777216)) as \"DELIVERY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"NEWBORN_FLAG\" ,\n                    cast(null as NUMBER(1,0)) as \"NICU_FLAG\" ,\n                    cast(null as character varying(16777216)) as \"DRG_CODE_TYPE\" ,\n                    cast(null as character varying(16777216)) as \"DRG_CODE\" ,\n                    cast(null as character varying(256)) as \"DRG_DESCRIPTION\" ,\n                    cast(null as character varying(256)) as \"MEDICAL_SURGICAL\" ,\n                    cast(null as character varying(16777216)) as \"ADMIT_SOURCE_CODE\" ,\n                    cast(null as character varying(256)) as \"ADMIT_SOURCE_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"ADMIT_TYPE_CODE\" ,\n                    cast(null as character varying(256)) as \"ADMIT_TYPE_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"DISCHARGE_DISPOSITION_CODE\" ,\n                    cast(null as character varying(256)) as \"DISCHARGE_DISPOSITION_DESCRIPTION\" ,\n                    cast(\"TOTAL_PAID_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_PAID_AMOUNT\" ,\n                    cast(\"TOTAL_ALLOWED_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_ALLOWED_AMOUNT\" ,\n                    cast(\"TOTAL_CHARGE_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_CHARGE_AMOUNT\" ,\n                    cast(\"CLAIM_COUNT\" as NUMBER(18,0)) as \"CLAIM_COUNT\" ,\n                    cast(\"INST_CLAIM_COUNT\" as NUMBER(18,0)) as \"INST_CLAIM_COUNT\" ,\n                    cast(\"PROF_CLAIM_COUNT\" as NUMBER(18,0)) as \"PROF_CLAIM_COUNT\" ,\n                    cast(null as NUMBER(9,0)) as \"LENGTH_OF_STAY\" ,\n                    cast(null as NUMBER(1,0)) as \"MORTALITY_FLAG\" ,\n                    cast(\"DATA_SOURCE\" as character varying(16777216)) as \"DATA_SOURCE\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as character varying(16777216)) as \"BILLING_ID\" ,\n                    cast(null as character varying(191)) as \"PROVIDER_NAME\" ,\n                    cast(null as character varying(173)) as \"PROVIDER_SPECIALTY\" ,\n                    cast(null as character varying(16777216)) as \"HCPCS_CODE\" ,\n                    cast(null as character varying(3)) as \"CCS_CATEGORY\" ,\n                    cast(null as character varying(256)) as \"CCS_CATEGORY_DESCRIPTION\" ,\n                    cast(\"PLACE_OF_SERVICE_CODE\" as character varying(16777216)) as \"PLACE_OF_SERVICE_CODE\" ,\n                    cast(\"PLACE_OF_SERVICE_DESCRIPTION\" as character varying(256)) as \"PLACE_OF_SERVICE_DESCRIPTION\" \n\n            from tuva.claims_preprocessing.lab__encounter_grain\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.claims_preprocessing.orphaned_claim__encounter_grain' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"ENCOUNTER_ID\" as NUMBER(18,0)) as \"ENCOUNTER_ID\" ,\n                    cast(\"ENCOUNTER_START_DATE\" as DATE) as \"ENCOUNTER_START_DATE\" ,\n                    cast(\"ENCOUNTER_END_DATE\" as DATE) as \"ENCOUNTER_END_DATE\" ,\n                    cast(\"PATIENT_DATA_SOURCE_ID\" as NUMBER(18,0)) as \"PATIENT_DATA_SOURCE_ID\" ,\n                    cast(\"ENCOUNTER_TYPE\" as character varying(29)) as \"ENCOUNTER_TYPE\" ,\n                    cast(\"ENCOUNTER_GROUP\" as character varying(12)) as \"ENCOUNTER_GROUP\" ,\n                    cast(\"ADMIT_AGE\" as NUMBER(15,6)) as \"ADMIT_AGE\" ,\n                    cast(\"GENDER\" as character varying(16777216)) as \"GENDER\" ,\n                    cast(\"RACE\" as character varying(16777216)) as \"RACE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE_TYPE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE_TYPE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_CODE\" as character varying(16777216)) as \"PRIMARY_DIAGNOSIS_CODE\" ,\n                    cast(\"PRIMARY_DIAGNOSIS_DESCRIPTION\" as character varying(256)) as \"PRIMARY_DIAGNOSIS_DESCRIPTION\" ,\n                    cast(\"FACILITY_ID\" as character varying(16777216)) as \"FACILITY_ID\" ,\n                    cast(null as NUMBER(1,0)) as \"OBSERVATION_FLAG\" ,\n                    cast(null as NUMBER(1,0)) as \"ED_FLAG\" ,\n                    cast(\"LAB_FLAG\" as NUMBER(1,0)) as \"LAB_FLAG\" ,\n                    cast(\"DME_FLAG\" as NUMBER(1,0)) as \"DME_FLAG\" ,\n                    cast(\"AMBULANCE_FLAG\" as NUMBER(1,0)) as \"AMBULANCE_FLAG\" ,\n                    cast(\"PHARMACY_FLAG\" as NUMBER(1,0)) as \"PHARMACY_FLAG\" ,\n                    cast(\"FACILITY_NAME\" as character varying(95)) as \"FACILITY_NAME\" ,\n                    cast(\"FACILITY_TYPE\" as character varying(173)) as \"FACILITY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"DELIVERY_FLAG\" ,\n                    cast(null as character varying(16777216)) as \"DELIVERY_TYPE\" ,\n                    cast(null as NUMBER(1,0)) as \"NEWBORN_FLAG\" ,\n                    cast(null as NUMBER(1,0)) as \"NICU_FLAG\" ,\n                    cast(null as character varying(16777216)) as \"DRG_CODE_TYPE\" ,\n                    cast(null as character varying(16777216)) as \"DRG_CODE\" ,\n                    cast(null as character varying(256)) as \"DRG_DESCRIPTION\" ,\n                    cast(null as character varying(256)) as \"MEDICAL_SURGICAL\" ,\n                    cast(null as character varying(16777216)) as \"ADMIT_SOURCE_CODE\" ,\n                    cast(null as character varying(256)) as \"ADMIT_SOURCE_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"ADMIT_TYPE_CODE\" ,\n                    cast(null as character varying(256)) as \"ADMIT_TYPE_DESCRIPTION\" ,\n                    cast(null as character varying(16777216)) as \"DISCHARGE_DISPOSITION_CODE\" ,\n                    cast(null as character varying(256)) as \"DISCHARGE_DISPOSITION_DESCRIPTION\" ,\n                    cast(\"TOTAL_PAID_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_PAID_AMOUNT\" ,\n                    cast(\"TOTAL_ALLOWED_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_ALLOWED_AMOUNT\" ,\n                    cast(\"TOTAL_CHARGE_AMOUNT\" as NUMBER(38,6)) as \"TOTAL_CHARGE_AMOUNT\" ,\n                    cast(\"CLAIM_COUNT\" as NUMBER(18,0)) as \"CLAIM_COUNT\" ,\n                    cast(\"INST_CLAIM_COUNT\" as NUMBER(18,0)) as \"INST_CLAIM_COUNT\" ,\n                    cast(\"PROF_CLAIM_COUNT\" as NUMBER(18,0)) as \"PROF_CLAIM_COUNT\" ,\n                    cast(null as NUMBER(9,0)) as \"LENGTH_OF_STAY\" ,\n                    cast(null as NUMBER(1,0)) as \"MORTALITY_FLAG\" ,\n                    cast(\"DATA_SOURCE\" as character varying(16777216)) as \"DATA_SOURCE\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as character varying(16777216)) as \"BILLING_ID\" ,\n                    cast(null as character varying(191)) as \"PROVIDER_NAME\" ,\n                    cast(null as character varying(173)) as \"PROVIDER_SPECIALTY\" ,\n                    cast(null as character varying(16777216)) as \"HCPCS_CODE\" ,\n                    cast(null as character varying(3)) as \"CCS_CATEGORY\" ,\n                    cast(null as character varying(256)) as \"CCS_CATEGORY_DESCRIPTION\" ,\n                    cast(\"PLACE_OF_SERVICE_CODE\" as character varying(16777216)) as \"PLACE_OF_SERVICE_CODE\" ,\n                    cast(\"PLACE_OF_SERVICE_DESCRIPTION\" as character varying(256)) as \"PLACE_OF_SERVICE_DESCRIPTION\" \n\n            from tuva.claims_preprocessing.orphaned_claim__encounter_grain\n\n            \n        )\n\n        \n)\n\nSELECT\n    cast(encounter_id as TEXT ) as encounter_id\n  , cast(p.person_id as TEXT ) as person_id\n  , cast(encounter_type as TEXT ) as encounter_type\n  , cast(encounter_group as TEXT ) as encounter_group\n  , try_cast( encounter_start_date as date ) as encounter_start_date\n  , try_cast( encounter_end_date as date ) as encounter_end_date\n  , cast(length_of_stay as integer ) as length_of_stay\n  , cast(admit_source_code as TEXT ) as admit_source_code\n  , cast(admit_source_description as TEXT ) as admit_source_description\n  , cast(admit_type_code as TEXT ) as admit_type_code\n  , cast(admit_type_description as TEXT ) as admit_type_description\n  , cast(discharge_disposition_code as TEXT ) as discharge_disposition_code\n  , cast(discharge_disposition_description as TEXT ) as discharge_disposition_description\n  , cast(null as TEXT ) as attending_provider_id\n  , cast(null as TEXT ) as attending_provider_name\n  , cast(facility_id as TEXT ) as facility_id\n  , cast(facility_name as TEXT ) as facility_name\n  , cast(facility_type as TEXT ) as facility_type\n  , cast(observation_flag as integer ) as observation_flag\n  , cast(lab_flag as integer ) as lab_flag\n  , cast(dme_flag as integer ) as dme_flag\n  , cast(ambulance_flag as integer ) as ambulance_flag\n  , cast(pharmacy_flag as integer ) as pharmacy_flag\n  , cast(ed_flag as integer ) as ed_flag\n  , cast(delivery_flag as integer ) as delivery_flag\n  , cast(delivery_type as TEXT ) as delivery_type\n  , cast(newborn_flag as integer ) as newborn_flag\n  , cast(nicu_flag as integer ) as nicu_flag\n  , cast(primary_diagnosis_code_type as TEXT ) as primary_diagnosis_code_type\n  , cast(primary_diagnosis_code as TEXT ) as primary_diagnosis_code\n  , cast(primary_diagnosis_description as TEXT ) as primary_diagnosis_description\n  , cast(drg_code_type as TEXT ) as drg_code_type\n  , cast(drg_code as TEXT ) as drg_code\n  , cast(drg_description as TEXT ) as drg_description\n  , cast(total_paid_amount as numeric(28,6) ) as paid_amount\n  , cast(total_allowed_amount as numeric(28,6) ) as allowed_amount\n  , cast(total_charge_amount as numeric(28,6) ) as charge_amount\n  , cast(claim_count as  integer) as claim_count\n  , cast(inst_claim_count as  integer) as inst_claim_count\n  , cast(prof_claim_count as  integer) as prof_claim_count\n  , cast(_dbt_source_relation  as  TEXT) as source_model\n  , cast(base.data_source as TEXT ) as data_source\n  , cast('2025-02-25 21:25:59.177756+00:00' as timestamp ) as  tuva_last_run\nFROM base\ninner join tuva.claims_preprocessing.encounters__patient_data_source_id p on base.patient_data_source_id = p.patient_data_source_id", "relation_name": "tuva.core._stg_claims_encounter"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.380540Z", "completed_at": "2025-02-25T21:26:31.386695Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:31.386954Z", "completed_at": "2025-02-25T21:26:31.386962Z"}], "thread_id": "Thread-1", "execution_time": 0.007328987121582031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.core__encounter", "compiled": true, "compiled_code": "\n\nselect *,'claim' as encounter_source_type\n    from tuva.core._stg_claims_encounter\n\n    union all\n\n    select *,'clinical' as encounter_source_type\n    from tuva.core._stg_clinical_encounter\n\n", "relation_name": "tuva.core.encounter"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.394393Z", "completed_at": "2025-02-25T21:26:31.409643Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:31.410373Z", "completed_at": "2025-02-25T21:26:31.410380Z"}], "thread_id": "Thread-2", "execution_time": 0.021297931671142578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__acute_inpatient", "compiled": true, "compiled_code": "\n\nwith cte as (\n    select count(*) as result_count\n    ,'inpatient encounter missing professional claim' as data_quality_check\n    from tuva.core.encounter\n    where encounter_type = 'acute inpatient'\n    and prof_claim_count = 0 \n)\n\n\nselect data_quality_check\n,result_count\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom cte", "relation_name": "tuva.data_quality.data_quality_acute_inpatient"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.390908Z", "completed_at": "2025-02-25T21:26:31.409926Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:31.410856Z", "completed_at": "2025-02-25T21:26:31.410860Z"}], "thread_id": "Thread-4", "execution_time": 0.02202606201171875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ahrq_measures__stg_pqi_inpatient_encounter", "compiled": true, "compiled_code": "\n\nselect \n    encounter_id\n  , data_source\n  , drg_code\n  , drg_description\n  , admit_source_code\n  , encounter_start_date\n  , encounter_end_date\n  , length_of_stay\n  , primary_diagnosis_code\n  , person_id\n  , facility_id\n  , paid_amount\n  , date_part('year', encounter_start_date) as year_number\nfrom\n    tuva.core.encounter\nwhere \n    encounter_type = 'acute inpatient'", "relation_name": "tuva.ahrq_measures._stg_pqi_inpatient_encounter"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.398911Z", "completed_at": "2025-02-25T21:26:31.410152Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:31.411456Z", "completed_at": "2025-02-25T21:26:31.411460Z"}], "thread_id": "Thread-3", "execution_time": 0.022078990936279297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__acute_inpatient_prevalence", "compiled": true, "compiled_code": "\n\nwith total_cte as (\nselect cast(count(*) as numeric(28,6) ) as total_encounters\nfrom tuva.core.encounter\nwhere encounter_type = 'acute inpatient'\n) \n\n,cte as (\nselect \n    drg_code || ' - ' || drg_description as drg_code_and_description\n    ,cast('acute inpatient drg distribution' as TEXT ) as analytics_concept\n    ,cast(count(*) as numeric(28,6) )/total_encounters as encounter_percent\n    ,total_encounters\n    ,row_number() over (order by count(*) desc) as rank_nbr\nfrom tuva.core.encounter\ncross join total_cte \nwhere encounter_type = 'acute inpatient'\nand\ndrg_code is not null\ngroup by \n    drg_code || ' - ' || drg_description,\n    total_encounters\n)\n\nselect \n    cte.analytics_concept\n    ,drg_code_and_description as analytics_measure\n    ,encounter_percent as data_source_value\n    ,m.analytics_value\n    ,rank_nbr as value_rank\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.data_quality._value_set_reference_mart_analytics m \nleft join cte on\nm.analytics_concept = cte.analytics_concept\nand\ncte.rank_nbr = m.value_rank\nwhere m.analytics_concept = 'acute inpatient drg distribution'\nand rank_nbr < 11", "relation_name": "tuva.data_quality.data_quality_acute_inpatient_prevalence"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.404533Z", "completed_at": "2025-02-25T21:26:31.411245Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:31.412511Z", "completed_at": "2025-02-25T21:26:31.412515Z"}], "thread_id": "Thread-1", "execution_time": 0.022785186767578125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__acute_inpatient_reference", "compiled": true, "compiled_code": "\n\nwith cte as (\nselect avg(length_of_stay) los\n,sum(case when discharge_disposition_code in ('20','40','41','42') then 1 else 0 end) deceased_encounters\n,sum(case when discharge_disposition_code in ('20','40','41','42') then 1 else 0 end)/count(*) as mortality_rate\nfrom tuva.core.encounter\nwhere encounter_type = 'acute inpatient'\n)\n\n\n,long_cte as (\n   select 'acute inpatient' as analytics_concept\n,'length of stay' as analytics_measure\n,los as data_source_value\nfrom cte\n\nunion all \n\n   select 'acute inpatient' as analytics_concept\n,'mortality rate' as analytics_measure\n,mortality_rate as data_source_value\nfrom cte\n)\n\n\nselect m.analytics_concept\n,m.analytics_measure\n,data_source_value\n,m.analytics_value\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.data_quality._value_set_reference_mart_analytics m \nleft join long_cte on long_cte.analytics_measure = m.analytics_measure\nand\nm.analytics_concept = long_cte.analytics_concept\nwhere m.analytics_concept = 'acute inpatient'\nand\nm.analytics_measure = 'length of stay'\n\nunion all \n\nselect m.analytics_concept\n,m.analytics_measure\n,data_source_value\n,m.analytics_value\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.data_quality._value_set_reference_mart_analytics m \nleft join long_cte on long_cte.analytics_measure = m.analytics_measure\nand\nm.analytics_concept = long_cte.analytics_concept\nwhere m.analytics_concept = 'acute inpatient'\nand\nm.analytics_measure = 'mortality rate'", "relation_name": "tuva.data_quality.data_quality_acute_inpatient_reference"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.415355Z", "completed_at": "2025-02-25T21:26:31.438959Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:31.439253Z", "completed_at": "2025-02-25T21:26:31.439260Z"}], "thread_id": "Thread-2", "execution_time": 0.026057958602905273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__core_populated", "compiled": true, "compiled_code": "\n\nwith medical as (\n  select\n      'medical_claim' as table_name\n    , count(*) as record_count\n  from tuva.core.medical_claim\n)\n\n, pharmacy as (\n  select\n      'pharmacy_claim' as table_name\n    , count(*) as record_count\n  from tuva.core.pharmacy_claim\n)\n\n, eligibility as (\n  select\n      'eligibility' as table_name\n    , count(*) as record_count\n  from tuva.core.eligibility\n)\n\n, member_months as (\n  select\n      'member_months' as table_name\n    , count(*) as record_count\n  from tuva.core.member_months\n)\n\n, patient as (\n  select\n      'patient' as table_name\n    , count(*) as record_count\n  from tuva.core.patient\n)\n\n, encounter as (\n  select\n      'encounter' as table_name\n    , count(*) as record_count\n  from tuva.core.encounter\n)\n\n, condition as (\n  select\n      'condition' as table_name\n    , count(*) as record_count\n  from tuva.core.condition\n)\n\n, procedure_cte as (\n  select\n      'procedure' as table_name\n    , count(*) as record_count\n  from tuva.core.procedure\n)\n\n,final as (\nselect * from medical\nunion all\nselect * from pharmacy\nunion all\nselect * from eligibility\nunion all\nselect * from member_months\nunion all\nselect * from patient\nunion all\nselect * from encounter\nunion all\nselect * from condition\nunion all\nselect * from procedure_cte\n)\n\nselect *\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom final", "relation_name": "tuva.data_quality.core_populated"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.428729Z", "completed_at": "2025-02-25T21:26:31.439748Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:31.440652Z", "completed_at": "2025-02-25T21:26:31.440663Z"}], "thread_id": "Thread-3", "execution_time": 0.026620864868164062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__encounters_cost_and_utilization_trend", "compiled": true, "compiled_code": "\n\nwith member_months as (\n    select\n        year_month\n      , count(1) as member_months\n    from tuva.core.member_months\n    group by year_month\n)\n\n, encounters as (\n    select\n        cast(cal.year_month_int as TEXT) as year_month\n      , e.encounter_group\n      , e.encounter_type\n      , e.encounter_id\n      , e.paid_amount\n    from tuva.core.encounter as e\n    left join tuva.reference_data.calendar as cal\n      on e.encounter_start_date = cal.full_date\n)\n\n, pkpy_trend as (\n    select\n        enc.year_month\n      , enc.encounter_group\n      , enc.encounter_type\n      , count(enc.encounter_id) / mm.member_months * 12000 as pkpy\n      , sum(enc.paid_amount) / nullif(count(enc.encounter_id), 0) as paid_per\n    from encounters as enc\n    inner join member_months as mm\n      on enc.year_month = mm.year_month\n    group by\n        enc.year_month\n      , enc.encounter_group\n      , enc.encounter_type\n      , mm.member_months\n)\n\nselect\n    pkpy_trend.year_month\n  , pkpy_trend.encounter_group\n  , pkpy_trend.encounter_type\n  , pkpy_trend.pkpy\n  , pkpy_trend.paid_per\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom pkpy_trend", "relation_name": "tuva.data_quality.encounters_cost_and_utilization_trend"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.420622Z", "completed_at": "2025-02-25T21:26:31.440008Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:31.441399Z", "completed_at": "2025-02-25T21:26:31.441404Z"}], "thread_id": "Thread-4", "execution_time": 0.027910947799682617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__encounters_cost_and_utilization", "compiled": true, "compiled_code": "\n\nwith member_months as (\n    select \n        cast(count(1) as numeric(28,6)) as member_months \n    from tuva.core.member_months\n)\n,pkpy as (\nselect\n    cast('encounters cost and utilization PKPY' as TEXT) as analytics_concept\n    , enc.encounter_group\n    , cast(enc.encounter_type as TEXT) as analytics_measure\n    , case when avg(mm.member_months) = 0 then 0\n           else count(enc.encounter_id)  / avg(mm.member_months ) * 12000 \n      end as data_source_value\nfrom tuva.core.encounter as enc\ncross join member_months as mm\ngroup by\n    enc.encounter_group\n    , enc.encounter_type\n)\n,paid_per as (\nselect\n    cast('encounters cost and utilization paid per' as TEXT) as analytics_concept\n    , enc.encounter_group\n    , cast(enc.encounter_type as TEXT) as analytics_measure\n    , case when count(enc.encounter_id) = 0 then 0\n           else sum(enc.paid_amount) / count(enc.encounter_id) \n      end as data_source_value\nfrom tuva.core.encounter as enc\ncross join member_months as mm\ngroup by\n    enc.encounter_group\n    , enc.encounter_type\n)\n\nselect\n    pkpy.*\n    ,ref_data.analytics_value\n    ,cast('2025-02-25 21:25:59.177756+00:00' as TEXT) as tuva_last_run\nfrom pkpy\nleft join tuva.data_quality._value_set_reference_mart_analytics ref_data on pkpy.analytics_concept = ref_data.analytics_concept and pkpy.analytics_measure = ref_data.analytics_measure\nunion all\nselect\n    paid_per.*\n    ,ref_data.analytics_value\n    ,cast('2025-02-25 21:25:59.177756+00:00' as TEXT) as tuva_last_run\nfrom paid_per\nleft join tuva.data_quality._value_set_reference_mart_analytics ref_data on paid_per.analytics_concept = paid_per.analytics_concept and paid_per.analytics_measure = paid_per.analytics_measure", "relation_name": "tuva.data_quality.encounters_cost_and_utilization"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.434888Z", "completed_at": "2025-02-25T21:26:31.441141Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:31.442822Z", "completed_at": "2025-02-25T21:26:31.442829Z"}], "thread_id": "Thread-1", "execution_time": 0.02805304527282715, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__encounters_missing_groups", "compiled": true, "compiled_code": "\n\nwith expected_groups as (\n    select 'inpatient' as encounter_group\n    union all\n    select 'outpatient'\n    union all\n    select 'office based'\n    union all\n    select 'other'\n)\n\n, actual_groups as (\n    select distinct\n        encounter_group\n    from tuva.core.encounter\n)\n\nselect\n    a.encounter_group\n    , case\n        when a.encounter_group is null then 'missing'\n      else 'populated'\n    end as missing_encounter_group\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom expected_groups e\nleft join actual_groups a\n    on e.encounter_group = a.encounter_group", "relation_name": "tuva.data_quality.encounters_missing_groups"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.449248Z", "completed_at": "2025-02-25T21:26:31.469866Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:31.470718Z", "completed_at": "2025-02-25T21:26:31.470723Z"}], "thread_id": "Thread-3", "execution_time": 0.02681589126586914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.mart_review__data_source", "compiled": true, "compiled_code": "\n\nwith data_sources as (\nSELECT DISTINCT data_source\nFROM tuva.core.condition\n\nUNION ALL\n\nSELECT DISTINCT data_source\nFROM tuva.core.eligibility\n\nUNION ALL\n\nSELECT DISTINCT data_source\nFROM tuva.core.encounter\n\nUNION ALL\n\nSELECT DISTINCT data_source\nFROM tuva.core.location\n\nUNION ALL\n\nSELECT DISTINCT data_source\nFROM tuva.core.medical_claim\n\nUNION ALL\n\nSELECT DISTINCT data_source\nFROM tuva.core.member_months\n\nUNION ALL\n\nSELECT DISTINCT data_source\nFROM tuva.core.patient\n\nUNION ALL\n\nSELECT DISTINCT data_source\nFROM tuva.core.pharmacy_claim\n\nUNION ALL\n\nSELECT DISTINCT data_source\nFROM tuva.core.practitioner\n\nUNION ALL\n\nSELECT DISTINCT data_source\nFROM tuva.core.procedure\n)\n\nSELECT DISTINCT\n    data_source\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom data_sources", "relation_name": "tuva.data_quality.mart_review__data_source"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.454565Z", "completed_at": "2025-02-25T21:26:31.470174Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:31.471104Z", "completed_at": "2025-02-25T21:26:31.471107Z"}], "thread_id": "Thread-4", "execution_time": 0.026586055755615234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.mart_review__inpatient", "compiled": true, "compiled_code": "\n\nwith cte as (\n    select distinct\n        location_id\n      , npi\n      , name\n    from tuva.core.location\n)\n\n, final as (\n    select\n        e.*\n      , e.person_id || '|' || e.data_source as patient_source_key\n      , e.encounter_id || '|' || e.data_source as encounter_source_key\n      , e.drg_code || '|' || e.drg_description as drgwithdescription\n      , e.primary_diagnosis_code || '|' || e.primary_diagnosis_description as primary_diagnosis_and_description\n      , e.admit_source_code || '|' || e.admit_source_description as admit_source_code_and_description\n      , e.admit_type_code || '|' || e.admit_type_description as admit_type_code_and_description\n      , e.discharge_disposition_code || '|' || e.discharge_disposition_description as discharge_code_and_description\n      , p.ccsr_parent_category\n      , p.ccsr_category\n      , p.ccsr_category_description\n      , p.ccsr_category || '|' || p.ccsr_category_description as ccsr_category_and_description\n      , b.body_system\n      , case \n            when e.length_of_stay <= 1 then '1. 0-1 day'\n            when e.length_of_stay <= 3 then '2. 2-3 days'\n            when e.length_of_stay <= 5 then '3. 4-5 days'\n            when e.length_of_stay <= 7 then '4. 6-7 days'\n            when e.length_of_stay <= 14 then '5. 8-14 days'\n            when e.length_of_stay <= 30 then '6. 15-30 days'\n            else '7. 31+ Days'\n        end as los_groups\n      , weights.drg_weight\n    from tuva.core.encounter as e\n    left join cte as l\n      on e.facility_id = l.location_id\n    left join tuva.ccsr.dx_vertical_pivot as p\n      on e.primary_diagnosis_code = p.code\n      and p.ccsr_category_rank = 1\n    left join tuva.ccsr._value_set_dxccsr_v2023_1_body_systems as b\n      on p.ccsr_parent_category = b.ccsr_parent_category\n    left join tuva.terminology.ms_drg_weights_los as weights\n      on e.drg_code = weights.ms_drg\n    where e.encounter_type = 'acute inpatient'\n)\n\nselect * from final", "relation_name": "tuva.data_quality.mart_review__inpatient"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.477961Z", "completed_at": "2025-02-25T21:26:31.491842Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:31.492502Z", "completed_at": "2025-02-25T21:26:31.492508Z"}], "thread_id": "Thread-3", "execution_time": 0.01634979248046875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.not_null_core__encounter_person_id.6a9a6bcb6f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect person_id\nfrom tuva.core.encounter\nwhere person_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.483377Z", "completed_at": "2025-02-25T21:26:31.492058Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:31.492912Z", "completed_at": "2025-02-25T21:26:31.492916Z"}], "thread_id": "Thread-1", "execution_time": 0.016228199005126953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.mart_review__service_categories_long", "compiled": true, "compiled_code": "\n\nwith encounters as (\n    select\n        cast(c.year_month_int as TEXT) as year_month\n      , mc.person_id\n      , service_category_1\n      , service_category_2\n      , count(distinct mc.encounter_id) as visits\n    from tuva.data_quality.mart_review__stg_medical_claim as mc\n    left join tuva.reference_data.calendar c on mc.claim_start_date = c.full_date\n    inner join tuva.core.encounter as e\n      on mc.encounter_id = e.encounter_id\n    group by\n        cast(c.year_month_int as TEXT)\n      , mc.person_id\n      , service_category_1\n      , service_category_2\n)\n\n\n    select     \n        pmpm.year_month\n      , pmpm.data_source\n      , pmpm.payer\n      , pmpm.plan\n      , pmpm.service_category_1\n      , pmpm.service_category_2\n      , sum(total_paid) as paid_amt\n      , sum(visits) as visits\n    from tuva.financial_pmpm._int_patient_spend_with_service_categories as pmpm\n    left join encounters\n      on pmpm.year_month = encounters.year_month\n      and pmpm.person_id = encounters.person_id\n      and pmpm.service_category_1 = encounters.service_category_1\n      and pmpm.service_category_2 = encounters.service_category_2\n    group by\n        pmpm.year_month\n      , pmpm.data_source\n      , pmpm.payer\n      , pmpm.plan\n      , pmpm.service_category_1\n      , pmpm.service_category_2", "relation_name": "tuva.data_quality.mart_review__service_categories_long"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.480702Z", "completed_at": "2025-02-25T21:26:31.492288Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:31.493296Z", "completed_at": "2025-02-25T21:26:31.493300Z"}], "thread_id": "Thread-4", "execution_time": 0.016861915588378906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.unique_core__encounter_encounter_id.d6227f8792", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    encounter_id as unique_field,\n    count(*) as n_records\n\nfrom tuva.core.encounter\nwhere encounter_id is not null\ngroup by encounter_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.487869Z", "completed_at": "2025-02-25T21:26:31.493896Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:31.494941Z", "completed_at": "2025-02-25T21:26:31.494945Z"}], "thread_id": "Thread-2", "execution_time": 0.007669925689697266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ahrq_measures__int_pqi_shared_exclusion_missing_dates", "compiled": true, "compiled_code": "\n-- Exclude encounters with missing start dates\nselect\n    encounter_id\n  , data_source\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._stg_pqi_inpatient_encounter\nwhere \n  encounter_start_date is null", "relation_name": "tuva.ahrq_measures._int_pqi_shared_exclusion_missing_dates"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.503281Z", "completed_at": "2025-02-25T21:26:31.510815Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:31.511086Z", "completed_at": "2025-02-25T21:26:31.511093Z"}], "thread_id": "Thread-4", "execution_time": 0.015607118606567383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ahrq_measures__int_pqi_shared_exclusion_ungroupable_drg", "compiled": true, "compiled_code": "\n\n-- Exclude encounters with ungroupable DRG\nselect \n    encounter_id\n  , data_source\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._stg_pqi_inpatient_encounter\nwhere \n  drg_code = '999'", "relation_name": "tuva.ahrq_measures._int_pqi_shared_exclusion_ungroupable_drg"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.500207Z", "completed_at": "2025-02-25T21:26:31.517694Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:31.526427Z", "completed_at": "2025-02-25T21:26:31.526435Z"}], "thread_id": "Thread-1", "execution_time": 0.031200170516967773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ahrq_measures__int_pqi_shared_exclusion_transfer", "compiled": true, "compiled_code": "\n\n-- Exclude transfers from hospital, SNF, or other healthcare facility\nselect \n    encounter_id\n  , data_source\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._stg_pqi_inpatient_encounter\nwhere \n  admit_source_code in ('4', '5', '6')", "relation_name": "tuva.ahrq_measures._int_pqi_shared_exclusion_transfer"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.507569Z", "completed_at": "2025-02-25T21:26:31.526874Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:31.527629Z", "completed_at": "2025-02-25T21:26:31.527633Z"}], "thread_id": "Thread-2", "execution_time": 0.02773880958557129, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__encounters_missing_groups_union", "compiled": true, "compiled_code": "\n\nselect\n    'number of missing encounter groups' as data_quality_check\n  , count(*) as result_count\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.data_quality.encounters_missing_groups", "relation_name": "tuva.data_quality.encounters_missing_groups_union"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.496625Z", "completed_at": "2025-02-25T21:26:31.527094Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:31.528022Z", "completed_at": "2025-02-25T21:26:31.528026Z"}], "thread_id": "Thread-3", "execution_time": 0.0334780216217041, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ahrq_measures__int_pqi_shared_exclusion_missing_primary_dx", "compiled": true, "compiled_code": "\n\n-- Exclude encounters with missing primary diagnosis code\nselect \n    encounter_id\n  , data_source\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._stg_pqi_inpatient_encounter\nwhere \n  primary_diagnosis_code is null", "relation_name": "tuva.ahrq_measures._int_pqi_shared_exclusion_missing_primary_dx"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.512167Z", "completed_at": "2025-02-25T21:26:31.528621Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:31.529658Z", "completed_at": "2025-02-25T21:26:31.529663Z"}], "thread_id": "Thread-4", "execution_time": 0.01798701286315918, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ed_classification__int_map_primary_dx", "compiled": true, "compiled_code": "/*\nAll condition discharge diagnosis left join with probabilistic\nindicators of ED classification terminology\n*/\n\n\n\n\nwith  __dbt__cte__ed_classification__stg_encounter as (\n\n\nselect\n    encounter_id\n    , encounter_type\n    , person_id\n    , encounter_end_date\n    , facility_id\n    , primary_diagnosis_code_type\n    , primary_diagnosis_code\n    , primary_diagnosis_description\n    , paid_amount\n    , allowed_amount\n    , charge_amount\nfrom tuva.core.encounter\n), condition as (\n    select * \n    from __dbt__cte__ed_classification__stg_encounter\n    where encounter_type = 'emergency department'\n)\n, icd9 as (\n  select\n     icd9 as code\n     \n     , edcnnpa\n     \n     , edcnpa\n     \n     , epct\n     \n     , noner\n     \n     , injury\n     \n     , psych\n     \n     , alcohol\n     \n     , drug\n     \n     , 1 as ed_classification_capture\n  from tuva.ed_classification._value_set_johnston_icd9\n)\n, icd10 as (\n  select\n     icd10 as code\n     \n     , edcnnpa\n     \n     , edcnpa\n     \n     , epct\n     \n     , noner\n     \n     , injury\n     \n     , psych\n     \n     , alcohol\n     \n     , drug\n     \n     , 1 as ed_classification_capture\n  from tuva.ed_classification._value_set_johnston_icd10\n)\n\nselect\n   a.*\n   \n   , icd10.edcnnpa\n   \n   , icd10.edcnpa\n   \n   , icd10.epct\n   \n   , icd10.noner\n   \n   , icd10.injury\n   \n   , icd10.psych\n   \n   , icd10.alcohol\n   \n   , icd10.drug\n   \n   , coalesce(icd10.ed_classification_capture, 0) as ed_classification_capture\nfrom condition a\nleft join icd10\n    on a.primary_diagnosis_code = icd10.code \n    and a.primary_diagnosis_code_type = 'icd-10-cm'\n\nunion all\n\nselect\n   a.*\n   \n   , icd9.edcnnpa\n   \n   , icd9.edcnpa\n   \n   , icd9.epct\n   \n   , icd9.noner\n   \n   , icd9.injury\n   \n   , icd9.psych\n   \n   , icd9.alcohol\n   \n   , icd9.drug\n   \n   , coalesce(icd9.ed_classification_capture, 0) ed_classification_capture\nfrom condition a\ninner join icd9\n    on a.primary_diagnosis_code = icd9.code \n    and a.primary_diagnosis_code_type = 'icd-9-cm'", "relation_name": "tuva.ed_classification._int_by_provider_parent_organization"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.530644Z", "completed_at": "2025-02-25T21:26:31.613325Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:31.625022Z", "completed_at": "2025-02-25T21:26:31.625029Z"}], "thread_id": "Thread-1", "execution_time": 0.0967109203338623, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.quality_measures__int_cqm130_denominator", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte___stg_encounter as (\n\n\nselect\n      person_id\n    , encounter_id\n    , encounter_type\n    , encounter_group\n    , length_of_stay\n    , encounter_start_date\n    , encounter_end_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.encounter\n\n\n),  __dbt__cte___stg_procedure as (\n\nselect\n      person_id\n    , encounter_id\n    , procedure_date\n    , source_code_type\n    , source_code\n    , normalized_code_type\n    , normalized_code\n    , modifier_1\n    , modifier_2\n    , modifier_3\n    , modifier_4\n    , modifier_5\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.procedure\n),  __dbt__cte___stg_medical_claim as (\n\n\nselect\n      person_id\n    , claim_id\n    , claim_start_date\n    , claim_end_date\n    , place_of_service_code\n    , hcpcs_code\n    , hcpcs_modifier_1\n    , hcpcs_modifier_2\n    , hcpcs_modifier_3\n    , hcpcs_modifier_4\n    , hcpcs_modifier_5\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.medical_claim\n\n\n),  __dbt__cte___stg_patient as (\n\nselect\n      person_id\n    , sex\n    , birth_date\n    , death_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.patient\n), visit_codes as (\n\n    select\n          code\n        , code_system\n    from tuva.quality_measures._value_set_codes\n    where lower(concept_name) in (\n            'encounter to document medications'\n    )\n\n)\n\n, visits_encounters as (\n\n    select \n          person_id\n        , coalesce(encounter.encounter_start_date,encounter.encounter_end_date) as procedure_encounter_date -- alias only to enable union later\n        , coalesce(encounter.encounter_end_date,encounter.encounter_start_date) as claims_encounter_date -- alias only to enable union later\n    from __dbt__cte___stg_encounter encounter\n    inner join tuva.quality_measures._int_cqm130__performance_period as pp\n        on coalesce(encounter.encounter_end_date,encounter.encounter_start_date) >= pp.performance_period_begin\n            and coalesce(encounter.encounter_start_date,encounter.encounter_end_date) <= pp.performance_period_end\n    where lower(encounter_type) in (\n          'home health'\n        , 'telehealth'\n    )\n    \n    or lower(encounter_group) in (\n          'office based'\n        , 'outpatient'\n    )\n\n)\n\n, procedure_encounters as (\n\n    select \n          person_id\n        , procedure_date as procedure_encounter_date\n        , try_cast( null as date ) as claims_encounter_date\n    from __dbt__cte___stg_procedure procs\n    inner join tuva.quality_measures._int_cqm130__performance_period as pp\n        on procedure_date between pp.performance_period_begin and pp.performance_period_end\n    inner join visit_codes\n        on coalesce(procs.normalized_code,procs.source_code) = visit_codes.code\n\n)\n\n, claims_encounters as (\n    \n    select \n          person_id\n        , try_cast( null as date ) as procedure_encounter_date\n        , coalesce(claim_end_date,claim_start_date) as claims_encounter_date\n    from __dbt__cte___stg_medical_claim medical_claim\n    inner join tuva.quality_measures._int_cqm130__performance_period as pp \n        on coalesce(claim_end_date,claim_start_date)  >=  pp.performance_period_begin\n            and coalesce(claim_start_date,claim_end_date) <=  pp.performance_period_end\n    inner join visit_codes\n        on medical_claim.hcpcs_code = visit_codes.code\n\n)\n\n, all_encounters as (\n\n    select *, 'v' as visit_enc, cast(null as TEXT) as proc_enc, cast(null as TEXT) as claim_enc\n    from visits_encounters\n\n    union all\n\n    select *, cast(null as TEXT) as visit_enc, 'p' as proc_enc, cast(null as TEXT) as claim_enc\n    from procedure_encounters\n\n    union all\n    \n    select *, cast(null as TEXT) as visit_enc, cast(null as TEXT) as proc_enc, 'c' as claim_enc\n    from claims_encounters\n\n)\n\n, multiple_encounters_by_patient as (\n\n    select\n          person_id\n        , procedure_encounter_date\n        , claims_encounter_date\n        , case when procedure_encounter_date >= claims_encounter_date\n                then procedure_encounter_date\n            else claims_encounter_date\n          end as max_encounter_date\n        , coalesce(min(visit_enc), '') || coalesce(min(proc_enc), '') || coalesce(min(claim_enc), '') as qualifying_types\n    from all_encounters\n    group by person_id, procedure_encounter_date, claims_encounter_date\n\n)\n\n, max_encounter_dates_by_patient as (\n\n\tselect\n\t\t  person_id\n\t\t, max(max_encounter_date) as max_encounter_date\n\tfrom multiple_encounters_by_patient\n\tgroup by person_id\n\n)\n\n, latest_patient_encounters as (\n\t\n\tselect\n\t\t  max_encounter_dates_by_patient.person_id\n\t\t, max_encounter_dates_by_patient.max_encounter_date\n\t\t, procedure_encounter_date\n\t\t, claims_encounter_date\n\tfrom max_encounter_dates_by_patient\n\tinner join multiple_encounters_by_patient\n\t\ton max_encounter_dates_by_patient.person_id = multiple_encounters_by_patient.person_id\n\n)\n\n, patients_with_age as (\n\n    select\n          p.person_id\n        , procedure_encounter_date\n        , claims_encounter_date\n        , floor(datediff(\n        hour,\n        birth_date,\n        e.max_encounter_date\n        ) / 8760.0) as max_age\n    from __dbt__cte___stg_patient p\n    inner join latest_patient_encounters e\n        on p.person_id = e.person_id\n    where p.death_date is null\n\n)\n\n, qualifying_patients as (\n\n    select\n        distinct\n          patients_with_age.person_id\n        , patients_with_age.max_age as age\n        , patients_with_age.procedure_encounter_date\n        , patients_with_age.claims_encounter_date\n        , pp.performance_period_begin\n        , pp.performance_period_end\n        , pp.measure_id\n        , pp.measure_name\n        , pp.measure_version\n        , 1 as denominator_flag\n    from patients_with_age\n    cross join tuva.quality_measures._int_cqm130__performance_period pp\n    where max_age >= 18\n    \n)\n\n, add_data_types as (\n\n    select\n          cast(person_id as TEXT) as person_id\n        , cast(age as integer) as age\n        , cast(performance_period_begin as date) as performance_period_begin\n        , cast(performance_period_end as date) as performance_period_end\n        , cast(measure_id as TEXT) as measure_id\n        , cast(measure_name as TEXT) as measure_name\n        , cast(measure_version as TEXT) as measure_version\n        , cast(procedure_encounter_date as date) as procedure_encounter_date\n        , cast(claims_encounter_date as date) as claims_encounter_date\n        , cast(denominator_flag as integer) as denominator_flag\n    from qualifying_patients\n\n)\n\nselect \n      person_id\n    , age\n    , procedure_encounter_date\n    , claims_encounter_date\n    , performance_period_begin\n    , performance_period_end\n    , measure_id\n    , measure_name\n    , measure_version\n    , denominator_flag\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.quality_measures._int_cqm130_denominator"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.638493Z", "completed_at": "2025-02-25T21:26:31.665808Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:31.666154Z", "completed_at": "2025-02-25T21:26:31.666162Z"}], "thread_id": "Thread-1", "execution_time": 0.040579795837402344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.readmissions__encounter", "compiled": true, "compiled_code": "\n\nwith __dbt__cte__readmissions__stg_core__encounter as (\n\n\nselect\n    encounter_id,\n    person_id,\n    encounter_start_date,\n    encounter_end_date,\n    discharge_disposition_code,\n    facility_id,\n    drg_code_type,\n    drg_code,\n    paid_amount,\n    primary_diagnosis_code,\n    '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.encounter\nwhere encounter_type = 'acute inpatient'\n) -- Staging model for the input layer:\n-- stg_encounter input layer model.\n-- This contains one row for every unique encounter in the dataset.\n\nselect\n    cast(encounter_id as TEXT) as encounter_id,\n    cast(person_id as TEXT) as person_id,\n    cast(encounter_start_date as date) as admit_date,\n    cast(encounter_end_date as date) as discharge_date,\n    cast(discharge_disposition_code as TEXT) as discharge_disposition_code,\n    cast(facility_id as TEXT) as facility_id,\n    cast(drg_code_type as TEXT ) as drg_code_type,\n    cast(drg_code as TEXT) as drg_code,\n    cast(paid_amount as numeric(28,6)) as paid_amount,\n    cast(primary_diagnosis_code as TEXT) as primary_diagnosis_code,\n    '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom __dbt__cte__readmissions__stg_core__encounter", "relation_name": "tuva.readmissions._int_encounter"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.603771Z", "completed_at": "2025-02-25T21:26:31.666952Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:31.667673Z", "completed_at": "2025-02-25T21:26:31.667678Z"}], "thread_id": "Thread-4", "execution_time": 0.10169506072998047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.not_null_quality_measures__stg_core__encounter_person_id.1f62115a6f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nwith __dbt__cte___stg_encounter as (\n\n\nselect\n      person_id\n    , encounter_id\n    , encounter_type\n    , encounter_group\n    , length_of_stay\n    , encounter_start_date\n    , encounter_end_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.encounter\n\n\n) select person_id\nfrom __dbt__cte___stg_encounter\nwhere person_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.566373Z", "completed_at": "2025-02-25T21:26:31.667458Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:31.668480Z", "completed_at": "2025-02-25T21:26:31.668484Z"}], "thread_id": "Thread-2", "execution_time": 0.13840413093566895, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.quality_measures__int_cqm438_denominator", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte___stg_encounter as (\n\n\nselect\n      person_id\n    , encounter_id\n    , encounter_type\n    , encounter_group\n    , length_of_stay\n    , encounter_start_date\n    , encounter_end_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.encounter\n\n\n),  __dbt__cte___stg_procedure as (\n\nselect\n      person_id\n    , encounter_id\n    , procedure_date\n    , source_code_type\n    , source_code\n    , normalized_code_type\n    , normalized_code\n    , modifier_1\n    , modifier_2\n    , modifier_3\n    , modifier_4\n    , modifier_5\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.procedure\n),  __dbt__cte___stg_medical_claim as (\n\n\nselect\n      person_id\n    , claim_id\n    , claim_start_date\n    , claim_end_date\n    , place_of_service_code\n    , hcpcs_code\n    , hcpcs_modifier_1\n    , hcpcs_modifier_2\n    , hcpcs_modifier_3\n    , hcpcs_modifier_4\n    , hcpcs_modifier_5\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.medical_claim\n\n\n),  __dbt__cte___stg_patient as (\n\nselect\n      person_id\n    , sex\n    , birth_date\n    , death_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.patient\n), patients_with_ascvd as (\n\n    select \n          person_id\n        , performance_period_begin\n        , performance_period_end\n        , measure_id\n        , measure_name\n        , measure_version\n        , 1 as criteria\n    from tuva.quality_measures._int_cqm438_denominator_criteria1\n\n)\n\n, patients_with_cholesterol as (\n\n    select \n          person_id\n        , performance_period_begin\n        , performance_period_end\n        , measure_id\n        , measure_name\n        , measure_version\n        , 2 as criteria\n    from tuva.quality_measures._int_cqm438_denominator_criteria2\n\n)\n\n, patients_with_diabetes as (\n\n    select \n          person_id\n        , performance_period_begin\n        , performance_period_end\n        , measure_id\n        , measure_name\n        , measure_version\n        , 3 as criteria\n    from tuva.quality_measures._int_cqm438_denominator_criteria3\n\n)\n\n, visit_codes as (\n\n    select\n          code\n        , code_system\n    from tuva.quality_measures._value_set_codes \n    where lower(concept_name) in (\n          'annual wellness visit'\n        , 'office visit'\n        , 'outpatient consultation'\n        , 'preventive care services established office visit, 18 and up'\n        , 'preventive care services individual counseling'\n        , 'preventive care services initial office visit, 18 and up'\n        , 'outpatient encounters for preventive care'\n    )\n\n)\n\n, visits_encounters as (\n\n    select person_id\n         , coalesce(encounter.encounter_start_date,encounter.encounter_end_date) as min_date\n         , coalesce(encounter.encounter_end_date,encounter.encounter_start_date) as max_date\n    from __dbt__cte___stg_encounter encounter\n    inner join tuva.quality_measures._int_cqm438__performance_period as pp\n        on coalesce(encounter.encounter_end_date,encounter.encounter_start_date) >= pp.performance_period_begin\n        and  coalesce(encounter.encounter_start_date,encounter.encounter_end_date) <= pp.performance_period_end\n    where lower(encounter_type) in (\n          'home health'\n        , 'telehealth'\n    )\n    \n    or lower(encounter_group) in (\n          'office based'\n        , 'outpatient'\n    )\n\n)\n\n, procedure_encounters as (\n\n    select \n          person_id\n        , procedure_date as min_date\n        , procedure_date as max_date\n    from __dbt__cte___stg_procedure procedures\n    inner join tuva.quality_measures._int_cqm438__performance_period  as pp\n        on procedure_date between pp.performance_period_begin and  pp.performance_period_end\n    inner join visit_codes\n        on coalesce(procedures.normalized_code,procedures.source_code) = visit_codes.code\n\n)\n\n, claims_encounters as (\n    \n    select person_id\n    , coalesce(claim_start_date,claim_end_date) as min_date\n    , coalesce(claim_end_date,claim_start_date) as max_date\n    from __dbt__cte___stg_medical_claim medical_claim\n    inner join tuva.quality_measures._int_cqm438__performance_period  as pp on\n        coalesce(claim_end_date,claim_start_date)  >=  pp.performance_period_begin\n         and coalesce(claim_start_date,claim_end_date) <=  pp.performance_period_end\n    inner join visit_codes\n        on medical_claim.hcpcs_code= visit_codes.code\n\n)\n\n, all_encounters as (\n\n    select *, 'v' as visit_enc,cast(null as TEXT) as proc_enc, cast(null as TEXT) as claim_enc\n    from visits_encounters\n\n    union all\n\n    select *, cast(null as TEXT) as visit_enc, 'p' as proc_enc, cast(null as TEXT) as claim_enc\n    from procedure_encounters\n\n    union all\n    \n    select *, cast(null as TEXT) as visit_enc, cast(null as TEXT) as proc_enc, 'c' as claim_enc\n    from claims_encounters\n\n)\n\n, encounters_by_patient as (\n\n    select person_id,min(min_date) min_date, max(max_date) max_date,\n        concat(concat(\n            coalesce(min(visit_enc),'')\n            ,coalesce(min(proc_enc),''))\n            ,coalesce(min(claim_enc),'')\n            ) as qualifying_types\n    from all_encounters\n    group by person_id\n\n)\n\n, patients_with_age as (\n\n    select\n          p.person_id\n        , floor(datediff(\n        hour,\n        birth_date,\n        performance_period_begin\n        ) / 8760.0)  as age\n    from __dbt__cte___stg_patient p\n    inner join encounters_by_patient e\n        on p.person_id = e.person_id\n            and p.death_date is null\n    cross join tuva.quality_measures._int_cqm438__performance_period\n\n)\n\n, qualifying_patients_from_criteria1 as (\n\n    select\n        distinct\n          patients_with_ascvd.person_id\n        , patients_with_age.age as age\n        , patients_with_ascvd.performance_period_begin\n        , patients_with_ascvd.performance_period_end\n        , patients_with_ascvd.measure_id\n        , patients_with_ascvd.measure_name\n        , patients_with_ascvd.measure_version\n        , 1 as denominator_flag\n    from patients_with_ascvd\n    left join patients_with_age\n    on patients_with_ascvd.person_id = patients_with_age.person_id\n    where age is not null\n\n)\n\n, qualifying_patients_from_criteria2 as (\n\n    select\n        distinct\n          patients_with_cholesterol.person_id\n        , patients_with_age.age as age\n        , patients_with_cholesterol.performance_period_begin\n        , patients_with_cholesterol.performance_period_end\n        , patients_with_cholesterol.measure_id\n        , patients_with_cholesterol.measure_name\n        , patients_with_cholesterol.measure_version\n        , 1 as denominator_flag\n    from patients_with_cholesterol\n    left join patients_with_age\n    on patients_with_cholesterol.person_id = patients_with_age.person_id\n    where age between 20 and 75\n\n)\n\n, qualifying_patients_from_criteria3 as (\n\n    select\n        distinct\n          patients_with_diabetes.person_id\n        , patients_with_age.age as age\n        , patients_with_diabetes.performance_period_begin\n        , patients_with_diabetes.performance_period_end\n        , patients_with_diabetes.measure_id\n        , patients_with_diabetes.measure_name\n        , patients_with_diabetes.measure_version\n        , 1 as denominator_flag\n    from patients_with_diabetes\n    left join patients_with_age\n    on patients_with_diabetes.person_id = patients_with_age.person_id\n    where age between 40 and 75\n\n)\n\n, final_denominator as (\n    \n    select\n          person_id\n        , age\n        , performance_period_begin\n        , performance_period_end\n        , measure_id\n        , measure_name\n        , measure_version\n        , denominator_flag\n    from qualifying_patients_from_criteria1\n\n    union all\n\n    select\n          person_id\n        , age\n        , performance_period_begin\n        , performance_period_end\n        , measure_id\n        , measure_name\n        , measure_version\n        , denominator_flag\n    from qualifying_patients_from_criteria2\n    \n    union all\n\n    select\n          person_id\n        , age\n        , performance_period_begin\n        , performance_period_end\n        , measure_id\n        , measure_name\n        , measure_version\n        , denominator_flag\n    from qualifying_patients_from_criteria3\n\n)\n\n, add_data_types as (\n\n    select\n          cast(person_id as TEXT) as person_id\n        , cast(age as integer) as age\n        , cast(performance_period_begin as date) as performance_period_begin\n        , cast(performance_period_end as date) as performance_period_end\n        , cast(measure_id as TEXT) as measure_id\n        , cast(measure_name as TEXT) as measure_name\n        , cast(measure_version as TEXT) as measure_version\n        , cast(denominator_flag as integer) as denominator_flag\n    from final_denominator\n\n)\n\nselect \n      person_id\n    , age\n    , performance_period_begin\n    , performance_period_end\n    , measure_id\n    , measure_name\n    , measure_version\n    , denominator_flag\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.quality_measures._int_cqm438_denominator"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.578723Z", "completed_at": "2025-02-25T21:26:31.668078Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:31.669100Z", "completed_at": "2025-02-25T21:26:31.669103Z"}], "thread_id": "Thread-3", "execution_time": 0.13875484466552734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.quality_measures__int_nqf0420_denominator", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte___stg_encounter as (\n\n\nselect\n      person_id\n    , encounter_id\n    , encounter_type\n    , encounter_group\n    , length_of_stay\n    , encounter_start_date\n    , encounter_end_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.encounter\n\n\n),  __dbt__cte___stg_procedure as (\n\nselect\n      person_id\n    , encounter_id\n    , procedure_date\n    , source_code_type\n    , source_code\n    , normalized_code_type\n    , normalized_code\n    , modifier_1\n    , modifier_2\n    , modifier_3\n    , modifier_4\n    , modifier_5\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.procedure\n),  __dbt__cte___stg_medical_claim as (\n\n\nselect\n      person_id\n    , claim_id\n    , claim_start_date\n    , claim_end_date\n    , place_of_service_code\n    , hcpcs_code\n    , hcpcs_modifier_1\n    , hcpcs_modifier_2\n    , hcpcs_modifier_3\n    , hcpcs_modifier_4\n    , hcpcs_modifier_5\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.medical_claim\n\n\n),  __dbt__cte___stg_patient as (\n\nselect\n      person_id\n    , sex\n    , birth_date\n    , death_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.patient\n), visit_codes as (\n\n    select\n          code\n        , code_system\n    from tuva.quality_measures._value_set_codes\n    where lower(concept_name) in (\n          'home healthcare services'\n        , 'office visit'\n        , 'encounter to document medications'\n        , 'psychological and/or neuropsychological test administration'\n    )\n\n)\n\n, visits_encounters as (\n\n    select \n          person_id\n        , coalesce(encounter.encounter_start_date, encounter.encounter_end_date) as min_date\n        , coalesce(encounter.encounter_end_date, encounter.encounter_start_date) as max_date\n    from __dbt__cte___stg_encounter encounter\n    inner join tuva.quality_measures._int_nqf0420__performance_period as pp\n        on coalesce(encounter.encounter_end_date, encounter.encounter_start_date) >= pp.performance_period_begin\n            and coalesce(encounter.encounter_start_date, encounter.encounter_end_date) <= pp.performance_period_end\n    where lower(encounter_type) = 'home health'\n        or lower(encounter_group) in (\n              'office based'\n            , 'outpatient'\n    )\n\n)\n\n, procedures as (\n\n    select\n        person_id\n      , procedure_date\n      , coalesce (\n              normalized_code_type\n            , case\n                when lower(source_code_type) = 'cpt' then 'hcpcs'\n                when lower(source_code_type) = 'snomed' then 'snomed-ct'\n                else lower(source_code_type)\n              end\n          ) as code_type\n        , coalesce (\n              normalized_code\n            , source_code\n          ) as code\n    from __dbt__cte___stg_procedure\n    where   coalesce(modifier_1, '') not in ('GQ', 'GT', '95')\n        and coalesce(modifier_2, '') not in ('GQ', 'GT', '95')\n        and coalesce(modifier_3, '') not in ('GQ', 'GT', '95')\n        and coalesce(modifier_4, '') not in ('GQ', 'GT', '95')\n        and coalesce(modifier_5, '') not in ('GQ', 'GT', '95')\n\n)\n\n, claims as (\n\n    select \n          person_id\n        , coalesce(claim_start_date,claim_end_date) as min_date\n        , coalesce(claim_end_date,claim_start_date) as max_date\n        , hcpcs_code\n    from __dbt__cte___stg_medical_claim\n    where   coalesce(hcpcs_modifier_1, '') not in ('GQ', 'GT', '95')\n        and coalesce(hcpcs_modifier_2, '') not in ('GQ', 'GT', '95')\n        and coalesce(hcpcs_modifier_3, '') not in ('GQ', 'GT', '95')\n        and coalesce(hcpcs_modifier_4, '') not in ('GQ', 'GT', '95')\n        and coalesce(hcpcs_modifier_5, '') not in ('GQ', 'GT', '95')\n        and coalesce(place_of_service_code, '') not in ('02')\n        \n)\n\n, procedure_encounters as (\n\n    select \n          procedures.person_id\n        , procedures.procedure_date as min_date\n        , procedures.procedure_date as max_date\n    from procedures\n    inner join tuva.quality_measures._int_nqf0420__performance_period  as pp\n        on procedure_date between pp.performance_period_begin and pp.performance_period_end\n    inner join visit_codes\n        on procedures.code = visit_codes.code\n            and procedures.code_type = visit_codes.code_system\n\n)\n\n, claims_encounters as (\n    \n    select \n          claims.person_id\n        , claims.min_date\n        , claims.max_date\n    from claims\n    inner join tuva.quality_measures._int_nqf0420__performance_period as pp \n        on claims.max_date >=  pp.performance_period_begin\n            and claims.min_date <=  pp.performance_period_end\n    inner join visit_codes\n        on claims.hcpcs_code = visit_codes.code\n            and visit_codes.code_system = 'hcpcs'\n\n)\n\n, all_encounters as (\n\n    select *, 'v' as visit_enc, cast(null as TEXT) as proc_enc, cast(null as TEXT) as claim_enc\n    from visits_encounters\n\n    union all\n\n    select *, cast(null as TEXT) as visit_enc, 'p' as proc_enc, cast(null as TEXT) as claim_enc\n    from procedure_encounters\n\n    union all\n    \n    select *, cast(null as TEXT) as visit_enc, cast(null as TEXT) as proc_enc, 'c' as claim_enc\n    from claims_encounters\n\n)\n\n, encounters_by_patient as (\n\n    select \n          person_id\n        , max(max_date) max_date\n        , coalesce(min(visit_enc), '') || coalesce(min(proc_enc), '') || coalesce(min(claim_enc), '') as qualifying_types\n    from all_encounters\n    group by person_id\n\n)\n\n, patients_with_age as (\n\n    select\n          p.person_id\n        , floor(datediff(\n        hour,\n        birth_date,\n        e.max_date\n        ) / 8760.0) as max_age\n        , qualifying_types\n    from __dbt__cte___stg_patient p\n    inner join encounters_by_patient e\n        on p.person_id = e.person_id\n    where p.death_date is null\n\n)\n\n, qualifying_patients as (\n\n    select\n        distinct\n          person_id\n        , max_age as age\n        , pp.performance_period_begin\n        , pp.performance_period_end\n        , pp.measure_id\n        , pp.measure_name\n        , pp.measure_version\n        , 1 as denominator_flag\n    from patients_with_age\n    cross join tuva.quality_measures._int_nqf0420__performance_period pp\n    where max_age >= 18\n\n)\n\n, add_data_types as (\n\n    select\n          cast(person_id as TEXT) as person_id\n        , cast(age as integer) as age\n        , cast(performance_period_begin as date) as performance_period_begin\n        , cast(performance_period_end as date) as performance_period_end\n        , cast(measure_id as TEXT) as measure_id\n        , cast(measure_name as TEXT) as measure_name\n        , cast(measure_version as TEXT) as measure_version\n        , cast(denominator_flag as integer) as denominator_flag\n    from qualifying_patients\n\n)\n\nselect \n      person_id\n    , age\n    , performance_period_begin\n    , performance_period_end\n    , measure_id\n    , measure_name\n    , measure_version\n    , denominator_flag\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.quality_measures._int_nqf0420_denominator"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.669450Z", "completed_at": "2025-02-25T21:26:31.678989Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:31.682408Z", "completed_at": "2025-02-25T21:26:31.682415Z"}], "thread_id": "Thread-1", "execution_time": 0.01532602310180664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ahrq_measures__int_pqi_shared_exclusion_union", "compiled": true, "compiled_code": "\n\n-- Missing Age Exclusion\nselect \n    denom.encounter_id\n  , denom.data_source\n  , 'missing age' as exclusion_reason\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._stg_pqi_inpatient_encounter as denom\ninner join tuva.ahrq_measures._int_pqi_shared_exclusions_missing_age as age\n  on denom.person_id = age.person_id\n  and denom.data_source = age.data_source\n\nunion all\n\n-- Missing Gender Exclusion\nselect \n    denom.encounter_id\n  , denom.data_source\n  , 'missing gender' as exclusion_reason\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._stg_pqi_inpatient_encounter as denom\ninner join tuva.ahrq_measures._int_pqi_shared_exclusion_missing_gender as gender\n  on denom.person_id = gender.person_id\n  and denom.data_source = gender.data_source\n\nunion all\n\n-- Missing Dates Exclusion\nselect \n    denom.encounter_id\n  , denom.data_source\n  , 'missing dates' as exclusion_reason\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._stg_pqi_inpatient_encounter as denom\ninner join tuva.ahrq_measures._int_pqi_shared_exclusion_missing_dates as dates\n  on denom.encounter_id = dates.encounter_id\n  and denom.data_source = dates.data_source\n\nunion all\n\n-- Missing Primary Diagnosis Exclusion\nselect \n    denom.encounter_id\n  , denom.data_source\n  , 'missing primary diagnosis' as exclusion_reason\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._stg_pqi_inpatient_encounter as denom\ninner join tuva.ahrq_measures._int_pqi_shared_exclusion_missing_primary_dx as dx\n  on denom.encounter_id = dx.encounter_id\n  and denom.data_source = dx.data_source\n\nunion all\n\n-- Transfer Exclusion\nselect \n    denom.encounter_id\n  , denom.data_source\n  , 'transfer' as exclusion_reason\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._stg_pqi_inpatient_encounter as denom\ninner join tuva.ahrq_measures._int_pqi_shared_exclusion_transfer as tx\n  on denom.encounter_id = tx.encounter_id\n  and denom.data_source = tx.data_source\n\nunion all\n\n-- Ungroupable DRG Exclusion\nselect \n    denom.encounter_id\n  , denom.data_source\n  , 'ungroupable DRG' as exclusion_reason\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._stg_pqi_inpatient_encounter as denom\ninner join tuva.ahrq_measures._int_pqi_shared_exclusion_ungroupable_drg as drg\n  on denom.encounter_id = drg.encounter_id\n  and denom.data_source = drg.data_source", "relation_name": "tuva.ahrq_measures._int_pqi_shared_exclusion_union"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.679373Z", "completed_at": "2025-02-25T21:26:31.737635Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:31.739946Z", "completed_at": "2025-02-25T21:26:31.739951Z"}], "thread_id": "Thread-4", "execution_time": 0.06244778633117676, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ed_classification__int_filter_encounter_with_classification", "compiled": true, "compiled_code": "/*\nFilter conditions to those that were classified and pick the classification\nwith the greatest probability (that's the greatest logic). This logic removes\nany rows that were not classified.\n*/\n\n\nselect\n   a.*\n   , case greatest(edcnnpa, edcnpa, epct, noner, injury, psych, alcohol, drug)\n          when edcnnpa then 'edcnnpa'\n          when edcnpa then 'edcnpa'\n          when epct then 'epct'\n          when noner then 'noner'\n          when injury then 'injury'\n          when psych then 'psych'\n          when alcohol then 'alcohol'\n          when drug then 'drug'\n          else 'unclassified'\n   end as classification\nfrom tuva.ed_classification._int_by_provider_parent_organization a\nwhere ed_classification_capture = 1", "relation_name": "tuva.ed_classification._int_filter_encounter_with_classification"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.682812Z", "completed_at": "2025-02-25T21:26:31.740985Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:31.741884Z", "completed_at": "2025-02-25T21:26:31.741889Z"}], "thread_id": "Thread-2", "execution_time": 0.06366610527038574, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.quality_measures__int_cqm130_exclusions", "compiled": true, "compiled_code": "with  __dbt__cte___stg_condition as (\n\nselect\n      person_id\n    , claim_id\n    , encounter_id\n    , recorded_date\n    , source_code_type\n    , source_code\n    , normalized_code_type\n    , normalized_code\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.condition\n),  __dbt__cte___stg_procedure as (\n\nselect\n      person_id\n    , encounter_id\n    , procedure_date\n    , source_code_type\n    , source_code\n    , normalized_code_type\n    , normalized_code\n    , modifier_1\n    , modifier_2\n    , modifier_3\n    , modifier_4\n    , modifier_5\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.procedure\n),  __dbt__cte___stg_medical_claim as (\n\n\nselect\n      person_id\n    , claim_id\n    , claim_start_date\n    , claim_end_date\n    , place_of_service_code\n    , hcpcs_code\n    , hcpcs_modifier_1\n    , hcpcs_modifier_2\n    , hcpcs_modifier_3\n    , hcpcs_modifier_4\n    , hcpcs_modifier_5\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.medical_claim\n\n\n), exclusion_codes as (\n\n    select\n          code\n        , code_system\n        , concept_name\n    from tuva.quality_measures._value_set_codes\n    where lower(concept_name) in  (\n            'medical reason'\n    )\n\n)\n\n, conditions as (\n\n    select\n          person_id\n        , recorded_date\n        , claim_id\n        , coalesce (\n              normalized_code_type\n            , case\n                when lower(source_code_type) = 'snomed' then 'snomed-ct'\n                else lower(source_code_type)\n              end\n          ) as code_type\n        , coalesce (\n              normalized_code\n            , source_code\n          ) as code\n    from __dbt__cte___stg_condition\n    where recorded_date between (\n  select \n    performance_period_begin\n  from tuva.quality_measures._int_cqm130__performance_period\n) and (\n  select \n    performance_period_end\n  from tuva.quality_measures._int_cqm130__performance_period\n)\n\n)\n\n, procedures as (\n\n    select\n          person_id\n        , procedure_date\n        , coalesce (\n              normalized_code_type\n            , case\n                when lower(source_code_type) = 'cpt' then 'hcpcs'\n                when lower(source_code_type) = 'snomed' then 'snomed-ct'\n                else lower(source_code_type)\n              end\n          ) as code_type\n        , coalesce (\n              normalized_code\n            , source_code\n          ) as code\n    from __dbt__cte___stg_procedure\n    where procedure_date between (\n  select \n    performance_period_begin\n  from tuva.quality_measures._int_cqm130__performance_period\n) and (\n  select \n    performance_period_end\n  from tuva.quality_measures._int_cqm130__performance_period\n)\n\n)\n\n, medical_claim as (\n\n    select\n          person_id\n        , claim_start_date\n        , claim_end_date\n        , hcpcs_code\n    from __dbt__cte___stg_medical_claim\n    where coalesce(claim_end_date, claim_start_date) between (\n  select \n    performance_period_begin\n  from tuva.quality_measures._int_cqm130__performance_period\n) and (\n  select \n    performance_period_end\n  from tuva.quality_measures._int_cqm130__performance_period\n)\n\n)\n\n, condition_exclusions as (\n\n    select\n          conditions.person_id\n        , conditions.claim_id\n        , conditions.recorded_date\n        , exclusion_codes.concept_name as concept_name\n    from conditions\n    inner join exclusion_codes\n      on conditions.code = exclusion_codes.code\n        and conditions.code_type = exclusion_codes.code_system\n\n)\n\n, procedure_exclusions as (\n\n    select\n          procedures.person_id\n        , procedures.procedure_date\n        , exclusion_codes.concept_name as concept_name\n    from procedures\n    inner join exclusion_codes\n      on procedures.code = exclusion_codes.code\n        and procedures.code_type = exclusion_codes.code_system\n\n)\n\n, med_claim_exclusions as (\n\n    select\n          medical_claim.person_id\n        , coalesce(medical_claim.claim_end_date, medical_claim.claim_start_date) as exclusion_date\n        , medical_claim.hcpcs_code\n        , exclusion_codes.concept_name as concept_name\n    from medical_claim\n    inner join exclusion_codes\n      on medical_claim.hcpcs_code = exclusion_codes.code\n        and exclusion_codes.code_system = 'hcpcs'\n\n)\n\n, patients_with_exclusions as (\n    \n    select \n          person_id\n        , recorded_date as exclusion_date\n        , concept_name as exclusion_reason\n    from condition_exclusions\n\n    union all\n\n    select \n          person_id\n        , procedure_date as exclusion_date\n        , concept_name as exclusion_reason\n    from procedure_exclusions\n\n    union all\n\n    select\n          person_id\n        , exclusion_date\n        , concept_name as exclusion_reason\n    from med_claim_exclusions\n\n)\n\n, valid_exclusions as (\n\n  select \n        patients_with_exclusions.person_id\n      , patients_with_exclusions.exclusion_date\n      , patients_with_exclusions.exclusion_reason  \n  from patients_with_exclusions\n  inner join tuva.quality_measures._int_cqm130_denominator as denominator\n      on patients_with_exclusions.person_id = denominator.person_id\n\n)\n\n, add_data_types as (\n\n    select\n        distinct\n          cast(person_id as TEXT) as person_id\n        , cast(exclusion_date as date) as exclusion_date\n        , cast(exclusion_reason as TEXT) as exclusion_reason\n        , cast(1 as integer) as exclusion_flag\n    from valid_exclusions\n\n)\n\nselect\n      person_id\n    , exclusion_date\n    , exclusion_reason\n    , exclusion_flag\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.quality_measures._int_cqm130_exclusions"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.708135Z", "completed_at": "2025-02-25T21:26:31.741684Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:31.746956Z", "completed_at": "2025-02-25T21:26:31.746962Z"}], "thread_id": "Thread-3", "execution_time": 0.0682380199432373, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.quality_measures__int_cqm130_numerator", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte___stg_procedure as (\n\nselect\n      person_id\n    , encounter_id\n    , procedure_date\n    , source_code_type\n    , source_code\n    , normalized_code_type\n    , normalized_code\n    , modifier_1\n    , modifier_2\n    , modifier_3\n    , modifier_4\n    , modifier_5\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.procedure\n),  __dbt__cte___stg_medical_claim as (\n\n\nselect\n      person_id\n    , claim_id\n    , claim_start_date\n    , claim_end_date\n    , place_of_service_code\n    , hcpcs_code\n    , hcpcs_modifier_1\n    , hcpcs_modifier_2\n    , hcpcs_modifier_3\n    , hcpcs_modifier_4\n    , hcpcs_modifier_5\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.medical_claim\n\n\n), denominator as (\n\n    select\n          person_id\n        , procedure_encounter_date\n        , claims_encounter_date\n        , performance_period_begin\n        , performance_period_end\n        , measure_id\n        , measure_name\n        , measure_version\n    from tuva.quality_measures._int_cqm130_denominator\n\n)\n\n, medication_code as (\n\n    select\n          code\n        , code_system\n        , concept_name\n    from tuva.quality_measures._value_set_codes\n    where lower(concept_name) in  (\n          'eligible clinician attests to documenting current medications'\n    )\n\n)\n\n, procedures as (\n\n    select\n        person_id\n      , procedure_date\n      , coalesce (\n              normalized_code_type\n            , case\n                when lower(source_code_type) = 'cpt' then 'hcpcs'\n                when lower(source_code_type) = 'snomed' then 'snomed-ct'\n                else lower(source_code_type)\n              end\n          ) as code_type\n        , coalesce (\n              normalized_code\n            , source_code\n          ) as code\n    from __dbt__cte___stg_procedure\n\n)\n\n, documenting_meds_procedures as (\n\n    select\n          person_id\n        , procedure_date\n    from procedures\n    inner join medication_code\n      on procedures.code = medication_code.code\n        and procedures.code_type = medication_code.code_system\n\n)\n\n, documenting_meds_claims as (\n\n    select\n          person_id\n        , coalesce(claim_end_date,claim_start_date) as encounter_date\n    from __dbt__cte___stg_medical_claim medical_claim\n    inner join medication_code\n        on medical_claim.hcpcs_code = medication_code.code\n          and medication_code.code_system = 'hcpcs'\n\n)\n\n, qualifying_procedure as (\n\n    select \n          documenting_meds_procedures.person_id\n        , documenting_meds_procedures.procedure_date as encounter_date\n        , denominator.performance_period_begin\n        , denominator.performance_period_end\n        , denominator.measure_id\n        , denominator.measure_name\n        , denominator.measure_version\n    from documenting_meds_procedures\n    inner join denominator\n      on documenting_meds_procedures.person_id = denominator.person_id\n        and documenting_meds_procedures.procedure_date = denominator.procedure_encounter_date\n\n)\n\n, qualifying_claims as (\n    \n    select \n          documenting_meds_claims.person_id\n        , documenting_meds_claims.encounter_date\n        , denominator.performance_period_begin\n        , denominator.performance_period_end\n        , denominator.measure_id\n        , denominator.measure_name\n        , denominator.measure_version\n    from documenting_meds_claims\n    inner join denominator\n      on documenting_meds_claims.person_id = denominator.person_id\n        and documenting_meds_claims.encounter_date = denominator.claims_encounter_date\n\n)\n\n, qualifying_cares as (\n\n    select\n          person_id\n        , encounter_date\n        , performance_period_begin\n        , performance_period_end\n        , measure_id\n        , measure_name\n        , measure_version\n        , cast(1 as integer) as numerator_flag\n    from qualifying_procedure\n\n    union all\n\n    select\n          person_id\n        , encounter_date\n        , performance_period_begin\n        , performance_period_end\n        , measure_id\n        , measure_name\n        , measure_version\n        , cast(1 as integer) as numerator_flag\n    from qualifying_claims\n\n)\n\n, add_data_types as (\n\n     select distinct\n          cast(person_id as TEXT) as person_id\n        , cast(performance_period_begin as date) as performance_period_begin\n        , cast(performance_period_end as date) as performance_period_end\n        , cast(measure_id as TEXT) as measure_id\n        , cast(measure_name as TEXT) as measure_name\n        , cast(measure_version as TEXT) as measure_version\n        , cast(encounter_date as date) as evidence_date\n        , cast(null as TEXT) as evidence_value\n        , cast(numerator_flag as integer) as numerator_flag\n      from qualifying_cares\n\n)\n\nselect\n      person_id\n    , performance_period_begin\n    , performance_period_end\n    , measure_id\n    , measure_name\n    , measure_version\n    , evidence_date\n    , evidence_value\n    , numerator_flag\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.quality_measures._int_cqm130_numerator"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.742287Z", "completed_at": "2025-02-25T21:26:31.751430Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:31.752185Z", "completed_at": "2025-02-25T21:26:31.752189Z"}], "thread_id": "Thread-1", "execution_time": 0.011822938919067383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.readmissions__encounter_overlap", "compiled": true, "compiled_code": "\n\n-- Here we give a list of all pairs of encounters\n-- that have some date overlap.\n\n\nwith encounters_with_row_num as (\nselect\n    encounter_id,\n    person_id,\n    admit_date,\n    discharge_date,\n    row_number() over (\n        partition by person_id order by encounter_id\n\t) as row_num\nfrom tuva.readmissions._int_encounter\n),\n\n\ncartesian as (\nselect\n    aa.encounter_id as encounter_id_A,\n    bb.encounter_id as encounter_id_B,\n    aa.person_id,\n    aa.admit_date as Ai,\n    aa.discharge_date as Af,\n    bb.admit_date as Bi,\n    bb.discharge_date as Bf,\n    case\n        when (aa.admit_date between bb.admit_date and bb.discharge_date) or (aa.discharge_date between bb.admit_date and bb.discharge_date) or\n             (bb.admit_date between aa.admit_date and aa.discharge_date) or (bb.discharge_date between aa.admit_date and aa.discharge_date)\n        then 1\n        else 0\n    end as overlap\n    from encounters_with_row_num aa\n    left join encounters_with_row_num bb\n    on aa.person_id = bb.person_id and aa.row_num < bb.row_num\n),\n\n\noverlapping_pairs\nas\n(\n    select\n        person_id,\n        encounter_id_A,\n\tencounter_id_B\n    from cartesian\n    where overlap = 1\n)\n\n\n\nselect *, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom overlapping_pairs", "relation_name": "tuva.readmissions._int_encounter_overlap"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.747666Z", "completed_at": "2025-02-25T21:26:31.752951Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:31.760270Z", "completed_at": "2025-02-25T21:26:31.760275Z"}], "thread_id": "Thread-4", "execution_time": 0.01887202262878418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.readmissions__encounter_with_ccs", "compiled": true, "compiled_code": "\n\n-- Here we add a CCS diagnosis category to\n-- every encounter that we can add a CCS diagnosis category to.\n-- The CCS diagnosis category is found using\n-- the encounter's primary diagnosis code.\n\n\nselect\n    aa.encounter_id,\n    aa.person_id,\n    aa.admit_date,\n    aa.discharge_date,\n    aa.discharge_disposition_code,\n    aa.facility_id,\n    aa.drg_code_type,\n    aa.drg_code,\n    aa.paid_amount,\n    aa.primary_diagnosis_code,\n\n    case\n      when bb.icd_10_cm is not null then 1\n      else 0\n    end as valid_primary_diagnosis_code_flag,\n\n    cc.ccs_diagnosis_category,\n\n    '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\n\nfrom\n    tuva.readmissions._int_encounter aa\n    left join tuva.terminology.icd_10_cm bb\n    on aa.primary_diagnosis_code = bb.icd_10_cm\n    left join tuva.readmissions._value_set_icd_10_cm_to_ccs cc\n    on aa.primary_diagnosis_code = cc.icd_10_cm", "relation_name": "tuva.readmissions._int_encounter_with_ccs"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.756671Z", "completed_at": "2025-02-25T21:26:31.761593Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:31.774638Z", "completed_at": "2025-02-25T21:26:31.774645Z"}], "thread_id": "Thread-3", "execution_time": 0.02275395393371582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.readmissions__index_time_requirement", "compiled": true, "compiled_code": "\n\n-- Here we list encounter_ids that meet\n-- the time requirement to be an index admission:\n-- The discharge date must be at least 30 days\n-- earlier than the last discharge date available\n-- in the dataset.\n\n\nwith cte as (\n  select max(discharge_date) max_discharge\n  from tuva.readmissions._int_encounter\n)\n\nselect encounter_id\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.readmissions._int_encounter\ncross join cte\nwhere discharge_date <= \n\n    dateadd(\n        day,\n        -30,\n        cte.max_discharge\n        )\n\n", "relation_name": "tuva.readmissions._int_index_time_requirement"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.753367Z", "completed_at": "2025-02-25T21:26:31.761787Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:31.786697Z", "completed_at": "2025-02-25T21:26:31.786702Z"}], "thread_id": "Thread-2", "execution_time": 0.035108089447021484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.readmissions__index_discharge_requirement", "compiled": true, "compiled_code": "\n\n-- Here we list encounter_ids that meet\n-- the discharge_disposition_code requirements to be an\n-- index admission:\n--    *** Must NOT be discharged to another acute care hospital\n--    *** Must NOT have left against medical advice\n--    *** Patient must be alive at discharge\n\n\n\nwith all_invalid_discharges as (\nselect encounter_id\nfrom tuva.readmissions._int_encounter\nwhere discharge_disposition_code in (\n     '02' -- Patient discharged/transferred to other short term general hospital for inpatient care.\n    ,'07' -- Patient left against medical advice\n    ,'20' -- Patient died\n    )\n)\n\n-- All discharges that meet the discharge_disposition_code\n-- requirements to be an index admission\nselect a.encounter_id, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.readmissions._int_encounter a\nleft join all_invalid_discharges b\n    on a.encounter_id = b.encounter_id\nwhere b.encounter_id is null", "relation_name": "tuva.readmissions._int_index_discharge_requirement"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.762202Z", "completed_at": "2025-02-25T21:26:31.836981Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:31.850108Z", "completed_at": "2025-02-25T21:26:31.850114Z"}], "thread_id": "Thread-1", "execution_time": 0.08951878547668457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.quality_measures__int_cqm438_exclusions", "compiled": true, "compiled_code": "with  __dbt__cte___stg_condition as (\n\nselect\n      person_id\n    , claim_id\n    , encounter_id\n    , recorded_date\n    , source_code_type\n    , source_code\n    , normalized_code_type\n    , normalized_code\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.condition\n),  __dbt__cte___stg_medical_claim as (\n\n\nselect\n      person_id\n    , claim_id\n    , claim_start_date\n    , claim_end_date\n    , place_of_service_code\n    , hcpcs_code\n    , hcpcs_modifier_1\n    , hcpcs_modifier_2\n    , hcpcs_modifier_3\n    , hcpcs_modifier_4\n    , hcpcs_modifier_5\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.medical_claim\n\n\n),  __dbt__cte___stg_observation as (\n\n\nselect\n      person_id\n    , encounter_id\n    , observation_date\n    , result\n    , source_code_type\n    , source_code\n    , normalized_code_type\n    , normalized_code\n    , normalized_description\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.observation\n\n\n),  __dbt__cte___stg_procedure as (\n\nselect\n      person_id\n    , encounter_id\n    , procedure_date\n    , source_code_type\n    , source_code\n    , normalized_code_type\n    , normalized_code\n    , modifier_1\n    , modifier_2\n    , modifier_3\n    , modifier_4\n    , modifier_5\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.procedure\n),  __dbt__cte___stg_medication as (\n\n\nselect\n      person_id\n    , encounter_id\n    , prescribing_date  \n    , dispensing_date\n    , source_code_type\n    , source_code\n    , ndc_code\n    , rxnorm_code\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.medication\n\n\n),  __dbt__cte___stg_pharmacy_claim as (\n\n\nselect\n      person_id\n    , dispensing_date\n    , ndc_code\n    , days_supply\n    , paid_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.pharmacy_claim\n\n\n), exclusion_codes as (\n\n    select\n          code\n        , case code_system\n            when 'SNOMEDCT' then 'snomed-ct'\n            when 'ICD9CM' then 'icd-9-cm'\n            when 'ICD10CM' then 'icd-10-cm'\n            when 'CPT' then 'hcpcs'\n            when 'ICD10PCS' then 'icd-10-pcs'\n          else lower(code_system) end as code_system\n        , concept_name\n    from tuva.quality_measures._value_set_codes\n    where lower(concept_name) in  (\n            'rhabdomyolysis'\n          , 'breastfeeding'\n          , 'liver disease'\n          , 'hepatitis a'\n          , 'hepatitis b'\n          , 'documentation of medical reason for no statin therapy'\n          , 'statin allergen'\n          , 'end stage renal disease'\n          , 'statin associated muscle symptoms'\n          , 'medical reason'\n    )\n\n)\n\n, valid_hospice_palliative as (\n\n  select\n      person_id\n    , exclusion_date\n    , exclusion_reason\n    , exclusion_type\n  from tuva.quality_measures._int_shared_exclusions_hospice_palliative\n  where exclusion_date between (\n  select \n    performance_period_begin\n  from tuva.quality_measures._int_cqm438__performance_period\n\n) and (\n  select \n    performance_period_end\n  from tuva.quality_measures._int_cqm438__performance_period\n\n)\n\n)\n\n, conditions as (\n\n    select\n          person_id\n        , claim_id\n        , recorded_date\n        , coalesce (\n              normalized_code_type\n            , case\n                when lower(source_code_type) = 'snomed' then 'snomed-ct'\n                else lower(source_code_type)\n              end\n          ) as code_type\n        , coalesce (\n              normalized_code\n            , source_code\n          ) as code\n    from __dbt__cte___stg_condition\n    where recorded_date between (\n  select \n    performance_period_begin\n  from tuva.quality_measures._int_cqm438__performance_period\n\n) and (\n  select \n    performance_period_end\n  from tuva.quality_measures._int_cqm438__performance_period\n\n)\n\n)\n\n, medical_claim as (\n\n    select\n          person_id\n        , claim_id\n        , claim_start_date\n        , claim_end_date\n        , hcpcs_code\n        , place_of_service_code\n    from __dbt__cte___stg_medical_claim\n    where coalesce(claim_end_date, claim_start_date) between (\n  select \n    performance_period_begin\n  from tuva.quality_measures._int_cqm438__performance_period\n\n) and (\n  select \n    performance_period_end\n  from tuva.quality_measures._int_cqm438__performance_period\n\n)\n\n)\n\n, observations as (\n\n    select\n          person_id\n        , observation_date\n        , coalesce (\n              normalized_code_type\n            , case\n                when lower(source_code_type) = 'cpt' then 'hcpcs'\n                when lower(source_code_type) = 'snomed' then 'snomed-ct'\n                else lower(source_code_type)\n              end\n          ) as code_type\n        , coalesce (\n              normalized_code\n            , source_code\n          ) as code\n    from __dbt__cte___stg_observation\n    where observation_date between (\n  select \n    performance_period_begin\n  from tuva.quality_measures._int_cqm438__performance_period\n\n) and (\n  select \n    performance_period_end\n  from tuva.quality_measures._int_cqm438__performance_period\n\n)\n\n)\n\n, procedures as (\n\n    select\n          person_id\n        , procedure_date\n        , coalesce (\n              normalized_code_type\n            , case\n                when lower(source_code_type) = 'cpt' then 'hcpcs'\n                when lower(source_code_type) = 'snomed' then 'snomed-ct'\n                else lower(source_code_type)\n              end\n          ) as code_type\n        , coalesce (\n              normalized_code\n            , source_code\n          ) as code\n    from __dbt__cte___stg_procedure\n    where procedure_date between (\n  select \n    performance_period_begin\n  from tuva.quality_measures._int_cqm438__performance_period\n\n) and (\n  select \n    performance_period_end\n  from tuva.quality_measures._int_cqm438__performance_period\n\n)\n\n)\n\n, medications as (\n    \n    select\n        person_id\n      , coalesce(prescribing_date, dispensing_date) as exclusion_date\n      , source_code\n      , source_code_type\n    from __dbt__cte___stg_medication\n\n)\n\n, pharmacy_claims as (\n\n    select\n        person_id\n      , dispensing_date\n      , ndc_code\n    from __dbt__cte___stg_pharmacy_claim \n\n)\n\n, condition_exclusions as (\n\n    select\n          conditions.person_id\n        , conditions.claim_id\n        , conditions.recorded_date\n        , exclusion_codes.concept_name as concept_name\n    from conditions\n         inner join exclusion_codes\n            on conditions.code = exclusion_codes.code\n            and conditions.code_type = exclusion_codes.code_system\n\n)\n\n, med_claim_exclusions as (\n\n    select\n          medical_claim.person_id\n        , medical_claim.claim_id\n        , medical_claim.claim_start_date\n        , medical_claim.claim_end_date\n        , medical_claim.hcpcs_code\n        , exclusion_codes.concept_name as concept_name\n    from medical_claim\n         inner join exclusion_codes\n            on medical_claim.hcpcs_code = exclusion_codes.code\n    where exclusion_codes.code_system = 'hcpcs'\n\n)\n\n, observation_exclusions as (\n\n    select\n          observations.person_id\n        , observations.observation_date\n        , exclusion_codes.concept_name as concept_name\n    from observations\n    inner join exclusion_codes\n        on observations.code = exclusion_codes.code\n        and observations.code_type = exclusion_codes.code_system\n\n)\n\n, procedure_exclusions as (\n\n    select\n          procedures.person_id\n        , procedures.procedure_date\n        , exclusion_codes.concept_name as concept_name\n    from procedures\n    inner join exclusion_codes\n        on procedures.code = exclusion_codes.code\n          and procedures.code_type = exclusion_codes.code_system\n\n)\n\n, medication_exclusions as (\n\n    select\n          medications.person_id\n        , medications.exclusion_date\n        , exclusion_codes.concept_name as concept_name\n    from medications\n    inner join exclusion_codes\n        on medications.source_code = exclusion_codes.code\n          and medications.source_code_type = exclusion_codes.code_system\n\n)\n\n, pharmacy_claims_exclusions as (\n\n    select\n          pharmacy_claims.person_id\n        , pharmacy_claims.dispensing_date\n        , exclusion_codes.concept_name as concept_name\n    from pharmacy_claims\n    inner join exclusion_codes\n        on pharmacy_claims.ndc_code = exclusion_codes.code\n        and lower(exclusion_codes.code_system) = 'ndc'\n\n)\n\n, patients_with_exclusions as(\n    \n    select \n          person_id\n        , recorded_date as exclusion_date\n        , concept_name as exclusion_reason\n    from condition_exclusions\n\n    union all\n\n    select \n          person_id\n        , coalesce(claim_end_date, claim_start_date) as exclusion_date\n        , concept_name as exclusion_reason\n    from med_claim_exclusions\n\n    union all\n\n    select \n          person_id\n        , observation_date as exclusion_date\n        , concept_name as exclusion_reason\n    from observation_exclusions\n\n    union all\n\n    select \n          person_id\n        , procedure_date as exclusion_date\n        , concept_name as exclusion_reason\n    from procedure_exclusions\n\n    union all\n\n    select \n          person_id\n        , exclusion_date\n        , concept_name as exclusion_reason\n    from medication_exclusions\n\n    union all\n\n    select\n          person_id\n        , dispensing_date as exclusion_date\n        , concept_name as exclusion_reason\n    from pharmacy_claims_exclusions\n\n    union all\n\n    select\n          person_id\n        , exclusion_date\n        , exclusion_reason\n    from valid_hospice_palliative\n\n)\n\n, valid_exclusions as (\n\n  select \n        patients_with_exclusions.person_id\n      , patients_with_exclusions.exclusion_date\n      , patients_with_exclusions.exclusion_reason  \n  from patients_with_exclusions\n  inner join tuva.quality_measures._int_cqm438_denominator as denominator\n      on patients_with_exclusions.person_id = denominator.person_id\n\n)\n\n, add_data_types as (\n\n    select\n        distinct\n          cast(person_id as TEXT) as person_id\n        , cast(exclusion_date as date) as exclusion_date\n        , cast(exclusion_reason as TEXT) as exclusion_reason\n        , cast(1 as integer) as exclusion_flag\n    from valid_exclusions\n\n)\n\nselect\n      person_id\n    , exclusion_date\n    , exclusion_reason\n    , exclusion_flag\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.quality_measures._int_cqm438_exclusions"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.811870Z", "completed_at": "2025-02-25T21:26:31.843570Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:31.865921Z", "completed_at": "2025-02-25T21:26:31.865927Z"}], "thread_id": "Thread-4", "execution_time": 0.10402202606201172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.quality_measures__int_cqm438_numerator", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte___stg_procedure as (\n\nselect\n      person_id\n    , encounter_id\n    , procedure_date\n    , source_code_type\n    , source_code\n    , normalized_code_type\n    , normalized_code\n    , modifier_1\n    , modifier_2\n    , modifier_3\n    , modifier_4\n    , modifier_5\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.procedure\n),  __dbt__cte___stg_pharmacy_claim as (\n\n\nselect\n      person_id\n    , dispensing_date\n    , ndc_code\n    , days_supply\n    , paid_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.pharmacy_claim\n\n\n),  __dbt__cte___stg_medication as (\n\n\nselect\n      person_id\n    , encounter_id\n    , prescribing_date  \n    , dispensing_date\n    , source_code_type\n    , source_code\n    , ndc_code\n    , rxnorm_code\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.medication\n\n\n), denominator as (\n\n    select\n          person_id\n        , performance_period_begin\n        , performance_period_end\n        , measure_id\n        , measure_name\n        , measure_version\n    from tuva.quality_measures._int_cqm438_denominator\n\n)\n\n, statin_codes as (\n\n    select\n          code\n        , code_system\n        , concept_name\n    from tuva.quality_measures._value_set_codes\n    where lower(concept_name) in  (\n          'high intensity statin therapy'\n        , 'low intensity statin therapy'\n        , 'moderate intensity statin therapy'\n        , 'statin therapy'\n    )\n\n)\n\n, procedures as (\n\n    select\n        person_id\n      , procedure_date\n      , coalesce (\n              normalized_code_type\n            , case\n                when lower(source_code_type) = 'cpt' then 'hcpcs'\n                when lower(source_code_type) = 'snomed' then 'snomed-ct'\n                else lower(source_code_type)\n              end\n          ) as code_type\n        , coalesce (\n              normalized_code\n            , source_code\n          ) as code\n    from __dbt__cte___stg_procedure\n\n)\n\n, procedure_statin_related as (\n\n    select \n          procedures.person_id\n        , procedures.procedure_date as evidence_date\n    from procedures\n    inner join statin_codes\n        on procedures.code = statin_codes.code\n            and procedures.code_type = statin_codes.code_system\n\n)\n\n, pharmacy_claims_statin_related as (\n\n    select\n        person_id\n      , dispensing_date as evidence_date\n      , ndc_code\n    from __dbt__cte___stg_pharmacy_claim as pharmacy_claims\n    inner join statin_codes\n    on pharmacy_claims.ndc_code = statin_codes.code\n        and lower(statin_codes.code_system) = 'ndc'\n\n)\n\n, medication_statin_related as (\n\n    select\n          person_id\n        , coalesce(dispensing_date, prescribing_date) as evidence_date\n        , source_code\n        , source_code_type\n    from __dbt__cte___stg_medication as medications\n    inner join statin_codes\n        on medications.source_code = statin_codes.code\n        and medications.source_code_type = statin_codes.code_system\n        \n)\n\n, qualifying_patients as (\n\n    select\n          procedure_statin_related.person_id\n        , procedure_statin_related.evidence_date\n    from procedure_statin_related\n\n    union all\n\n    select\n          pharmacy_claims_statin_related.person_id\n        , pharmacy_claims_statin_related.evidence_date\n    from pharmacy_claims_statin_related\n\n    union all\n\n    select\n          medication_statin_related.person_id\n        , medication_statin_related.evidence_date\n    from medication_statin_related\n\n)\n\n, qualifying_patients_with_denominator as (\n\n    select \n          qualifying_patients.person_id\n        , qualifying_patients.evidence_date\n        , denominator.performance_period_begin\n        , denominator.performance_period_end\n        , denominator.measure_id\n        , denominator.measure_name\n        , denominator.measure_version\n        , cast(1 as integer) as numerator_flag\n    from qualifying_patients\n    inner join denominator\n    on qualifying_patients.person_id = denominator.person_id\n    and evidence_date between \n            denominator.performance_period_begin and \n                denominator.performance_period_end\n\n)\n\n, add_data_types as (\n\n     select distinct\n          cast(person_id as TEXT) as person_id\n        , cast(performance_period_begin as date) as performance_period_begin\n        , cast(performance_period_end as date) as performance_period_end\n        , cast(measure_id as TEXT) as measure_id\n        , cast(measure_name as TEXT) as measure_name\n        , cast(measure_version as TEXT) as measure_version\n        , cast(evidence_date as date) as evidence_date\n        , cast(null as TEXT) as evidence_value\n        , cast(numerator_flag as integer) as numerator_flag\n    from qualifying_patients_with_denominator\n\n)\n\nselect\n      person_id\n    , performance_period_begin\n    , performance_period_end\n    , measure_id\n    , measure_name\n    , measure_version\n    , evidence_date\n    , evidence_value\n    , numerator_flag\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.quality_measures._int_cqm438_numerator"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.837379Z", "completed_at": "2025-02-25T21:26:31.882554Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:31.886267Z", "completed_at": "2025-02-25T21:26:31.886272Z"}], "thread_id": "Thread-3", "execution_time": 0.05015110969543457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.quality_measures__int_nqf0420_exclusions", "compiled": true, "compiled_code": "with  __dbt__cte___stg_procedure as (\n\nselect\n      person_id\n    , encounter_id\n    , procedure_date\n    , source_code_type\n    , source_code\n    , normalized_code_type\n    , normalized_code\n    , modifier_1\n    , modifier_2\n    , modifier_3\n    , modifier_4\n    , modifier_5\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.procedure\n),  __dbt__cte___stg_medical_claim as (\n\n\nselect\n      person_id\n    , claim_id\n    , claim_start_date\n    , claim_end_date\n    , place_of_service_code\n    , hcpcs_code\n    , hcpcs_modifier_1\n    , hcpcs_modifier_2\n    , hcpcs_modifier_3\n    , hcpcs_modifier_4\n    , hcpcs_modifier_5\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.medical_claim\n\n\n), denominator as (\n  \n    select\n        person_id\n    from tuva.quality_measures._int_nqf0420_denominator\n\n)\n\n, exclusion_codes as (\n\n    select\n          code\n        , code_system\n        , concept_name\n    from tuva.quality_measures._value_set_codes\n    where lower(concept_name) in (\n          'patient is not eligible for a pain assessment'\n      )\n\n)\n\n, procedures as (\n\n    select\n          person_id\n        , procedure_date\n        , coalesce (\n              normalized_code_type\n            , case\n                when lower(source_code_type) = 'cpt' then 'hcpcs'\n                when lower(source_code_type) = 'snomed' then 'snomed-ct'\n                else lower(source_code_type)\n              end\n          ) as code_type\n        , coalesce (\n              normalized_code\n            , source_code\n          ) as code\n    from __dbt__cte___stg_procedure\n    where procedure_date between (\n  select \n    performance_period_begin\n  from tuva.quality_measures._int_nqf0420__performance_period\n\n) and (\n  select \n    performance_period_end\n  from tuva.quality_measures._int_nqf0420__performance_period\n\n)\n\n)\n\n, medical_claim as (\n\n    select\n          person_id\n        , claim_start_date\n        , claim_end_date\n        , hcpcs_code\n    from __dbt__cte___stg_medical_claim\n    where coalesce(claim_end_date, claim_start_date) between (\n  select \n    performance_period_begin\n  from tuva.quality_measures._int_nqf0420__performance_period\n\n) and (\n  select \n    performance_period_end\n  from tuva.quality_measures._int_nqf0420__performance_period\n\n)\n\n)\n\n, procedure_exclusions as (\n\n    select\n          procedures.person_id\n        , procedures.procedure_date\n        , exclusion_codes.concept_name as concept_name\n    from procedures\n    inner join exclusion_codes\n        on procedures.code = exclusion_codes.code\n          and procedures.code_type = exclusion_codes.code_system\n\n)\n\n, med_claim_exclusions as (\n\n    select\n          medical_claim.person_id\n        , coalesce(medical_claim.claim_end_date, medical_claim.claim_start_date) as exclusion_date\n        , medical_claim.hcpcs_code\n        , exclusion_codes.concept_name as concept_name\n    from medical_claim\n    inner join exclusion_codes\n      on medical_claim.hcpcs_code = exclusion_codes.code\n        and exclusion_codes.code_system = 'hcpcs'\n\n)\n\n, patients_with_exclusions as(\n    \n    select\n        person_id\n      , exclusion_date\n      , concept_name as exclusion_reason\n    from med_claim_exclusions\n\n    union all\n\n    select \n          person_id\n        , procedure_date as exclusion_date\n        , concept_name as exclusion_reason\n    from procedure_exclusions\n\n)\n\n, valid_exclusions as (\n\n  select \n        patients_with_exclusions.person_id\n      , patients_with_exclusions.exclusion_date\n      , patients_with_exclusions.exclusion_reason  \n  from patients_with_exclusions\n  inner join denominator\n      on patients_with_exclusions.person_id = denominator.person_id\n\n)\n\n, add_data_types as (\n\n    select\n        distinct\n          cast(person_id as TEXT) as person_id\n        , cast(exclusion_date as date) as exclusion_date\n        , cast(exclusion_reason as TEXT) as exclusion_reason\n        , cast(1 as integer) as exclusion_flag\n    from valid_exclusions\n\n)\n\nselect\n      person_id\n    , exclusion_date\n    , exclusion_reason\n    , exclusion_flag\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.quality_measures._int_nqf0420_exclusions"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.859600Z", "completed_at": "2025-02-25T21:26:31.886055Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:31.889673Z", "completed_at": "2025-02-25T21:26:31.889678Z"}], "thread_id": "Thread-2", "execution_time": 0.0532679557800293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.quality_measures__int_nqf0420_numerator", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte___stg_procedure as (\n\nselect\n      person_id\n    , encounter_id\n    , procedure_date\n    , source_code_type\n    , source_code\n    , normalized_code_type\n    , normalized_code\n    , modifier_1\n    , modifier_2\n    , modifier_3\n    , modifier_4\n    , modifier_5\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.procedure\n),  __dbt__cte___stg_medical_claim as (\n\n\nselect\n      person_id\n    , claim_id\n    , claim_start_date\n    , claim_end_date\n    , place_of_service_code\n    , hcpcs_code\n    , hcpcs_modifier_1\n    , hcpcs_modifier_2\n    , hcpcs_modifier_3\n    , hcpcs_modifier_4\n    , hcpcs_modifier_5\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.medical_claim\n\n\n), denominator as (\n\n    select \n          person_id\n        , performance_period_begin\n        , performance_period_end\n        , measure_id\n        , measure_name\n        , measure_version\n    from tuva.quality_measures._int_nqf0420_denominator\n\n)\n\n, pain_assessment_code as (\n\n    select\n          code\n        , code_system\n        , concept_name\n    from tuva.quality_measures._value_set_codes\n    where lower(concept_name) in (\n          'pain assessment documented'\n    )\n\n)\n\n, procedures as (\n\n    select\n        person_id\n      , procedure_date\n      , coalesce (\n              normalized_code_type\n            , case\n                when lower(source_code_type) = 'cpt' then 'hcpcs'\n                when lower(source_code_type) = 'snomed' then 'snomed-ct'\n                else lower(source_code_type)\n              end\n          ) as code_type\n        , coalesce (\n              normalized_code\n            , source_code\n          ) as code\n    from __dbt__cte___stg_procedure\n\n)\n\n, pain_assessment_procedures as (\n\n    select \n          procedures.person_id\n        , procedures.procedure_date as evidence_date\n    from procedures\n    inner join pain_assessment_code\n        on procedures.code = pain_assessment_code.code\n            and procedures.code_type = pain_assessment_code.code_system\n\n)\n\n, pain_assessment_claims as (\n\n    select\n          person_id\n        , coalesce(claim_end_date, claim_start_date) as evidence_date\n    from __dbt__cte___stg_medical_claim medical_claim\n    inner join pain_assessment_code\n        on medical_claim.hcpcs_code = pain_assessment_code.code\n            and lower(pain_assessment_code.code_system) = 'hcpcs'\n\n)\n\n, time_unbounded_qualifying_patients as (\n\n    select\n          person_id\n        , evidence_date\n    from pain_assessment_procedures\n    \n    union all\n\n    select\n          person_id\n        , evidence_date\n    from pain_assessment_claims\n\n)\n\n, qualifying_patients_with_denominator as (\n\n    select \n          time_unbounded_qualifying_patients.person_id\n        , time_unbounded_qualifying_patients.evidence_date\n        , denominator.performance_period_begin\n        , denominator.performance_period_end\n        , denominator.measure_id\n        , denominator.measure_name\n        , denominator.measure_version\n        , 1 as numerator_flag\n    from time_unbounded_qualifying_patients\n    inner join denominator\n        on time_unbounded_qualifying_patients.person_id = denominator.person_id\n            and time_unbounded_qualifying_patients.evidence_date between\n                denominator.performance_period_begin and denominator.performance_period_end\n\n)\n\n, add_data_types as (\n\n     select distinct\n          cast(person_id as TEXT) as person_id\n        , cast(performance_period_begin as date) as performance_period_begin\n        , cast(performance_period_end as date) as performance_period_end\n        , cast(measure_id as TEXT) as measure_id\n        , cast(measure_name as TEXT) as measure_name\n        , cast(measure_version as TEXT) as measure_version\n        , cast(evidence_date as date) as evidence_date\n        , cast(null as TEXT) as evidence_value\n        , cast(numerator_flag as integer) as numerator_flag\n      from qualifying_patients_with_denominator\n\n)\n\nselect\n      person_id\n    , performance_period_begin\n    , performance_period_end\n    , measure_id\n    , measure_name\n    , measure_version\n    , evidence_date\n    , evidence_value\n    , numerator_flag\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.quality_measures._int_nqf0420_numerator"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.882988Z", "completed_at": "2025-02-25T21:26:31.890575Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:31.891531Z", "completed_at": "2025-02-25T21:26:31.891534Z"}], "thread_id": "Thread-1", "execution_time": 0.009855985641479492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ahrq_measures__int_pqi_01_exclusions", "compiled": true, "compiled_code": "\n\nselect\n    encounter_id\n  , data_source\n  , exclusion_reason\n  , row_number() over (\n      partition by encounter_id, data_source \n      order by exclusion_reason\n    ) as exclusion_number\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._int_pqi_shared_exclusion_union", "relation_name": "tuva.ahrq_measures._int_pqi_01_exclusions"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.886643Z", "completed_at": "2025-02-25T21:26:31.891125Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:31.892044Z", "completed_at": "2025-02-25T21:26:31.892048Z"}], "thread_id": "Thread-4", "execution_time": 0.010013818740844727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ahrq_measures__int_pqi_03_exclusions", "compiled": true, "compiled_code": "\n\nselect\n    encounter_id\n  , data_source\n  , exclusion_reason\n  , row_number() over (\n      partition by encounter_id, data_source \n      order by exclusion_reason\n    ) as exclusion_number\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._int_pqi_shared_exclusion_union", "relation_name": "tuva.ahrq_measures._int_pqi_03_exclusions"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.892770Z", "completed_at": "2025-02-25T21:26:31.920036Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:31.930837Z", "completed_at": "2025-02-25T21:26:31.930847Z"}], "thread_id": "Thread-3", "execution_time": 0.040158987045288086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ahrq_measures__int_pqi_05_exclusions", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte___stg_pqi_condition as (\n\n\nselect \n    normalized_code_type\n  , normalized_code\n  , encounter_id\n  , data_source\nfrom \n    tuva.core.condition\n), resp_an as (\n    select distinct\n        encounter_id\n      , data_source\n      , 'cystic fibrosis' as exclusion_reason\n    from __dbt__cte___stg_pqi_condition as c\n    inner join tuva.ahrq_measures._value_set_pqi as pqi\n      on c.normalized_code = pqi.code\n      and c.normalized_code_type = 'icd-10-cm'\n      and pqi.value_set_name = 'cystic_fibrosis_and_anomalies_of_the_respiratory_system'\n      and pqi_number = '05'\n    where c.encounter_id is not null\n),\n\nunion_cte as (\n    select\n        encounter_id\n      , data_source\n      , exclusion_reason\n    from tuva.ahrq_measures._int_pqi_shared_exclusion_union\n\n    union all\n\n    select\n        encounter_id\n      , data_source\n      , exclusion_reason\n    from resp_an\n)\n\nselect\n    encounter_id\n  , data_source\n  , exclusion_reason\n  , row_number() over (\n      partition by encounter_id, data_source \n      order by exclusion_reason\n    ) as exclusion_number\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom union_cte", "relation_name": "tuva.ahrq_measures._int_pqi_05_exclusions"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.901872Z", "completed_at": "2025-02-25T21:26:31.926903Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:31.951324Z", "completed_at": "2025-02-25T21:26:31.951334Z"}], "thread_id": "Thread-2", "execution_time": 0.0601801872253418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ahrq_measures__int_pqi_07_exclusions", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte___stg_pqi_procedure as (\n\n\nselect \n    normalized_code_type\n  , normalized_code\n  , encounter_id\n  , data_source\nfrom \n    tuva.core.procedure\n),  __dbt__cte___stg_pqi_condition as (\n\n\nselect \n    normalized_code_type\n  , normalized_code\n  , encounter_id\n  , data_source\nfrom \n    tuva.core.condition\n), cardiac as (\n    select distinct\n        encounter_id\n      , data_source\n      , 'cardiac procedure' as exclusion_reason\n    from __dbt__cte___stg_pqi_procedure as c\n    inner join tuva.ahrq_measures._value_set_pqi as pqi \n      on c.normalized_code = pqi.code\n      and c.normalized_code_type = 'icd-10-pcs'\n      and pqi.value_set_name = 'cardiac_procedure_codes'\n      and pqi_number = 'appendix_b'\n    where c.encounter_id is not null\n),\n\nckd as (\n    select distinct\n        encounter_id\n      , data_source\n    from __dbt__cte___stg_pqi_condition as c\n    inner join tuva.ahrq_measures._value_set_pqi as pqi \n      on c.normalized_code = pqi.code\n      and c.normalized_code_type = 'icd-10-cm'\n      and pqi.value_set_name = 'exclusion_kidney_disease_diagnosis_codes'\n      and pqi_number = '07'\n    where c.encounter_id is not null\n),\n\naccess as (\n    select distinct\n        encounter_id\n      , data_source\n    from __dbt__cte___stg_pqi_procedure as c\n    inner join tuva.ahrq_measures._value_set_pqi as pqi \n      on c.normalized_code = pqi.code\n      and c.normalized_code_type = 'icd-10-pcs'\n      and pqi.value_set_name = 'exclusion_dialysis_access_procedure_codes'\n      and pqi.pqi_number = '07'\n    where c.encounter_id is not null\n),\n\ncombine as (\n    select\n        c.encounter_id\n      , c.data_source\n      , 'ckd' as exclusion_reason\n    from __dbt__cte___stg_pqi_condition as c\n    inner join ckd \n      on c.encounter_id = ckd.encounter_id\n      and c.data_source = ckd.data_source\n    inner join access as a \n      on c.encounter_id = a.encounter_id\n      and c.data_source = a.data_source\n),\n\nunion_cte as (\n    select\n        encounter_id\n      , data_source\n      , exclusion_reason\n    from tuva.ahrq_measures._int_pqi_shared_exclusion_union\n    \n    union all\n    \n    select\n        encounter_id\n      , data_source\n      , exclusion_reason\n    from cardiac\n    \n    union all\n    \n    select\n        encounter_id\n      , data_source\n      , exclusion_reason\n    from combine\n)\n\nselect\n    encounter_id\n  , data_source\n  , exclusion_reason\n  , row_number() over (\n      partition by encounter_id, data_source \n      order by exclusion_reason\n    ) as exclusion_number\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom union_cte", "relation_name": "tuva.ahrq_measures._int_pqi_07_exclusions"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.920637Z", "completed_at": "2025-02-25T21:26:31.953115Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:31.954507Z", "completed_at": "2025-02-25T21:26:31.954515Z"}], "thread_id": "Thread-1", "execution_time": 0.04016995429992676, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ahrq_measures__int_pqi_08_exclusions", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte___stg_pqi_procedure as (\n\n\nselect \n    normalized_code_type\n  , normalized_code\n  , encounter_id\n  , data_source\nfrom \n    tuva.core.procedure\n), cardiac as (\n    select distinct\n        encounter_id\n      , data_source\n      , 'cardiac procedure' as exclusion_reason\n    from __dbt__cte___stg_pqi_procedure as c\n    inner join tuva.ahrq_measures._value_set_pqi as pqi \n      on c.normalized_code = pqi.code\n      and c.normalized_code_type = 'icd-10-pcs'\n      and pqi.value_set_name = 'cardiac_procedure_codes'\n      and pqi.pqi_number = 'appendix_b'\n    where c.encounter_id is not null\n),\n\nunion_cte as (\n    select\n        encounter_id\n      , data_source\n      , exclusion_reason\n    from tuva.ahrq_measures._int_pqi_shared_exclusion_union\n\n    union all\n\n    select\n        encounter_id\n      , data_source\n      , exclusion_reason\n    from cardiac\n)\n\nselect\n    encounter_id\n  , data_source\n  , exclusion_reason\n  , row_number() over (\n      partition by encounter_id, data_source \n      order by exclusion_reason\n    ) as exclusion_number\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom union_cte", "relation_name": "tuva.ahrq_measures._int_pqi_08_exclusions"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.931420Z", "completed_at": "2025-02-25T21:26:31.954273Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:31.955506Z", "completed_at": "2025-02-25T21:26:31.955513Z"}], "thread_id": "Thread-4", "execution_time": 0.036609649658203125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ahrq_measures__int_pqi_11_exclusions", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte___stg_pqi_condition as (\n\n\nselect \n    normalized_code_type\n  , normalized_code\n  , encounter_id\n  , data_source\nfrom \n    tuva.core.condition\n),  __dbt__cte___stg_pqi_procedure as (\n\n\nselect \n    normalized_code_type\n  , normalized_code\n  , encounter_id\n  , data_source\nfrom \n    tuva.core.procedure\n), sickle_cell as (\n    select distinct\n        encounter_id\n      , data_source\n      , 'sickle cell' as exclusion_reason\n    from __dbt__cte___stg_pqi_condition as c\n    inner join tuva.ahrq_measures._value_set_pqi as pqi \n      on c.normalized_code = pqi.code\n      and c.normalized_code_type = 'icd-10-cm'\n      and pqi.value_set_name = 'sickle_cell_anemia_or_hb-s_disease_diagnosis_codes'\n      and pqi.pqi_number = '11'\n    where c.encounter_id is not null\n),\n\nimmune_dx as (\n    select distinct\n        encounter_id\n      , data_source\n      , 'immunocompromised diagnosis' as exclusion_reason\n    from __dbt__cte___stg_pqi_condition as c\n    inner join tuva.ahrq_measures._value_set_pqi as pqi \n      on c.normalized_code = pqi.code\n      and c.normalized_code_type = 'icd-10-cm'\n      and pqi.value_set_name = 'immunocompromised_state_diagnosis_codes'\n      and pqi.pqi_number = 'appendix_c'\n    where c.encounter_id is not null\n),\n\nimmune_px as (\n    select distinct\n        encounter_id\n      , data_source\n      , 'immunocompromised procedure' as exclusion_reason\n    from __dbt__cte___stg_pqi_procedure as c\n    inner join tuva.ahrq_measures._value_set_pqi as pqi \n      on c.normalized_code = pqi.code\n      and c.normalized_code_type = 'icd-10-pcs'\n      and pqi.value_set_name = 'immunocompromised_state_procedure_codes'\n      and pqi.pqi_number = 'appendix_c'\n    where c.encounter_id is not null\n),\n\nunion_cte as (\n    select\n        encounter_id\n      , data_source\n      , exclusion_reason\n    from tuva.ahrq_measures._int_pqi_shared_exclusion_union\n\n    union all\n\n    select\n        encounter_id\n      , data_source\n      , exclusion_reason\n    from sickle_cell\n\n    union all\n\n    select\n        encounter_id\n      , data_source\n      , exclusion_reason\n    from immune_dx\n\n    union all\n\n    select\n        encounter_id\n      , data_source\n      , exclusion_reason\n    from immune_px\n)\n\nselect\n    encounter_id\n  , data_source\n  , exclusion_reason\n  , row_number() over (\n      partition by encounter_id, data_source \n      order by exclusion_reason\n    ) as exclusion_number\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom union_cte", "relation_name": "tuva.ahrq_measures._int_pqi_11_exclusions"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.974273Z", "completed_at": "2025-02-25T21:26:31.980208Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:31.990607Z", "completed_at": "2025-02-25T21:26:31.990616Z"}], "thread_id": "Thread-2", "execution_time": 0.0367128849029541, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ahrq_measures__int_pqi_14_exclusions", "compiled": true, "compiled_code": "\n\nselect\n    encounter_id\n  , data_source\n  , exclusion_reason\n  , row_number() over (\n      partition by encounter_id, data_source \n      order by exclusion_reason\n    ) as exclusion_number\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._int_pqi_shared_exclusion_union", "relation_name": "tuva.ahrq_measures._int_pqi_14_exclusions"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.956171Z", "completed_at": "2025-02-25T21:26:31.980687Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:32.006654Z", "completed_at": "2025-02-25T21:26:32.006663Z"}], "thread_id": "Thread-3", "execution_time": 0.053112030029296875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ahrq_measures__int_pqi_12_exclusions", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte___stg_pqi_condition as (\n\n\nselect \n    normalized_code_type\n  , normalized_code\n  , encounter_id\n  , data_source\nfrom \n    tuva.core.condition\n),  __dbt__cte___stg_pqi_procedure as (\n\n\nselect \n    normalized_code_type\n  , normalized_code\n  , encounter_id\n  , data_source\nfrom \n    tuva.core.procedure\n), kidney as (\n    select distinct\n        encounter_id\n      , data_source\n      , 'kidney' as exclusion_reason\n    from __dbt__cte___stg_pqi_condition as c\n    inner join tuva.ahrq_measures._value_set_pqi as pqi \n      on c.normalized_code = pqi.code\n      and c.normalized_code_type = 'icd-10-cm'\n      and pqi.value_set_name = 'kidney_or_urinary_tract_disorder_diagnosis_codes'\n      and pqi.pqi_number = '12'\n    where c.encounter_id is not null\n),\n\nimmune_dx as (\n    select distinct\n        encounter_id\n      , data_source\n      , 'immunocompromised diagnosis' as exclusion_reason\n    from __dbt__cte___stg_pqi_condition as c\n    inner join tuva.ahrq_measures._value_set_pqi as pqi \n      on c.normalized_code = pqi.code\n      and c.normalized_code_type = 'icd-10-cm'\n      and pqi.value_set_name = 'immunocompromised_state_diagnosis_codes'\n      and pqi.pqi_number = 'appendix_c'\n    where c.encounter_id is not null\n),\n\nimmune_px as (\n    select distinct\n        encounter_id\n      , data_source\n      , 'immunocompromised procedure' as exclusion_reason\n    from __dbt__cte___stg_pqi_procedure as c\n    inner join tuva.ahrq_measures._value_set_pqi as pqi \n      on c.normalized_code = pqi.code\n      and c.normalized_code_type = 'icd-10-pcs'\n      and pqi.value_set_name = 'immunocompromised_state_procedure_codes'\n      and pqi.pqi_number = 'appendix_c'\n    where c.encounter_id is not null\n),\n\nunion_cte as (\n    select\n        encounter_id\n      , data_source\n      , exclusion_reason\n    from tuva.ahrq_measures._int_pqi_shared_exclusion_union\n\n    union all\n\n    select\n        encounter_id\n      , data_source\n      , exclusion_reason\n    from kidney\n\n    union all\n\n    select\n        encounter_id\n      , data_source\n      , exclusion_reason\n    from immune_dx\n\n    union all\n\n    select\n        encounter_id\n      , data_source\n      , exclusion_reason\n    from immune_px\n)\n\nselect\n    encounter_id\n  , data_source\n  , exclusion_reason\n  , row_number() over (\n      partition by encounter_id, data_source \n      order by exclusion_reason\n    ) as exclusion_number\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom union_cte", "relation_name": "tuva.ahrq_measures._int_pqi_12_exclusions"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.980914Z", "completed_at": "2025-02-25T21:26:32.008021Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:32.009858Z", "completed_at": "2025-02-25T21:26:32.009863Z"}], "thread_id": "Thread-1", "execution_time": 0.030931949615478516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ahrq_measures__int_pqi_15_exclusions", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte___stg_pqi_condition as (\n\n\nselect \n    normalized_code_type\n  , normalized_code\n  , encounter_id\n  , data_source\nfrom \n    tuva.core.condition\n), resp_an as (\n    select distinct\n        encounter_id\n      , data_source\n      , 'cystic fibrosis' as exclusion_reason\n    from __dbt__cte___stg_pqi_condition as c\n    inner join tuva.ahrq_measures._value_set_pqi as pqi \n      on c.normalized_code = pqi.code\n      and c.normalized_code_type = 'icd-10-cm'\n      and pqi.value_set_name = 'cystic_fibrosis_and_anomalies_of_the_respiratory_system_diagnosis_codes'\n      and pqi.pqi_number = '15'\n    where c.encounter_id is not null\n),\n\nunion_cte as (\n    select\n        encounter_id\n      , data_source\n      , exclusion_reason\n    from tuva.ahrq_measures._int_pqi_shared_exclusion_union\n\n    union all\n\n    select\n        encounter_id\n      , data_source\n      , exclusion_reason\n    from resp_an\n)\n\nselect\n    encounter_id\n  , data_source\n  , exclusion_reason\n  , row_number() over (\n      partition by encounter_id, data_source \n      order by exclusion_reason\n    ) as exclusion_number\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom union_cte", "relation_name": "tuva.ahrq_measures._int_pqi_15_exclusions"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:31.991179Z", "completed_at": "2025-02-25T21:26:32.009526Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:32.010804Z", "completed_at": "2025-02-25T21:26:32.010808Z"}], "thread_id": "Thread-4", "execution_time": 0.03126096725463867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ahrq_measures__int_pqi_16_exclusions", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte___stg_pqi_condition as (\n\n\nselect \n    normalized_code_type\n  , normalized_code\n  , encounter_id\n  , data_source\nfrom \n    tuva.core.condition\n), amputation as (\n    select distinct\n        encounter_id\n      , data_source\n      , 'amputation' as exclusion_reason\n    from __dbt__cte___stg_pqi_condition as c\n    inner join tuva.ahrq_measures._value_set_pqi as pqi \n      on c.normalized_code = pqi.code\n      and c.normalized_code_type = 'icd-10-cm'\n      and pqi.value_set_name = 'traumatic_amputation_of_the_lower_extremity_diagnosis_codes'\n      and pqi.pqi_number = '16'\n    where c.encounter_id is not null\n),\n\npregnancy as (\n    select distinct\n        encounter_id\n      , data_source\n      , 'pregnancy' as exclusion_reason\n    from __dbt__cte___stg_pqi_condition as c\n    inner join tuva.ahrq_measures._value_set_pqi as pqi \n      on c.normalized_code = pqi.code\n      and c.normalized_code_type = 'icd-10-cm'\n      and pqi.value_set_name = 'mdc_14_principal_diagnosis_codes'\n      and pqi.pqi_number = 'appendix_f'\n    where c.encounter_id is not null\n),\n\nunion_cte as (\n    select\n        encounter_id\n      , data_source\n      , exclusion_reason\n    from tuva.ahrq_measures._int_pqi_shared_exclusion_union\n\n    union all\n\n    select\n        encounter_id\n      , data_source\n      , exclusion_reason\n    from amputation\n\n    union all\n\n    select\n        encounter_id\n      , data_source\n      , exclusion_reason\n    from pregnancy\n)\n\nselect\n    encounter_id\n  , data_source\n  , exclusion_reason\n  , row_number() over (\n      partition by encounter_id, data_source \n      order by exclusion_reason\n    ) as exclusion_number\n   , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom union_cte", "relation_name": "tuva.ahrq_measures._int_pqi_16_exclusions"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:32.011758Z", "completed_at": "2025-02-25T21:26:32.034798Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:32.041925Z", "completed_at": "2025-02-25T21:26:32.041933Z"}], "thread_id": "Thread-2", "execution_time": 0.03281998634338379, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ed_classification__summary", "compiled": true, "compiled_code": "\n\n\nwith __dbt__cte__ed_classification__stg_patient as (\n\n\nselect\n    person_id\n    , sex\n    , birth_date\n    , race\n    , state\n    , zip_code\n    , latitude\n    , longitude\nfrom tuva.core.patient\n) select\n    class.encounter_id\n    , cat.classification_name as ed_classification_description\n    , cat.classification_order as ed_classification_order\n    , class.person_id\n    , class.encounter_end_date\n    , date_part('year', class.encounter_end_date) || \n\n    case when 2 = 0\n        then ''\n    else\n        right(\n            '00' || date_part('month', class.encounter_end_date),\n            2\n        )\n    end as year_month\n    , class.primary_diagnosis_code\n    , class.primary_diagnosis_description\n    , class.paid_amount\n    , class.allowed_amount\n    , class.charge_amount\n    , class.facility_id\n    , fac_prov.provider_organization_name as facility_name\n    , practice_state as facility_state\n    , practice_city as facility_city\n    , practice_zip_code as facility_zip_code\n    , pat.sex as patient_sex\n    , floor(datediff(\n        hour,\n        pat.birth_date,\n        class.encounter_end_date\n        ) / 8766.0) as patient_age\n    , zip_code as patient_zip_code\n    , latitude as patient_latitude\n    , longitude as patient_longitude\n    , race as patient_race\nfrom tuva.ed_classification._int_filter_encounter_with_classification class\ninner join tuva.ed_classification._value_set_categories cat\n    on class.classification = cat.classification\nleft join tuva.terminology.provider fac_prov \n    on class.facility_id = fac_prov.npi\nleft join __dbt__cte__ed_classification__stg_patient pat\n    on class.person_id = pat.person_id", "relation_name": "tuva.ed_classification.summary"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:32.027054Z", "completed_at": "2025-02-25T21:26:32.048152Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:32.049168Z", "completed_at": "2025-02-25T21:26:32.049176Z"}], "thread_id": "Thread-3", "execution_time": 0.03915596008300781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.quality_measures__int_cqm130_long", "compiled": true, "compiled_code": "\n\nwith denominator as (\n\n    select\n          person_id\n        , performance_period_begin\n        , performance_period_end\n        , measure_id\n        , measure_name\n        , measure_version\n        , denominator_flag\n    from tuva.quality_measures._int_cqm130_denominator\n\n)\n\n, numerator as (\n\n    select\n          person_id\n        , evidence_date\n        , evidence_value\n    from tuva.quality_measures._int_cqm130_numerator\n\n)\n\n, exclusions as (\n\n    select\n          person_id\n        , exclusion_date\n        , exclusion_reason\n    from tuva.quality_measures._int_cqm130_exclusions\n\n)\n\n, measure_flags as (\n\n    select\n          denominator.person_id\n        , case\n            when denominator.person_id is not null\n            then 1\n            else null\n          end as denominator_flag\n        , case\n            when numerator.person_id is not null and denominator.person_id is not null\n            then 1\n            when denominator.person_id is not null\n            then 0\n            else null\n          end as numerator_flag\n        , case\n            when exclusions.person_id is not null and denominator.person_id is not null\n            then 1\n            when denominator.person_id is not null\n            then 0\n            else null\n          end as exclusion_flag\n        , numerator.evidence_date\n        , numerator.evidence_value\n        , exclusions.exclusion_date\n        , exclusions.exclusion_reason\n        , denominator.performance_period_begin\n        , denominator.performance_period_end\n        , denominator.measure_id\n        , denominator.measure_name\n        , denominator.measure_version\n        , (row_number() over(\n            partition by\n                  denominator.person_id\n                , denominator.performance_period_begin\n                , denominator.performance_period_end\n                , denominator.measure_id\n                , denominator.measure_name\n              order by\n                  case when numerator.evidence_date is null then 1 else 0 end,\n                  numerator.evidence_date desc\n                , case when exclusions.exclusion_date is null then 1 else 0 end,\n                  exclusions.exclusion_date desc\n          )) as rn\n    from denominator\n        left join numerator\n            on denominator.person_id = numerator.person_id\n        left join exclusions\n            on denominator.person_id = exclusions.person_id\n\n)\n\n/*\n    Deduplicate measure rows by latest evidence date or exclusion date\n*/\n, deduped as (\n\n    select\n          person_id\n        , denominator_flag\n        , numerator_flag\n        , exclusion_flag\n        , evidence_date\n        , evidence_value\n        , exclusion_date\n        , exclusion_reason\n        , performance_period_begin\n        , performance_period_end\n        , measure_id\n        , measure_name\n        , measure_version\n    from measure_flags\n    where rn = 1\n\n)\n\n, add_data_types as (\n\n    select\n          cast(person_id as TEXT) as person_id\n        , cast(denominator_flag as integer) as denominator_flag\n        , cast(numerator_flag as integer) as numerator_flag\n        , cast(exclusion_flag as integer) as exclusion_flag\n        , cast(evidence_date as date) as evidence_date\n        , cast(evidence_value as TEXT) as evidence_value\n        , cast(exclusion_date as date) as exclusion_date\n        , cast(exclusion_reason as TEXT) as exclusion_reason\n        , cast(performance_period_begin as date) as performance_period_begin\n        , cast(performance_period_end as date) as performance_period_end\n        , cast(measure_id as TEXT) as measure_id\n        , cast(measure_name as TEXT) as measure_name\n        , cast(measure_version as TEXT) as measure_version\n    from deduped\n\n)\n\nselect\n      person_id\n    , denominator_flag\n    , numerator_flag\n    , exclusion_flag\n    , evidence_date\n    , evidence_value\n    , exclusion_date\n    , exclusion_reason\n    , performance_period_begin\n    , performance_period_end\n    , measure_id\n    , measure_name\n    , measure_version\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.quality_measures._int_cqm130_long"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:32.035487Z", "completed_at": "2025-02-25T21:26:32.050864Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:32.051913Z", "completed_at": "2025-02-25T21:26:32.051920Z"}], "thread_id": "Thread-1", "execution_time": 0.025411128997802734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.readmissions__readmission_crude", "compiled": true, "compiled_code": "\n\n-- Here we calculate readmissions using all encounters\n-- that have valid admit and discharge dates and no overlap.\n-- This is meant to give a crude sense of the readmission\n-- rate without taking into account all the CMS HWR logic.\n\n\nwith encounter_info as (\nselect\n    enc.encounter_id,\n    enc.person_id,\n    enc.admit_date,\n    enc.discharge_date\nfrom tuva.readmissions._int_encounter enc\nleft join tuva.readmissions._int_encounter_overlap over_a\n    on enc.encounter_id = over_a.encounter_id_A\nleft join tuva.readmissions._int_encounter_overlap over_b\n    on enc.encounter_id = over_b.encounter_id_B\nwhere\n    admit_date is not null\n    and\n    discharge_date is not null\n    and\n    admit_date <= discharge_date\nand over_a.encounter_id_A is null and over_b.encounter_id_B is null\n    ),\n\n\nencounter_sequence as (\nselect\n    encounter_id,\n    person_id,\n    admit_date,\n    discharge_date,\n    row_number() over(\n        partition by person_id order by admit_date, discharge_date\n    ) as encounter_seq\nfrom encounter_info\n),\n\n\nreadmission_calc as (\nselect\n    aa.encounter_id,\n    aa.person_id,\n    aa.admit_date,\n    aa.discharge_date,\n    case\n        when bb.encounter_id is not null then 1\n\telse 0\n    end as had_readmission_flag,\n    datediff(\n        day,\n        bb.admit_date,\n        aa.discharge_date\n        ) as days_to_readmit,\n    case\n        when (datediff(\n        day,\n        bb.admit_date,\n        aa.discharge_date\n        )) <= 30  then 1\n\telse 0\n    end as readmit_30_flag\nfrom encounter_sequence aa left join encounter_sequence bb\n     on aa.person_id = bb.person_id\n     and aa.encounter_seq + 1 = bb.encounter_seq\n)\n\n\n\nselect *, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom readmission_calc", "relation_name": "tuva.readmissions._int_readmission_crude"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:32.042525Z", "completed_at": "2025-02-25T21:26:32.051383Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:32.052772Z", "completed_at": "2025-02-25T21:26:32.052783Z"}], "thread_id": "Thread-4", "execution_time": 0.019212007522583008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.readmissions__encounter_data_quality", "compiled": true, "compiled_code": "\n\n-- Here we list all encounters from the stg_encounter table\n-- with data quality flags that may disqualify them from\n-- being used for readmission measures \n\n\n-- Flag several potential data quality issues\n-- with all encounters.\n-- Every encounter_id from the stg_encounter model\n-- will be here. This CTE should have the same\n-- number of rows as the stg_encounter model, i.e.,\n-- there is a one to one correspondence between the\n-- rows in stg_encounter and this CTE.\nwith encounter_data_quality_issues as (\nselect\n    aa.encounter_id,\n    case\n        when aa.admit_date is null then 1\n\telse 0\n    end as missing_admit_date_flag,\n    case\n        when aa.discharge_date is null then 1\n\telse 0\n    end as missing_discharge_date_flag,\n    case\n        when aa.admit_date > aa.discharge_date then 1\n\telse 0\n    end as admit_after_discharge_flag,\n    case\n        when aa.discharge_disposition_code is null then 1\n\telse 0\n    end as missing_discharge_disposition_code_flag,\n    case\n        when\n\t    (aa.discharge_disposition_code is not null)\n\t    and\n\t    (bb.discharge_disposition_code is null) then 1\n\telse 0\n    end as invalid_discharge_disposition_code_flag,\n    case\n      when aa.primary_diagnosis_code is null then 1\n      else 0\n    end as missing_primary_diagnosis_flag,\n    case\n        when aa.valid_primary_diagnosis_code_flag = 0 then 1\n\telse 0\n    end as invalid_primary_diagnosis_code_flag,\n    case\n        when aa.ccs_diagnosis_category is null  then 1\n\telse 0\n    end as no_diagnosis_ccs_flag,\n    aa.ccs_diagnosis_category as diagnosis_ccs,\n    case\n        when aa.encounter_id in (select distinct encounter_id_A\n\t                         from tuva.readmissions._int_encounter_overlap )\n\t     or\n\t     aa.encounter_id in (select distinct encounter_id_B\n\t                         from tuva.readmissions._int_encounter_overlap )\n\tthen 1\n\telse 0\n    end as overlaps_with_another_encounter_flag,\n    case\n        when aa.drg_code is null then 1\n\telse 0\n    end as missing_drg_flag,\n    case\n        when coalesce(cc.ms_drg_code,dd.apr_drg_code) is null then 1\n\telse 0\n    end as invalid_drg_flag\n\nfrom tuva.readmissions._int_encounter_with_ccs aa\n     left join tuva.terminology.discharge_disposition bb\n     on aa.discharge_disposition_code = bb.discharge_disposition_code\n     left join tuva.terminology.ms_drg cc\n     on aa.drg_code = cc.ms_drg_code\n     and aa.drg_code_type = 'ms-drg'\n     left join tuva.terminology.apr_drg dd\n     on aa.drg_code = dd.apr_drg_code\n     and aa.drg_code_type = 'apr-drg'\n),\n\n\n-- Here we add a disqualified_encounter_flag.\n-- This disqualified_encounter_flag = 1\n-- when any of the critical data quality flags\n-- from the above CTE are equal to 1.\nall_data_quality_flags as (\nselect\n    encounter_id,\n    diagnosis_ccs,\n    case\n        when\n\t    (missing_admit_date_flag = 1)\n\t    or\n\t    (missing_discharge_date_flag = 1)\n\t    or\n\t    (admit_after_discharge_flag = 1)\n\t    or\n\t    (missing_discharge_disposition_code_flag = 1)\n\t    or\n\t    (invalid_discharge_disposition_code_flag = 1)\n\t    or\n\t    (missing_primary_diagnosis_flag = 1)\n\t    or\n\t    (invalid_primary_diagnosis_code_flag = 1)\n\t    or\n\t    (no_diagnosis_ccs_flag = 1)\n\t    or\n\t    (overlaps_with_another_encounter_flag = 1)\n\t    or\n\t    (missing_drg_flag = 1)\n\t    or\n\t    (invalid_drg_flag = 1)\n\t    then 1\n\telse 0\n    end as disqualified_encounter_flag,\n    missing_admit_date_flag,\n    missing_discharge_date_flag,\n    admit_after_discharge_flag,\n    missing_discharge_disposition_code_flag,\n    invalid_discharge_disposition_code_flag,\n    missing_primary_diagnosis_flag,\n    invalid_primary_diagnosis_code_flag,\n    no_diagnosis_ccs_flag,\n    overlaps_with_another_encounter_flag,\n    missing_drg_flag,\n    invalid_drg_flag\nfrom encounter_data_quality_issues\n)    \n\n\n\nselect *, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom all_data_quality_flags", "relation_name": "tuva.readmissions._int_encounter_data_quality"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:32.053293Z", "completed_at": "2025-02-25T21:26:32.065419Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:32.076475Z", "completed_at": "2025-02-25T21:26:32.076486Z"}], "thread_id": "Thread-2", "execution_time": 0.02606797218322754, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.readmissions__encounter_specialty_cohort", "compiled": true, "compiled_code": "\n\n-- Here we list the specialty cohort for each encounter that has\n-- an associated specialty cohort.\n-- There are 5 possible specialty cohorts:\n--      [1] Medicine\n--      [2] Surgery/Gynecology\n--      [3] Cardiology\n--      [4] Cardiovascular\n--      [5] Neurology\n-- An encounter that has an ICD-10-PCS procedure code or a\n-- CCS procedure category that corresponds to the\n-- 'Surgery/Gynecology' cohort will always be in that cohort.\n-- For encounters that are not in the 'Surgery/Gynecology' cohort,\n-- we then check to see if they are in one of the other 4 cohorts.\n\n--ranking to eventually assign a cohort to encounters in multiple cohorts\nwith cohort_ranks as (\n    select 'Surgery/Gynecology' as cohort, 1 as c_rank\n    union all\n    select 'Cardiorespiratory' as cohort, 2 as c_rank\n    union all\n    select 'Cardiovascular' as cohort, 3 as c_rank\n    union all\n    select 'Neurology' as cohort, 4 as c_rank\n    union all\n    select 'Medicine' as cohort, 5 as c_rank\n)\n\n\n--get all encounter ids in any procedure or diagnosis based cohorts\n, all_encounter_cohorts as (\n\n    --encounter ids in procedure based cohorts\n        select procs.encounter_id, 1 as c_rank\n        from tuva.readmissions._int_procedure_ccs procs\n        left join tuva.readmissions._value_set_surgery_gynecology_cohort sgc\n            on procs.procedure_code = sgc.icd_10_pcs\n        left join tuva.readmissions._value_set_specialty_cohort sgsc\n            on procs.ccs_procedure_category = sgsc.ccs and sgsc.specialty_cohort = 'Surgery/Gynecology'\n        where sgc.icd_10_pcs is not null or sgsc.ccs is not null\n\n    union all\n\n    --encounter ids in diagnosis based cohorts\n    select diag.encounter_id, cohort_ranks.c_rank\n    from tuva.readmissions._int_encounter_with_ccs diag\n    inner join tuva.readmissions._value_set_specialty_cohort sc\n        on diag.ccs_diagnosis_category = sc.ccs and sc.procedure_or_diagnosis = 'Diagnosis'\n    inner join cohort_ranks\n        on sc.specialty_cohort = cohort_ranks.cohort\n)\n\n\n-- getting one cohort per encounter\n, main_encounter_cohort as (\n    select encounter_id, min(c_rank) as main_c_rank\n    from all_encounter_cohorts\n    group by encounter_id\n\n)\n\n\n--getting all encounters, with labeled cohorts, if no cohort cohort is \"medicine\"\nselect enc.encounter_id, coalesce(cohort_ranks.cohort, 'Medicine') as specialty_cohort, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.readmissions._int_encounter enc\nleft join main_encounter_cohort mec\n    on enc.encounter_id = mec.encounter_id\nleft join cohort_ranks\n    on mec.main_c_rank = cohort_ranks.c_rank", "relation_name": "tuva.readmissions._int_encounter_specialty_cohort"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:32.060222Z", "completed_at": "2025-02-25T21:26:32.076987Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:32.085052Z", "completed_at": "2025-02-25T21:26:32.085066Z"}], "thread_id": "Thread-3", "execution_time": 0.0327610969543457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.readmissions__exclusion", "compiled": true, "compiled_code": "\n\n-- Here we list encounter_ids that are excluded\n-- from being index admissions because they\n-- belong to one of these categories:\n--       [1] Medical Treatment of Cancer\n--       [2] Rehabilitation\n--       [3] Psychiatric\n\n\n-- encounter_ids for encounters that should be\n-- excluded because they belong to one of the\n-- exclusion categories\nwith exclusions as (\nselect distinct encounter_id\nfrom tuva.readmissions._int_encounter_with_ccs\nwhere\n(ccs_diagnosis_category is not null)\nand\n(\nccs_diagnosis_category in\n    (select distinct ccs_diagnosis_category\n     from tuva.readmissions._value_set_exclusion_ccs_diagnosis_category )\n)\n)\n\n\nselect *, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom exclusions", "relation_name": "tuva.readmissions._int_exclusion"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:32.065963Z", "completed_at": "2025-02-25T21:26:32.085898Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:32.087134Z", "completed_at": "2025-02-25T21:26:32.087138Z"}], "thread_id": "Thread-1", "execution_time": 0.0273590087890625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.readmissions__planned_encounter", "compiled": true, "compiled_code": "\n\n-- Here we list encounter_ids for all encounters\n-- that are planned.\n\n\n-- encounter_ids for encounters that we know\n-- are planned because they had a procedure category\n-- that is only present for planned encounters \nwith always_planned_px as (\nselect distinct pccs.encounter_id\nfrom tuva.readmissions._int_procedure_ccs pccs\ninner join tuva.readmissions._value_set_always_planned_ccs_procedure_category apc\n    on pccs.ccs_procedure_category = apc.ccs_procedure_category\n),\n\n\n-- encounter_ids for encounters that we know\n-- are planned because they had a diagnosis category\n-- that is only present for planned encounters\nalways_planned_dx as (\nselect distinct encounter_id\nfrom tuva.readmissions._int_encounter_with_ccs dccs\ninner join tuva.readmissions._value_set_always_planned_ccs_diagnosis_category apd\n    on dccs.ccs_diagnosis_category = apd.ccs_diagnosis_category\n),\n\n\n-- encounter_ids for encounters that are potentially planned\n-- based on one of their CCS procedure categories.\n-- For these encounters to actually be planned, we must further\n-- require that they are NOT acute encounters\npotentially_planned_px_ccs as (\nselect distinct encounter_id\nfrom tuva.readmissions._int_procedure_ccs pccs\ninner join tuva.readmissions._value_set_potentially_planned_ccs_procedure_category pcs\n    on pccs.ccs_procedure_category = pcs.ccs_procedure_category\n),\n\n\n-- encounter_ids for encounters that are potentially planned\n-- based on their ICD-10-PCS procedure codes.\n-- For these encounters to actually be planned, we must further\n-- require that they are NOT acute encounters\npotentially_planned_px_icd_10_pcs as (\nselect distinct encounter_id\nfrom tuva.readmissions._int_procedure_ccs pcs\ninner join  tuva.readmissions._value_set_potentially_planned_icd_10_pcs pps\n    on pcs.procedure_code = pps.icd_10_pcs\n),\n\n\n-- encounter_ids for encounters that are acute based\n-- on their primary diagnosis code or their CCS diagnosis category\nacute_encounters as (\nselect distinct encounter_id\nfrom tuva.readmissions._int_encounter_with_ccs dccs\nleft join tuva.readmissions._value_set_acute_diagnosis_icd_10_cm adi\n    on dccs.primary_diagnosis_code = adi.icd_10_cm\nleft join tuva.readmissions._value_set_acute_diagnosis_ccs adc\n    on dccs.ccs_diagnosis_category = adc.ccs_diagnosis_category\nwhere adi.icd_10_cm is not null or adc.ccs_diagnosis_category is not null\n),\n\n\n-- encounter_ids for encounters that are:\n--           [1] potentially planned, based on one of\n--               their CCS procedure categories or\n--               their ICD-10-PCS procedure codes\n--           [2] not acute, based on their primary diagnosis code\n--               or their CCS diagnosis category\n-- These encounters are therefore confirmed to be planned\npotentially_planned_that_are_actually_planned as (\nselect distinct ppp.encounter_id\nfrom (\n    select * from potentially_planned_px_ccs\n        union all\n    select * from potentially_planned_px_icd_10_pcs) ppp\nleft join acute_encounters\n    on ppp.encounter_id = acute_encounters.encounter_id\nwhere acute_encounters.encounter_id is null\n\n)\n\n\n-- Aggregate of all encounter_ids for planned encounters\n\nselect * , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run from always_planned_px\n\nunion distinct\n\nselect *, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run from always_planned_dx\n\nunion distinct\n\nselect *, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run from potentially_planned_that_are_actually_planned", "relation_name": "tuva.readmissions._int_planned_encounter"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:32.077251Z", "completed_at": "2025-02-25T21:26:32.086614Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:32.087824Z", "completed_at": "2025-02-25T21:26:32.087828Z"}], "thread_id": "Thread-4", "execution_time": 0.023049116134643555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.quality_measures__int_cqm438_long", "compiled": true, "compiled_code": "\n\nwith denominator as (\n\n    select\n          person_id\n        , performance_period_begin\n        , performance_period_end\n        , measure_id\n        , measure_name\n        , measure_version\n        , denominator_flag\n    from tuva.quality_measures._int_cqm438_denominator\n\n)\n\n, numerator as (\n\n    select\n          person_id\n        , evidence_date\n        , evidence_value\n    from tuva.quality_measures._int_cqm438_numerator\n\n)\n\n, exclusions as (\n\n    select\n          person_id\n        , exclusion_date\n        , exclusion_reason\n    from tuva.quality_measures._int_cqm438_exclusions\n\n)\n\n, measure_flags as (\n\n    select\n          denominator.person_id\n        , case\n            when denominator.person_id is not null\n            then 1\n            else null\n          end as denominator_flag\n        , case\n            when numerator.person_id is not null and denominator.person_id is not null\n            then 1\n            when denominator.person_id is not null\n            then 0\n            else null\n          end as numerator_flag\n        , case\n            when exclusions.person_id is not null and denominator.person_id is not null\n            then 1\n            when denominator.person_id is not null\n            then 0\n            else null\n          end as exclusion_flag\n        , numerator.evidence_date\n        , numerator.evidence_value\n        , exclusions.exclusion_date\n        , exclusions.exclusion_reason\n        , denominator.performance_period_begin\n        , denominator.performance_period_end\n        , denominator.measure_id\n        , denominator.measure_name\n        , denominator.measure_version\n        , (row_number() over(\n            partition by\n                  denominator.person_id\n                , denominator.performance_period_begin\n                , denominator.performance_period_end\n                , denominator.measure_id\n                , denominator.measure_name\n              order by\n                  case when numerator.evidence_date is null then 1 else 0 end,\n                  numerator.evidence_date desc\n                , case when exclusions.exclusion_date is null then 1 else 0 end,\n                  exclusions.exclusion_date desc\n          )) as rn\n    from denominator\n        left join numerator\n            on denominator.person_id = numerator.person_id\n        left join exclusions\n            on denominator.person_id = exclusions.person_id\n\n)\n\n/*\n    Deduplicate measure rows by latest evidence date or exclusion date\n*/\n, deduped as (\n\n    select\n          person_id\n        , denominator_flag\n        , numerator_flag\n        , exclusion_flag\n        , evidence_date\n        , evidence_value\n        , exclusion_date\n        , exclusion_reason\n        , performance_period_begin\n        , performance_period_end\n        , measure_id\n        , measure_name\n        , measure_version\n    from measure_flags\n    where rn = 1\n\n)\n\n, add_data_types as (\n\n    select\n          cast(person_id as TEXT) as person_id\n        , cast(denominator_flag as integer) as denominator_flag\n        , cast(numerator_flag as integer) as numerator_flag\n        , cast(exclusion_flag as integer) as exclusion_flag\n        , cast(evidence_date as date) as evidence_date\n        , cast(evidence_value as TEXT) as evidence_value\n        , cast(exclusion_date as date) as exclusion_date\n        , cast(exclusion_reason as TEXT) as exclusion_reason\n        , cast(performance_period_begin as date) as performance_period_begin\n        , cast(performance_period_end as date) as performance_period_end\n        , cast(measure_id as TEXT) as measure_id\n        , cast(measure_name as TEXT) as measure_name\n        , cast(measure_version as TEXT) as measure_version\n    from deduped\n\n)\n\nselect\n      person_id\n    , denominator_flag\n    , numerator_flag\n    , exclusion_flag\n    , evidence_date\n    , evidence_value\n    , exclusion_date\n    , exclusion_reason\n    , performance_period_begin\n    , performance_period_end\n    , measure_id\n    , measure_name\n    , measure_version\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.quality_measures._int_cqm438_long"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:32.088188Z", "completed_at": "2025-02-25T21:26:32.101940Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:32.102964Z", "completed_at": "2025-02-25T21:26:32.102974Z"}], "thread_id": "Thread-2", "execution_time": 0.017436742782592773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.quality_measures__int_nqf0420_long", "compiled": true, "compiled_code": "\n\nwith denominator as (\n\n    select\n          person_id\n        , performance_period_begin\n        , performance_period_end\n        , measure_id\n        , measure_name\n        , measure_version\n        , denominator_flag\n    from tuva.quality_measures._int_nqf0420_denominator\n\n)\n\n, numerator as (\n\n    select\n          person_id\n        , evidence_date\n        , evidence_value\n    from tuva.quality_measures._int_nqf0420_numerator\n\n)\n\n, exclusions as (\n\n    select\n          person_id\n        , exclusion_date\n        , exclusion_reason\n    from tuva.quality_measures._int_nqf0420_exclusions\n\n)\n\n, measure_flags as (\n\n    select\n          denominator.person_id\n        , case\n            when denominator.person_id is not null\n            then 1\n            else null\n          end as denominator_flag\n        , case\n            when numerator.person_id is not null and denominator.person_id is not null\n            then 1\n            when denominator.person_id is not null\n            then 0\n            else null\n          end as numerator_flag\n        , case\n            when exclusions.person_id is not null and denominator.person_id is not null\n            then 1\n            when denominator.person_id is not null\n            then 0\n            else null\n          end as exclusion_flag\n        , numerator.evidence_date\n        , numerator.evidence_value\n        , exclusions.exclusion_date\n        , exclusions.exclusion_reason\n        , denominator.performance_period_begin\n        , denominator.performance_period_end\n        , denominator.measure_id\n        , denominator.measure_name\n        , denominator.measure_version\n        , (row_number() over(\n            partition by\n                  denominator.person_id\n                , denominator.performance_period_begin\n                , denominator.performance_period_end\n                , denominator.measure_id\n                , denominator.measure_name\n              order by\n                  case when numerator.evidence_date is null then 1 else 0 end,\n                  numerator.evidence_date desc\n                , case when exclusions.exclusion_date is null then 1 else 0 end,\n                  exclusions.exclusion_date desc\n          )) as rn\n    from denominator\n        left join numerator\n            on denominator.person_id = numerator.person_id\n        left join exclusions\n            on denominator.person_id = exclusions.person_id\n\n)\n\n/*\n    Deduplicate measure rows by latest evidence date or exclusion date\n*/\n, deduped as (\n\n    select\n          person_id\n        , denominator_flag\n        , numerator_flag\n        , exclusion_flag\n        , evidence_date\n        , evidence_value\n        , exclusion_date\n        , exclusion_reason\n        , performance_period_begin\n        , performance_period_end\n        , measure_id\n        , measure_name\n        , measure_version\n    from measure_flags\n    where rn = 1\n\n)\n\n, add_data_types as (\n\n    select\n          cast(person_id as TEXT) as person_id\n        , cast(denominator_flag as integer) as denominator_flag\n        , cast(numerator_flag as integer) as numerator_flag\n        , cast(exclusion_flag as integer) as exclusion_flag\n        , cast(evidence_date as date) as evidence_date\n        , cast(evidence_value as TEXT) as evidence_value\n        , cast(exclusion_date as date) as exclusion_date\n        , cast(exclusion_reason as TEXT) as exclusion_reason\n        , cast(performance_period_begin as date) as performance_period_begin\n        , cast(performance_period_end as date) as performance_period_end\n        , cast(measure_id as TEXT) as measure_id\n        , cast(measure_name as TEXT) as measure_name\n        , cast(measure_version as TEXT) as measure_version\n    from deduped\n\n)\n\nselect\n      person_id\n    , denominator_flag\n    , numerator_flag\n    , exclusion_flag\n    , evidence_date\n    , evidence_value\n    , exclusion_date\n    , exclusion_reason\n    , performance_period_begin\n    , performance_period_end\n    , measure_id\n    , measure_name\n    , measure_version\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.quality_measures._int_nqf0420_long"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:32.096167Z", "completed_at": "2025-02-25T21:26:32.108285Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:32.114110Z", "completed_at": "2025-02-25T21:26:32.114117Z"}], "thread_id": "Thread-3", "execution_time": 0.02666640281677246, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ahrq_measures__int_pqi_01_num", "compiled": true, "compiled_code": "\n\nselect\n    e.data_source\n  , e.person_id\n  , e.year_number\n  , e.encounter_id\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._stg_pqi_inpatient_encounter as e\ninner join tuva.ahrq_measures._value_set_pqi as pqi\n  on e.primary_diagnosis_code = pqi.code\n  and pqi.value_set_name = 'diabetes_with_short-term_complications_diagnosis_codes'\n  and pqi.pqi_number = '01'\ninner join tuva.ahrq_measures._int_pqi_01_denom as denom\n  on e.person_id = denom.person_id\n  and e.data_source = denom.data_source\n  and e.year_number = denom.year_number\nleft join tuva.ahrq_measures._int_pqi_01_exclusions as shared\n  on e.encounter_id = shared.encounter_id\n  and e.data_source = shared.data_source\nwhere shared.encounter_id is null", "relation_name": "tuva.ahrq_measures._int_pqi_01_num"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:32.103545Z", "completed_at": "2025-02-25T21:26:32.115084Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:32.116187Z", "completed_at": "2025-02-25T21:26:32.116194Z"}], "thread_id": "Thread-1", "execution_time": 0.020465850830078125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ahrq_measures__int_pqi_03_num", "compiled": true, "compiled_code": "\n\nselect\n    e.data_source\n  , e.person_id\n  , e.year_number\n  , e.encounter_id\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._stg_pqi_inpatient_encounter as e\ninner join tuva.ahrq_measures._value_set_pqi as pqi\n  on e.primary_diagnosis_code = pqi.code\n  and pqi.value_set_name = 'diabetes_with_long-term_complications_diagnosis_codes'\n  and pqi.pqi_number = '03'\ninner join tuva.ahrq_measures._int_pqi_03_denom as denom\n  on e.person_id = denom.person_id\n  and e.data_source = denom.data_source\n  and e.year_number = denom.year_number\nleft join tuva.ahrq_measures._int_pqi_03_exclusions as shared\n  on e.encounter_id = shared.encounter_id\n  and e.data_source = shared.data_source\nwhere shared.encounter_id is null", "relation_name": "tuva.ahrq_measures._int_pqi_03_num"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:32.108545Z", "completed_at": "2025-02-25T21:26:32.115956Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:32.122741Z", "completed_at": "2025-02-25T21:26:32.122751Z"}], "thread_id": "Thread-4", "execution_time": 0.02121877670288086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ahrq_measures__int_pqi_05_num", "compiled": true, "compiled_code": "\n\nselect\n    e.data_source\n  , e.person_id\n  , e.year_number\n  , e.encounter_id\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._stg_pqi_inpatient_encounter as e\ninner join tuva.ahrq_measures._int_pqi_05_denom as denom\n  on e.person_id = denom.person_id\n  and e.data_source = denom.data_source\n  and e.year_number = denom.year_number\nleft join tuva.ahrq_measures._value_set_pqi as copd\n  on e.primary_diagnosis_code = copd.code\n  and copd.value_set_name = 'chronic_obstructive_pulmonary_disorder'\n  and copd.pqi_number = '05'\nleft join tuva.ahrq_measures._value_set_pqi asthma\n  on e.primary_diagnosis_code = asthma.code\n  and asthma.value_set_name = 'asthma'\n  and asthma.pqi_number = '05'\nleft join tuva.ahrq_measures._int_pqi_05_exclusions as shared\n  on e.encounter_id = shared.encounter_id\n  and e.data_source = shared.data_source\nwhere shared.encounter_id is null\n  and (\n    asthma.code is not null \n    or copd.code is not null\n    )", "relation_name": "tuva.ahrq_measures._int_pqi_05_num"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:32.117064Z", "completed_at": "2025-02-25T21:26:32.128852Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:32.129674Z", "completed_at": "2025-02-25T21:26:32.129680Z"}], "thread_id": "Thread-2", "execution_time": 0.015011787414550781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ahrq_measures__int_pqi_07_num", "compiled": true, "compiled_code": "\n\nselect\n    e.data_source\n  , e.person_id\n  , e.year_number\n  , e.encounter_id\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._stg_pqi_inpatient_encounter as e\ninner join tuva.ahrq_measures._value_set_pqi as hyp\n  on e.primary_diagnosis_code = hyp.code\n  and hyp.value_set_name = 'hypertension_diagnosis_codes'\n  and hyp.pqi_number = '07'\ninner join tuva.ahrq_measures._int_pqi_07_denom as denom\n  on e.person_id = denom.person_id\n  and e.data_source = denom.data_source\n  and e.year_number = denom.year_number\nleft join tuva.ahrq_measures._int_pqi_07_exclusions as shared\n  on e.encounter_id = shared.encounter_id\n  and e.data_source = shared.data_source\nwhere shared.encounter_id is null", "relation_name": "tuva.ahrq_measures._int_pqi_07_num"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:32.124542Z", "completed_at": "2025-02-25T21:26:32.136119Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:32.140920Z", "completed_at": "2025-02-25T21:26:32.140927Z"}], "thread_id": "Thread-3", "execution_time": 0.02420806884765625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ahrq_measures__int_pqi_08_num", "compiled": true, "compiled_code": "\n\nselect\n    e.data_source\n  , e.person_id\n  , e.year_number\n  , e.encounter_id\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._stg_pqi_inpatient_encounter as e\ninner join tuva.ahrq_measures._value_set_pqi as hyp\n  on e.primary_diagnosis_code = hyp.code\n  and hyp.value_set_name = 'heart_failure_diagnosis_codes'\n  and hyp.pqi_number = '08'\ninner join tuva.ahrq_measures._int_pqi_08_denom as denom\n  on e.person_id = denom.person_id\n  and e.data_source = denom.data_source\n  and e.year_number = denom.year_number\nleft join tuva.ahrq_measures._int_pqi_08_exclusions as shared\n  on e.encounter_id = shared.encounter_id\n  and e.data_source = shared.data_source\nwhere shared.encounter_id is null", "relation_name": "tuva.ahrq_measures._int_pqi_08_num"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:32.130321Z", "completed_at": "2025-02-25T21:26:32.141659Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:32.147136Z", "completed_at": "2025-02-25T21:26:32.147143Z"}], "thread_id": "Thread-1", "execution_time": 0.02296304702758789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ahrq_measures__int_pqi_11_num", "compiled": true, "compiled_code": "\n\nselect\n    e.data_source\n  , e.person_id\n  , e.year_number\n  , e.encounter_id\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._stg_pqi_inpatient_encounter as e\ninner join tuva.ahrq_measures._value_set_pqi as hyp\n  on e.primary_diagnosis_code = hyp.code\n  and hyp.value_set_name = 'community_acquired_bacterial_pneumonia_diagnosis_codes'\n  and hyp.pqi_number = '11'\ninner join tuva.ahrq_measures._int_pqi_11_denom as denom\n  on e.person_id = denom.person_id\n  and e.data_source = denom.data_source\n  and e.year_number = denom.year_number\nleft join tuva.ahrq_measures._int_pqi_11_exclusions as shared\n  on e.encounter_id = shared.encounter_id\n  and e.data_source = shared.data_source\nwhere shared.encounter_id is null", "relation_name": "tuva.ahrq_measures._int_pqi_11_num"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:32.136349Z", "completed_at": "2025-02-25T21:26:32.146856Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:32.148085Z", "completed_at": "2025-02-25T21:26:32.148090Z"}], "thread_id": "Thread-4", "execution_time": 0.01906895637512207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ahrq_measures__int_pqi_14_num", "compiled": true, "compiled_code": "\n\nselect\n    e.data_source\n  , e.person_id\n  , e.year_number\n  , e.encounter_id\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._stg_pqi_inpatient_encounter as e\ninner join tuva.ahrq_measures._value_set_pqi as hyp\n  on e.primary_diagnosis_code = hyp.code\n  and hyp.value_set_name = 'uncontrolled_diabetes_diagnosis_codes'\n  and hyp.pqi_number = '14'\ninner join tuva.ahrq_measures._int_pqi_14_denom as denom\n  on e.person_id = denom.person_id\n  and e.data_source = denom.data_source\n  and e.year_number = denom.year_number\nleft join tuva.ahrq_measures._int_pqi_14_exclusions as shared\n  on e.encounter_id = shared.encounter_id\n  and e.data_source = shared.data_source\nwhere shared.encounter_id is null", "relation_name": "tuva.ahrq_measures._int_pqi_14_num"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:32.142487Z", "completed_at": "2025-02-25T21:26:32.148866Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:32.149895Z", "completed_at": "2025-02-25T21:26:32.149900Z"}], "thread_id": "Thread-2", "execution_time": 0.009348869323730469, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ahrq_measures__int_pqi_12_num", "compiled": true, "compiled_code": "\n\nselect\n    e.data_source\n  , e.person_id\n  , e.year_number\n  , e.encounter_id\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._stg_pqi_inpatient_encounter as e\ninner join tuva.ahrq_measures._value_set_pqi as hyp\n  on e.primary_diagnosis_code = hyp.code\n  and hyp.value_set_name = 'urinary_tract_infection_diagnosis_codes'\n  and hyp.pqi_number = '12'\ninner join tuva.ahrq_measures._int_pqi_12_denom as denom\n  on e.person_id = denom.person_id\n  and e.data_source = denom.data_source\n  and e.year_number = denom.year_number\nleft join tuva.ahrq_measures._int_pqi_12_exclusions as shared\n  on e.encounter_id = shared.encounter_id\n  and e.data_source = shared.data_source\nwhere shared.encounter_id is null", "relation_name": "tuva.ahrq_measures._int_pqi_12_num"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:32.150320Z", "completed_at": "2025-02-25T21:26:32.179891Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:32.180606Z", "completed_at": "2025-02-25T21:26:32.180614Z"}], "thread_id": "Thread-3", "execution_time": 0.03297090530395508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ahrq_measures__int_pqi_15_num", "compiled": true, "compiled_code": "\n\nselect\n    e.data_source\n  , e.person_id\n  , e.year_number\n  , e.encounter_id\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._stg_pqi_inpatient_encounter as e\ninner join tuva.ahrq_measures._value_set_pqi as hyp\n  on e.primary_diagnosis_code = hyp.code\n  and hyp.value_set_name = 'asthma_diagnosis_codes'\n  and hyp.pqi_number = '15'\ninner join tuva.ahrq_measures._int_pqi_15_denom as denom\n  on e.person_id = denom.person_id\n  and e.data_source = denom.data_source\n  and e.year_number = denom.year_number\nleft join tuva.ahrq_measures._int_pqi_15_exclusions as shared\n  on e.encounter_id = shared.encounter_id\n  and e.data_source = shared.data_source\nwhere shared.encounter_id is null", "relation_name": "tuva.ahrq_measures._int_pqi_15_num"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:32.155543Z", "completed_at": "2025-02-25T21:26:32.185102Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:32.186022Z", "completed_at": "2025-02-25T21:26:32.186028Z"}], "thread_id": "Thread-1", "execution_time": 0.036505937576293945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ahrq_measures__int_pqi_16_num", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte___stg_pqi_condition as (\n\n\nselect \n    normalized_code_type\n  , normalized_code\n  , encounter_id\n  , data_source\nfrom \n    tuva.core.condition\n),  __dbt__cte___stg_pqi_procedure as (\n\n\nselect \n    normalized_code_type\n  , normalized_code\n  , encounter_id\n  , data_source\nfrom \n    tuva.core.procedure\n), diagnosis as (\n    select distinct\n        c.encounter_id\n      , c.data_source\n    from __dbt__cte___stg_pqi_condition as c\n    inner join tuva.ahrq_measures._value_set_pqi as pqi\n      on c.normalized_code = pqi.code\n      and c.normalized_code_type = 'icd-10-cm'\n      and pqi.value_set_name = 'diabetes_diagnosis_codes'\n      and pqi_number = '16'\n    where c.encounter_id is not null\n),\n\n\nprocedures as (\n    select distinct\n        p.encounter_id\n      , p.data_source\n    from __dbt__cte___stg_pqi_procedure as p\n    inner join diagnosis as d \n      on p.encounter_id = d.encounter_id\n      and d.data_source = p.data_source\n    inner join tuva.ahrq_measures._value_set_pqi as pqi\n      on p.normalized_code = pqi.code\n      and p.normalized_code_type = 'icd-10-pcs'\n      and pqi.value_set_name = 'lower-extremity_amputation_procedure_codes'\n      and pqi_number = '16'\n)\n\nselect\n    e.data_source\n  , e.person_id\n  , e.year_number\n  , e.encounter_id\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._stg_pqi_inpatient_encounter as e\ninner join tuva.ahrq_measures._int_pqi_16_denom as denom \n  on e.person_id = denom.person_id\n  and e.data_source = denom.data_source\n  and e.year_number = denom.year_number\n    inner join procedures as p\n  on e.encounter_id = p.encounter_id\n  and e.data_source = p.data_source\nleft join tuva.ahrq_measures._int_pqi_16_exclusions as shared\n  on e.encounter_id = shared.encounter_id\n  and e.data_source = shared.data_source\nwhere shared.encounter_id is null", "relation_name": "tuva.ahrq_measures._int_pqi_16_num"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:32.168216Z", "completed_at": "2025-02-25T21:26:32.185387Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:32.186429Z", "completed_at": "2025-02-25T21:26:32.186434Z"}], "thread_id": "Thread-4", "execution_time": 0.032122135162353516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ahrq_measures__pqi_exclusion_long", "compiled": true, "compiled_code": "\n\nselect\n    e.data_source\n  , e.encounter_id\n  , e.exclusion_reason\n  , e.exclusion_number\n  , 1 as pqi_number\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._int_pqi_01_exclusions as e\n\nunion all\n\nselect\n    e.data_source\n  , e.encounter_id\n  , e.exclusion_reason\n  , e.exclusion_number\n  , 3 as pqi_number\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._int_pqi_03_exclusions as e\n\nunion all\n\nselect\n    e.data_source\n  , e.encounter_id\n  , e.exclusion_reason\n  , e.exclusion_number\n  , 5 as pqi_number\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._int_pqi_05_exclusions as e\n\nunion all\n\nselect\n    e.data_source\n  , e.encounter_id\n  , e.exclusion_reason\n  , e.exclusion_number\n  , 7 as pqi_number\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._int_pqi_07_exclusions as e\n\nunion all\n\nselect\n    e.data_source\n  , e.encounter_id\n  , e.exclusion_reason\n  , e.exclusion_number\n  , 8 as pqi_number\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._int_pqi_08_exclusions as e\n\nunion all\n\nselect\n    e.data_source\n  , e.encounter_id\n  , e.exclusion_reason\n  , e.exclusion_number\n  , 11 as pqi_number\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._int_pqi_11_exclusions as e\n\nunion all\n\nselect\n    e.data_source\n  , e.encounter_id\n  , e.exclusion_reason\n  , e.exclusion_number\n  , 12 as pqi_number\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._int_pqi_12_exclusions as e\n\nunion all\n\nselect\n    e.data_source\n  , e.encounter_id\n  , e.exclusion_reason\n  , e.exclusion_number\n  , 14 as pqi_number\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._int_pqi_14_exclusions as e\n\nunion all\n\nselect\n    e.data_source\n  , e.encounter_id\n  , e.exclusion_reason\n  , e.exclusion_number\n  , 15 as pqi_number\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._int_pqi_15_exclusions as e\n\nunion all\n\nselect\n    e.data_source\n  , e.encounter_id\n  , e.exclusion_reason\n  , e.exclusion_number\n  , 16 as pqi_number\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._int_pqi_16_exclusions as e", "relation_name": "tuva.ahrq_measures.pqi_exclusion_long"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:32.181079Z", "completed_at": "2025-02-25T21:26:32.186830Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:32.188058Z", "completed_at": "2025-02-25T21:26:32.188062Z"}], "thread_id": "Thread-2", "execution_time": 0.021214962005615234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__ed_classification", "compiled": true, "compiled_code": "\n\nwith cte as (\n  select \n    max(case when ed_classification_description = 'Emergent, ED Care Needed, Preventable/Avoidable' then 1 else 0 end) as ed_care_needed_preventable,\n    max(case when ed_classification_description = 'Emergent, Primary Care Treatable' then 1 else 0 end) as pc_treatable,\n    max(case when ed_classification_description = 'Emergent, ED Care Needed, Not Preventable/Avoidable' then 1 else 0 end) as ed_care_needed_not_preventable,\n    max(case when ed_classification_description = 'Non-Emergent' then 1 else 0 end) as non_emergent\n  from tuva.ed_classification.summary\n)\n\n,final as (\nselect 'ed classification missing ed_care_needed_preventable' as data_quality_check,\n       case when ed_care_needed_preventable = 0 then 1 else 0 end as result_count\nfrom cte\n\nunion all\n\nselect 'ed classification missing pc_treatable' as data_quality_check,\n       case when pc_treatable = 0 then 1 else 0 end as result_count\nfrom cte\n\nunion all\n\nselect 'ed classification missing ed_care_needed_not_preventable' as data_quality_check,\n       case when ed_care_needed_not_preventable = 0 then 1 else 0 end as result_count\nfrom cte\n\nunion all\n\nselect 'ed classification missing non_emergent' as data_quality_check,\n       case when non_emergent = 0 then 1 else 0 end as result_count\nfrom cte\n)\n\nselect *\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom final", "relation_name": "tuva.data_quality.data_quality_ed_classification"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:32.188476Z", "completed_at": "2025-02-25T21:26:32.207206Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:32.207840Z", "completed_at": "2025-02-25T21:26:32.207847Z"}], "thread_id": "Thread-3", "execution_time": 0.022284746170043945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__ed_classification_reference", "compiled": true, "compiled_code": "\n\nwith total_cte as \n(\nselect count(*) as total_encounters\nfrom tuva.core.encounter\nwhere encounter_type = cast('emergency department' as TEXT)\n) \n\n,final as (\nselect coalesce(cast(ed_classification_description as TEXT), cast('Not Classified' as TEXT)) as ed_classification_description\n,count(*) as encounters\n,total_cte.total_encounters\n,count(*)/total_cte.total_encounters as percent_of_total\n,row_number() over (order by count(*) desc) as value_rank\nfrom tuva.core.encounter e\ncross join total_cte\nleft join tuva.ed_classification.summary s on e.encounter_id = s.encounter_id \nwhere encounter_type = cast('emergency department' as TEXT)\ngroup by coalesce(cast(ed_classification_description as TEXT), cast('Not Classified' as TEXT))\n,total_cte.total_encounters\n)\n\n,actually_final as (\nselect cast('ed classification' as TEXT) as analytics_concept\n,ed_classification_description as analytics_measure\n,percent_of_total as data_source_value\n,value_rank as value_rank\nfrom final\n)\n\nselect m.analytics_concept\n,m.analytics_measure\n,data_source_value\n,m.analytics_value\n,m.value_rank\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.data_quality._value_set_reference_mart_analytics m \nleft join actually_final on actually_final.analytics_measure = m.analytics_measure\nand\nm.analytics_concept = actually_final.analytics_concept\nwhere m.analytics_concept = cast('ed classification' as TEXT)", "relation_name": "tuva.data_quality.data_quality_ed_classification_reference"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:32.202140Z", "completed_at": "2025-02-25T21:26:32.214666Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:32.215772Z", "completed_at": "2025-02-25T21:26:32.215777Z"}], "thread_id": "Thread-4", "execution_time": 0.020969867706298828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.readmissions__index_admission", "compiled": true, "compiled_code": "\n\n-- Here we list all index admissions for the hospital wide readmissions\n-- measure.\n-- These represent encounter_ids that meet the requirements to be an\n-- index admission for the HWR measure.\n-- These are the requirements for a hospitalization to be an index admission\n-- for the HWR measure:\n--\n--     Time Requirement: The discharge data must be at least 30 days\n--                       earlier than the last dischareg date available\n--                       in the dataset.\n-- \n--     Discharge Requirements: The patient must not be discharged to another\n--                             acute care hospital; the patient must not have\n--                             left against medical advice; and the patient\n--                             must be alive at discharge.\n--\n--     Diagnosis Requirements: Exclude encounters where based on the CCS\n--     (exclusions)            diagnosis category we know the encounter was\n--                             for medical treatment of cancer, rehabilitation,\n--                             or psychiatric reasons.\n\n\n\nselect distinct a.encounter_id, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.readmissions._int_encounter a\ninner join tuva.readmissions._int_index_time_requirement b\n    on a.encounter_id = b.encounter_id\ninner join tuva.readmissions._int_index_discharge_requirement c\n    on a.encounter_id = c.encounter_id\nleft join tuva.readmissions._int_exclusion d\n    on a.encounter_id = d.encounter_id\nwhere d.encounter_id is null", "relation_name": "tuva.readmissions._int_index_admission"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:32.196547Z", "completed_at": "2025-02-25T21:26:32.215258Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:32.216410Z", "completed_at": "2025-02-25T21:26:32.216416Z"}], "thread_id": "Thread-1", "execution_time": 0.02197098731994629, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.mart_review__ed_classification", "compiled": true, "compiled_code": "\n\nWITH cte AS\n(\n    SELECT DISTINCT location_id, npi, name\n    FROM tuva.core.location\n)\n\nSELECT\n    e.encounter_id,\n    case when s.encounter_id is null then 'Not Classified' else s.ed_classification_description end as ed_classification_description,\n    CASE\n        when s.encounter_id is null then 'Non-Avoidable'\n        when cast(s.ed_classification_order as int) <= 3 then s.ed_classification_description\n        ELSE 'Non-Avoidable' END AS avoidable_category,\n    e.paid_amount,\n    e.primary_diagnosis_code,\n    e.primary_diagnosis_description,\n    e.primary_diagnosis_code || '|' || e.primary_diagnosis_description as primary_diagnosis_and_description,\n    p.ccsr_parent_category,\n    p.ccsr_category,\n    p.ccsr_category_description,\n    p.ccsr_category || '|' || p.ccsr_category_description as ccsr_parent_category_and_description,\n    b.body_system,\n    e.facility_id,\n    e.allowed_amount,\n    e.charge_amount,\n    e.data_source,\n    e.length_of_stay,\n    e.discharge_disposition_code || '|' || e.discharge_disposition_description as discharge_code_and_description,\n    e.person_id || '|' || e.data_source as patient_source_key,\n    e.facility_name,\n    e.encounter_start_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.encounter e\nleft join tuva.ed_classification.summary s on e.encounter_id = s.encounter_id\nleft join cte on e.facility_id = cte.location_id\nleft join tuva.ccsr.dx_vertical_pivot as p\n  on e.primary_diagnosis_code = p.code\n  and p.ccsr_category_rank = 1\nleft join tuva.ccsr._value_set_dxccsr_v2023_1_body_systems b on p.ccsr_parent_category = b.ccsr_parent_category\nwhere e.encounter_type = 'emergency department'", "relation_name": "tuva.data_quality.mart_review__ed_classification"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:32.218573Z", "completed_at": "2025-02-25T21:26:32.235094Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:32.235376Z", "completed_at": "2025-02-25T21:26:32.235383Z"}], "thread_id": "Thread-3", "execution_time": 0.018602848052978516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ahrq_measures__pqi_num_long", "compiled": true, "compiled_code": "\n\nselect\n    n.data_source\n  , n.person_id\n  , n.year_number\n  , n.encounter_id\n  , '01' as pqi_number\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._int_pqi_01_num as n\n\nunion all\n\nselect\n    n.data_source\n  , n.person_id\n  , n.year_number\n  , n.encounter_id\n  , '03' as pqi_number\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._int_pqi_03_num as n\n\nunion all\n\nselect\n    n.data_source\n  , n.person_id\n  , n.year_number\n  , n.encounter_id\n  , '05' as pqi_number\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._int_pqi_05_num as n\n\nunion all\n\nselect\n    n.data_source\n  , n.person_id\n  , n.year_number\n  , n.encounter_id\n  , '07' as pqi_number\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._int_pqi_07_num as n\n\nunion all\n\nselect\n    n.data_source\n  , n.person_id\n  , n.year_number\n  , n.encounter_id\n  , '08' as pqi_number\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._int_pqi_08_num as n\n\nunion all\n\nselect\n    n.data_source\n  , n.person_id\n  , n.year_number\n  , n.encounter_id\n  , '11' as pqi_number\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._int_pqi_11_num as n\n\nunion all\n\nselect\n    n.data_source\n  , n.person_id\n  , n.year_number\n  , n.encounter_id\n  , '12' as pqi_number\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._int_pqi_12_num as n\n\nunion all\n\nselect\n    n.data_source\n  , n.person_id\n  , n.year_number\n  , n.encounter_id\n  , '14' as pqi_number\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._int_pqi_14_num as n\n\nunion all\n\nselect\n    n.data_source\n  , n.person_id\n  , n.year_number\n  , n.encounter_id\n  , '15' as pqi_number\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._int_pqi_15_num as n\n\nunion all\n\nselect\n    n.data_source\n  , n.person_id\n  , n.year_number\n  , n.encounter_id\n  , '16' as pqi_number\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures._int_pqi_16_num as n", "relation_name": "tuva.ahrq_measures.pqi_num_long"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:32.230430Z", "completed_at": "2025-02-25T21:26:32.235883Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:32.236132Z", "completed_at": "2025-02-25T21:26:32.236135Z"}], "thread_id": "Thread-4", "execution_time": 0.018093109130859375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.readmissions__encounter_augmented", "compiled": true, "compiled_code": "\n\n-- Here we list all encounters from the stg_encounter model\n-- and we augment them with extra fields\n-- that are relevant for readmission measures\nselect\n    aa.encounter_id,\n    aa.person_id,\n    aa.admit_date,\n    aa.discharge_date,\n    aa.discharge_disposition_code,\n    aa.facility_id,\n    aa.drg_code_type,\n    aa.drg_code,\n    aa.paid_amount,\n    datediff(\n        day,\n        aa.admit_date,\n        aa.discharge_date\n        ) as length_of_stay,\n    case\n        when bb.encounter_id is not null then 1\n\t    else 0\n    end as index_admission_flag,\n    case\n        when cc.encounter_id is not null then 1\n\t    else 0\n    end as planned_flag,\n    dd.specialty_cohort,\n    case\n        when aa.discharge_disposition_code = '20' then 1\n\t    else 0\n    end as died_flag,\n    ee.diagnosis_ccs,\n    ee.disqualified_encounter_flag,\n    ee.missing_admit_date_flag,\n    ee.missing_discharge_date_flag,\n    ee.admit_after_discharge_flag,\n    ee.missing_discharge_disposition_code_flag,\n    ee.invalid_discharge_disposition_code_flag,\n    ee.missing_primary_diagnosis_flag,\n    ee.invalid_primary_diagnosis_code_flag,\n    ee.no_diagnosis_ccs_flag,\n    ee.overlaps_with_another_encounter_flag,\n    ee.missing_drg_flag,\n    ee.invalid_drg_flag,\n    '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom\n    tuva.readmissions._int_encounter aa\n    left join tuva.readmissions._int_index_admission bb\n    on aa.encounter_id = bb.encounter_id\n    left join tuva.readmissions._int_planned_encounter cc\n    on aa.encounter_id = cc.encounter_id \n    left join tuva.readmissions._int_encounter_specialty_cohort dd\n    on aa.encounter_id = dd.encounter_id\n    left join tuva.readmissions._int_encounter_data_quality ee\n    on aa.encounter_id = ee.encounter_id", "relation_name": "tuva.readmissions.encounter_augmented"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:32.244207Z", "completed_at": "2025-02-25T21:26:32.256033Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:32.256383Z", "completed_at": "2025-02-25T21:26:32.256391Z"}], "thread_id": "Thread-3", "execution_time": 0.018574237823486328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ahrq_measures__pqi_summary", "compiled": true, "compiled_code": "\n\nselect p.pqi_number\n , m.pqi_name\n , e.year_number\n , e.encounter_id\n , e.data_source\n , e.person_id\n , e.facility_id\n , e.drg_code\n , e.drg_description\n , e.encounter_start_date\n , e.encounter_end_date\n , e.length_of_stay\n , e.paid_amount\n , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.ahrq_measures.pqi_num_long p \ninner join tuva.ahrq_measures._stg_pqi_inpatient_encounter e\n    on p.encounter_id = e.encounter_id\n    and p.data_source = e.data_source\ninner join tuva.ahrq_measures._value_set_pqi_measures m on cast(p.pqi_number as TEXT)  = m.pqi_number", "relation_name": "tuva.ahrq_measures.pqi_summary"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:32.238948Z", "completed_at": "2025-02-25T21:26:32.256929Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:32.257429Z", "completed_at": "2025-02-25T21:26:32.257433Z"}], "thread_id": "Thread-1", "execution_time": 0.020398855209350586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.ahrq_measures__pqi_rate", "compiled": true, "compiled_code": "\n\nwith num as (\n    select\n        data_source\n      , year_number\n      , pqi_number\n      , count(encounter_id) as num_count\n    from tuva.ahrq_measures.pqi_num_long\n    group by\n        data_source\n      , year_number\n      , pqi_number\n)\n\n, denom as (\n    select\n        data_source\n      , year_number\n      , pqi_number\n      , count(person_id) as denom_count\n    from tuva.ahrq_measures.pqi_denom_long as d\n    group by\n        data_source\n      , year_number\n      , pqi_number\n)\n\nselect\n    d.data_source\n  , d.year_number\n  , d.pqi_number\n  , d.denom_count\n  , coalesce(num.num_count, 0) as num_count\n  , coalesce(num.num_count, 0) / d.denom_count * 100000 as rate_per_100_thousand\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom denom as d\nleft join num\n    on d.pqi_number = num.pqi_number\n    and d.year_number = num.year_number\n    and d.data_source = num.data_source", "relation_name": "tuva.ahrq_measures.pqi_rate"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:32.259168Z", "completed_at": "2025-02-25T21:26:32.264469Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:32.264704Z", "completed_at": "2025-02-25T21:26:32.264711Z"}], "thread_id": "Thread-3", "execution_time": 0.006911039352416992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.readmissions__readmission_summary", "compiled": true, "compiled_code": "\n\n-- Here calculate days to readmission for encounters\n-- that had a readmission and create readmission flags\n\n\n-- We create the encounter_sequence integer count\n-- which keeps track of what number of encounter each\n-- encounter is for a given patient\nwith encounter_sequence as (\nselect\n    *,\n    row_number() over(\n        partition by person_id order by admit_date, discharge_date\n    ) as encounter_seq\nfrom tuva.readmissions.encounter_augmented\nwhere disqualified_encounter_flag = 0\n),\n\n\nreadmission_calc as (\nselect\n    aa.encounter_id,\n    aa.person_id,\n    aa.admit_date,\n    aa.discharge_date,\n    aa.discharge_disposition_code,\n    aa.facility_id,\n    aa.drg_code_type,\n    aa.drg_code,\n    aa.paid_amount,\n    aa.length_of_stay,\n    aa.index_admission_flag,\n    aa.planned_flag,\n    aa.specialty_cohort,\n    aa.died_flag,\n    aa.diagnosis_ccs,\n    case\n        when bb.encounter_id is not null then 1\n\t    else 0\n    end as had_readmission_flag,\n    datediff(\n        day,\n        aa.discharge_date,\n        bb.admit_date\n        ) as days_to_readmit,\n    case\n        when (datediff(\n        day,\n        aa.discharge_date,\n        bb.admit_date\n        )) <= 30  then 1\n\t    else 0\n    end as readmit_30_flag,\n    case\n        when\n\t    ((datediff(\n        day,\n        aa.discharge_date,\n        bb.admit_date\n        )) <= 30) and (bb.planned_flag = 0) then 1\n\t    else 0\n    end as unplanned_readmit_30_flag,\n    bb.encounter_id as readmission_encounter_id,\n    bb.admit_date as readmission_admit_date,\n    bb.discharge_date as readmission_discharge_date,\n    bb.discharge_disposition_code as readmission_discharge_disposition_code,\n    bb.facility_id as readmission_facility,\n    bb.drg_code_type as readmission_drg_code_type,\n    bb.drg_code as readmission_drg,\n    bb.length_of_stay as readmission_length_of_stay,\n    bb.index_admission_flag as readmission_index_admission_flag,\n    bb.planned_flag as readmission_planned_flag,\n    bb.specialty_cohort as readmission_specialty_cohort,\n    bb.died_flag as readmission_died_flag,\n    bb.diagnosis_ccs as readmission_diagnosis_ccs,\n    '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom\n    encounter_sequence aa\n    left join encounter_sequence bb\n    on aa.person_id = bb.person_id\n    and aa.encounter_seq + 1 = bb.encounter_seq\n)\n\nselect *\nfrom readmission_calc", "relation_name": "tuva.readmissions.readmission_summary"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:32.362323Z", "completed_at": "2025-02-25T21:26:32.365620Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:32.365876Z", "completed_at": "2025-02-25T21:26:32.365882Z"}], "thread_id": "Thread-3", "execution_time": 0.09979510307312012, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.mart_review__readmissions", "compiled": true, "compiled_code": "\n\nSELECT *\nFROM tuva.readmissions.readmission_summary\nWHERE index_admission_flag = 1", "relation_name": "tuva.data_quality.mart_review__readmissions"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:32.267041Z", "completed_at": "2025-02-25T21:26:32.366484Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:32.366773Z", "completed_at": "2025-02-25T21:26:32.366776Z"}], "thread_id": "Thread-1", "execution_time": 0.10109186172485352, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__readmissions_reference", "compiled": true, "compiled_code": "\n\nwith cte as (\nselect \n    cast('readmission rate' as TEXT) as analytics_measure\n    ,cast('readmissions' as TEXT) as analytics_concept\n    ,sum(unplanned_readmit_30_flag)/cast(count(*) as numeric(28,6) ) as data_source_value\nfrom tuva.readmissions.readmission_summary  r \nwhere index_admission_flag = 1\n)\n\nselect \n    m.analytics_concept as analytics_concept\n    ,m.analytics_measure as analytics_measure\n    ,cte.data_source_value\n    ,m.analytics_value\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.data_quality._value_set_reference_mart_analytics m \nleft join cte on cte.analytics_measure = m.analytics_measure\nand\nm.analytics_concept = cte.analytics_concept\nwhere m.analytics_concept = cast('readmissions' as TEXT)", "relation_name": "tuva.data_quality.data_quality_readmissions_reference"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:32.248799Z", "completed_at": "2025-02-25T21:26:32.790646Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:32.791333Z", "completed_at": "2025-02-25T21:26:32.791362Z"}], "thread_id": "Thread-4", "execution_time": 0.7318201065063477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__readmissions", "compiled": true, "compiled_code": "\n\n\nwith disqualified_unpivot as (\n    select\n        encounter_id,\n\n      cast('MISSING_ADMIT_DATE_FLAG' as TEXT) as disqualified_reason,\n      cast(  \n           MISSING_ADMIT_DATE_FLAG\n             \n           as TEXT) as flagvalue\n\n    from tuva.readmissions.encounter_augmented\n\n    union all\n    select\n        encounter_id,\n\n      cast('MISSING_DISCHARGE_DATE_FLAG' as TEXT) as disqualified_reason,\n      cast(  \n           MISSING_DISCHARGE_DATE_FLAG\n             \n           as TEXT) as flagvalue\n\n    from tuva.readmissions.encounter_augmented\n\n    union all\n    select\n        encounter_id,\n\n      cast('ADMIT_AFTER_DISCHARGE_FLAG' as TEXT) as disqualified_reason,\n      cast(  \n           ADMIT_AFTER_DISCHARGE_FLAG\n             \n           as TEXT) as flagvalue\n\n    from tuva.readmissions.encounter_augmented\n\n    union all\n    select\n        encounter_id,\n\n      cast('MISSING_DISCHARGE_DISPOSITION_CODE_FLAG' as TEXT) as disqualified_reason,\n      cast(  \n           MISSING_DISCHARGE_DISPOSITION_CODE_FLAG\n             \n           as TEXT) as flagvalue\n\n    from tuva.readmissions.encounter_augmented\n\n    union all\n    select\n        encounter_id,\n\n      cast('INVALID_DISCHARGE_DISPOSITION_CODE_FLAG' as TEXT) as disqualified_reason,\n      cast(  \n           INVALID_DISCHARGE_DISPOSITION_CODE_FLAG\n             \n           as TEXT) as flagvalue\n\n    from tuva.readmissions.encounter_augmented\n\n    union all\n    select\n        encounter_id,\n\n      cast('MISSING_PRIMARY_DIAGNOSIS_FLAG' as TEXT) as disqualified_reason,\n      cast(  \n           MISSING_PRIMARY_DIAGNOSIS_FLAG\n             \n           as TEXT) as flagvalue\n\n    from tuva.readmissions.encounter_augmented\n\n    union all\n    select\n        encounter_id,\n\n      cast('INVALID_PRIMARY_DIAGNOSIS_CODE_FLAG' as TEXT) as disqualified_reason,\n      cast(  \n           INVALID_PRIMARY_DIAGNOSIS_CODE_FLAG\n             \n           as TEXT) as flagvalue\n\n    from tuva.readmissions.encounter_augmented\n\n    union all\n    select\n        encounter_id,\n\n      cast('NO_DIAGNOSIS_CCS_FLAG' as TEXT) as disqualified_reason,\n      cast(  \n           NO_DIAGNOSIS_CCS_FLAG\n             \n           as TEXT) as flagvalue\n\n    from tuva.readmissions.encounter_augmented\n\n    union all\n    select\n        encounter_id,\n\n      cast('OVERLAPS_WITH_ANOTHER_ENCOUNTER_FLAG' as TEXT) as disqualified_reason,\n      cast(  \n           OVERLAPS_WITH_ANOTHER_ENCOUNTER_FLAG\n             \n           as TEXT) as flagvalue\n\n    from tuva.readmissions.encounter_augmented\n\n    union all\n    select\n        encounter_id,\n\n      cast('MISSING_DRG_FLAG' as TEXT) as disqualified_reason,\n      cast(  \n           MISSING_DRG_FLAG\n             \n           as TEXT) as flagvalue\n\n    from tuva.readmissions.encounter_augmented\n\n    union all\n    select\n        encounter_id,\n\n      cast('INVALID_DRG_FLAG' as TEXT) as disqualified_reason,\n      cast(  \n           INVALID_DRG_FLAG\n             \n           as TEXT) as flagvalue\n\n    from tuva.readmissions.encounter_augmented\n\n    \n)\n\n-- Using the transformed data to perform aggregation\nselect \n    'inpatient encounter ' || d.disqualified_reason as data_quality_check\n    ,  count(distinct encounter_id) as result_count\n      , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom disqualified_unpivot d\nwhere cast(flagvalue as integer ) = 1  \ngroup by disqualified_reason", "relation_name": "tuva.data_quality.data_quality_readmissions"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:32.208390Z", "completed_at": "2025-02-25T21:26:33.582641Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:33.582879Z", "completed_at": "2025-02-25T21:26:33.582891Z"}], "thread_id": "Thread-2", "execution_time": 1.5416429042816162, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.quality_measures__summary_long", "compiled": true, "compiled_code": "\n\n/* measures should already be at the full eligibility population grain */\nwith  __dbt__cte___stg_patient as (\n\nselect\n      person_id\n    , sex\n    , birth_date\n    , death_date\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.core.patient\n), union_measures as (\n\n    \n\n        (\n            select\n                cast('tuva.quality_measures._int_cqm438_long' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"PERSON_ID\" as character varying(16777216)) as \"PERSON_ID\" ,\n                    cast(\"DENOMINATOR_FLAG\" as NUMBER(38,0)) as \"DENOMINATOR_FLAG\" ,\n                    cast(\"NUMERATOR_FLAG\" as NUMBER(38,0)) as \"NUMERATOR_FLAG\" ,\n                    cast(\"EXCLUSION_FLAG\" as NUMBER(38,0)) as \"EXCLUSION_FLAG\" ,\n                    cast(\"EVIDENCE_DATE\" as DATE) as \"EVIDENCE_DATE\" ,\n                    cast(\"EVIDENCE_VALUE\" as character varying(16777216)) as \"EVIDENCE_VALUE\" ,\n                    cast(\"EXCLUSION_DATE\" as DATE) as \"EXCLUSION_DATE\" ,\n                    cast(\"EXCLUSION_REASON\" as character varying(16777216)) as \"EXCLUSION_REASON\" ,\n                    cast(\"PERFORMANCE_PERIOD_BEGIN\" as DATE) as \"PERFORMANCE_PERIOD_BEGIN\" ,\n                    cast(\"PERFORMANCE_PERIOD_END\" as DATE) as \"PERFORMANCE_PERIOD_END\" ,\n                    cast(\"MEASURE_ID\" as character varying(16777216)) as \"MEASURE_ID\" ,\n                    cast(\"MEASURE_NAME\" as character varying(16777216)) as \"MEASURE_NAME\" ,\n                    cast(\"MEASURE_VERSION\" as character varying(16777216)) as \"MEASURE_VERSION\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.quality_measures._int_cqm438_long\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.quality_measures._int_cqm130_long' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"PERSON_ID\" as character varying(16777216)) as \"PERSON_ID\" ,\n                    cast(\"DENOMINATOR_FLAG\" as NUMBER(38,0)) as \"DENOMINATOR_FLAG\" ,\n                    cast(\"NUMERATOR_FLAG\" as NUMBER(38,0)) as \"NUMERATOR_FLAG\" ,\n                    cast(\"EXCLUSION_FLAG\" as NUMBER(38,0)) as \"EXCLUSION_FLAG\" ,\n                    cast(\"EVIDENCE_DATE\" as DATE) as \"EVIDENCE_DATE\" ,\n                    cast(\"EVIDENCE_VALUE\" as character varying(16777216)) as \"EVIDENCE_VALUE\" ,\n                    cast(\"EXCLUSION_DATE\" as DATE) as \"EXCLUSION_DATE\" ,\n                    cast(\"EXCLUSION_REASON\" as character varying(16777216)) as \"EXCLUSION_REASON\" ,\n                    cast(\"PERFORMANCE_PERIOD_BEGIN\" as DATE) as \"PERFORMANCE_PERIOD_BEGIN\" ,\n                    cast(\"PERFORMANCE_PERIOD_END\" as DATE) as \"PERFORMANCE_PERIOD_END\" ,\n                    cast(\"MEASURE_ID\" as character varying(16777216)) as \"MEASURE_ID\" ,\n                    cast(\"MEASURE_NAME\" as character varying(16777216)) as \"MEASURE_NAME\" ,\n                    cast(\"MEASURE_VERSION\" as character varying(16777216)) as \"MEASURE_VERSION\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.quality_measures._int_cqm130_long\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.quality_measures._int_nqf0420_long' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"PERSON_ID\" as character varying(16777216)) as \"PERSON_ID\" ,\n                    cast(\"DENOMINATOR_FLAG\" as NUMBER(38,0)) as \"DENOMINATOR_FLAG\" ,\n                    cast(\"NUMERATOR_FLAG\" as NUMBER(38,0)) as \"NUMERATOR_FLAG\" ,\n                    cast(\"EXCLUSION_FLAG\" as NUMBER(38,0)) as \"EXCLUSION_FLAG\" ,\n                    cast(\"EVIDENCE_DATE\" as DATE) as \"EVIDENCE_DATE\" ,\n                    cast(\"EVIDENCE_VALUE\" as character varying(16777216)) as \"EVIDENCE_VALUE\" ,\n                    cast(\"EXCLUSION_DATE\" as DATE) as \"EXCLUSION_DATE\" ,\n                    cast(\"EXCLUSION_REASON\" as character varying(16777216)) as \"EXCLUSION_REASON\" ,\n                    cast(\"PERFORMANCE_PERIOD_BEGIN\" as DATE) as \"PERFORMANCE_PERIOD_BEGIN\" ,\n                    cast(\"PERFORMANCE_PERIOD_END\" as DATE) as \"PERFORMANCE_PERIOD_END\" ,\n                    cast(\"MEASURE_ID\" as character varying(16777216)) as \"MEASURE_ID\" ,\n                    cast(\"MEASURE_NAME\" as character varying(16777216)) as \"MEASURE_NAME\" ,\n                    cast(\"MEASURE_VERSION\" as character varying(16777216)) as \"MEASURE_VERSION\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.quality_measures._int_nqf0420_long\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.quality_measures._int_adh_diabetes_long' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"PERSON_ID\" as character varying(16777216)) as \"PERSON_ID\" ,\n                    cast(\"DENOMINATOR_FLAG\" as NUMBER(38,0)) as \"DENOMINATOR_FLAG\" ,\n                    cast(\"NUMERATOR_FLAG\" as NUMBER(38,0)) as \"NUMERATOR_FLAG\" ,\n                    cast(\"EXCLUSION_FLAG\" as NUMBER(38,0)) as \"EXCLUSION_FLAG\" ,\n                    cast(\"EVIDENCE_DATE\" as DATE) as \"EVIDENCE_DATE\" ,\n                    cast(\"EVIDENCE_VALUE\" as character varying(16777216)) as \"EVIDENCE_VALUE\" ,\n                    cast(\"EXCLUSION_DATE\" as DATE) as \"EXCLUSION_DATE\" ,\n                    cast(\"EXCLUSION_REASON\" as character varying(16777216)) as \"EXCLUSION_REASON\" ,\n                    cast(\"PERFORMANCE_PERIOD_BEGIN\" as DATE) as \"PERFORMANCE_PERIOD_BEGIN\" ,\n                    cast(\"PERFORMANCE_PERIOD_END\" as DATE) as \"PERFORMANCE_PERIOD_END\" ,\n                    cast(\"MEASURE_ID\" as character varying(16777216)) as \"MEASURE_ID\" ,\n                    cast(\"MEASURE_NAME\" as character varying(16777216)) as \"MEASURE_NAME\" ,\n                    cast(\"MEASURE_VERSION\" as character varying(16777216)) as \"MEASURE_VERSION\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.quality_measures._int_adh_diabetes_long\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.quality_measures._int_adhras_long' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"PERSON_ID\" as character varying(16777216)) as \"PERSON_ID\" ,\n                    cast(\"DENOMINATOR_FLAG\" as NUMBER(38,0)) as \"DENOMINATOR_FLAG\" ,\n                    cast(\"NUMERATOR_FLAG\" as NUMBER(38,0)) as \"NUMERATOR_FLAG\" ,\n                    cast(\"EXCLUSION_FLAG\" as NUMBER(38,0)) as \"EXCLUSION_FLAG\" ,\n                    cast(\"EVIDENCE_DATE\" as DATE) as \"EVIDENCE_DATE\" ,\n                    cast(\"EVIDENCE_VALUE\" as character varying(16777216)) as \"EVIDENCE_VALUE\" ,\n                    cast(\"EXCLUSION_DATE\" as DATE) as \"EXCLUSION_DATE\" ,\n                    cast(\"EXCLUSION_REASON\" as character varying(16777216)) as \"EXCLUSION_REASON\" ,\n                    cast(\"PERFORMANCE_PERIOD_BEGIN\" as DATE) as \"PERFORMANCE_PERIOD_BEGIN\" ,\n                    cast(\"PERFORMANCE_PERIOD_END\" as DATE) as \"PERFORMANCE_PERIOD_END\" ,\n                    cast(\"MEASURE_ID\" as character varying(16777216)) as \"MEASURE_ID\" ,\n                    cast(\"MEASURE_NAME\" as character varying(16777216)) as \"MEASURE_NAME\" ,\n                    cast(\"MEASURE_VERSION\" as character varying(16777216)) as \"MEASURE_VERSION\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.quality_measures._int_adhras_long\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.quality_measures._int_supd_long' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"PERSON_ID\" as character varying(16777216)) as \"PERSON_ID\" ,\n                    cast(\"DENOMINATOR_FLAG\" as NUMBER(38,0)) as \"DENOMINATOR_FLAG\" ,\n                    cast(\"NUMERATOR_FLAG\" as NUMBER(38,0)) as \"NUMERATOR_FLAG\" ,\n                    cast(\"EXCLUSION_FLAG\" as NUMBER(38,0)) as \"EXCLUSION_FLAG\" ,\n                    cast(\"EVIDENCE_DATE\" as DATE) as \"EVIDENCE_DATE\" ,\n                    cast(\"EVIDENCE_VALUE\" as character varying(16777216)) as \"EVIDENCE_VALUE\" ,\n                    cast(\"EXCLUSION_DATE\" as DATE) as \"EXCLUSION_DATE\" ,\n                    cast(\"EXCLUSION_REASON\" as character varying(16777216)) as \"EXCLUSION_REASON\" ,\n                    cast(\"PERFORMANCE_PERIOD_BEGIN\" as DATE) as \"PERFORMANCE_PERIOD_BEGIN\" ,\n                    cast(\"PERFORMANCE_PERIOD_END\" as DATE) as \"PERFORMANCE_PERIOD_END\" ,\n                    cast(\"MEASURE_ID\" as character varying(16777216)) as \"MEASURE_ID\" ,\n                    cast(\"MEASURE_NAME\" as character varying(16777216)) as \"MEASURE_NAME\" ,\n                    cast(\"MEASURE_VERSION\" as character varying(16777216)) as \"MEASURE_VERSION\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.quality_measures._int_supd_long\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.quality_measures._int_adh_statins_long' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"PERSON_ID\" as character varying(16777216)) as \"PERSON_ID\" ,\n                    cast(\"DENOMINATOR_FLAG\" as NUMBER(38,0)) as \"DENOMINATOR_FLAG\" ,\n                    cast(\"NUMERATOR_FLAG\" as NUMBER(38,0)) as \"NUMERATOR_FLAG\" ,\n                    cast(\"EXCLUSION_FLAG\" as NUMBER(38,0)) as \"EXCLUSION_FLAG\" ,\n                    cast(\"EVIDENCE_DATE\" as DATE) as \"EVIDENCE_DATE\" ,\n                    cast(\"EVIDENCE_VALUE\" as character varying(16777216)) as \"EVIDENCE_VALUE\" ,\n                    cast(\"EXCLUSION_DATE\" as DATE) as \"EXCLUSION_DATE\" ,\n                    cast(\"EXCLUSION_REASON\" as character varying(16777216)) as \"EXCLUSION_REASON\" ,\n                    cast(\"PERFORMANCE_PERIOD_BEGIN\" as DATE) as \"PERFORMANCE_PERIOD_BEGIN\" ,\n                    cast(\"PERFORMANCE_PERIOD_END\" as DATE) as \"PERFORMANCE_PERIOD_END\" ,\n                    cast(\"MEASURE_ID\" as character varying(16777216)) as \"MEASURE_ID\" ,\n                    cast(\"MEASURE_NAME\" as character varying(16777216)) as \"MEASURE_NAME\" ,\n                    cast(\"MEASURE_VERSION\" as character varying(16777216)) as \"MEASURE_VERSION\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(32)) as \"TUVA_LAST_RUN\" \n\n            from tuva.quality_measures._int_adh_statins_long\n\n            \n        )\n\n        \n\n)\n\n, patient as (\n\n    select distinct person_id\n    from __dbt__cte___stg_patient\n\n)\n\n/* selecting the full patient population as the grain of this table */\n, joined as (\n\n    select distinct\n          patient.person_id\n        , union_measures.denominator_flag\n        , union_measures.numerator_flag\n        , union_measures.exclusion_flag\n        , case\n            when union_measures.exclusion_flag = 1 then null\n            when union_measures.numerator_flag = 1 then 1\n            when union_measures.denominator_flag = 1 then 0\n            else null\n          end as performance_flag\n        , union_measures.evidence_date\n        , union_measures.evidence_value\n        , union_measures.exclusion_date\n        , union_measures.exclusion_reason\n        , union_measures.performance_period_begin\n        , union_measures.performance_period_end\n        , union_measures.measure_id\n        , union_measures.measure_name\n        , union_measures.measure_version\n    from patient\n        left join union_measures\n            on patient.person_id = union_measures.person_id\n)\n\n, add_data_types as (\n\n    select\n          cast(person_id as TEXT) as person_id\n        , cast(denominator_flag as integer) as denominator_flag\n        , cast(numerator_flag as integer) as numerator_flag\n        , cast(exclusion_flag as integer) as exclusion_flag\n        , cast(performance_flag as integer) as performance_flag\n        , cast(evidence_date as date) as evidence_date\n        , cast(evidence_value as TEXT) as evidence_value\n        , cast(exclusion_date as date) as exclusion_date\n        , cast(exclusion_reason as TEXT) as exclusion_reason\n        , cast(performance_period_begin as date) as performance_period_begin\n        , cast(performance_period_end as date) as performance_period_end\n        , cast(measure_id as TEXT) as measure_id\n        , cast(measure_name as TEXT) as measure_name\n        , cast(measure_version as TEXT) as measure_version\n    from joined\n\n)\n\nselect\n      person_id\n    , denominator_flag\n    , numerator_flag\n    , exclusion_flag\n    , performance_flag\n    , evidence_date\n    , evidence_value\n    , exclusion_date\n    , exclusion_reason\n    , performance_period_begin\n    , performance_period_end\n    , measure_id\n    , measure_name\n    , measure_version\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.quality_measures.summary_long"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:33.745185Z", "completed_at": "2025-02-25T21:26:33.775516Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:33.776578Z", "completed_at": "2025-02-25T21:26:33.776589Z"}], "thread_id": "Thread-3", "execution_time": 0.035630226135253906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.mart_review__quality_measures_summary_long", "compiled": true, "compiled_code": "\n\n\nselect *\nfrom tuva.quality_measures.summary_long s", "relation_name": "tuva.data_quality.mart_review__quality_measures_summary_long"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:33.753285Z", "completed_at": "2025-02-25T21:26:33.777459Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:33.777804Z", "completed_at": "2025-02-25T21:26:33.777810Z"}], "thread_id": "Thread-1", "execution_time": 0.035256147384643555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.quality_measures__summary_counts", "compiled": true, "compiled_code": "\n\nwith summary_long as (\n\n    select\n          measure_id\n        , measure_name\n        , measure_version\n        , performance_period_begin\n        , performance_period_end\n        , denominator_flag\n        , numerator_flag\n        , exclusion_flag\n        , performance_flag\n    from tuva.quality_measures.summary_long\n    where measure_id is not null\n\n)\n\n, calculate_performance_rate  as (\n\n    select\n          measure_id\n        , measure_name\n        , measure_version\n        , performance_period_begin\n        , performance_period_end\n        , sum(denominator_flag) as denominator_sum\n        , sum(numerator_flag) as numerator_sum\n        , sum(exclusion_flag) as exclusion_sum\n        , (\n            cast(sum(performance_flag) as numeric(28,6)) /\n                (cast(count(performance_flag) as numeric(28,6)) )\n          )*100 as performance_rate\n    from summary_long\n    group by\n          measure_id\n        , measure_name\n        , measure_version\n        , performance_period_begin\n        , performance_period_end\n\n)\n\n, add_data_types as (\n\n    select\n          cast(measure_id as TEXT) as measure_id\n        , cast(measure_name as TEXT) as measure_name\n        , cast(measure_version as TEXT) as measure_version\n        , cast(performance_period_begin as date) as performance_period_begin\n        , cast(performance_period_end as date) as performance_period_end\n        , cast(denominator_sum as integer) as denominator_sum\n        , cast(numerator_sum as integer) as numerator_sum\n        , cast(exclusion_sum as integer) as exclusion_sum\n        , round(cast(performance_rate as numeric(28,6)),3) as performance_rate\n    from calculate_performance_rate\n\n)\n\nselect\n      measure_id\n    , measure_name\n    , measure_version\n    , performance_period_begin\n    , performance_period_end\n    , denominator_sum\n    , numerator_sum\n    , exclusion_sum\n    , performance_rate\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.quality_measures.summary_counts"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:33.763424Z", "completed_at": "2025-02-25T21:26:33.778442Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:33.778823Z", "completed_at": "2025-02-25T21:26:33.778829Z"}], "thread_id": "Thread-4", "execution_time": 0.03521990776062012, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.quality_measures__summary_wide", "compiled": true, "compiled_code": "\n\n/*\n    Each measure is pivoted into a boolean column by evaluating the\n    denominator, numerator, and exclusion flags.\n*/\nwith measures_long as (\n\n        select\n          person_id\n        , denominator_flag\n        , numerator_flag\n        , exclusion_flag\n        , performance_flag\n        , measure_id\n    from tuva.quality_measures.summary_long\n\n)\n\n, cqm_438 as (\n\n    select\n          person_id\n        , performance_flag\n    from measures_long\n    where measure_id = 'CQM438'\n\n)\n\n, cqm_130 as (\n\n    select\n          person_id\n        , performance_flag\n    from measures_long\n    where measure_id = 'CQM130'\n\n)\n\n, nqf_0420 as (\n\n    select\n          person_id\n        , performance_flag\n    from measures_long\n    where measure_id = 'NQF0420'\n\n)\n\n, adh_diabetes as (\n\n    select\n          person_id\n        , performance_flag\n    from measures_long\n    where measure_id = 'ADH-Diabetes'\n\n)\n\n, adh_ras as (\n\n    select\n          person_id\n        , performance_flag\n    from measures_long\n    where measure_id = 'ADH-RAS'\n    \n)\n\n, supd as (\n\n    select\n          person_id\n        , performance_flag\n    from measures_long\n    where measure_id = 'SUPD'\n\n)\n\n, adh_statins as (\n\n    select\n          person_id\n        , performance_flag\n    from measures_long\n    where measure_id = 'ADH-Statins'\n\n)\n\n, joined as (\n\n    select\n          measures_long.person_id\n        , max(cqm_438.performance_flag) as cqm_438\n        , max(cqm_130.performance_flag) as cqm_130\n        , max(nqf_0420.performance_flag) as nqf_0420\n        , max(adh_diabetes.performance_flag) as adh_diabetes\n        , max(adh_ras.performance_flag) as adh_ras\n        , max(supd.performance_flag) as supd\n        , max(adh_statins.performance_flag) as adh_statins\n    from measures_long\n        left join cqm_438\n            on measures_long.person_id = cqm_438.person_id\n        left join cqm_130\n            on measures_long.person_id = cqm_130.person_id\n        left join nqf_0420\n            on measures_long.person_id = nqf_0420.person_id\n        left join adh_diabetes\n            on measures_long.person_id = adh_diabetes.person_id\n        left join adh_ras\n            on measures_long.person_id = adh_ras.person_id\n        left join supd\n            on measures_long.person_id = supd.person_id\n        left join adh_statins\n            on measures_long.person_id = adh_statins.person_id\n    group by measures_long.person_id\n\n)\n\n, add_data_types as (\n\n    select\n          cast(person_id as TEXT) as person_id\n        , cast(cqm_438 as integer) as cqm_438\n        , cast(cqm_130 as integer) as cqm_130\n        , cast(nqf_0420 as integer) as nqf_0420\n        , cast(adh_diabetes as integer) as adh_diabetes\n        , cast(adh_ras as integer) as adh_ras\n        , cast(supd as integer) as supd\n        , cast(adh_statins as integer) as adh_statins\n    from joined\n\n)\n\nselect\n      person_id\n    , adh_diabetes\n    , adh_ras\n    , adh_statins\n    , cqm_130\n    , cqm_438\n    , nqf_0420\n    , supd\n    , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom add_data_types", "relation_name": "tuva.quality_measures.summary_wide"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:33.769873Z", "completed_at": "2025-02-25T21:26:33.779367Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:33.780446Z", "completed_at": "2025-02-25T21:26:33.780450Z"}], "thread_id": "Thread-2", "execution_time": 0.03631901741027832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__analytics_populated", "compiled": true, "compiled_code": "\n\nwith tuva_chronic_condition_long as (\n  select\n      'tuva_chronic_condition_long' as table_name\n    , count(*) as record_count\n  from tuva.chronic_conditions.tuva_chronic_conditions_long\n)\n\n, cms_hcc_patient_risk_factors as (\n  select\n      'cms_hcc__patient_risk_factors' as table_name\n    , count(*) as record_count\n  from tuva.cms_hcc.patient_risk_factors\n)\n\n, service_category_grouper as (\n  select\n      'service_category__service_category_grouper' as table_name\n    , count(*) as record_count\n  from tuva.claims_preprocessing.service_category_grouper\n)\n\n, financial_pmpm_payer as (\n  select\n      'financial_pmpm__pmpm_payer' as table_name\n    , count(*) as record_count\n  from tuva.financial_pmpm.pmpm_payer\n)\n\n, readmission_summary as (\n  select\n      'readmissions__readmission_summary' as table_name\n    , count(*) as record_count\n  from tuva.readmissions.readmission_summary\n)\n\n, quality_measures_summary_long as (\n  select\n      'quality_measures__summary_long' as table_name\n    , count(*) as record_count\n  from tuva.quality_measures.summary_long\n)\n\n, acute_inpatient_visits as (\n  select\n      'acute_inpatient_visits' as table_name\n    , count(*) as record_count\n  from tuva.core.encounter\n  where encounter_type = 'acute inpatient'\n)\n\n, ed_visits as (\n  select\n      'ed_visits' as table_name\n    , count(*) as record_count\n  from tuva.core.encounter\n  where encounter_type = 'emergency department'\n)\n\n,final as (\nselect * from tuva_chronic_condition_long\nunion all\nselect * from cms_hcc_patient_risk_factors\nunion all\nselect * from service_category_grouper\nunion all\nselect * from financial_pmpm_payer\nunion all\nselect * from readmission_summary\nunion all\nselect * from quality_measures_summary_long\nunion all\nselect * from acute_inpatient_visits\nunion all\nselect * from ed_visits\n)\n\nselect *\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom final", "relation_name": "tuva.data_quality.analytics_populated"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:33.782196Z", "completed_at": "2025-02-25T21:26:33.791304Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:33.791589Z", "completed_at": "2025-02-25T21:26:33.791595Z"}], "thread_id": "Thread-3", "execution_time": 0.010711908340454102, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__quality_measures", "compiled": true, "compiled_code": "\n\nwith cte as (\nselect sum(case when numerator_sum = 0 then 1 else 0 end) as numerator_zero_count\n,sum(case when denominator_sum = 0 then 1 else 0 end) as denominator_zero_count\nfrom tuva.quality_measures.summary_counts \n)\n\n,final as (\nselect 'quality measure numerator zero' as data_quality_check\n,numerator_zero_count as result_count\nfrom cte \n\nunion all \n\nselect 'quality measure denominator zero' as data_quality_check\n,denominator_zero_count as result_count\nfrom cte\n)\n\nselect *\n, '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom final", "relation_name": "tuva.data_quality.data_quality_quality_measures"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:33.786451Z", "completed_at": "2025-02-25T21:26:33.792117Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:33.792406Z", "completed_at": "2025-02-25T21:26:33.792411Z"}], "thread_id": "Thread-1", "execution_time": 0.011209964752197266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__quality_measures_reference", "compiled": true, "compiled_code": "\n\nwith cte as (\nselect \n    cast('quality measures' as TEXT) as analytics_concept\n    ,measure_name as analytics_measure\n    ,performance_rate as data_source_value\nfrom tuva.quality_measures.summary_counts  r \n)\n\nselect \n    m.analytics_concept as analytics_concept\n    ,m.analytics_measure as analytics_measure\n    ,cte.data_source_value\n    ,m.analytics_value\n      , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom tuva.data_quality._value_set_reference_mart_analytics m \nleft join cte on cte.analytics_measure = m.analytics_measure\nand\nm.analytics_concept = cte.analytics_concept\nwhere m.analytics_concept = cast('quality measures' as TEXT)", "relation_name": "tuva.data_quality.data_quality_quality_measures_reference"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:33.794264Z", "completed_at": "2025-02-25T21:26:35.149505Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:35.150076Z", "completed_at": "2025-02-25T21:26:35.150090Z"}], "thread_id": "Thread-4", "execution_time": 1.515657901763916, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__analytics_checks_summary", "compiled": true, "compiled_code": "\n\nwith unioned_data as (\n\n  -- Unioning multiple data quality checks, excluding the _loaded_at field\n  \n\n        (\n            select\n                cast('tuva.data_quality.data_quality_readmissions' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"DATA_QUALITY_CHECK\" as character varying(16777216)) as \"DATA_QUALITY_CHECK\" ,\n                    cast(\"RESULT_COUNT\" as NUMBER(18,0)) as \"RESULT_COUNT\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(16777216)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as character varying(256)) as \"MEDICARE_LDS_REFERENCE\" ,\n                    cast(null as NUMBER(1,0)) as \"NORMALLY_ZERO\" \n\n            from tuva.data_quality.data_quality_readmissions\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.data_quality.chronic_conditions_none' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"DATA_QUALITY_CHECK\" as character varying(16777216)) as \"DATA_QUALITY_CHECK\" ,\n                    cast(\"RESULT_COUNT\" as NUMBER(18,0)) as \"RESULT_COUNT\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(16777216)) as \"TUVA_LAST_RUN\" ,\n                    cast(\"MEDICARE_LDS_REFERENCE\" as character varying(256)) as \"MEDICARE_LDS_REFERENCE\" ,\n                    cast(\"NORMALLY_ZERO\" as NUMBER(1,0)) as \"NORMALLY_ZERO\" \n\n            from tuva.data_quality.chronic_conditions_none\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.data_quality.data_quality_cms_hcc' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"DATA_QUALITY_CHECK\" as character varying(16777216)) as \"DATA_QUALITY_CHECK\" ,\n                    cast(\"RESULT_COUNT\" as NUMBER(18,0)) as \"RESULT_COUNT\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(16777216)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as character varying(256)) as \"MEDICARE_LDS_REFERENCE\" ,\n                    cast(null as NUMBER(1,0)) as \"NORMALLY_ZERO\" \n\n            from tuva.data_quality.data_quality_cms_hcc\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.data_quality.data_quality_quality_measures' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"DATA_QUALITY_CHECK\" as character varying(16777216)) as \"DATA_QUALITY_CHECK\" ,\n                    cast(\"RESULT_COUNT\" as NUMBER(18,0)) as \"RESULT_COUNT\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(16777216)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as character varying(256)) as \"MEDICARE_LDS_REFERENCE\" ,\n                    cast(null as NUMBER(1,0)) as \"NORMALLY_ZERO\" \n\n            from tuva.data_quality.data_quality_quality_measures\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.data_quality.encounters_missing_groups_union' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"DATA_QUALITY_CHECK\" as character varying(16777216)) as \"DATA_QUALITY_CHECK\" ,\n                    cast(\"RESULT_COUNT\" as NUMBER(18,0)) as \"RESULT_COUNT\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(16777216)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as character varying(256)) as \"MEDICARE_LDS_REFERENCE\" ,\n                    cast(null as NUMBER(1,0)) as \"NORMALLY_ZERO\" \n\n            from tuva.data_quality.encounters_missing_groups_union\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.data_quality.data_quality_acute_inpatient' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"DATA_QUALITY_CHECK\" as character varying(16777216)) as \"DATA_QUALITY_CHECK\" ,\n                    cast(\"RESULT_COUNT\" as NUMBER(18,0)) as \"RESULT_COUNT\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(16777216)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as character varying(256)) as \"MEDICARE_LDS_REFERENCE\" ,\n                    cast(null as NUMBER(1,0)) as \"NORMALLY_ZERO\" \n\n            from tuva.data_quality.data_quality_acute_inpatient\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.data_quality.data_quality_ed_classification' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"DATA_QUALITY_CHECK\" as character varying(16777216)) as \"DATA_QUALITY_CHECK\" ,\n                    cast(\"RESULT_COUNT\" as NUMBER(18,0)) as \"RESULT_COUNT\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(16777216)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as character varying(256)) as \"MEDICARE_LDS_REFERENCE\" ,\n                    cast(null as NUMBER(1,0)) as \"NORMALLY_ZERO\" \n\n            from tuva.data_quality.data_quality_ed_classification\n\n            \n        )\n\n        \n\n)\n\nselect\n  data_quality_check\n  , coalesce(result_count,0) as result_count\n  , coalesce(normally_zero ,1) as normally_zero\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom unioned_data", "relation_name": "tuva.data_quality.analytics_checks_summary"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:35.316925Z", "completed_at": "2025-02-25T21:26:35.333574Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:35.334697Z", "completed_at": "2025-02-25T21:26:35.334709Z"}], "thread_id": "Thread-2", "execution_time": 0.02133798599243164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.not_null_data_quality__analytics_checks_summary_data_quality_check.91ca1cc43a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect data_quality_check\nfrom tuva.data_quality.analytics_checks_summary\nwhere data_quality_check is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:35.326076Z", "completed_at": "2025-02-25T21:26:35.334110Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:35.335728Z", "completed_at": "2025-02-25T21:26:35.335736Z"}], "thread_id": "Thread-1", "execution_time": 0.021293163299560547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.the_tuva_project.unique_data_quality__analytics_checks_summary_data_quality_check.1150c178a0", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    data_quality_check as unique_field,\n    count(*) as n_records\n\nfrom tuva.data_quality.analytics_checks_summary\nwhere data_quality_check is not null\ngroup by data_quality_check\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-02-25T21:26:33.801718Z", "completed_at": "2025-02-25T21:26:35.421342Z"}, {"name": "execute", "started_at": "2025-02-25T21:26:35.421592Z", "completed_at": "2025-02-25T21:26:35.421600Z"}], "thread_id": "Thread-3", "execution_time": 1.775970220565796, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.the_tuva_project.data_quality__analytics_reference_summary", "compiled": true, "compiled_code": "\n\nwith unioned_data as (\n\n  -- Unioning multiple data quality checks, excluding the _loaded_at field\n  \n\n        (\n            select\n                cast('tuva.data_quality.data_quality_readmissions_reference' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"ANALYTICS_CONCEPT\" as character varying(16777216)) as \"ANALYTICS_CONCEPT\" ,\n                    cast(\"ANALYTICS_MEASURE\" as character varying(16777216)) as \"ANALYTICS_MEASURE\" ,\n                    cast(\"DATA_SOURCE_VALUE\" as NUMBER(25,6)) as \"DATA_SOURCE_VALUE\" ,\n                    cast(\"ANALYTICS_VALUE\" as character varying(256)) as \"ANALYTICS_VALUE\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(16777216)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as NUMBER(18,0)) as \"PATIENTS\" ,\n                    cast(null as NUMBER(18,0)) as \"VALUE_RANK\" ,\n                    cast(null as NUMBER(38,0)) as \"MEDICARE_LDS_CONDITION_RANK\" ,\n                    cast(null as character varying(16777216)) as \"ENCOUNTER_GROUP\" ,\n                    cast(null as NUMBER(38,6)) as \"TOTAL_PAID\" ,\n                    cast(null as NUMBER(38,12)) as \"MEMBER_MONTHS\" \n\n            from tuva.data_quality.data_quality_readmissions_reference\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.data_quality.data_quality_cms_hcc_reference' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"ANALYTICS_CONCEPT\" as character varying(16777216)) as \"ANALYTICS_CONCEPT\" ,\n                    cast(\"ANALYTICS_MEASURE\" as character varying(16777216)) as \"ANALYTICS_MEASURE\" ,\n                    cast(\"DATA_SOURCE_VALUE\" as NUMBER(25,6)) as \"DATA_SOURCE_VALUE\" ,\n                    cast(\"ANALYTICS_VALUE\" as character varying(256)) as \"ANALYTICS_VALUE\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(16777216)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as NUMBER(18,0)) as \"PATIENTS\" ,\n                    cast(null as NUMBER(18,0)) as \"VALUE_RANK\" ,\n                    cast(null as NUMBER(38,0)) as \"MEDICARE_LDS_CONDITION_RANK\" ,\n                    cast(null as character varying(16777216)) as \"ENCOUNTER_GROUP\" ,\n                    cast(null as NUMBER(38,6)) as \"TOTAL_PAID\" ,\n                    cast(null as NUMBER(38,12)) as \"MEMBER_MONTHS\" \n\n            from tuva.data_quality.data_quality_cms_hcc_reference\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.data_quality.chronic_conditions_prevalence' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"ANALYTICS_CONCEPT\" as character varying(16777216)) as \"ANALYTICS_CONCEPT\" ,\n                    cast(\"ANALYTICS_MEASURE\" as character varying(16777216)) as \"ANALYTICS_MEASURE\" ,\n                    cast(\"DATA_SOURCE_VALUE\" as NUMBER(25,6)) as \"DATA_SOURCE_VALUE\" ,\n                    cast(\"ANALYTICS_VALUE\" as character varying(256)) as \"ANALYTICS_VALUE\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(16777216)) as \"TUVA_LAST_RUN\" ,\n                    cast(\"PATIENTS\" as NUMBER(18,0)) as \"PATIENTS\" ,\n                    cast(\"VALUE_RANK\" as NUMBER(18,0)) as \"VALUE_RANK\" ,\n                    cast(\"MEDICARE_LDS_CONDITION_RANK\" as NUMBER(38,0)) as \"MEDICARE_LDS_CONDITION_RANK\" ,\n                    cast(null as character varying(16777216)) as \"ENCOUNTER_GROUP\" ,\n                    cast(null as NUMBER(38,6)) as \"TOTAL_PAID\" ,\n                    cast(null as NUMBER(38,12)) as \"MEMBER_MONTHS\" \n\n            from tuva.data_quality.chronic_conditions_prevalence\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.data_quality.data_quality_quality_measures_reference' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"ANALYTICS_CONCEPT\" as character varying(16777216)) as \"ANALYTICS_CONCEPT\" ,\n                    cast(\"ANALYTICS_MEASURE\" as character varying(16777216)) as \"ANALYTICS_MEASURE\" ,\n                    cast(\"DATA_SOURCE_VALUE\" as NUMBER(25,6)) as \"DATA_SOURCE_VALUE\" ,\n                    cast(\"ANALYTICS_VALUE\" as character varying(256)) as \"ANALYTICS_VALUE\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(16777216)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as NUMBER(18,0)) as \"PATIENTS\" ,\n                    cast(null as NUMBER(18,0)) as \"VALUE_RANK\" ,\n                    cast(null as NUMBER(38,0)) as \"MEDICARE_LDS_CONDITION_RANK\" ,\n                    cast(null as character varying(16777216)) as \"ENCOUNTER_GROUP\" ,\n                    cast(null as NUMBER(38,6)) as \"TOTAL_PAID\" ,\n                    cast(null as NUMBER(38,12)) as \"MEMBER_MONTHS\" \n\n            from tuva.data_quality.data_quality_quality_measures_reference\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.data_quality.data_quality_acute_inpatient_reference' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"ANALYTICS_CONCEPT\" as character varying(16777216)) as \"ANALYTICS_CONCEPT\" ,\n                    cast(\"ANALYTICS_MEASURE\" as character varying(16777216)) as \"ANALYTICS_MEASURE\" ,\n                    cast(\"DATA_SOURCE_VALUE\" as NUMBER(25,6)) as \"DATA_SOURCE_VALUE\" ,\n                    cast(\"ANALYTICS_VALUE\" as character varying(256)) as \"ANALYTICS_VALUE\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(16777216)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as NUMBER(18,0)) as \"PATIENTS\" ,\n                    cast(null as NUMBER(18,0)) as \"VALUE_RANK\" ,\n                    cast(null as NUMBER(38,0)) as \"MEDICARE_LDS_CONDITION_RANK\" ,\n                    cast(null as character varying(16777216)) as \"ENCOUNTER_GROUP\" ,\n                    cast(null as NUMBER(38,6)) as \"TOTAL_PAID\" ,\n                    cast(null as NUMBER(38,12)) as \"MEMBER_MONTHS\" \n\n            from tuva.data_quality.data_quality_acute_inpatient_reference\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.data_quality.data_quality_acute_inpatient_prevalence' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"ANALYTICS_CONCEPT\" as character varying(16777216)) as \"ANALYTICS_CONCEPT\" ,\n                    cast(\"ANALYTICS_MEASURE\" as character varying(16777216)) as \"ANALYTICS_MEASURE\" ,\n                    cast(\"DATA_SOURCE_VALUE\" as NUMBER(25,6)) as \"DATA_SOURCE_VALUE\" ,\n                    cast(\"ANALYTICS_VALUE\" as character varying(256)) as \"ANALYTICS_VALUE\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(16777216)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as NUMBER(18,0)) as \"PATIENTS\" ,\n                    cast(\"VALUE_RANK\" as NUMBER(18,0)) as \"VALUE_RANK\" ,\n                    cast(null as NUMBER(38,0)) as \"MEDICARE_LDS_CONDITION_RANK\" ,\n                    cast(null as character varying(16777216)) as \"ENCOUNTER_GROUP\" ,\n                    cast(null as NUMBER(38,6)) as \"TOTAL_PAID\" ,\n                    cast(null as NUMBER(38,12)) as \"MEMBER_MONTHS\" \n\n            from tuva.data_quality.data_quality_acute_inpatient_prevalence\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.data_quality.encounters_cost_and_utilization' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"ANALYTICS_CONCEPT\" as character varying(16777216)) as \"ANALYTICS_CONCEPT\" ,\n                    cast(\"ANALYTICS_MEASURE\" as character varying(16777216)) as \"ANALYTICS_MEASURE\" ,\n                    cast(\"DATA_SOURCE_VALUE\" as NUMBER(25,6)) as \"DATA_SOURCE_VALUE\" ,\n                    cast(\"ANALYTICS_VALUE\" as character varying(256)) as \"ANALYTICS_VALUE\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(16777216)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as NUMBER(18,0)) as \"PATIENTS\" ,\n                    cast(null as NUMBER(18,0)) as \"VALUE_RANK\" ,\n                    cast(null as NUMBER(38,0)) as \"MEDICARE_LDS_CONDITION_RANK\" ,\n                    cast(\"ENCOUNTER_GROUP\" as character varying(16777216)) as \"ENCOUNTER_GROUP\" ,\n                    cast(null as NUMBER(38,6)) as \"TOTAL_PAID\" ,\n                    cast(null as NUMBER(38,12)) as \"MEMBER_MONTHS\" \n\n            from tuva.data_quality.encounters_cost_and_utilization\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.data_quality.data_quality_ed_classification_reference' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"ANALYTICS_CONCEPT\" as character varying(16777216)) as \"ANALYTICS_CONCEPT\" ,\n                    cast(\"ANALYTICS_MEASURE\" as character varying(16777216)) as \"ANALYTICS_MEASURE\" ,\n                    cast(\"DATA_SOURCE_VALUE\" as NUMBER(25,6)) as \"DATA_SOURCE_VALUE\" ,\n                    cast(\"ANALYTICS_VALUE\" as character varying(256)) as \"ANALYTICS_VALUE\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(16777216)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as NUMBER(18,0)) as \"PATIENTS\" ,\n                    cast(\"VALUE_RANK\" as NUMBER(18,0)) as \"VALUE_RANK\" ,\n                    cast(null as NUMBER(38,0)) as \"MEDICARE_LDS_CONDITION_RANK\" ,\n                    cast(null as character varying(16777216)) as \"ENCOUNTER_GROUP\" ,\n                    cast(null as NUMBER(38,6)) as \"TOTAL_PAID\" ,\n                    cast(null as NUMBER(38,12)) as \"MEMBER_MONTHS\" \n\n            from tuva.data_quality.data_quality_ed_classification_reference\n\n            \n        )\n\n        union all\n        \n\n        (\n            select\n                cast('tuva.data_quality.service_categories_pmpm' as TEXT) as _dbt_source_relation,\n\n                \n                    cast(\"ANALYTICS_CONCEPT\" as character varying(16777216)) as \"ANALYTICS_CONCEPT\" ,\n                    cast(\"ANALYTICS_MEASURE\" as character varying(16777216)) as \"ANALYTICS_MEASURE\" ,\n                    cast(\"DATA_SOURCE_VALUE\" as NUMBER(25,6)) as \"DATA_SOURCE_VALUE\" ,\n                    cast(\"ANALYTICS_VALUE\" as character varying(256)) as \"ANALYTICS_VALUE\" ,\n                    cast(\"TUVA_LAST_RUN\" as character varying(16777216)) as \"TUVA_LAST_RUN\" ,\n                    cast(null as NUMBER(18,0)) as \"PATIENTS\" ,\n                    cast(null as NUMBER(18,0)) as \"VALUE_RANK\" ,\n                    cast(null as NUMBER(38,0)) as \"MEDICARE_LDS_CONDITION_RANK\" ,\n                    cast(null as character varying(16777216)) as \"ENCOUNTER_GROUP\" ,\n                    cast(\"TOTAL_PAID\" as NUMBER(38,6)) as \"TOTAL_PAID\" ,\n                    cast(\"MEMBER_MONTHS\" as NUMBER(38,12)) as \"MEMBER_MONTHS\" \n\n            from tuva.data_quality.service_categories_pmpm\n\n            \n        )\n\n        \n\n)\n\nselect\n    analytics_concept   \n  , analytics_measure\n  , data_source_value\n  , analytics_value\n  , value_rank\n  , '2025-02-25 21:25:59.177756+00:00' as tuva_last_run\nfrom unioned_data", "relation_name": "tuva.data_quality.analytics_reference_summary"}], "elapsed_time": 25.30557894706726, "args": {"warn_error_options": {"include": [], "exclude": []}, "log_level_file": "debug", "macro_debugging": false, "partial_parse": false, "target": "tuva", "empty_catalog": false, "require_explicit_package_overrides_for_builtin_materializations": true, "printer_width": 80, "indirect_selection": "eager", "show_resource_report": false, "which": "generate", "vars": {}, "enable_legacy_logger": false, "profiles_dir": "/Users/sarah/.dbt", "log_level": "info", "populate_cache": true, "project_dir": "/Users/sarah/tuva-repos/tuva/integration_tests/docs_generate", "print": true, "static_parser": true, "version_check": true, "cache_selected_only": false, "target_path": "../target", "invocation_command": "dbt docs generate --target-path ../target --target tuva", "strict_mode": false, "defer": false, "send_anonymous_usage_stats": true, "source_freshness_run_project_hooks": false, "favor_state": false, "use_colors": true, "quiet": false, "log_path": "/Users/sarah/tuva-repos/tuva/integration_tests/docs_generate/logs", "compile": true, "static": false, "select": [], "introspect": true, "log_format_file": "debug", "log_file_max_bytes": 10485760, "use_colors_file": true, "write_json": true, "exclude": [], "partial_parse_file_diff": true, "require_resource_names_without_spaces": false, "log_format": "default"}}