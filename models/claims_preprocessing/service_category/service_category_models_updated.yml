models:
#final
  - name: service_category__service_category_grouper
    description: Assigns every claim line into a unique service category.
    config:
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}
      alias: service_category_grouper
      materialized: table
      tags:
        - service_category_grouper
        - claims_preprocessing
    columns:
      - name: claim_id
        description: Unique identifier for each claim.
      - name: claim_line_number
        description: Indicates the line number for the particular line of the claim.
      - name: claim_type
        description: Indicated the type of claims
      - name: service_category_1
        description: The first service category of the claim line
      - name: service_category_2
        description: The second, more specific service category of the claim line
      - name: tuva_last_run
        description: The time at with the model was materialized. Generated by `dbt_utils.pretty_time`
          as the local time of the `dbt run` environment.  Timezone is configurable
          via the `tuva_last_run` var.

  - name: service_category__service_category_grouper_pbi
    description: Assigns every claim line into a unique service category.
    config:
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}
      alias: service_category_grouper_pbi
      materialized: table
      tags:
        - service_category_grouper
        - claims_preprocessing

#intermediate:
  - name: service_category__combined_professional
    description: N/A
    config:
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}
      alias: _int_combined_professional
      materialized: table
      tags:
        - service_category_grouper
        - claims_preprocessing

  - name: service_category__combined_institutional_header_level
    description: N/A
    config:
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}
      alias: _int_combined_institutional_header_level
      materialized: table
      tags:
        - service_category_grouper
        - claims_preprocessing

  - name: service_category__combined_institutional_line_level
    description: N/A
    config:
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}
      alias: _int_combined_institutional_line_level
      materialized: table
      tags:
        - service_category_grouper
        - claims_preprocessing


  - name: service_category__acute_inpatient_professional
    description: N/A
    config:
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}
      alias: _int_acute_inpatient_professional
      materialized: table
      tags:
        - service_category_grouper
        - claims_preprocessing

  - name: service_category__ambulance_professional
    description: N/A
    config:
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}
      alias: _int_ambulance_professional
      materialized: table
      tags:
        - service_category_grouper
        - claims_preprocessing

  - name: service_category__ambulatory_surgery_professional
    description: N/A
    config:
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}
      alias: _int_ambulatory_surgery_professional
      materialized: table
      tags:
        - service_category_grouper
        - claims_preprocessing

  - name: service_category__dialysis_institutional
    description: N/A
    config:
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}
      alias: _int_dialysis_institutional
      materialized: table
      tags:
        - service_category_grouper
        - claims_preprocessing

  - name: service_category__dialysis_professional
    description: N/A
    config:
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}
      alias: _int_dialysis_professional
      materialized: table
      tags:
        - service_category_grouper
        - claims_preprocessing

  - name: service_category__dme_professional
    description: N/A
    config:
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}
      alias: _int_dme_professional
      materialized: table
      tags:
        - service_category_grouper
        - claims_preprocessing

  - name: service_category__emergency_department_institutional
    description: N/A
    config:
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}
      alias: _int_emergency_department_institutional
      materialized: table
      tags:
        - service_category_grouper
        - claims_preprocessing

  - name: service_category__emergency_department_professional
    description: N/A
    config:
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}
      alias: _int_emergency_department_professional
      materialized: table
      tags:
        - service_category_grouper
        - claims_preprocessing

  - name: service_category__home_health_institutional
    description: N/A
    config:
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}
      alias: _int_home_health_institutional
      materialized: table
      tags:
        - service_category_grouper
        - claims_preprocessing

  - name: service_category__home_health_professional
    description: N/A
    config:
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}
      alias: _int_home_health_professional
      materialized: table
      tags:
        - service_category_grouper
        - claims_preprocessing

  - name: service_category__inpatient_hospice_institutional
    description: N/A
    config:
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}
      alias: _int_inpatient_hospice_institutional
      materialized: table
      tags:
        - service_category_grouper
        - claims_preprocessing

  - name: service_category__inpatient_hospice_professional
    description: N/A
    config:
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}
      alias: _int_inpatient_hospice_professional
      materialized: table
      tags:
        - service_category_grouper
        - claims_preprocessing

  - name: service_category__inpatient_psychiatric_professional
    description: N/A
    config:
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}
      alias: _int_inpatient_psychiatric_professional
      materialized: table
      tags:
        - service_category_grouper
        - claims_preprocessing

  - name: service_category__inpatient_psychiatric_institutional
    description: N/A
    config:
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}
      alias: _int_inpatient_psychiatric_institutional
      materialized: table
      tags:
        - service_category_grouper
        - claims_preprocessing

  - name: service_category__inpatient_rehab_professional
    description: N/A
    config:
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}
      alias: _int_inpatient_rehab_professional
      materialized: table
      tags:
        - service_category_grouper
        - claims_preprocessing

  - name: service_category__lab_institutional
    description: N/A
    config:
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}
      alias: _int_lab_institutional
      materialized: table
      tags:
        - service_category_grouper
        - claims_preprocessing

  - name: service_category__lab_professional
    description: N/A
    config:
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}
      alias: _int_lab_professional
      materialized: table
      tags:
        - service_category_grouper
        - claims_preprocessing

  - name: service_category__office_based_visit_professional
    description: N/A
    config:
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}
      alias: _int_office_based_visit_professional
      materialized: table
      tags:
        - service_category_grouper
        - claims_preprocessing

  - name: service_category__outpatient_hospital_or_clinic_institutional
    description: N/A
    config:
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}
      alias: _int_outpatient_hospital_or_clinic_institutional
      materialized: table
      tags:
        - service_category_grouper
        - claims_preprocessing

  - name: service_category__outpatient_hospital_or_clinic_professional
    description: N/A
    config:
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}
      alias: _int_outpatient_hospital_or_clinic_professional
      materialized: table
      tags:
        - service_category_grouper
        - claims_preprocessing

  - name: service_category__outpatient_psychiatric_institutional
    description: N/A
    config:
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}
      alias: _int_outpatient_psychiatric_institutional
      materialized: table
      tags:
        - service_category_grouper
        - claims_preprocessing

  - name: service_category__outpatient_psychiatric_professional
    description: N/A
    config:
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}
      alias: _int_outpatient_psychiatric_professional
      materialized: table
      tags:
        - service_category_grouper
        - claims_preprocessing

  - name: service_category__outpatient_rehab_professional
    description: N/A
    config:
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}
      alias: _int_outpatient_rehab_professional
      materialized: table
      tags:
        - service_category_grouper
        - claims_preprocessing

  - name: service_category__inpatient_skilled_nursing_institutional
    description: N/A
    config:
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}
      alias: _int_inpatient_skilled_nursing_institutional
      materialized: table
      tags:
        - service_category_grouper
        - claims_preprocessing

  - name: service_category__inpatient_skilled_nursing_professional
    description: N/A
    config:
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}
      alias: _int_inpatient_skilled_nursing_professional
      materialized: table
      tags:
        - service_category_grouper
        - claims_preprocessing

  - name: service_category__urgent_care_institutional
    description: N/A
    config:
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}
      alias: _int_urgent_care_institutional
      materialized: table
      tags:
        - service_category_grouper
        - claims_preprocessing

  - name: service_category__urgent_care_professional
    description: N/A
    config:
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}
      alias: _int_urgent_care_professional
      materialized: table
      tags:
        - service_category_grouper
        - claims_preprocessing

  - name: service_category__acute_inpatient_institutional_med_surg
    config:
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}
      alias: _int_acute_inpatient_institutional_med_surg
      materialized: table
      tags:
        - service_category_grouper
        - claims_preprocessing

  - name: service_category__acute_inpatient_institutional_maternity
    config:
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}
      alias: _int_acute_inpatient_institutional_maternity
      materialized: table
      tags:
        - service_category_grouper
        - claims_preprocessing
  
  - name: service_category__acute_inpatient_institutional_other
    config:
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}
      alias: _int_acute_inpatient_institutional_other
      materialized: table
      tags:
        - service_category_grouper
        - claims_preprocessing

  - name: service_category__ambulatory_surgery_institutional
    config:
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}
      alias: _int_ambulatory_surgery_institutional
      materialized: table
      tags:
        - service_category_grouper
        - claims_preprocessing

  - name: service_category__observation_institutional
    config:
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}
      alias: _int_observation_institutional
      materialized: table
      tags:
        - service_category_grouper
        - claims_preprocessing


  - name: service_category__acute_inpatient_institutional_substance_use
    description: Auto-generated model entry
    config:
      schema: |
        {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing
        {% else %}claims_preprocessing{%- endif -%}
      alias: _int_acute_inpatient_institutional_substance_use
      materialized: table
      tags:
        - service_category_grouper
        - needs_review
  - name: service_category__office_based_other_professional
    description: Auto-generated model entry
    config:
      schema: |
        {%- if var('tuva_schema_prefix', None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing{%- else %}claims_preprocessing{%- endif -%}
      alias: service_category__office_based_other_professional
      materialized: table
      tags:
        - service_category_grouper
        - needs_review
  - name: service_category__office_based_pharmacy_professional
    description: Auto-generated model entry
    config:
      schema: |
        {%- if var('tuva_schema_prefix', None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing{%- else %}claims_preprocessing{%- endif -%}
      alias: service_category__office_based_pharmacy_professional
      materialized: table
      tags:
        - service_category_grouper
        - needs_review
  - name: service_category__office_based_physical_therapy_professional
    description: Auto-generated model entry
    config:
      schema: |
        {%- if var('tuva_schema_prefix', None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing{%- else %}claims_preprocessing{%- endif -%}
      alias: service_category__office_based_physical_therapy_professional
      materialized: table
      tags:
        - service_category_grouper
        - needs_review
  - name: service_category__office_based_radiology
    description: Auto-generated model entry
    config:
      schema: |
        {%- if var('tuva_schema_prefix', None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing{%- else %}claims_preprocessing{%- endif -%}
      alias: service_category__office_based_radiology
      materialized: table
      tags:
        - service_category_grouper
        - needs_review
  - name: service_category__office_based_surgery_professional
    description: Auto-generated model entry
    config:
      schema: |
        {%- if var('tuva_schema_prefix', None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing{%- else %}claims_preprocessing{%- endif -%}
      alias: service_category__office_based_surgery_professional
      materialized: table
      tags:
        - service_category_grouper
        - needs_review

  - name: service_category__outpatient_path_lab
    description: Auto-generated model entry
    config:
      schema: |
        {%- if var('tuva_schema_prefix', None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing{%- else %}claims_preprocessing{%- endif -%}
      alias: service_category__outpatient_path_lab
      materialized: table
      tags:
        - service_category_grouper
        - needs_review
  - name: service_category__outpatient_pharmacy_institutional
    description: Auto-generated model entry
    config:
      schema: |
        {%- if var('tuva_schema_prefix', None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing{%- else %}claims_preprocessing{%- endif -%}
      alias: service_category__outpatient_pharmacy_institutional
      materialized: table
      tags:
        - service_category_grouper
        - needs_review
  - name: service_category__outpatient_physical_therapy_institutional
    description: Auto-generated model entry
    config:
      schema: |
        {%- if var('tuva_schema_prefix', None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing{%- else %}claims_preprocessing{%- endif -%}
      alias: service_category__outpatient_physical_therapy_institutional
      materialized: table
      tags:
        - service_category_grouper
        - needs_review
  - name: service_category__outpatient_radiology
    description: Auto-generated model entry
    config:
      schema: |
        {%- if var('tuva_schema_prefix', None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing{%- else %}claims_preprocessing{%- endif -%}
      alias: service_category__outpatient_radiology
      materialized: table
      tags:
        - service_category_grouper
        - needs_review
  - name: service_category__outpatient_substance_use_institutional
    description: Auto-generated model entry
    config:
      schema: |
        {%- if var('tuva_schema_prefix', None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing{%- else %}claims_preprocessing{%- endif -%}
      alias: service_category__outpatient_substance_use_institutional
      materialized: table
      tags:
        - service_category_grouper
        - needs_review
  - name: service_category__outpatient_surgery_institutional
    description: Auto-generated model entry
    config:
      schema: |
        {%- if var('tuva_schema_prefix', None) != None -%}{{var('tuva_schema_prefix')}}_claims_preprocessing{%- else %}claims_preprocessing{%- endif -%}
      alias: service_category__outpatient_surgery_institutional
      materialized: table
      tags:
        - service_category_grouper
        - needs_review
#staging:
  - name: service_category__stg_medical_claim
    description: Staging med claims for sc grouper
    config:
      materialized: table # change back
      tags:
        #- service_category_grouper
        - claims_preprocessing

  - name: service_category__stg_inpatient_institutional
    config:
      materialized: table
      tags:
        - service_category_grouper
        - claims_preprocessing

  - name: service_category__stg_outpatient_institutional
    config:
      materialized: table
      tags:
        - service_category_grouper
        - claims_preprocessing

  - name: service_category__stg_professional
    config:
      materialized: table
      tags:
        - service_category_grouper
        - claims_preprocessing