version: 2
models:

#### Data Quality
## Final
- name: data_quality__crosswalk_field_to_mart_sk
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: crosswalk_field_to_mart_sk
    tags:
      - claims
      - clinical
      - final
    materialized: table
  columns:
    - name: input_layer_table_name
      description: Name of the input layer table
    - name: claim_type
      description: The claim type (e.g. institutional or professional) or data type (e.g. clinical or claims)
    - name: field_name
      description: Name of the input table column
    - name: table_claim_type_field_sk
      description: Surrogate key for claim type field
    - name: tuva_last_run
      description: >
        The last time the data was refreshed.  Generated by 
        `dbt_utils.pretty_time` as the local time of the `dbt run` 
        environment.  Timezone is configurable via the `tuva_last_run` var.



- name: data_quality__data_quality_detail
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: data_quality_detail
    tags:
      - claims
      - clinical
      - final
    materialized: table
  columns:
    - name: data_source
      description:  User-configured field that indicates the data source
    - name: source_date
      description: The source date relevant to the field_name (e.g. field_name = death_date means the source_date = death_date)
    - name: table_name
      description: Name of the input table
    - name: drill_down_key
      description: Key for drill down
    - name: drill_down_value
      description:  Value for drill down
    - name: claim_type
      description: The claim type (e.g. institutional or professional) or data type (e.g. clinical or claims)
    - name: field_name
      description: Name of the input table column
    - name: bucket_name
      description: Category of data quality test result
    - name: invalid_reason
      description: Reason row failed data quality test(s)
    - name: field_value
      description: The source column value being tested
    - name: summary_sk
      description: Surrogate key for summary table
    - name: tuva_last_run
      description: >
        The last time the data was refreshed.  Generated by 
        `dbt_utils.pretty_time` as the local time of the `dbt run` 
        environment.  Timezone is configurable via the `tuva_last_run` var.



- name: data_quality__data_quality_for_pbi
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: data_quality_for_pbi
    tags:
      - claims
      - clinical
      - final
    materialized: table
  columns:
    - name: summary_sk
      description: Surrogate key for summary table
    - name: data_source
      description:  User-configured field that indicates the data source
    - name: table_name
      description: Name of the input table
    - name: claim_type
      description: The claim type (e.g. institutional or professional) or data type (e.g. clinical or claims)
    - name: field_name
      description: Name of the input table column
    - name: bucket_name
      description: Category of data quality test result
    - name: invalid_reason
      description: Reason row failed data quality test(s)
    - name: drill_down_key
      description: Key for drill down
    - name: drill_down_value
      description:  Value for drill down
    - name: field_value
      description: The source column value being tested
    - name: frequency
      description:  Count of frequency
    - name: tuva_last_run
      description: >
        The last time the data was refreshed.  Generated by 
        `dbt_utils.pretty_time` as the local time of the `dbt run` 
        environment.  Timezone is configurable via the `tuva_last_run` var.



- name: data_quality__quality_trend
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: quality_trend
    tags:
      - claims
      - clinical
      - final
    materialized: table
  columns:
    - name: first_day_of_month
      description: The first day of a given month in date format
    - name: summary_sk
      description: Surrogate key for summary table
    - name: valid_num
      description: Number of rows valid
    - name: fill_num
      description: Number of rows filled
    - name: denom
      description: The denominator for the data quality tests
    - name: tuva_last_run
      description: >
        The last time the data was refreshed.  Generated by 
        `dbt_utils.pretty_time` as the local time of the `dbt run` 
        environment.  Timezone is configurable via the `tuva_last_run` var.



- name: data_quality__raw_summary
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: raw_summary
    tags:
      - claims
      - clinical
      - final
    materialized: table
  columns:
    - name: source
      description: Whether info came from raw data or input_layer
    - name: table_name
      description: Table data check was run on
    - name: row_count
      description: Number of rows in table
    - name: unique_check
      description: Number of unique values in the table
    - name: unique_check_desc
      description: Explanation of what the unique check is on that specific table
    - name: table_order
      description: Column used to sort the result set in a logical order
    - name: tuva_last_run
      description: >
        The last time the data was refreshed.  Generated by 
        `dbt_utils.pretty_time` as the local time of the `dbt run` 
        environment.  Timezone is configurable via the `tuva_last_run` var.



- name: data_quality__summary
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: summary
    tags:
      - claims
      - clinical
      - final
    materialized: table
  columns:
    - name: summary_sk
      description: Surrogate key for summary table
    - name: table_claim_type_field_sk
      description: Surrogate key for claim type field.
    - name: data_source
      description: User-configured field that indicates the data source
    - name: table_name
      description: Name of the input table
    - name: claim_type
      description: The claim type (e.g. institutional or professional) or data type (e.g. clinical or claims)
    - name: field_name
      description: Name of the input table column
    - name: red
      description: Percentage to show data quality check as red (bad)
    - name: green
      description: Percentage to show data quality check as green (good)
    - name: valid_num
      description: Number of rows valid
    - name: fill_num
      description: Number of rows filled
    - name: denom
      description: The denominator for the data quality tests
    - name: tuva_last_run
      description: >
        The last time the data was refreshed.  Generated by 
        `dbt_utils.pretty_time` as the local time of the `dbt run` 
        environment.  Timezone is configurable via the `tuva_last_run` var.




#### Atomic Checks
## Claims Eligibility

- name: data_quality__eligibility_address
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: eligibility_address
    tags:
      - claims
      - eligibility
      - intermediate
    materialized: table


- name: data_quality__eligibility_birth_date
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: eligibility_birth_date
    tags:
      - claims
      - eligibility
      - intermediate
    materialized: table


- name: data_quality__eligibility_city
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: eligibility_city
    tags:
      - claims
      - eligibility
      - intermediate
    materialized: table


- name: data_quality__eligibility_data_source
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: eligibility_data_source
    tags:
      - claims
      - eligibility
      - intermediate
    materialized: table


- name: data_quality__eligibility_death_date
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: eligibility_death_date
    tags:
      - claims
      - eligibility
      - intermediate
    materialized: table


- name: data_quality__eligibility_death_flag
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: eligibility_death_flag
    tags:
      - claims
      - eligibility
      - intermediate
    materialized: table


- name: data_quality__eligibility_dual_status_code
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: eligibility_dual_status_code
    tags:
      - claims
      - eligibility
      - intermediate
    materialized: table


- name: data_quality__eligibility_end_date
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: eligibility_end_date
    tags:
      - claims
      - eligibility
      - intermediate
    materialized: table


- name: data_quality__eligibility_first_name
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: eligibility_first_name
    tags:
      - claims
      - eligibility
      - intermediate
    materialized: table


- name: data_quality__eligibility_gender
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: eligibility_gender
    tags:
      - claims
      - eligibility
      - intermediate
    materialized: table


- name: data_quality__eligibility_last_name
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: eligibility_last_name
    tags:
      - claims
      - eligibility
      - intermediate
    materialized: table


- name: data_quality__eligibility_medicare_status_code
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: eligibility_medicare_status_code
    tags:
      - claims
      - eligibility
      - intermediate
    materialized: table


- name: data_quality__eligibility_member_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: eligibility_member_id
    tags:
      - claims
      - eligibility
      - intermediate
    materialized: table


- name: data_quality__eligibility_original_reason_entitlement_code
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: eligibility_original_reason_entitlement_code
    tags:
      - claims
      - eligibility
      - intermediate
    materialized: table


- name: data_quality__eligibility_patient_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: eligibility_patient_id
    tags:
      - claims
      - eligibility
      - intermediate
    materialized: table


- name: data_quality__eligibility_payer_type
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: eligibility_payer_type
    tags:
      - claims
      - eligibility
      - intermediate
    materialized: table


- name: data_quality__eligibility_payer
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: eligibility_payer
    tags:
      - claims
      - eligibility
      - intermediate
    materialized: table


- name: data_quality__eligibility_phone
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: eligibility_phone
    tags:
      - claims
      - eligibility
      - intermediate
    materialized: table


- name: data_quality__eligibility_plan
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: eligibility_plan
    tags:
      - claims
      - eligibility
      - intermediate
    materialized: table


- name: data_quality__eligibility_race
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: eligibility_race
    tags:
      - claims
      - eligibility
      - intermediate
    materialized: table


- name: data_quality__eligibility_start_date
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: eligibility_start_date
    tags:
      - claims
      - eligibility
      - intermediate
    materialized: table


- name: data_quality__eligibility_state
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: eligibility_state
    tags:
      - claims
      - eligibility
      - intermediate
    materialized: table


- name: data_quality__eligibility_zip_code
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: eligibility_zip_code
    tags:
      - claims
      - eligibility
      - intermediate
    materialized: table


## Claims medical
### Claim Header


- name: data_quality__claim_allowed_amount
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: claim_allowed_amount
    tags:
      - claims
      - medical
      - intermediate
    materialized: table


- name: data_quality__claim_charge_amount
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: claim_charge_amount
    tags:
      - claims
      - medical
      - intermediate
    materialized: table


- name: data_quality__claim_claim_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: claim_claim_id
    tags:
      - claims
      - medical
      - intermediate
    materialized: table


- name: data_quality__claim_claim_line_end_date
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: claim_claim_line_end_date
    tags:
      - claims
      - medical
      - intermediate
    materialized: table


- name: data_quality__claim_claim_line_number
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: claim_claim_line_number
    tags:
      - claims
      - medical
      - intermediate
    materialized: table


- name: data_quality__claim_claim_line_start_date
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: claim_claim_line_start_date
    tags:
      - claims
      - medical
      - intermediate
    materialized: table


- name: data_quality__claim_claim_type
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: claim_claim_type
    tags:
      - claims
      - medical
      - intermediate
    materialized: table


- name: data_quality__claim_coinsurance_amount
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: claim_coninsurance_amount
    tags:
      - claims
      - medical
      - intermediate
    materialized: table


- name: data_quality__claim_copayment_amount
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: claim_copayment_amount
    tags:
      - claims
      - medical
      - intermediate
    materialized: table


- name: data_quality__claim_data_source
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: claim_data_source
    tags:
      - claims
      - medical
      - intermediate
    materialized: table


- name: data_quality__claim_deductible_amount
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: claim_deductible_amount
    tags:
      - claims
      - medical
      - intermediate
    materialized: table


- name: data_quality__claim_diagnosis_code_type
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: claim_diagnosis_code_type
    tags:
      - claims
      - medical
      - intermediate
    materialized: table


- name: data_quality__claim_hcpcs_code
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: claim_hcpcs_code
    tags:
      - claims
      - medical
      - intermediate
    materialized: table


- name: data_quality__claim_member_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: claim_member_id
    tags:
      - claims
      - medical
      - intermediate
    materialized: table


- name: data_quality__claim_paid_amount
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: claim_paid_amount
    tags:
      - claims
      - medical
      - intermediate
    materialized: table


- name: data_quality__claim_paid_date
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: claim_paid_date
    tags:
      - claims
      - medical
      - intermediate
    materialized: table


- name: data_quality__claim_patient_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: claim_patient_id
    tags:
      - claims
      - medical
      - intermediate
    materialized: table


- name: data_quality__claim_payer
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: claim_payer
    tags:
      - claims
      - medical
      - intermediate
    materialized: table


- name: data_quality__claim_plan
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: claim_plan
    tags:
      - claims
      - medical
      - intermediate
    materialized: table


- name: data_quality__claim_total_cost_amount
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: claim_total_cost_amount
    tags:
      - claims
      - medical
      - intermediate
    materialized: table


### Institutional Claims


- name: data_quality__institutional_ms_drg_code
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: institutional_ms_drg_code
    tags:
      - claims
      - medical
      - institutional
      - intermediate
    materialized: table


- name: data_quality__institutional_admission_date
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: institutional_admission_date
    tags:
      - claims
      - medical
      - institutional
      - intermediate
    materialized: table


- name: data_quality__institutional_admit_source_code
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: institutional_admit_source_code
    tags:
      - claims
      - medical
      - institutional
      - intermediate
    materialized: table


- name: data_quality__institutional_admit_type_code
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: institutional_admit_type_code
    tags:
      - claims
      - medical
      - institutional
      - intermediate
    materialized: table


- name: data_quality__institutional_apr_drg_code
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: institutional_apr_drg_code
    tags:
      - claims
      - medical
      - institutional
      - intermediate
    materialized: table


- name: data_quality__institutional_bill_type_code
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: institutional_bill_type_code
    tags:
      - claims
      - medical
      - institutional
      - intermediate
    materialized: table


- name: data_quality__institutional_billing_npi
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: institutional_billing_npi
    tags:
      - claims
      - medical
      - institutional
      - intermediate
    materialized: table


- name: data_quality__institutional_claim_end_date
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: institutional_claim_end_date
    tags:
      - claims
      - medical
      - institutional
      - intermediate
    materialized: table


- name: data_quality__institutional_claim_start_date
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: institutional_claim_start_date
    tags:
      - claims
      - medical
      - institutional
      - intermediate
    materialized: table


- name: data_quality__institutional_diagnosis_code_1
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: institutional_diagnosis_code_1
    tags:
      - claims
      - medical
      - institutional
      - intermediate
    materialized: table


- name: data_quality__institutional_diagnosis_code_2
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: institutional_diagnosis_code_2
    tags:
      - claims
      - medical
      - institutional
      - intermediate
    materialized: table


- name: data_quality__institutional_diagnosis_code_3
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: institutional_diagnosis_code_3
    tags:
      - claims
      - medical
      - institutional
      - intermediate
    materialized: table


- name: data_quality__institutional_discharge_date
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: institutional_discharge_date
    tags:
      - claims
      - medical
      - institutional
      - intermediate
    materialized: table


- name: data_quality__institutional_discharge_disposition_code
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: institutional_discharge_disposition_code
    tags:
      - claims
      - medical
      - institutional
      - intermediate
    materialized: table


- name: data_quality__institutional_facility_npi
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: institutional_facility_npi
    tags:
      - claims
      - medical
      - institutional
      - intermediate
    materialized: table


- name: data_quality__institutional_present_on_admission_1
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: institutional_present_on_admission_1
    tags:
      - claims
      - medical
      - institutional
      - intermediate
    materialized: table


- name: data_quality__institutional_present_on_admission_2
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: institutional_present_on_admission_2
    tags:
      - claims
      - medical
      - institutional
      - intermediate
    materialized: table


- name: data_quality__institutional_present_on_admission_3
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: institutional_present_on_admission_3
    tags:
      - claims
      - medical
      - institutional
      - intermediate
    materialized: table


- name: data_quality__institutional_procedure_code_1
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: institutional_procedure_code_1
    tags:
      - claims
      - medical
      - institutional
      - intermediate
    materialized: table


- name: data_quality__institutional_procedure_code_2
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: institutional_procedure_code_2
    tags:
      - claims
      - medical
      - institutional
      - intermediate
    materialized: table


- name: data_quality__institutional_procedure_code_3
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: institutional_procedure_code_3
    tags:
      - claims
      - medical
      - institutional
      - intermediate
    materialized: table


- name: data_quality__institutional_procedure_date_1
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: institutional_procedure_date_1
    tags:
      - claims
      - medical
      - institutional
      - intermediate
    materialized: table


- name: data_quality__institutional_procedure_date_2
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: institutional_procedure_date_2
    tags:
      - claims
      - medical
      - institutional
      - intermediate
    materialized: table


- name: data_quality__institutional_procedure_date_3
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: institutional_procedure_date_3
    tags:
      - claims
      - medical
      - institutional
      - intermediate
    materialized: table


- name: data_quality__institutional_rendering_npi
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: institutional_rendering_npi
    tags:
      - claims
      - medical
      - institutional
      - intermediate
    materialized: table


- name: data_quality__institutional_revenue_center_code
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: institutional_revenue_center_code
    tags:
      - claims
      - medical
      - institutional
      - intermediate
    materialized: table


- name: data_quality__institutional_service_unit_quantity
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: institutional_service_unit_quantity
    tags:
      - claims
      - medical
      - institutional
      - intermediate
    materialized: table


### Professional Claims


- name: data_quality__professional_billing_npi
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: professional_billing_npi
    tags:
      - claims
      - medical
      - professional
      - intermediate
    materialized: table

- name: data_quality__professional_rendering_npi
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: professional_rendering_npi
    tags:
      - claims
      - medical
      - professional
      - intermediate
    materialized: table

- name: data_quality__professional_facility_npi
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: professional_facility_npi
    tags:
      - claims
      - medical
      - professional
      - intermediate
    materialized: table


- name: data_quality__professional_place_of_service_code
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: professional_place_of_service_code
    tags:
      - claims
      - medical
      - professional
      - intermediate
    materialized: table


- name: data_quality__professional_claim_end_date
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: professional_claim_end_date
    tags:
      - claims
      - medical
      - professional
      - intermediate
    materialized: table


- name: data_quality__professional_claim_start_date
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: professional_claim_start_date
    tags:
      - claims
      - medical
      - professional
      - intermediate
    materialized: table


- name: data_quality__professional_diagnosis_code_1
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: professional_diagnosis_code_1
    tags:
      - claims
      - medical
      - professional
      - intermediate
    materialized: table


- name: data_quality__professional_diagnosis_code_2
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: professional_diagnosis_code_2
    tags:
      - claims
      - medical
      - professional
      - intermediate
    materialized: table


- name: data_quality__professional_diagnosis_code_3
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: professional_diagnosis_code_3
    tags:
      - claims
      - medical
      - professional
      - intermediate
    materialized: table


## Claims pharmacy

- name: data_quality__pharmacy_allowed_amount
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: pharmacy_allowed_amount
    tags:
      - claims
      - pharmacy
      - intermediate
    materialized: table


- name: data_quality__pharmacy_claim_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: pharmacy_claim_id
    tags:
      - claims
      - pharmacy
      - intermediate
    materialized: table


- name: data_quality__pharmacy_claim_line_number
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: pharmacy_claim_line_number
    tags:
      - claims
      - pharmacy
      - intermediate
    materialized: table


- name: data_quality__pharmacy_coinsurance_amount
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: pharmacy_coinsurance_amount
    tags:
      - claims
      - pharmacy
      - intermediate
    materialized: table


- name: data_quality__pharmacy_copayment_amount
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: pharmacy_copayment_amount
    tags:
      - claims
      - pharmacy
      - intermediate
    materialized: table


- name: data_quality__pharmacy_data_source
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: pharmacy_data_source
    tags:
      - claims
      - pharmacy
      - intermediate
    materialized: table


- name: data_quality__pharmacy_days_supply
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: pharmacy_days_supply
    tags:
      - claims
      - pharmacy
      - intermediate
    materialized: table


- name: data_quality__pharmacy_deductible_amount
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: pharmacy_deductible_amount
    tags:
      - claims
      - pharmacy
      - intermediate
    materialized: table


- name: data_quality__pharmacy_dispensing_date
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: pharmacy_dispensing_date
    tags:
      - claims
      - pharmacy
      - intermediate
    materialized: table


- name: data_quality__pharmacy_dispensing_provider_npi
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: pharmacy_dispensing_provider_npi
    tags:
      - claims
      - pharmacy
      - intermediate
    materialized: table


- name: data_quality__pharmacy_member_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: pharmacy_member_id
    tags:
      - claims
      - pharmacy
      - intermediate
    materialized: table


- name: data_quality__pharmacy_ndc_code
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: pharmacy_ndc_code
    tags:
      - claims
      - pharmacy
      - intermediate
    materialized: table


- name: data_quality__pharmacy_paid_amount
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: pharmacy_paid_amount
    tags:
      - claims
      - pharmacy
      - intermediate
    materialized: table


- name: data_quality__pharmacy_paid_date
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: pharmacy_paid_date
    tags:
      - claims
      - pharmacy
      - intermediate
    materialized: table


- name: data_quality__pharmacy_patient_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: pharmacy_patient_id
    tags:
      - claims
      - pharmacy
      - intermediate
    materialized: table


- name: data_quality__pharmacy_payer
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: pharmacy_payer
    tags:
      - claims
      - pharmacy
      - intermediate
    materialized: table


- name: data_quality__pharmacy_plan
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: pharmacy_plan
    tags:
      - claims
      - pharmacy
      - intermediate
    materialized: table


- name: data_quality__pharmacy_prescribing_provider_npi
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: pharmacy_prescribing_provider_npi
    tags:
      - claims
      - pharmacy
      - intermediate
    materialized: table


- name: data_quality__pharmacy_quantity
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: pharmacy_quantity
    tags:
      - claims
      - pharmacy
      - intermediate
    materialized: table


- name: data_quality__pharmacy_refills
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: pharmacy_refills
    tags:
      - claims
      - pharmacy
      - intermediate
    materialized: table

#### Atomic Checks
## Clinical condition
- name: data_quality__condition_claim_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: condition_claim_id
    tags:
      - clinical
      - condition
      - intermediate
    materialized: table


- name: data_quality__condition_condition_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: condition_condition_id
    tags:
      - clinical
      - condition
      - intermediate
    materialized: table


- name: data_quality__condition_condition_rank
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: condition_condition_rank
    tags:
      - clinical
      - condition
      - intermediate
    materialized: table


- name: data_quality__condition_condition_type
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: condition_condition_type
    tags:
      - clinical
      - condition
      - intermediate
    materialized: table


- name: data_quality__condition_data_source
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: condition_data_source
    tags:
      - clinical
      - condition
      - intermediate
    materialized: table


- name: data_quality__condition_encounter_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: condition_encounter_id
    tags:
      - clinical
      - condition
      - intermediate
    materialized: table


- name: data_quality__condition_normalized_code_type
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: condition_normalized_code_type
    tags:
      - clinical
      - condition
      - intermediate
    materialized: table


- name: data_quality__condition_normalized_code
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: condition_normalized_code
    tags:
      - clinical
      - condition
      - intermediate
    materialized: table


- name: data_quality__condition_normalized_description
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: condition_normalized_description
    tags:
      - clinical
      - condition
      - intermediate
    materialized: table


- name: data_quality__condition_onset_date
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: condition_onset_date
    tags:
      - clinical
      - condition
      - intermediate
    materialized: table


- name: data_quality__condition_patient_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: condition_patient_id
    tags:
      - clinical
      - condition
      - intermediate
    materialized: table


- name: data_quality__condition_present_on_admit_code
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: condition_present_on_admit_code
    tags:
      - clinical
      - condition
      - intermediate
    materialized: table


- name: data_quality__condition_present_on_admit_description
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: condition_present_on_admit_description
    tags:
      - clinical
      - condition
      - intermediate
    materialized: table


- name: data_quality__condition_recorded_date
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: condition_recorded_date
    tags:
      - clinical
      - condition
      - intermediate
    materialized: table


- name: data_quality__condition_resolved_date
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: condition_resolved_date
    tags:
      - clinical
      - condition
      - intermediate
    materialized: table


- name: data_quality__condition_source_code
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: condition_source_code
    tags:
      - clinical
      - condition
      - intermediate
    materialized: table


- name: data_quality__condition_source_code_type
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: condition_source_code_type
    tags:
      - clinical
      - condition
      - intermediate
    materialized: table


- name: data_quality__condition_source_description
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: condition_source_description
    tags:
      - clinical
      - condition
      - intermediate
    materialized: table


- name: data_quality__condition_status
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: condition_status
    tags:
      - clinical
      - condition
      - intermediate
    materialized: table

## Clinical encounter
- name: data_quality__encounter_admit_source_code
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: encounter_admit_source_code
    tags:
      - clinical
      - encounter
      - intermediate
    materialized: table


- name: data_quality__encounter_admit_source_description
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: encounter_admit_source_description
    tags:
      - clinical
      - encounter
      - intermediate
    materialized: table


- name: data_quality__encounter_admit_type_code
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: encounter_admit_type_code
    tags:
      - clinical
      - encounter
      - intermediate
    materialized: table


- name: data_quality__encounter_admit_type_description
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: encounter_admit_type_description
    tags:
      - clinical
      - encounter
      - intermediate
    materialized: table


- name: data_quality__encounter_allowed_amount
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: encounter_allowed_amount
    tags:
      - clinical
      - encounter
      - intermediate
    materialized: table


- name: data_quality__encounter_apr_drg_code
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: encounter_apr_drg_code
    tags:
      - clinical
      - encounter
      - intermediate
    materialized: table


- name: data_quality__encounter_apr_drg_description
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: encounter_apr_drg_description
    tags:
      - clinical
      - encounter
      - intermediate
    materialized: table


- name: data_quality__encounter_attending_provider_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: encounter_attending_provider_id
    tags:
      - clinical
      - encounter
      - intermediate
    materialized: table


- name: data_quality__encounter_charge_amount
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: encounter_charge_amount
    tags:
      - clinical
      - encounter
      - intermediate
    materialized: table


- name: data_quality__encounter_data_source
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: encounter_data_source
    tags:
      - clinical
      - encounter
      - intermediate
    materialized: table


- name: data_quality__encounter_discharge_disposition_code
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: encounter_discharge_disposition_code
    tags:
      - clinical
      - encounter
      - intermediate
    materialized: table


- name: data_quality__encounter_discharge_disposition_description
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: encounter_discharge_disposition_description
    tags:
      - clinical
      - encounter
      - intermediate
    materialized: table


- name: data_quality__encounter_encounter_end_date
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: encounter_encounter_end_date
    tags:
      - clinical
      - encounter
      - intermediate
    materialized: table


- name: data_quality__encounter_encounter_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: encounter_encounter_id
    tags:
      - clinical
      - encounter
      - intermediate
    materialized: table


- name: data_quality__encounter_encounter_start_date
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: encounter_encounter_start_date
    tags:
      - clinical
      - encounter
      - intermediate
    materialized: table


- name: data_quality__encounter_encounter_type
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: encounter_encounter_type
    tags:
      - clinical
      - encounter
      - intermediate
    materialized: table


- name: data_quality__encounter_facility_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: encounter_facility_id
    tags:
      - clinical
      - encounter
      - intermediate
    materialized: table


- name: data_quality__encounter_length_of_stay
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: encounter_length_of_stay
    tags:
      - clinical
      - encounter
      - intermediate
    materialized: table


- name: data_quality__encounter_ms_drg_code
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: encounter_ms_drg_code
    tags:
      - clinical
      - encounter
      - intermediate
    materialized: table


- name: data_quality__encounter_ms_drg_description
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: encounter_ms_drg_description
    tags:
      - clinical
      - encounter
      - intermediate
    materialized: table


- name: data_quality__encounter_paid_amount
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: encounter_paid_amount
    tags:
      - clinical
      - encounter
      - intermediate
    materialized: table


- name: data_quality__encounter_patient_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: encounter_patient_id
    tags:
      - clinical
      - encounter
      - intermediate
    materialized: table


- name: data_quality__encounter_primary_diagnosis_code
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: encounter_primary_diagnosis_code
    tags:
      - clinical
      - encounter
      - intermediate
    materialized: table


- name: data_quality__encounter_primary_diagnosis_code_type
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: encounter_primary_diagnosis_code_type
    tags:
      - clinical
      - encounter
      - intermediate
    materialized: table


- name: data_quality__encounter_primary_diagnosis_description
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: encounter_primary_diagnosis_description
    tags:
      - clinical
      - encounter
      - intermediate
    materialized: table


## Clinical lab result
- name: data_quality__lab_result_source_abnormal_flag
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: lab_result_source_abnormal_flag
    tags:
      - clinical
      - lab_result
      - intermediate
    materialized: table


- name: data_quality__lab_result_specimen
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: lab_result_specimen
    tags:
      - clinical
      - lab_result
      - intermediate
    materialized: table


- name: data_quality__lab_result_source_reference_range_low
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: lab_result_source_reference_range_low
    tags:
      - clinical
      - lab_result
      - intermediate
    materialized: table


- name: data_quality__lab_result_source_units
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: lab_result_source_units
    tags:
      - clinical
      - lab_result
      - intermediate
    materialized: table


- name: data_quality__lab_result_lab_result_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: lab_result_lab_result_id
    tags:
      - clinical
      - lab_result
      - intermediate
    materialized: table


- name: data_quality__lab_result_collection_date
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: lab_result_collection_date
    tags:
      - clinical
      - lab_result
      - intermediate
    materialized: table


- name: data_quality__lab_result_normalized_component
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: lab_result_normalized_component
    tags:
      - clinical
      - lab_result
      - intermediate
    materialized: table


- name: data_quality__lab_result_ordering_practitioner_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: lab_result_ordering_practitioner_id
    tags:
      - clinical
      - lab_result
      - intermediate
    materialized: table


- name: data_quality__lab_result_result
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: lab_result_result
    tags:
      - clinical
      - lab_result
      - intermediate
    materialized: table


- name: data_quality__lab_result_source_code_type
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: lab_result_source_code_type
    tags:
      - clinical
      - lab_result
      - intermediate
    materialized: table


- name: data_quality__lab_result_normalized_description
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: lab_result_normalized_description
    tags:
      - clinical
      - lab_result
      - intermediate
    materialized: table


- name: data_quality__lab_result_normalized_reference_range_low
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: lab_result_normalized_reference_range_low
    tags:
      - clinical
      - lab_result
      - intermediate
    materialized: table


- name: data_quality__lab_result_normalized_reference_range_high
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: lab_result_normalized_reference_range_high
    tags:
      - clinical
      - lab_result
      - intermediate
    materialized: table


- name: data_quality__lab_result_normalized_code
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: lab_result_normalized_code
    tags:
      - clinical
      - lab_result
      - intermediate
    materialized: table


- name: data_quality__lab_result_source_description
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: lab_result_source_description
    tags:
      - clinical
      - lab_result
      - intermediate
    materialized: table


- name: data_quality__lab_result_status
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: lab_result_status
    tags:
      - clinical
      - lab_result
      - intermediate
    materialized: table


- name: data_quality__lab_result_accession_number
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: lab_result_accession_number
    tags:
      - clinical
      - lab_result
      - intermediate
    materialized: table


- name: data_quality__lab_result_result_date
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: lab_result_result_date
    tags:
      - clinical
      - lab_result
      - intermediate
    materialized: table


- name: data_quality__lab_result_normalized_abnormal_flag
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: lab_result_normalized_abnormal_flag
    tags:
      - clinical
      - lab_result
      - intermediate
    materialized: table


- name: data_quality__lab_result_data_source
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: lab_result_data_source
    tags:
      - clinical
      - lab_result
      - intermediate
    materialized: table


- name: data_quality__lab_result_normalized_units
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: lab_result_normalized_units
    tags:
      - clinical
      - lab_result
      - intermediate
    materialized: table


- name: data_quality__lab_result_normalized_code_type
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: lab_result_normalized_code_type
    tags:
      - clinical
      - lab_result
      - intermediate
    materialized: table


- name: data_quality__lab_result_source_reference_range_high
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: lab_result_source_reference_range_high
    tags:
      - clinical
      - lab_result
      - intermediate
    materialized: table


- name: data_quality__lab_result_source_code
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: lab_result_source_code
    tags:
      - clinical
      - lab_result
      - intermediate
    materialized: table


- name: data_quality__lab_result_patient_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: lab_result_patient_id
    tags:
      - clinical
      - lab_result
      - intermediate
    materialized: table


- name: data_quality__lab_result_source_component
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: lab_result_source_component
    tags:
      - clinical
      - lab_result
      - intermediate
    materialized: table


- name: data_quality__lab_result_encounter_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: lab_result_encounter_id
    tags:
      - clinical
      - lab_result
      - intermediate
    materialized: table

## Clinical location
- name: data_quality__location_parent_organization
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: location_parent_organization
    tags:
      - clinical
      - location
      - intermediate
    materialized: table


- name: data_quality__location_latitude
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: location_latitude
    tags:
      - clinical
      - location
      - intermediate
    materialized: table


- name: data_quality__location_facility_type
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: location_facility_type
    tags:
      - clinical
      - location
      - intermediate
    materialized: table


- name: data_quality__location_zip_code
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: location_zip_code
    tags:
      - clinical
      - location
      - intermediate
    materialized: table


- name: data_quality__location_data_source
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: location_data_source
    tags:
      - clinical
      - location
      - intermediate
    materialized: table


- name: data_quality__location_city
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: location_city
    tags:
      - clinical
      - location
      - intermediate
    materialized: table


- name: data_quality__location_npi
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: location_npi
    tags:
      - clinical
      - location
      - intermediate
    materialized: table


- name: data_quality__location_location_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: location_location_id
    tags:
      - clinical
      - location
      - intermediate
    materialized: table


- name: data_quality__location_longitude
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: location_longitude
    tags:
      - clinical
      - location
      - intermediate
    materialized: table


- name: data_quality__location_address
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: location_address
    tags:
      - clinical
      - location
      - intermediate
    materialized: table


- name: data_quality__location_state
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: location_state
    tags:
      - clinical
      - location
      - intermediate
    materialized: table


- name: data_quality__location_name
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: location_name
    tags:
      - clinical
      - location
      - intermediate
    materialized: table


## Clinical medication
- name: data_quality__medication_rxnorm_code
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: medication_rxnorm_code
    tags:
      - clinical
      - medication
      - intermediate
    materialized: table


- name: data_quality__medication_source_code
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: medication_source_code
    tags:
      - clinical
      - medication
      - intermediate
    materialized: table


- name: data_quality__medication_atc_code
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: medication_atc_code
    tags:
      - clinical
      - medication
      - intermediate
    materialized: table


- name: data_quality__medication_dispensing_date
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: medication_dispensing_date
    tags:
      - clinical
      - medication
      - intermediate
    materialized: table


- name: data_quality__medication_prescribing_date
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: medication_prescribing_date
    tags:
      - clinical
      - medication
      - intermediate
    materialized: table


- name: data_quality__medication_days_supply
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: medication_days_supply
    tags:
      - clinical
      - medication
      - intermediate
    materialized: table


- name: data_quality__medication_strength
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: medication_strength
    tags:
      - clinical
      - medication
      - intermediate
    materialized: table


- name: data_quality__medication_patient_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: medication_patient_id
    tags:
      - clinical
      - medication
      - intermediate
    materialized: table


- name: data_quality__medication_rxnorm_description
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: medication_rxnorm_description
    tags:
      - clinical
      - medication
      - intermediate
    materialized: table


- name: data_quality__medication_encounter_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: medication_encounter_id
    tags:
      - clinical
      - medication
      - intermediate
    materialized: table


- name: data_quality__medication_data_source
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: medication_data_source
    tags:
      - clinical
      - medication
      - intermediate
    materialized: table


- name: data_quality__medication_atc_description
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: medication_atc_description
    tags:
      - clinical
      - medication
      - intermediate
    materialized: table


- name: data_quality__medication_quantity_unit
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: medication_quantity_unit
    tags:
      - clinical
      - medication
      - intermediate
    materialized: table


- name: data_quality__medication_source_description
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: medication_source_description
    tags:
      - clinical
      - medication
      - intermediate
    materialized: table


- name: data_quality__medication_ndc_code
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: medication_ndc_code
    tags:
      - clinical
      - medication
      - intermediate
    materialized: table


- name: data_quality__medication_medication_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: medication_medication_id
    tags:
      - clinical
      - medication
      - intermediate
    materialized: table


- name: data_quality__medication_source_code_type
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: medication_source_code_type
    tags:
      - clinical
      - medication
      - intermediate
    materialized: table


- name: data_quality__medication_ndc_description
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: medication_ndc_description
    tags:
      - clinical
      - medication
      - intermediate
    materialized: table


- name: data_quality__medication_quantity
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: medication_quantity
    tags:
      - clinical
      - medication
      - intermediate
    materialized: table


- name: data_quality__medication_practitioner_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: medication_practitioner_id
    tags:
      - clinical
      - medication
      - intermediate
    materialized: table


- name: data_quality__medication_route
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: medication_route
    tags:
      - clinical
      - medication
      - intermediate
    materialized: table

## Clinical observation
- name: data_quality__observation_source_code
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: observation_source_code
    tags:
      - clinical
      - observation
      - intermediate
    materialized: table


- name: data_quality__observation_normalized_reference_range_high
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: observation_normalized_reference_range_high
    tags:
      - clinical
      - observation
      - intermediate
    materialized: table


- name: data_quality__observation_source_units
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: observation_source_units
    tags:
      - clinical
      - observation
      - intermediate
    materialized: table


- name: data_quality__observation_observation_type
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: observation_observation_type
    tags:
      - clinical
      - observation
      - intermediate
    materialized: table


- name: data_quality__observation_normalized_code
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: observation_normalized_code
    tags:
      - clinical
      - observation
      - intermediate
    materialized: table


- name: data_quality__observation_normalized_description
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: observation_normalized_description
    tags:
      - clinical
      - observation
      - intermediate
    materialized: table


- name: data_quality__observation_data_source
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: observation_data_source
    tags:
      - clinical
      - observation
      - intermediate
    materialized: table


- name: data_quality__observation_panel_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: observation_panel_id
    tags:
      - clinical
      - observation
      - intermediate
    materialized: table


- name: data_quality__observation_observation_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: observation_observation_id
    tags:
      - clinical
      - observation
      - intermediate
    materialized: table


- name: data_quality__observation_source_reference_range_low
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: observation_source_reference_range_low
    tags:
      - clinical
      - observation
      - intermediate
    materialized: table


- name: data_quality__observation_result
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: observation_result
    tags:
      - clinical
      - observation
      - intermediate
    materialized: table


- name: data_quality__observation_source_code_type
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: observation_source_code_type
    tags:
      - clinical
      - observation
      - intermediate
    materialized: table


- name: data_quality__observation_normalized_reference_range_low
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: observation_normalized_reference_range_low
    tags:
      - clinical
      - observation
      - intermediate
    materialized: table


- name: data_quality__observation_observation_date
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: observation_observation_date
    tags:
      - clinical
      - observation
      - intermediate
    materialized: table


- name: data_quality__observation_encounter_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: observation_encounter_id
    tags:
      - clinical
      - observation
      - intermediate
    materialized: table


- name: data_quality__observation_source_description
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: observation_source_description
    tags:
      - clinical
      - observation
      - intermediate
    materialized: table


- name: data_quality__observation_source_reference_range_high
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: observation_source_reference_range_high
    tags:
      - clinical
      - observation
      - intermediate
    materialized: table


- name: data_quality__observation_normalized_units
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: observation_normalized_units
    tags:
      - clinical
      - observation
      - intermediate
    materialized: table


- name: data_quality__observation_normalized_code_type
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: observation_normalized_code_type
    tags:
      - clinical
      - observation
      - intermediate
    materialized: table


- name: data_quality__observation_patient_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: observation_patient_id
    tags:
      - clinical
      - observation
      - intermediate
    materialized: table

## Clinical patient
- name: data_quality__patient_sex
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: patient_sex
    tags:
      - clinical
      - patient
      - intermediate
    materialized: table


- name: data_quality__patient_state
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: patient_state
    tags:
      - clinical
      - patient
      - intermediate
    materialized: table


- name: data_quality__patient_city
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: patient_city
    tags:
      - clinical
      - patient
      - intermediate
    materialized: table


- name: data_quality__patient_longitude
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: patient_longitude
    tags:
      - clinical
      - patient
      - intermediate
    materialized: table


- name: data_quality__patient_county
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: patient_county
    tags:
      - clinical
      - patient
      - intermediate
    materialized: table


- name: data_quality__patient_race
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: patient_race
    tags:
      - clinical
      - patient
      - intermediate
    materialized: table


- name: data_quality__patient_death_flag
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: patient_death_flag
    tags:
      - clinical
      - patient
      - intermediate
    materialized: table


- name: data_quality__patient_address
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: patient_address
    tags:
      - clinical
      - patient
      - intermediate
    materialized: table


- name: data_quality__patient_data_source
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: patient_data_source
    tags:
      - clinical
      - patient
      - intermediate
    materialized: table


- name: data_quality__patient_zip_code
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: patient_zip_code
    tags:
      - clinical
      - patient
      - intermediate
    materialized: table


- name: data_quality__patient_first_name
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: patient_first_name
    tags:
      - clinical
      - patient
      - intermediate
    materialized: table


- name: data_quality__patient_last_name
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: patient_last_name
    tags:
      - clinical
      - patient
      - intermediate
    materialized: table


- name: data_quality__patient_latitude
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: patient_latitude
    tags:
      - clinical
      - patient
      - intermediate
    materialized: table


- name: data_quality__patient_birth_date
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: patient_birth_date
    tags:
      - clinical
      - patient
      - intermediate
    materialized: table


- name: data_quality__patient_death_date
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: patient_death_date
    tags:
      - clinical
      - patient
      - intermediate
    materialized: table


- name: data_quality__patient_patient_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: patient_patient_id
    tags:
      - clinical
      - patient
      - intermediate
    materialized: table

## Clinical practitioner
- name: data_quality__practitioner_practice_affiliation
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: practitioner_practice_affiliation
    tags:
      - clinical
      - practitioner
      - intermediate
    materialized: table


- name: data_quality__practitioner_sub_specialty
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: practitioner_sub_specialty
    tags:
      - clinical
      - practitioner
      - intermediate
    materialized: table


- name: data_quality__practitioner_last_name
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: practitioner_last_name
    tags:
      - clinical
      - practitioner
      - intermediate
    materialized: table


- name: data_quality__practitioner_practitioner_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: practitioner_practitioner_id
    tags:
      - clinical
      - practitioner
      - intermediate
    materialized: table


- name: data_quality__practitioner_data_source
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: practitioner_data_source
    tags:
      - clinical
      - practitioner
      - intermediate
    materialized: table


- name: data_quality__practitioner_npi
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: practitioner_npi
    tags:
      - clinical
      - practitioner
      - intermediate
    materialized: table


- name: data_quality__practitioner_first_name
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: practitioner_first_name
    tags:
      - clinical
      - practitioner
      - intermediate
    materialized: table


- name: data_quality__practitioner_specialty
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: practitioner_specialty
    tags:
      - clinical
      - practitioner
      - intermediate
    materialized: table

## Clinical procedure
- name: data_quality__procedure_normalized_code_type
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: procedure_normalized_code_type
    tags:
      - clinical
      - procedure
      - intermediate
    materialized: table


- name: data_quality__procedure_normalized_description
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: procedure_normalized_description
    tags:
      - clinical
      - procedure
      - intermediate
    materialized: table


- name: data_quality__procedure_procedure_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: procedure_procedure_id
    tags:
      - clinical
      - procedure
      - intermediate
    materialized: table


- name: data_quality__procedure_claim_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: procedure_claim_id
    tags:
      - clinical
      - procedure
      - intermediate
    materialized: table


- name: data_quality__procedure_source_code
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: procedure_source_code
    tags:
      - clinical
      - procedure
      - intermediate
    materialized: table


- name: data_quality__procedure_source_code_type
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: procedure_source_code_type
    tags:
      - clinical
      - procedure
      - intermediate
    materialized: table


- name: data_quality__procedure_source_description
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: procedure_source_description
    tags:
      - clinical
      - procedure
      - intermediate
    materialized: table


- name: data_quality__procedure_practitioner_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: procedure_practitioner_id
    tags:
      - clinical
      - procedure
      - intermediate
    materialized: table


- name: data_quality__procedure_data_source
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: procedure_data_source
    tags:
      - clinical
      - procedure
      - intermediate
    materialized: table


- name: data_quality__procedure_patient_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: procedure_patient_id
    tags:
      - clinical
      - procedure
      - intermediate
    materialized: table


- name: data_quality__procedure_procedure_date
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: procedure_procedure_date
    tags:
      - clinical
      - procedure
      - intermediate
    materialized: table


- name: data_quality__procedure_encounter_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: procedure_encounter_id
    tags:
      - clinical
      - procedure
      - intermediate
    materialized: table


- name: data_quality__procedure_modifier_5
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: procedure_modifier_5
    tags:
      - clinical
      - procedure
      - intermediate
    materialized: table


- name: data_quality__procedure_modifier_4
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: procedure_modifier_4
    tags:
      - clinical
      - procedure
      - intermediate
    materialized: table


- name: data_quality__procedure_normalized_code
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: procedure_normalized_code
    tags:
      - clinical
      - procedure
      - intermediate
    materialized: table


- name: data_quality__procedure_modifier_1
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: procedure_modifier_1
    tags:
      - clinical
      - procedure
      - intermediate
    materialized: table


- name: data_quality__procedure_modifier_3
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: procedure_modifier_3
    tags:
      - clinical
      - procedure
      - intermediate
    materialized: table


- name: data_quality__procedure_modifier_2
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: procedure_modifier_2
    tags:
      - clinical
      - procedure
      - intermediate
    materialized: table
#### Concepts
- name: data_quality__unique_value_examples
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: unique_value_examples
    tags:
      - clinical
      - concepts
      - intermediate
    materialized: table


- name: data_quality__primary_keys_condition_condition_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: primary_keys_condition_condition_id
    tags:
      - clinical
      - concepts
      - intermediate
    materialized: table


- name: data_quality__primary_keys_encounter_encounter_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: primary_keys_encounter_encounter_id
    tags:
      - clinical
      - concepts
      - intermediate
    materialized: table


- name: data_quality__primary_keys_lab_result_lab_result_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: primary_keys_lab_result_lab_result_id
    tags:
      - clinical
      - concepts
      - intermediate
    materialized: table


- name: data_quality__primary_keys_location_location_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: primary_keys_location_location_id
    tags:
      - clinical
      - concepts
      - intermediate
    materialized: table


- name: data_quality__primary_keys_medication_medication_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: primary_keys_medication_medication_id
    tags:
      - clinical
      - concepts
      - intermediate
    materialized: table


- name: data_quality__primary_keys_observation_observation_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: primary_keys_observation_observation_id
    tags:
      - clinical
      - concepts
      - intermediate
    materialized: table


- name: data_quality__primary_keys_patient_patient_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: primary_keys_patient_patient_id
    tags:
      - clinical
      - concepts
      - intermediate
    materialized: table


- name: data_quality__primary_keys_practitioner_practitioner_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: primary_keys_practitioner_practitioner_id
    tags:
      - clinical
      - concepts
      - intermediate
    materialized: table


- name: data_quality__primary_keys_procedure_procedure_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: primary_keys_procedure_procedure_id
    tags:
      - clinical
      - concepts
      - intermediate
    materialized: table


#### union all processing
### Claims Specific

- name: data_quality__claim_type_summary
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: claim_type_summary
    tags:
      - claims
      - union all_processing
      - intermediate
    materialized: table



- name: data_quality__data_quality_claims_detail
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: data_quality_claims_detail
    tags:
      - claims
      - union all_processing
      - intermediate
    materialized: table


- name: data_quality__data_quality_claims_for_pbi
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: data_quality_claims_for_pbi
    tags:
      - claims
      - union all_processing
      - intermediate
    materialized: table


### Clinical Specific


- name: data_quality__data_quality_clinical_detail
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: data_quality_clinical_detail
    tags:
      - clinical
      - union all_processing
      - intermediate
    materialized: table


- name: data_quality__data_quality_clinical_for_pbi
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: data_quality_clinical_for_pbi
    tags:
      - clinical
      - union all_processing
      - intermediate
    materialized: table


## Staging

- name: data_quality__stg_eligibility
  config:
    tags:
      - data_quality_intelligence
    materialized: ephemeral

- name: data_quality__stg_institutional_inpatient
  config:
    tags:
      - data_quality_intelligence
    materialized: ephemeral

- name: data_quality__stg_medical_claim
  config:
    tags:
      - data_quality_intelligence
    materialized: ephemeral

- name: data_quality__stg_pharmacy_claim
  config:
    tags:
      - data_quality_intelligence
    materialized: ephemeral