version: 2
models:

#### Data Quality

- name: data_quality__pharmacy_patient
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: pharmacy_patient
    tags:
      - data_quality_new
    materialized: table

- name: data_quality__pharmacy_claim_date_checks
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: pharmacy_claim_date_checks
    tags:
      - data_quality_new
    materialized: table

- name: data_quality__pharmacy_claim_date_trends
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: pharmacy_claim_date_trends
    tags:
      - data_quality_new
    materialized: table

- name: data_quality__pharmacy_claim_ndc
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: pharmacy_claim_ndc      
    tags:
      - data_quality_new
    materialized: table

- name: data_quality__pharmacy_claim_prescription_details
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: pharmacy_claim_prescription_details      
    tags:
      - data_quality_new
    materialized: table

- name: data_quality__pharmacy_claim_npi
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: pharmacy_claim_npi      
    tags:
      - data_quality_new
    materialized: table

- name: data_quality__pharmacy_claim_trended_claim_volume_and_dollars
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: pharmacy_claim_trended_claim_volume_and_dollars      
    tags:
      - data_quality_new
    materialized: table

- name: data_quality__primary_keys
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: primary_keys      
    tags:
      - data_quality_new
    materialized: table

- name: data_quality__medical_claim_patient_id
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: medical_claim_patient_id      
    tags:
      - data_quality_new
    materialized: table

- name: data_quality__medical_claim_date_checks
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: medical_claim_date_checks      
    tags:
      - data_quality_new
    materialized: table

- name: data_quality__medical_claim_inst_header_fields
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: medical_claim_inst_header_fields      
    tags:
      - data_quality_new
    materialized: table

- name: data_quality__medical_claim_claim_line_fields
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: medical_claim_claim_line_fields      
    tags:
      - data_quality_new
    materialized: table

- name: data_quality__medical_claim_provider_npi
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: medical_claim_provider_npi      
    tags:
      - data_quality_new
    materialized: table

- name: data_quality__medical_claim_volume_and_dollars
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: medical_claim_volume_and_dollars      
    tags:
      - data_quality_new
    materialized: table

- name: data_quality__data_loss
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: data_loss      
    tags:
      - data_quality_new
    materialized: table

- name: data_quality__core_populated
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: core_populated      
    tags:
      - data_quality_new
    materialized: table

- name: data_quality__analytics_populated
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    alias: analytics_populated      
    tags:
      - data_quality_new
    materialized: table

#### stage
- name: data_quality__eligibility_dq_stage
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    tags:
      - data_quality_new
    materialized: view

- name: data_quality__inpatient_dq_stage
  config:
    schema: |
      {%- if var('tuva_schema_prefix',None) != None -%}{{var('tuva_schema_prefix')}}_data_quality
      {% else %}data_quality{%- endif -%}
    tags:
      - data_quality_new
    materialized: view